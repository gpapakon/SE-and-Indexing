<DOC>
<DOCNO>EP-0639907</DOCNO> 
<TEXT>
<INVENTION-TITLE>
Digital signature method and key agreement method
</INVENTION-TITLE>
<CLASSIFICATIONS>H04L932	G06F760	H04L908	G06F772	G07F710	H04L932	H04L908	G07F710	</CLASSIFICATIONS>
<CLASSIFICATIONS-THIRD>H04L	G06F	H04L	G06F	G07F	H04L	H04L	G07F	</CLASSIFICATIONS-THIRD>
<CLASSIFICATIONS-FOURTH>H04L9	G06F7	H04L9	G06F7	G07F7	H04L9	H04L9	G07F7	</CLASSIFICATIONS-FOURTH>
<ABSTRACT>
A digital signature method based on the discrete logarithm problem is 
provided that allows message recovery. The message x is transformed according 

to the rule 

e = x g-r mod p 
 
, where r is a secret value generated by the 

signer. A value y is then calculated according to the rule 

y = r + s e mod 
q 
 
, where s is the signer's secret key. The signature of x consists of the 

pair (e,y). The verifier recovers the message x according the the rule 

x = 
gy ke e mod p 
 
, where k is the signer's public key. The validation of x can 

be based on some redundancy contained in x. Alternatively, a conventional 
verification equation can be constructed by using the signature method 

together with a hash function H. In addition, a key agreement method based 
on the signature method is provided which establishes with a single 

transmission pass a shared secret key K between two parties A and B in an 
authenticated fashion. 


</ABSTRACT>
<APPLICANTS>
<APPLICANT-NAME>
R3 SECURITY ENGINEERING AG
</APPLICANT-NAME>
<APPLICANT-NAME>
R3 SECURITY ENGINEERING AG
</APPLICANT-NAME>
</APPLICANTS>
<INVENTORS>
<INVENTOR-NAME>
NYBERG KAISA DR
</INVENTOR-NAME>
<INVENTOR-NAME>
RUEPPEL RAINER A DR
</INVENTOR-NAME>
<INVENTOR-NAME>
NYBERG, KAISA, DR.
</INVENTOR-NAME>
<INVENTOR-NAME>
RUEPPEL, RAINER A., DR.
</INVENTOR-NAME>
</INVENTORS>
<DESCRIPTION>
The invention relates to a method for generating
and verifying a digital signature of a message. The
field of this invention is data integrity and in particular
generating and verifying a digital signature for a
message or data file. The inventive method can also be
used to establish a shared secret key between two parties.The invention also relates to an apparatus
for generating and/or verifying a digital signature.When a message is transmitted from one party
to another, the receiving party may desire to determine
whether the message has been altered in transit. Furthermore,
the receiving party may wish to be certain of the
origin of the message. It is known in the prior art to
provide both of these functions using digital signature
methods. Several known digital signature methods are
available for verifying the integrity of a message. These
known digital signature methods may also be used to prove
to a third party that the message was signed by the actual
originator. Several attempts have been made to find
practical public key signature schemes that are based on
the difficulty of solving certain mathematical problems
to make alteration or forgery by unauthorized parties
difficult. Most of the proposed schemes have been based
either on the problem of factoring large integers or on
the difficulty of computing discrete logarithms over finite
fields (or over finite groups in general). For example,
the Rivest-Shamir-Adleman system depends on the difficulty
of factoring large integers (see "A method for
obtaining digital signatures and public key cryptosystems", 
Communications of the ACM, Feb. 1978, Vol.
21, No. 2, pp. 120-126)In 1985 Taher El-Gamal proposed a signature
scheme based on the discrete logarithm problem (see "A
Public Key Cryptosystem and a Signature Scheme Based on
Discrete Logarithms," IEEE Trans. on Inform. Theory, vol.
IT-31, pp. 469-472, July 1985). In 1987 Chaum, Evertse
and Van de Graaf proposed a zero-knowledge identification
protocol based on the discrete logarithm problem. 1989
Schnorr proposed a modification of that protocol to obtain
an efficient identification and signature scheme
(see C.P. Schnorr, "Efficient Identification and Signatures
for Smart Cards", Proceedings of Crypto'89,
Springer-Verlag 1990, pp. 239-252 and European Patent Application
EP 0 384 475 A1). 1991 the National Institute
of Standards and Technology (NIST) proposed the "Digital
Signature Method" that combines some features of ElGamal's
and Schnorr's schemes (see Worldwide Patent WO
93/03562).There are digital
</DESCRIPTION>
<CLAIMS>
A method for generating a digital signature
e,y of a message x, comprising the steps of:


a. (step 15) providing a secret and random
value r;
b. providing a public value g;
c. (step 20) calculating a corresponding
value u proceeding from a prime modulus p according to

the rule

u = g
-r
 mod p;
d. (step 30) calculating said value e from
said message x and said value u according to the rule e =

f(G(x), u), wherein G(x) is a value derived from said
message x;
e. (step 40) calculating said value y proceeding
from a value q, selected to be a divisor of p-1,

according to the rule

y = r + se mod q

where s is a secret value;

   characterized in that

said function f(G(x), u) is such that
G(x) can be calculated from e and u using a function

h(u
-1
, e) = G(x).
The method of claim 1, wherein G(x) = x
and wherein x comprises a natural or artificially inserted

redundancy.
The method of claim 1, wherein G(x) is a
hash value H(x) computed by applying
 a hash function H to
said message x.
The method of any of the preceding claims,
wherein


f(G(x), u) = G(x)·u mod p

and

h(u
-1
, e) = u
-1
·e mod p,

or wherein

f(G(x), u) = G(x) + u mod p

and 

h(u
-1
, e) = e - u mod p,

or wherein

f(G(x), u) = G(x) xor u

and

h(u
-1
, e) = e xor u.
The method of any of the preceding claims,
wherein the sign of r and/or the sign of s are/is negative.
A method for verifying a digital signature
generated by the method of any of the preceding claims

comprising the steps of:

f. (step 110) calculating the inverse of said
value u according to the rule


u
-1
 = g
y
 k
e
 mod p

where k is congruent to g
-s
 mod p and value s is said secret
value;
g. (step 120) reconstructing G(x) from u
-1

and e according to the rule

G(x) = h(u
-1
, e)
h. (step 130) checking the validity of said
signature e,y using said value G(x).
The method of claim 6, wherein G(x) = x
and wherein step h comprises the verification of a natural

or artificially inserted redundancy in x.
The method of claim 6, wherein G(x) is a
hash value H(x) computed by applying a hash function H to

said message x and wherein step h comprises the verification
of said signature by comparison of G(x) as obtained

in step g with the value obtained from applying H to the
message x directly.
A method for generating a digital signature
e,y of a message x according to any of the claims 1-5

and for verifying the digital signature according to
any of the claims 6-8, wherein the arithmetic modulo p is

replaced by any other equivalent arithmetic where the
discrete logarithm problem is difficult to solve, such as

arithmetic in an extension field or arithmetic on an elliptic
curve over a finite field. 
Apparatus arranged to generate a digital
signature comprising means arranged to carry out the different

steps of the method of any one of the claims 1-5.
Apparatus arranged to verify a digital
signature comprising means arranged to carry out the different steps of the

method of any one of the claims 6-8.
A method for establishing a shared secret
key K between two parties A and B, comprising the steps

of:

a. (step 215) providing to party A two secret
and random values r and R;
b. providing a public value g and calculating
by party A a message x = g
R
;
c. calculating by party A a value u proceeding
from a prime modulus p according to the rule


u = g
-r
 mod p;
d. (step 220) calculating by party A a value

e = x u mod p;
e. (step 230) calculating by party A a value
y proceeding from a divisor q of p-1 according to the

rule

y = r + S
A
 e mod q

where s
A
 is a secret value only known by party A;
e1. (step 240) calculating by party A said
shared key K according to the rule


K = k
B
R
 mod p

where k
B
 is congruent to g
-S
B
 mod p and said value S
B
 is
a secret value only known by party B;
e2. transmitting said values e, y from party
A to party B;
f. calculating by party B the inverse of said
value u according to rule


u
-1
 = g
y
 k
A
e
 mod p;
g. (step 320) reconstructing by party B the
value x = g
R
 mod p according to the rule

g
R
 = g
y
 k
A
e
 e mod p = u
-1
 e mod p;

where k
A
 is congruent to g
-S
A
 mod p; 
h. (step 330) calculating by party B said
shared key K according to the rule


K = (g
R
)
-S
B
 mod p

where S
B
 is a secret value only known by party B.
The method of claim 12, where in step c
and e the sign of said value r is inverted, and/or where

in step b, e1, g and h the sign of said value R is inverted,
and/or where in steps e, e1, g and/or h the sign

of said values S
A
 and S
B
 are inverted.
</CLAIMS>
</TEXT>
</DOC>
