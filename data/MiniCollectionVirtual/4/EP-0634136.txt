<DOC>
<DOCNO>EP-0634136</DOCNO> 
<TEXT>
<INVENTION-TITLE>
Method and device for processing ECG-signals
</INVENTION-TITLE>
<CLASSIFICATIONS>G06F1700	A61B50452	G06F1700	A61B50472	A61B50452	</CLASSIFICATIONS>
<CLASSIFICATIONS-THIRD>G06F	A61B	G06F	A61B	A61B	</CLASSIFICATIONS-THIRD>
<CLASSIFICATIONS-FOURTH>G06F17	A61B5	G06F17	A61B5	A61B5	</CLASSIFICATIONS-FOURTH>
<ABSTRACT>
In a method for processing ECG-signals for the purpose of 
detecting low-amplitude signal structures in noise, the ECG-signals 

from a plurality of cardiac cycles are A/D-converted, 
and QRS complexes are detected. The signals from 

at least two cardiac cycles are time-synchronized, whereupon 
the concordance between these signals in intervals 

comprising at least two samples is determined, and an output 
quantity, representing the concordance thus determined, is 

generated, the magnitude of the output quantity designating 
the amplitude of the signal structure in question. A device 

for processing ECG-signals, in a similar manner, comprises 
means (24) for recording ECG-signals from a plurality of 

cardiac cycles, A/D-conversion of the signals and detection 
of QRS complexes. A synchronization unit is arranged to 

time-synchronize the signals from at least two cardiac 
cycles, and a calculator unit (10) is arranged to determine 

the concordance between the signals in time intervals, 
comprising at least two samples. The output means (12) are, 

finally, connected to the calculator unit in order to 
generate an output quantity the magnitude of which 

designates the amplitude of the signal structures in 
question. 


</ABSTRACT>
<APPLICANTS>
<APPLICANT-NAME>
SIEMENS ELEMA AB
</APPLICANT-NAME>
<APPLICANT-NAME>
SIEMENS-ELEMA AB
</APPLICANT-NAME>
</APPLICANTS>
<INVENTORS>
<INVENTOR-NAME>
ATARIUS ROOZBEH
</INVENTOR-NAME>
<INVENTOR-NAME>
OHLSSON THOMAS
</INVENTOR-NAME>
<INVENTOR-NAME>
SOERNMO LEIF
</INVENTOR-NAME>
<INVENTOR-NAME>
ATARIUS, ROOZBEH
</INVENTOR-NAME>
<INVENTOR-NAME>
OHLSSON, THOMAS
</INVENTOR-NAME>
<INVENTOR-NAME>
SOERNMO, LEIF
</INVENTOR-NAME>
</INVENTORS>
<DESCRIPTION>
The present invention relates to a method and a device for
processing ECG-signals for the purpose of detecting low-amplitude
signal structures in noise of the kind described
in the preambles of claims 1 and 13 respectively.These signal structures, such as so-called late potentials,
have an amplitude of the order of a few µV, usually making
impossible direct, quantitative detection of the same in the
ECG-signal. Signal averaging has hitherto been frequently
used to reduce the level of noise. The signal is further
subjected to highpass filtration in order to eliminate low-frequency
components. The vector quantities of the X, Y and
Z leads is then compared to a threshold value so as to
determine whether or not late potentials are present, cf.
US,A,4 422 459. However, residual noise affects the vector
quantity, thereby degrading accuracy. Important information
in individual leads is also lost when they are combined into
a single vector quantity.Spectral analysis of late potentials has also appeared to be
associated with major difficulties, since spectral analysis
of predominantly transient signals is generally complicated.The object of the present invention is to propose a new
method and provide a new device, based on a statistical
model which explicitly takes the presence of noise into
account, for more reliable detection of low-amplitude signal
structures in ECG-signals.This object is achieved with a method and a device of the
kind mentioned in the introductory part having the
characterizing features set forth in claims 1 and 13 
respectively.The present invention utilizes the circumstance that noise
is essentially uncorrelated from one cardiac cycle to
another, whereas the ECG-activity of interest is repetitive.According to one advantageous further development of the
invention, at least two sub-average values are formed of at
least the part of the signals containing the signal
structure in question from at least two different groups of
cardiac cycles in the plurality of cardiac cycles, whereupon
the concordance between the sub-average values is
determined. This improves the possibility of separating the
signal from noise.In the present invention each lead is processed
individually, thereby avoiding the loss of information which
occurs when a plurality of leads is combined into a single
vector unit.The invention will now be described in greater detail with
the aid of an exemplifying embodiment of the device
according to the invention with reference to the attached
drawings in which
FIG. 1 is an overview
</DESCRIPTION>
<CLAIMS>
Method for processing ECG-signals for the purpose of detecting
low-amplitude signal structures in noise, in which

method ECG-signals from a plurality of cardiac cycles are A/D

converted, and QRS complexes are detected,
characterized in that the signals from at least two

cardiac cycles are timesynchronized, whereupon the
concordance between these signals in time intervals

encompassing at least two samples is determined, and an
output quantity representing the concordance thus determined

is generated, the magnitude of the output quantity
designating the amplitude of the signal structures in

question.
Method according to claim 1, 
characterized
 in that
the noise level is estimated of the signals from each heart

cycle for compensation at the determination of the concordance.
Method according to any of claims 1 or 2, 
characterized

in that at least two sub-average values are formed of
at least the part of the signals containing the signal structure

in question from at least two different groups of
cardiac cycles in said plurality of cardiac cycles, whereupon

the concordance between the sub-average values is determined.
Method according to claim 3, 
characterized in
 that
n sub-average values, where n
>
2, are determined from the
signals of the cardiac cycles 1, n+1, 2n+1 ... and 2, n+2,

2n+2 etc. and n; 2n, 3n ... respectively of the said
plurality of cardiac cycles.
Method according to any of claims 3 or 4, 
characterized

in that the cross-covariance of the sub-average
values is determined in order to determine the concordance

between these values. 
Method according to claim 5, 
characterized
 in that
the cross-covariance is calculated for the sub-average values

in successive, overlapping intervals.
Method according to any of claims 5 or 6, 
characterized

in that the sub-average values are filtered according
to the magnitude of cross-covariance, whereupon the filtered

values are subjected to non-linear processing to form a function
representing the amplitude of said signal structures.
Method according to claim 7, 
characterized
 in that
the noise compensation of the filtered sub-average values is

performed in conjunction with the non-linear signal processing.
Method according to any of claims 5 - 8,

characterized
 in that the concordance of the sub-average
values is represented by a cross-covariance matrix

resulting from the calculation of cross-covariance, and in
that the filtration of the sub-average values is performed as

an eigenvector-based filtration with eigenvectors determined
from the cross-covariance matrix.
Method according to any of claims 7 - 9, 
characterized

in that the non-linear processing comprises squaring
of the filtered sub-average values, calculation of the signal

power and calculation therefrom of the signal amplitude.
Method according to claim 10, 
characterized
 in
that the resulting signal amplitude curve is compared with a

standard curve for determining a characteristic time in the
signal structure in question, e.g. its end point. 
Method according to any of claims 1 - 11, 
characterized

in that the said signal structures comprise so-called
late potentials.
Device for processing ECG-signals for the purpose of detecting
low-amplitude signal structures in noise, comprising

means (2,4) for recording ECG-signals from a plurality of
cardiac cycles, A/D-conversion of the signals and detection

of QRS complexes, 
characterized
 in that a
synchronization unit is arranged to time-synchronize the

signals from at least two cardiac cycles, and in that a
calculator unit (10) is arranged to determine the concordance

between the signals in time intervals, comprising at least
two samples, and in that output means (12) are connected to

the calculator unit in order to generate an output quantity
the magnitude of which designates the amplitude of the signal

structures in question.
Device according to claim 13, 
characterized
 in
that an averager (6) is arranged to form at least two sub-average

values of at least the parts of the ECG-signals,
which comprise said signal structures, in at least two

different groups of cardiac cycles of said plurality of heart
cycles, said averager (6) being connected to the calculator

unit (10) for determining the concordance between the sub-average
values.
Device according to claim 14, 
characterized
 in
that the calculator unit (10) is arranged to form the cross--covariance

between the sub-average values in order to
determine the concordance.
Device according to claim 15, 
characterized
 in
that the calculator unit (10) is connected to a filter unit

(16) for filtering the sub-average values according to the
magnitude of cross-covariance, and in that a signal 

processing unit (12) is arranged to subject the filtered
values to a non-linear processing in order to form a function

representing the amplitude of said signal structures.
Device according to claim 16, 
characterized
 in
that a unit (18) is arranged to estimate the level of noise

in the signal from each cardiac cycle, which unit is
connected to the signal processing unit (10) in order to

compensate the sub-average values for the noise in
conjunction with the non-linear signal processing.
Device according to any of claims 15 - 17,

characterized
 in that the calculator unit (10) is
arranged to calculate the cross-covariance of the sub-average

values in successive, overlapping intervals.
Device according to any of claims 16 - 18,

characterized
 in that the calculator unit (10)
controls the filter unit (16) to perform eigenvector-based

filtration, controlled by eigenvectors determined by the
cross-covariance calculation.
Device according to any of claims 16 - 19,

characterized
 in that the signal processing unit (12)
is arranged to square the filtered sub-average values and

determine the signal power and therefrom the signal
amplitude.
Device according to patent claim 20, 
characterized

in that the signal processing unit (12) comprises a so-called
Maximum Likelihood estimator (32), arranged to solve

the Maximum Likelihood equation

 
in which


λ
i
 denotes eigenvalues of the cross-covariance
matrix,
σ
v
2
 the variance of the estimated noise,
t
i
 the correlation between sub-average values
and i:th column in the eigenvector matrix,
Θ
2
 the signal power, and
m the number of samples in the interval.
Device according to any of the claims 16 - 21,

characterized
 in that a comparator unit (14) is
connected to the output of the signal processing unit (12) in

order to compare the terminal part of the signal amplitude
curve with a predetermined standard curve in order to

determine a characteristic time in the signal structure as
the time position in the standard curve which gives the best

concordance with the signal amplitude curve.
</CLAIMS>
</TEXT>
</DOC>
