<DOC>
<DOCNO>EP-0635956</DOCNO> 
<TEXT>
<INVENTION-TITLE>
Encryption apparatus, communication system using the same and method therefor
</INVENTION-TITLE>
<CLASSIFICATIONS>H04L918	H04L922	</CLASSIFICATIONS>
<CLASSIFICATIONS-THIRD>H04L	H04L	</CLASSIFICATIONS-THIRD>
<CLASSIFICATIONS-FOURTH>H04L9	H04L9	</CLASSIFICATIONS-FOURTH>
<ABSTRACT>
In order to attain high speed and secure 
encryption, a communication apparatus comprises a 

random number generation circuit for sequentially 
generating random number sequences which assure 

difficulty in terms of amount of calculation in 
cryptoanalyzing the sequences based on output 

sequences while using a cryptographic key shared by 
partner stations as an initial value, and an 

encryption circuit for sequentially encrypting 
communication texts and outputting cryptograms in 

a transmitting station and sequentially 
cryptoanalyzing the cryptograms and outputting the 

same in a receiving station, faster than the 
sequential generation of the random numbers by the 

random number generation circuit. 

</ABSTRACT>
<APPLICANTS>
<APPLICANT-NAME>
CANON KK
</APPLICANT-NAME>
<APPLICANT-NAME>
CANON KABUSHIKI KAISHA
</APPLICANT-NAME>
</APPLICANTS>
<INVENTORS>
<INVENTOR-NAME>
IWAMURA KEIICHI
</INVENTOR-NAME>
<INVENTOR-NAME>
YAMAMOTO TAKAHISA
</INVENTOR-NAME>
<INVENTOR-NAME>
IWAMURA, KEIICHI
</INVENTOR-NAME>
<INVENTOR-NAME>
YAMAMOTO, TAKAHISA
</INVENTOR-NAME>
</INVENTORS>
<DESCRIPTION>
The present invention relates to an
encryption system, and more particularly to data
security, acknowledgement of sender and receiver,
sharing of cryptographic key and zero knowledge
certification protocol in a field of
cryptocommunication.Prior art encryption system may be classified
into two major categories. In one category of
encryption system, a cryptographic key may be
cryptoanalyzed if a certain number of cryptograms are
available, that is, all of subsequently outputted
cryptograms can be readily cryptoanalyzed. Such an
encryption system is referred to as a system A.
Typical examples of the system A are the Feistel
encryption such as DES (Data Encryption Standard)
or FEAL (Fast Encryption Algorithm), or linear
feedback shift register system (hereinafter LFSR
system) or non-linear feedback shift register system
which uses a shift register.As shown in Fig. 12, the LFSR system
comprises a stages of shift registers 
R(t) = = (rs(t), rs-1(t), ..., r2(t), r1(t)) and tap
train (hs, hs-1, ..., h2, h1). It simultaneously
performs the following operations for each time point
(stop) to generate a pseudo-random number sequence.
(a) Output the bit r1(t) of the rightmost register
as a pseudo-random sequence
kt = r1(t)(b) Shift right rs(t), rs-1(t), ..., r2(t)
ri(t+1) = ri+1(t) (i = 1, 2, ..., s-1)(c) Calculate the bit rs(t+1) of the leftmost
register based on the content of the register and the
tap train.
To summarize the above, the pseudo-random
number sequence generation algorithm of the LFSR
system can be expressed by using an s-row and s-column
matrix H as follows:
R(t+1) = H·R(t) mod2
Namely,
By properly selecting the tap train of the
s-stage LFSR, a pseudo-random bit sequence having a
maximum period of 2s - 1 may be generated and the
sequence thereof is the maximum period sequence
described above.However, in the random number sequence
generation method using the LFSR, the s-stage tap
train (hs, hs-1, ..., h2, h1) may be determined based
on 2s-bit output pseudo-random number sequence in the
following manner by utilizing the linearity of the
LFSR.Assuming that the output pseudo-random number
sequence is k1, k2, ..., k2s, the contents R(t) of
the register at time points t (t = 1, 2, ..., s+1)
are represented by:
R(1) = (ks, ks-1, ..., k1)TR(2) = (ks-1, ks, ..., k2)T
   ...
R(s+1) = (k2s, k2s-1, ..., ks-1)T
where T represents transposition. When matrices X
and Y are given by:
X = (R(1), R(2), ..., R(s))Y = (R(2), R(3), ..., R(s+1))
the following relation is met from the formula (1);
Y = H·X, that is;H = Y·
</DESCRIPTION>
<CLAIMS>
An apparatus for generating a bit sequence for
encryption communication comprising:


first generation means (13) for generating a bit
sequence based on a first parameter;
second generation means (11) for generating a random
number sequence using a second parameter as an initial

value; and
modifying means for periodically modifying the first
parameter using at least part of the random number

sequence generated by the second generation means (11),
the apparatus being 
characterised in that
 the first
and second generation means (13, 11) are arranged so that

the random number sequence generated by the second
generation means (11) is generated at a rate slower than

the rate at which the bit sequence is generated by the
first generation means and the random number sequence

generated by the second generation means (11) requires
a larger amount of calculation to cryptoanalyse than the

bit sequence generated by the first generation means (13)
due to requiring a process having a complexity equivalent

to solving the factorization problem or the discrete
logarithm problem.
An apparatus according to claim 1, wherein said
first generation means (13) includes an input means for 

inputting communication data, encryption means for
encrypting the communication data and output means for

outputting the encrypted data as the bit sequence.
An apparatus according to claim 1, wherein said
first generation means (13) includes input means for

inputting encrypted data, and decryption means for
decrypting the encrypted data and output means for

outputting the decrypted data as the bit sequence.
An apparatus according to claim 1, wherein said
first generation means (13) generates a second random

number sequence as the bit sequence.
A communication system comprising a transmission
unit incorporating an apparatus (122) according to claim

2, and a receiver unit incorporating an apparatus (122)
according to claim 3, wherein the second parameter of the

apparatus (122) according to claim 2 corresponds to the
second parameter of the apparatus (122) according to

claim 3.
An apparatus according to any preceding claim,
wherein said first generation means (13) comprises a

choice from a DES random number generation means, a
linear feedback shift register and a non-linear feedback

shift register. 
An apparatus according to any preceding claim,
wherein said second generation means (11) comprises a

choice from:

means for performing a square residue operation and
outputting several low order bits of the operation

result, means for generating RSA random numbers and means
for generating discrete logarithm random numbers.
An apparatus according to any one of claims 1 to 5,
wherein said first generation means (13) comprises:


holding means (31) for holding data;
conversion means (32) for receiving the data held by
said holding means (31) and converting the received data

based on a parameter in a sequence of parameters;
updating means for updating the data held by said holding

means (31) in accordance with the conversion result by
said conversion means (32);
means for sequentially producing a portion of the
data held by said holding means (31) as a random number

sequence; and wherein
the modifying means is arranged to modify the
sequence of parameters at a rate determined by the rate

of random number sequence generation of the second
generation means (11).
A method of generating a bit sequence for encryption
communication comprising: 


a first generation step of sequentially generating
a bit sequence based on a first parameter;
a second generation step of sequentially generating
a random number sequence using a second parameter as an

initial value; and
a modifying step of periodically modifying the first
parameter using at least part of the random number

sequence generated during the second random number
generation step,
the method being 
characterised by
 generating a
random number sequence during the second generation step

at a rate slower than the rate at which the bit sequence
is generated during the first generation step and

generating a random number sequence in the second
generation step that requires a larger amoun
t of
calculation to cryptoanalyse than the bit sequence

generated during the first generation step due to
requiring a process having a complexity equivalent to

solving the factorization problem or the discrete
logarithm problem.
A method according to claim 9, further comprising:

an inputting step of inputting communication data;
an encrypting step of encrypting the communication
data; and
an outputting step of outputting the encrypted data
as the bit sequence.
A method according to claim 9, further comprising:

an inputting step of inputting encrypted data;
a decrypting step of decrypting the encrypted data;
and
an outputting step of outputting the decrypted data
as the bit sequence.
A method according to claim 9, wherein said first
generation step generates a second random number sequence

as the bit sequence.
A method of communicating code data between a
transmission unit and a receiver unit comprising a

transmitting step incorporating a method according to
claim 10, and a receiving step incorporating a method

according to claim 11, wherein the second parameter of
the method according to claim 10 corresponds to the

second parameter of the method according to claim 11.
A method according to any one of claims 9 to 13,
wherein said first generation step comprises a choice

from DES random number generation or random number
generation using a linear feedback shift register or

random number generation using a non-linear feedback
shift register.
A method according to any one of claims 9 to 14, 
wherein said second generation step comprises a choice

from:

performing a square residue operation and outputting
several low order bits of the operation result,

generating RSA random numbers and generating discrete
logarithm random numbers.
A method according to any one of claims 9 to 13,
wherein said first generation step comprises:


a holding step of holding data;
a converting step of receiving the data held during
said holding step and converting the received data based

on a parameter in a sequence of parameters;
an updating step of updating the data held during
said holding step in accordance with the conversion

result produced in said converting step;
a producing step for sequentially producing a
portion of the data held during said holding step as a

random number sequence; and wherein
the sequence of parameters are modified during the
modifying step at a rate determined by the rate of random

number sequence generation during the second generation
step.
</CLAIMS>
</TEXT>
</DOC>
