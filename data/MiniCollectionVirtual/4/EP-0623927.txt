<DOC>
<DOCNO>EP-0623927</DOCNO> 
<TEXT>
<INVENTION-TITLE>
Magnetic disk apparatus.
</INVENTION-TITLE>
<CLASSIFICATIONS>G11B2010	G11B2010	G11B2012	G11B2012	G11B2018	G11B2018	G11B2710	G11B2710	G11B2730	G11B2730	</CLASSIFICATIONS>
<CLASSIFICATIONS-THIRD>G11B	G11B	G11B	G11B	G11B	G11B	G11B	G11B	G11B	G11B	</CLASSIFICATIONS-THIRD>
<CLASSIFICATIONS-FOURTH>G11B20	G11B20	G11B20	G11B20	G11B20	G11B20	G11B27	G11B27	G11B27	G11B27	</CLASSIFICATIONS-FOURTH>
<ABSTRACT>
In a magnetic disc apparatus having data tracks, relocation 
tracks, and data-saving tracks, each track of these tracks has 

sectors composed of an identifier and a data part. An identifier 
includes a logical sector address and flags. And relocation is 

performed in a sector unit(not in a track unit), and identifiers are 
used for data identification in relocation. 


</ABSTRACT>
<APPLICANTS>
<APPLICANT-NAME>
NIPPON ELECTRIC CO
</APPLICANT-NAME>
<APPLICANT-NAME>
NEC CORPORATION
</APPLICANT-NAME>
</APPLICANTS>
<INVENTORS>
<INVENTOR-NAME>
KITAGAWA MASAYUKI C O NEC CORP
</INVENTOR-NAME>
<INVENTOR-NAME>
KITAGAWA, MASAYUKI, C/O NEC CORP.
</INVENTOR-NAME>
</INVENTORS>
<DESCRIPTION>
This invention relates to a magnetic disk apparatus, and more 
particularly to relocation of sectors when one or more than one 
sector in a track of a magnetic disk apparatus is(are) found 
defective. Usually, a spare sector for the relocation is provided for each 
track, and relocation tracks comprising spare sectors for 
relocation are provided in a system of a magnetic disc apparatus. 
And usually a magnetic disk apparatus has a micro-processor with 
RAM(random access memory), and the relocation of sectors is 
program-controlled by the micro-processor. Fig. 8 shows an example of relocation of sectors in a prior art. 
A data track 81(a data track which is an object of relocation is 
called an object track, and an object track before relocation is 
called an original track) has seven sectors denoted by P0∼P6. Here 
P means sector number in a physical address(called P-number), where 
the physical address is determined by physical position of the 
sector, and since P-number is not changed by relocation, P-numbers 
are omitted in other drawings. Sectors of current use have sector numbers in a logical 
address(called L-number), where the logical address is the position 
of a sector in a whole virtual storage of the system. A logical 
address given by a program is converted to a corresponding physical 
address through a conversion table, and the converted physical 
address determines the sector to be accessed. Thus, in the original track 81, L-numbers L0∼L5 are assigned  
 
to sectors P0∼P5 respectively, and a sector designated by P6 is a 
spare sector for relocation and is denoted by SP. C0∼C5 are 
contents of sectors L0∼L5 respectively. Suppose a sector(P3) in the track 81 is found defective. A 
first step is to store all contents C0∼C5 to a data-saving 
track(not shown in Fig. 8)temporarily. During whole process of 
relocation, C0∼C5 might be damaged by a process or by an accident. 
Data stored in the data-saving track can restore damaged data. All 
contents are read out on a RAM from the original track 81, and then 
written on the data-saving track. Correspondence of track number 
and P-number between the original track and the data-saving track 
is memorized in a data-saving control table, and if L-numbers of the 
original track 81 are stored in sectors of the data-saving track, 
the L-numbers do not include track number information. When contents C3 from the defective sector L3 are not reliable, 
the data at L3 are made blank. When there is one spare sector for one defective sector in a 
track, the
</DESCRIPTION>
<CLAIMS>
A magnetic disc apparatus comprising data tracks 13, 
relocation tracks 14, data-saving tracks 15, data-saving means and 

relocation means characterized in that: 
   each track of said data tracks, relocation tracks, and 

data-saving tracks has sectors, and each sector has a data part 12 
and an identifier 11, said identifier comprising a logical sector 

address and flags; 
   said data-saving means selects a data-saving track or 

data-saving tracks, and moves contents of all sectors in current 
use of a data track which is an object of relocation, to said 

selected data-saving track or selected data-saving tracks before 
relocation; and 

   said relocation means selects, when necessary, a relocation 
track or relocation tracks, and rewrites all identifiers of said 

object data track and, all identifiers of said selected relocation 
track or relocation tracks, in accordance with a status after 

relocation of the sector, and moves contents of sectors stored in 

said data-saving track or data-saving tracks to said object data 
track and said selected relocation track or relocation tracks in 

sectors having same logical sector address with sectors in said 
data saving track or data-saving tracks. 
A magnetic disc apparatus of claim 1, wherein said data-saving 
track or data-saving tracks are so selected that total number of 

indefectible sectors in selected tracks is not less than total 
number of sectors in current use before relocation in said object 

data track. 
An apparatus of claim 1 or 2, wherein said relocation 
means selects said relocation track or relocation tracks when said 

object data track has not a sufficient number of indefectible 
sectors for relocating total number of sectors in current use 

before relocation, and said relocation track or relocation tracks 
are so selected that total number of indefectible sectors in said 

object data track and selected relocation track or relocation 
tracks is not less than total number of sectors in current use 

before relocation in said object data track. 
An apparatus of claim 1, 2 or 3, wherein said logical 
sector address comprises a cylinder number 11a, a head number 11b, 

and a sector number 11c. 
An apparatus of any one of claims 1 to 4, wherein said flags 
comprises a defective sector flag 11d-1 for indicating a defective 

sector, a relocation spare sector flag 11d-2 for indicating a spare 
sector for relocation, and a data-saving track flag 11d-3 for 

indicating a sector of a data-saving track. 
An apparatus of any one of claims 2 to 5, wherein said data-saving 
means moves, in a first step, identifiers of all sectors in current 

use of said object data track to said data-saving track or 
data-saving tracks, and in a second step, moves data parts of said 

all sectors to sectors in said data-saving track or data-saving 
tracks having same logical sector address with sectors in said 

object data track. 
An apparatus of claim 5 or 6, wherein said data-saving 
means sets said data-saving track flags on identifiers moved from 

said object data track to said data-saving track or data-saving 
 

tracks. 
An apparatus of claim 5, 6 or 7, characterized in that: 
said relocation means modifies said flags in which a defective 

sector flag is set in a sector which becomes a defective sector 
after relocation and a relocation spare flag is reset in a sector 

which becomes a data sector after relocation in said object data 
track and said selected relocation track or relocation tracks, and 

relocates all identifiers of all sectors in current use of said data 
track, to all sectors of said data track having no flag and to 

sectors of said relocation track or relocation tracks having no 
flag and not occupied by data relocated from other data tracks, 

maintaining order in said logical sector address. 
</CLAIMS>
</TEXT>
</DOC>
