<DOC>
<DOCNO>EP-0640946</DOCNO> 
<TEXT>
<INVENTION-TITLE>
Method and apparatus for verification of classes of documents
</INVENTION-TITLE>
<CLASSIFICATIONS>G07D700	G07F712	G07D700	G07D720	G07F712	</CLASSIFICATIONS>
<CLASSIFICATIONS-THIRD>G07D	G07F	G07D	G07D	G07F	</CLASSIFICATIONS-THIRD>
<CLASSIFICATIONS-FOURTH>G07D7	G07F7	G07D7	G07D7	G07F7	</CLASSIFICATIONS-FOURTH>
<ABSTRACT>
Method and apparatus for verification of documents 
belonging to selected groups of classes of such documents. 

The documents are verified to assure that information 
contained in the documents is authenticated and unchanged. In 

one embodiment of the subject invention the documents maybe 
identification cards including both text (T) and an image (I) of the 

bearer. Each document also includes encrypted information 
E
i
[M] derived from the document, and encrypted decryption key 

CE
j
[D
i
] for decrypting the encrypted information and 

information identifying the document as a member of the jth 
class C
j
 of a group of classes of documents. Verifying 
apparatus validates the document by a scanning information 

from the document decrypting the encrypted decryption key an 
using the decryption key so obtained to decrypted the 

encrypted information and comparing the recovered encrypted 
information with information derived from the document 

directly. The verifying apparatus is responsive to enabling 
information from a data center (40) to enable the verifying 

apparatus to decrypt the encrypted decryption key for any 
document in a selected group of classes. 


</ABSTRACT>
<APPLICANTS>
<APPLICANT-NAME>
PITNEY BOWES INC
</APPLICANT-NAME>
<APPLICANT-NAME>
PITNEY BOWES, INC.
</APPLICANT-NAME>
</APPLICANTS>
<INVENTORS>
<INVENTOR-NAME>
BERSON WILLIAM
</INVENTOR-NAME>
<INVENTOR-NAME>
BERSON, WILLIAM
</INVENTOR-NAME>
</INVENTORS>
<DESCRIPTION>
The present invention generally relates to a
reliable method and apparatus for verifying documents and
is applicable to a reliable document verification system
using a public key cryptosystem.Throughout history, one of the tasks undertaken by many
people and organizations has been proving the authenticity of
the information content of documents. The importance of
actually proving the authenticity of a document can range from
merely identifying a signature to verifying military and/or
political intelligence. Further, as often as one tries to
demonstrate the authenticity of a document, there is usually
at least one party that attempts to forge a document. Hence,
there has been, and probably will continue to be, an ongoing
struggle to be able to reliably verify documents.Over the years technological advances have brought new
meaning to the word "document". Today, a document may be, for
example, an electronically generated receipt from a banking
machine or a digitized recording on an optical recording disk.
For the purpose of this patent application, therefore, the
word "document" should be interpreted to include any
information placed on any medium including, but not limited
to, magnetic disks, optical disks or paper.Another, similar task that has just as colorful a history
as document authentication is the secure communication of
information commonly includes the use of encryption/decryption
techniques. Similar to the forger referred to above, there is
usually at least one party that is interested in either
stealing the information being communicated that has been
encrypted or supplying false information in an encrypted 
format so that the receiver thereof is disinformed, or both.
Hence, throughout history various encryption/decryption
schemes have been developed that, at least for a time, were
thought to be secure only to discover that the security had
been compromised. Again, technological advances have
considerably changed the field of cryptography. For example,
with modern computers many cryptographic techniques can be
broken in a relatively short period of time due, primarily, to
the speed that computers perfnrm mathematical operations.One presently secure cryptographic technique is generally
known as the public key cryptographic system. One particular
form of such a system is fully described and discussed in the
basic article entitled "A Method For Obtaining Digital
Signatures and Public Key Cryptosystems" by R. L. Rivest, A.
Shamir and L. Adelmann, Volume 21 #2, February 1978,
Communications of ACM
</DESCRIPTION>
<CLAIMS>
A method for verifying a document belonging to a jth
class of documents, said jth class being one of a plurality of

classes of documents, each of said classes corresponding to a
class encryption/decryption key pair CE,CD, said document

incorporating encrypted information E
i
[M] comprising

information M derived from said document and encrypted with an
encryption key E
i
 for an encryption/decryption key pair E
i
,
D
i
, and said document further incorporating an encrypted
decryption key CE[D
i
] comprising decryption key D
i
 for said
key pair E
i
, D
i
 encrypted with encryption key CE; for
encryption/decryption key pair CE,CD associated with said

jth class, said method comprising the steps of:

a) providing enabling information for enabling
retrieval of a decryption key from any document in a

selected group of said classes;
b) determining if said document is in said selected
group, and if so retrieving said decryption key D
i
 from
said document;
c) decrypting said encrypted information E
i
[M] to

obtain decrypted information D
i
[E
i
[M]] and deriving said

information M from said document; and
d) comparing said decrypted information
D
i
[E
i
[M]] with said information M to verify the

information contained in said document as authentic and
unchanged.
A method as described in claim 1 further comprising the
step of:


providing verifying means for receiving said
enabling information and for decrypting said encrypted

information E
i
[M], said verifying means further

comprising memory means for storing preselected
decryption keys CD, said preselected keys CD being in

one-to-one correspondence with said classes, and still
further comprising means responsive to said enabling

information for enabling said verifying means to access
selected groups of said preselected keys; and wherein, 
said enabling information comprises information
defining a group of said preselected keys CD

corresponding to said selected groups of classes.
A method as described in claim 2 wherein said enabling
information comprises a code word, the bits being in

one-to-one correspondence with said preselected keys CD, said
verifying means storing said code word and said enabling means

responding to said code word to enable access to one of said
preselected keys if and only if a corresponding bit of said

code word is asserted.
A method as described in claim 3 wherein said code word
is encrypted, said verifying means decrypting said code word

prior to storing said code word.
A method as described in claim 4 wherein said verifying
means initially stores a first code word code having an

asserted bit corresponding to one of said preselected keys
CD
j
, said preselected key CD
j
 corresponding to said jth class;
and wherein subsequent values for said code word are encrypted

with said key CE
j
.
A method as described in claim 2 comprising the further
step of:

   a) transmitting request information to a data
center, said request information including encrypted

information identifying said verifying means and a
request for enabling information defining said group of

said preselected keys CD corresponding to said selected
group of classes: wherein said data center decrypts said

encrypted identifying information and responds to send
said requested enabling information to said verifying

means. 
A method as described in claim 1 further comprising the
steps of:


a) providing verifying means for receiving said
enabling information and for decrypting said encrypted

information E
i
[M], said verifying means further

comprising memory means for storing a plurality of
decryption keys CD; and wherein,
b) said enabling information comprises information
defining a group of said decryption keys CD corresponding

to said selected group of classes; and
c) said verifying means further comprises means
responsive to said enabling information for storing said

group of decryption keys in said memory means.
A method as described in claim 7 wherein said verifying
means initially stores at least decryption key CD
j
 for said
jth class and subsequent values for said enabling information

are encrypted with said corresponding key CE
j
.
A method as described in claim 7 comprising the further
step of:

   transmitting request information to a data
center, said request information including encrypted

information identifying said verifying means and a
request for enabling information defining said group of

said decryption keys corresponding to said selected group
of classes; wherein said data center decrypts said

encrypted identifying information and responds to send
said requested enabling information to said verifying

means.
A method as described as claim 1 wherein said document
further incorporates a second encrypted decryption key GE[D
i
]
encrypted with a group encryption key GE for an

encryption/decryption key pair GE,GD, and wherein documents in
at least a kth class incorporate a third encrypted decryption

key GE[D'
i
], and further comprising the step of: 


providing verifying means for receiving said
enabling information and for decrypting said encrypted

information E
i
[M], said verifying means further

comprising memory means for storing a decryption key; and
wherein,
said enabling information comprises information
defining a group decryption key GD for said key pair GE,

GD, said decryption key GD enabling decryption of
encrypted decryption keys on all documents comprised in

said selected group; and
said verifying means further comprises means
responsive to said enabling information for storing said

decryption key GD in said memory means.
A method as described in claim 10 wherein said enabling
information comprises said group decryption key GD in encrypted

form.
A method as described in claim 11 wherein said verifying
means initially stores said class decryption key CD; and said

enabling information further comprises an encrypted group
decryption key CE;[GD]
 encrypted with said corresponding
encryption key CE.
A method as described in claim 10 comprising the further
step of:

   transmitting request information to a data
center, said request information including encrypted

information identifying said verifying means and a
request for enabling information defining said group

decryption key GD, wherein said data center decrypts said
encrypted identifying information and responds to

transmit said requested enabling information to said
verifying means. 
An apparatus for verifying a document belonging to a jth
class of documents, said jth class being one of a plurality of

classes of document, each of said classes corresponding to a
class encryption/decryption key pair CE,CD, said document

incorporating encrypted information E
i
[M] comprising

information M derived from said document and encrypted with an
encryption key E
i
 for an encryption/decryption key pair E
i
, 
D
i
, and said document further incorporating encrypted
decryption key CE
j
[D
i
] comprising decryption key D
i
 for said
key pair E
i
,D
i
 encrypted with encryption key CE; for class
encryption/decryption key pair CE
j
,CD
j
 associated with said
jth class, comprising:


a) means (52) for scanning said document (C) to input
scanned information, said scanned information including

said encrypted information E
i
[M], said encrypted

decryption key CE
j
[D
i
], and information identifying said

jth class C
j
;
b) means (58) responsive to enabling information for
enabling retrieval of a decryption key from any document

in a selected group of said classes of documents and
responsive said identifying information C
j
 to determine
if said document is in said selected group, and if so

retrieving said decryption key D
i
 from said scanned
information;
c) means (58) for decrypting said encrypted information
E
i
[M] from said scanned information to obtain decrypted

encrypted information D
i
[E
i
[M]]; and
d) means (62) for comparing said decrypted
information D
i
[E
i
[M]] with said information M to

verify the information contained in said document as
authentic and unchanged.
An apparatus as described in claim 14 further
comprising enabling means having memory means (59) for

storing preselected keys CD, said preselected keys CD
being in one-to-one correspondence with said classes, and

wherein said enabling means is operable to respond to
said enabling information to enable access to a group of

said preselected keys CD, said group of keys
corresponding to said group of classes.
An apparatus as described in claim 15, wherein said
enabling information comprises a code word, and said enabling

means further comprises a storage location for storing said
code word, bits of said code word being in one-to-one

correspondence with said preselected keys, said apparatus 
further comprising means for storing said code word in said

storage location upon receipt of said enabling information and
said enabling means being operable to respond to asserted

bits of said stored code word to enable access to
corresponding ones of said keys CD.
An apparatus as described in claim 16, wherein said
decrypting means is further operable for decrypting said

code word prior to storing said code word.
An apparatus as described in claim 15 further comprising:

   means for transmitting request information to a data center
(40), said request information including encrypted information

identifying said apparatus and a request for enabling information
defining said group of said preselected keys CD corresponding to

said group of classes, wherein said data center (40) is operable to
decrypt said encrypted identifying information and to respond to

send said requested enabling information to said apparatus.
An apparatus as described in claim 14 wherein said
enabling means further comprises a memory means for storing a

plurality of said preselected keys CD, and wherein said
enabling information comprises information defining a group of

said decryption keys CD corresponding to said selected group
of classes; said apparatus further comprising means responsive

to said enabling information for storing said group of
decrypting keys in said memory means.
An apparatus as described in claim 19 wherein said
apparatus initially stores at least a decryption key CD
j
 for
said jth class and subsequent values for said enabling

information are encrypted with said corresponding key CE
j
.
An apparatus as described in claim 19 further comprising:

   means for transmitting request information to a
data center, said request information including encrypted

information identifying said apparatus and a request for
enabling information defining said group of said 

preselected keys CD corresponding to said group of
classes, wherein said data center decrypts said encrypted

identifying information and responds to send said
requested enabling information to said apparatus.
An apparatus as described in claim 14 wherein said
document further incorporates a second encrypted decryption

key GE[D
i
] encrypted with a group encryption key GE for an

encryption/decryption key pair GE,GD, and wherein documents in
at least a kth class incorporate a third encrypted decryption

key GE[D
i
']; and said enabling means further comprises memory

means for storing a decryption key GD for said
encryption/decryption key pair GE,GD, said decryption key GD

enabling decryption of encrypted decryption keys on all
documents comprised in said selected group; said apparatus

further comprising means, responsive to said enabling
information for storing said decryption key GD in said memory

means.
An apparatus as described in claim 22 wherein said
enabling information comprises said group decryption key GD in

encrypted form and said decrypting means is further for
decrypting said encryption of decryption key GD prior to

storing said decryption key GD in said memory means.
An apparatus as described in claim 23 wherein said
apparatus initially stores said class decryption key CD
j
 and
said enabling information comprises encrypted decryption key

CE
j
[GD] encrypted with said corresponding encryption key CE
j
.
An apparatus as described in claim 22 further comprising:

   means for transmitting request information to a
data center, said request information including encrypted

information identifying said apparatus and a request for
enabling information defining said group decryption key

GD; wherein said data center decrypts said encrypted
identifying information and responds to transmit said

request enabling information to said apparatus.
</CLAIMS>
</TEXT>
</DOC>
