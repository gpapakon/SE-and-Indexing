<DOC>
<DOCNO>EP-0617548</DOCNO> 
<TEXT>
<INVENTION-TITLE>
Image colour modification
</INVENTION-TITLE>
<CLASSIFICATIONS>G06T500	H04N158	H04N156	G06T500	G06T520	G06T520	</CLASSIFICATIONS>
<CLASSIFICATIONS-THIRD>G06T	H04N	H04N	G06T	G06T	G06T	</CLASSIFICATIONS-THIRD>
<CLASSIFICATIONS-FOURTH>G06T5	H04N1	H04N1	G06T5	G06T5	G06T5	</CLASSIFICATIONS-FOURTH>
<ABSTRACT>
A method and apparatus for modifying an image defined 
by data representing the colour component content of each 

pixel of the image. The method comprises, for each colour 
component of each pixel, 


(a) generating unsharp (U) and sharp (S) data and 
performing an unsharp masking algorithm on the sharp and 

unsharp data to generate fringe data (F); 
(b) modifying the fringe data with a weighting function () 
determined in accordance with the values of the sharp or 

unsharp data for all of the colour components (U
C
,U
M
,U
Y
) of 
the pixel; and 
(c) combining the modified fringe data with the pixel data 
to generate modified pixel data. 
By applying a weighting function related to all the 
unsharp values for the pixel and hence to the input colour 

component content of the input signals of a particular 
sample area, the fringe amplitude is varied according to 

the colour of the region thereby enabling sharpening or 
smoothing to be appropriate to the part of the image e.g. 

sharpening hair and smoothing skin colours. 

</ABSTRACT>
<APPLICANTS>
<APPLICANT-NAME>
FUJIFILM ELECTRONIC IMAGING
</APPLICANT-NAME>
<APPLICANT-NAME>
FUJIFILM ELECTRONIC IMAGING LIMITED
</APPLICANT-NAME>
</APPLICANTS>
<INVENTORS>
<INVENTOR-NAME>
GOUCH MARTIN PHILIP
</INVENTOR-NAME>
<INVENTOR-NAME>
MACDONALD LINDSAY WILLIAM
</INVENTOR-NAME>
<INVENTOR-NAME>
GOUCH, MARTIN PHILIP
</INVENTOR-NAME>
<INVENTOR-NAME>
MACDONALD, LINDSAY WILLIAM
</INVENTOR-NAME>
</INVENTORS>
<DESCRIPTION>
This invention relates to a method of modifying a
colour image.It is normal in the processing of an image or graphic
arts reproduction to sharpen edges and enhance fine detail
by means of unsharp masking (USM). Typically this is
performed by a convolution process, passing a filter window
across the image to take a weighted average of the
surrounding pixels at each position, then generating some
function of the so-called 'sharp' (original value of
central pixel) and 'unsharp' (weighted average of
neighbours) signals.Figure 7 shows the relationship between the regions
covered by the sharp and unsharp signals. The sharp
signal in this instance is the value of the single pixel 70
at the current processing location. The unsharp signal
signal is a weighted average of the 25 pixels in a 5 by 5
pixel region 71 centred on the same location. The
weighting function may be a simple average of all pixels,
ie. equal contribution from all elements, or may give
greater contribution to the pixels nearer the centre. The
regions sizes used in deriving both sharp and unsharp
signals may be either smaller or larger. The technique of
convolution is well known in digital image processing
applications, see for example the text "Digital Image
Processing (Second Edition) by R.C.Gonzalez and P.Wintz,
published in 1987 by Addison-Wesley, pp.161-183.The principle of unsharp masking is to emphasise highfrequency
fringe information in the image as illustrated in
Figure 8a. A function of the difference between the
original sharp (local) signal S and the low frequency
unsharp (neighbourhood average) signal U is calculated.
Figure 8a shows graphs of frequency (f) against number of
pixels for sharp (S) data, unsharp (U) data and the
function kF(S-U) which gives the high frequency fringe
data. Figures 8b-8e show the successive stages for addition
of a thresholded difference signal (sharp minus unsharp) to
the original sharp signal. Figure 8b shows the original
sharp pixel signal S and the low-pass filtered unsharp
signal U. The difference (S-U) is shown in Figue 8C, which
also shows the threshold values (T,-T). The thresholded
fringe signal is shown in Figure 8d and the final, enhanced
output signal P is shown in Figure 8e, in which the fringe
signal has been combined with the original signal. Typical
equations for the process are:
P = S + K.f(S-U)
   where
S =sharp signal (local value)U =unsharp signal (neighbourhood average)f ( ) =suitable fringe generation functionK =weighting factor for degree of USM appliedP =output signal
</DESCRIPTION>
<CLAIMS>
A method of modifying an image defined by data
representing the colour component content of each pixel of

the image, the method comprising, for a selected colour
component of each pixel,


(a) generating unsharp (U) and sharp (S) data from the
pixel data representing the selected colour component and

performing an unsharp masking algorithm on the sharp and
unsharp data to generate fringe data (F);
(b) modifying (40) the fringe data with a weighting
function () ; and
(c) combining the modified fringe data with the pixel data
representing the selected colour component to generate

modified pixel data (41);

   
characterised in that
 the method further comprises
selecting areas of the image having different required

degrees of modification, the weighting function () which
modifies the fringe data in step (b) being determined in

accordance with the values of the sharp or unsharp data for
all of the colour components (U
C
, U
M
, U
Y
) of the pixel, and in
accordance with the aver
age colour and required degree of
modification of each selected area.
A method according to claim 1, wherein the unsharp data
is generated by calculating a weighted average of the pixel

data in a region (71) surrounding the pixel (70).
A method according to any of the preceding claims,
wherein the weighting function () is a mathematically

continuous function in the coordinate space defined by the
unsharp colour signals.
A method according to any of the previous claims,
further comprising applying colour correction to the pixel

data, wherein the pixel data in step (c) is colour
corrected pixel data. 
A method according to any of the preceding claims
wherein the weighting function () is determined by

inputting the values of the sharp or unsharp data for all
of the colour components (U
c
, U
m
, U
y
) of the pixel into a
look-up table (36).
Apparatus (24) for modifying an image defined by data
representing the colour component content of each pixel of

the image, the apparatus comprising generating means
(23,31) to generate unsharp (U) and sharp (S) data from the

pixel data representing a selected colour component;
processing means (32) to perform an unsharp masking

algorithm on the unsharp and sharp data to generate fringe
data (F); means (36,40) to modify the fringe data with a

weighting function (); and means (34) for combining the
modified fringe data with the pixel data representing the

selected colour component to generate modified pixel data
(41); 
characterised in that
 the apparatus further comprises
means (42) to select areas of the image having different

required degrees of modification, and means (43) of
calculating the weighting function in accordance with the

average colour and required degree of modification of each
selected area, and in accordance with the values of the

sharp or unsharp data for all of the colour components
(U
C
,U
M
,U
Y
) of the pixel.
Apparatus according to claim 6, wherein the generating
means (31) generates unsharp data by calculating a weighted

average of the pixel data in a region (71) surrounding the
pixel (70).
Apparatus according to claim 6 or 7, wherein the
weighting function () is a mathematically continuous

function in the coordinate space defined by the unsharp
colour signals.
Apparatus according to any of claims 6 to 8 further
comprising a colour converter (33) to apply colour 

correction to the pixel data, wherein the colour corrected
pixel data is combined with the modified fringe data.
Apparatus according to any of claims 6 to 9 further
comprising a look-up table (36) which determines the

weighting function () and receives as inputs the values of
the sharp or unsharp data for all of the colour components

(U
c
, U
m
, U
y
) of the pixel.
</CLAIMS>
</TEXT>
</DOC>
