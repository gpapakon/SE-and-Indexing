<DOC>
<DOCNO>EP-0621709</DOCNO> 
<TEXT>
<INVENTION-TITLE>
Message communication system
</INVENTION-TITLE>
<CLASSIFICATIONS>H04L12413	H04L12407	</CLASSIFICATIONS>
<CLASSIFICATIONS-THIRD>H04L	H04L	</CLASSIFICATIONS-THIRD>
<CLASSIFICATIONS-FOURTH>H04L12	H04L12	</CLASSIFICATIONS-FOURTH>
<ABSTRACT>
A message communication system (12) for receiving, storing 
and transmitting messages comprises RAM-based storage buffers 

(20, 22) having two parallel ports (18, 44) and two serial ports (19, 
17) and an serial output portion (15) which has an input for 

receiving messages and an output for transmitting messages. The 
two serial ports (17, 19) and one of the parallel ports (44) are 

coupled to the serial output portion (15). Each message comprises ID 
information and data, the ID information of each message providing 

an indication of the priority of each message. The serial ports 
transfer serially the ID bits of the transmitted and received 

messages between the serial output portion (15) and the storage 
buffers (20, 22). Logic (28) is used to determine, from the ID bits, 

which message of the messages to be transmitted has the highest 
priority and to provide the ID bits of the highest priority message 

serially to serial output portion (15). Additional logic (48, 50) 
receives the ID bits of the received messages serially from the serial 

output portion (15) and determines whether the messages are to be 
stored in the RAM-based storage buffer, by comparing the received 

ID bits with previously stored ID bits. 

</ABSTRACT>
<APPLICANTS>
<APPLICANT-NAME>
MOTOROLA INC
</APPLICANT-NAME>
<APPLICANT-NAME>
MOTOROLA, INC.
</APPLICANT-NAME>
</APPLICANTS>
<INVENTORS>
<INVENTOR-NAME>
BEN-ARIE YARON
</INVENTOR-NAME>
<INVENTOR-NAME>
GINSBERG AVI
</INVENTOR-NAME>
<INVENTOR-NAME>
PATEL GIL
</INVENTOR-NAME>
<INVENTOR-NAME>
ROSEN BENJAMIN
</INVENTOR-NAME>
<INVENTOR-NAME>
BEN-ARIE, YARON
</INVENTOR-NAME>
<INVENTOR-NAME>
GINSBERG,AVI
</INVENTOR-NAME>
<INVENTOR-NAME>
PATEL, GIL
</INVENTOR-NAME>
<INVENTOR-NAME>
ROSEN, BENJAMIN
</INVENTOR-NAME>
</INVENTORS>
<DESCRIPTION>
This invention relates to a message communication system for
serial communication between a host processor and peripheral
devices.In applications, such as automotive applications, serial
message communication systems are typically required to provide
interfaces between a host processor, such as vehicle management
controller, and peripherals, such as a temperature controller, gear
controller, and engine controller.A convenient communication protocol used
see e.g. disclosures in
UND-ODER-NOR + STEUERUNGSTECHNIK,
vol.23, no.10, October 1990, MAINZ, DE
pages 32 - 34
P. ZIMMERMANN ET AL 'Controller Area
Network (CAN) - Ein universeller
Buscontroller für den Einsatz im
KFZ-Bereich'
and
ELEKTRONIK,
vol.38, no.4, 17 February 1989, MÜNCHEN,
DE
pages 102 - 105
F. BEIL ET AL 'Eine bitserielle
Universal-Schnittstelle nicht nur für
Kfz-Anwendungen' in such
applications utilises messages for communicating data between the
host and peripherals wherein each message comprises an n-bit data
field and an m-bit identifier field (where n and m are positive
integers). The data field contains the data to be transferred by the
message and the identifier (ID) field categorises the data in each
message. For example, all data relating to temperature has a unique
ID.The message communication system receives and transmits
messages between the host processor and the peripherals and
temporarily stores the received and transmitted messages in storage
buffers. The storage buffers are usually implemented using
associative memory or register files.During message transmission, the ID fields of the stored
messages to be transmitted are used to prioritise the messages to be
transmitted by the system. In known arrangements, the
prioritisation process takes as many cycles as the number of
messages to be transmitted. The time required for such
prioritisation can be a significant disadvantage.During message reception, the ID field of each of the received
messages is used to determine whether the message is to be
received by the system. With the associative memory 
implementation, in order to match the received messages, each bit
of the ID field is coupled to a comparator. Such an arrangement is
fast, but requires a large area to implement all the comparators.Thus, the prior art arrangements have a number of
disadvantages: they require significant silicon area to implement,
and require significant time for prioritisation of the message
transmission and are therefore expensive. Register files also require
significant silicon area.There is
</DESCRIPTION>
<CLAIMS>
A message communication system for receiving, storing and
transmitting messages, wherein each message comprises ID

information and data, the ID information of each message providing
an indication of the priority of each message,

characterized in that
the message

communication system comprises :

serial output means (15) having an input (16) for receiving messages
and an output (14) for transmitting messages;
RAM storage means (13) for storing messages received by the serial
output means (15) and transmit messages to be transmitted by the serial

output means (15), the RAM storage means (13) having a first port (44) coupled to the serial
output means (15) for transferring the data of the received and transmit

messages between the serial output means (15) and the RAM storage means (13), a
second port (18) for transferring messages to and from the message

communication system, a third port (19) for serially transferring ID
information of transmit messages from the RAM storage means (13) to the serial

output means (15) and a fourth port (17) for serially transferring ID
information of received messages from the serial output means (15) to the RAM

storage means (13), the RAM storage means (13) further comprising:
first logic means (28) coupled to receive the ID information of each of the
stored transmit messages for determining the stored transmit

message with the greatest priority and for generating a signal in
response thereto whereby the data of the determined transmit

message is transferred from the RAM storage means (13) to the serial output means (15),
the ID of the determined transmit message is transferred serially to

the serial output means (15) via the third port (19); and
second logic means (48,50,21) coupled to the fourth port (17) so as to receive the ID
information of the received messages for determining which of the

received messages are to be stored in the RAM storage means (13) and for
generating a signal in response thereto whereby the data of the

determined received messages is transferred from the serial output means (15)
via the first port (44) to the RAM storage means (13) for storage therein.
The message communication system according to claim 1
wherein the ID information comprises m ID bits and the first logic 

means (28) determines the stored transmit message with the greatest
priority in m cycles by comparing in m consecutive cycles each ID

bit of a stored transmit message with the corresponding ID bits of
the other stored messages, and by outputting to the serial output means (15)

via the third port (19) after each consecutive comparison the ID bit with
the determined greatest priority.
The message communication system according to claim 1
wherein the ID information comprises m ID bits and the first logic

means (28) comprises:

means for logically combining (30) in m consecutive cycles each of
the m ID bits of a stored transmit message with the corresponding

ID bits of other stored transmit messages and for providing a result
bit for each consecutive combination, each result bit being serially

transferred to the serial output means (15) via the third port (19);
means for comparing (32) each one of the combined ID bits with
the corresponding result bit and for providing a comparison result

for the respective stored transmit message for each consecutive
combination; and
means for generating a flag (34) for each stored transmit message,
each flag being switchable from a first state to a second state in

dependence on the comparison results, wherein after the m
consecutive cycles the stored transmit message with a flag having

the first state corresponds to the determined transmit message and
the result bits transferred to the serial output means (15) represent the ID

information of the determined transmit message.
The message communication system according to claim 3
wherein the

means for logically combining (30)
in response to the flag of a stored

transmit message being switched from the first state to the second
state, ignores the ID bits of the switched stored transmit message in

following cycles.
The message communication system according to claim 3 or 4
wherein the means for logically combining (30) comprises wired AND

logic. 
The message communication system according to claim 5
wherein the comparing means (32) provides a comparison result having

a first value when the combined ID bit of a stored transmit message
matches the result bit and a second value when the combined ID bit

does not match the result bit and wherein the flag generating means (34)
switches the flag from the first state to the second state when the

comparison result has the second value.
The message communication system according to any

preceding claim wherein the RAM storage means (13) comprises a receive
buffer means (22) for storing the received messages and a transmit

buffer means (20) for storing the transmit messages.
The message communication system according to claim 7
wherein each buffer means (20,22) comprises a plurality of message storage

locations, each message storage location comprising an ID storage
field (24) for storing the ID information and a data storage field (26) for

storing the data.
The message communication system according to claim 3 and
claim 7 or 8 wherein the comparing means (32) comprises a plurality of

comparators corresponding to the plurality of message storage
locations of the transmit buffer means (22), each comparator having a

first input coupled to a respective ID storage field (24), a second input
coupled to the means for logically combining (30) and an output coupled

to the flag generating means (34).
The message communication system according to any
preceding claim wherein the ID information comprises m ID bits and

the RAM storage means (13) stores predetermined ID informations received
via the second port (18) and wherein the second logic means (48,50,21) comprises

comparing means (48) for serially comparing each of the m ID bits of the
received messages with corresponding ID bits of the predetermined

ID informations, the second logic means (48,50,21) generating the signal when
the ID bits of the received messages match the ID bits of at least one

of the predetermined ID informations stored in the RAM storage means (13). 
The message communication system according to claim 8 and
10 wherein the predetermined ID informations are stored in ID

storage fields (24) of the receive buffer means (22) and the comparing means of the second logic means
comprises a plurality of comparators (48) corresponding to the plurality

of message storage locations of the receive buffer means (22), each
comparator (48) having a first input coupled to the fourth port (17), a second

input coupled to a respective ID storage field (24) and an output coupled
to a match flag generating means (50), the match flag generating means (50)

generating a flag for each storage location of the receive buffer
means (22), each flag being switchable from a first state which indicates

a match comparison result to a second state which indicates a no-match
comparison result in dependence on the output of the

respective comparator, wherein after m consecutive comparison
cycles the second logic means (48,50) generates the signal for the storage locations

with flags having the first state whereby data of the received
message is transferred from the serial output means to the data storage

fields (26) of of the storage locations with flags having the first state.
The message communication system according to any
preceding claims wherein the serial output means (15) comprises a first

shift register (40) for serially transferring data and a second shift
register (38) for serially transferring ID information.
A processing system (2) comprising:

a host processor (4);
a plurality of peripheral devices (6-8);
   a message communication system (10,12) as claimed in any preceding
claim for transferring messages between the host processor (4) and the

peripheral devices (6-8), a serial output means of the message
communication system being coupled to the plurality of peripheral

devices (6-8) via a serial bus (9) and the host processor (4) being coupled to the
second port of the message communication system (12).
</CLAIMS>
</TEXT>
</DOC>
