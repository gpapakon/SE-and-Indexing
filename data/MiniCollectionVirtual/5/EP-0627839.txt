<DOC>
<DOCNO>EP-0627839</DOCNO> 
<TEXT>
<INVENTION-TITLE>
Speakerphone with event driven control circuit.
</INVENTION-TITLE>
<CLASSIFICATIONS>H04M160	H04M160	H04M908	H04M908	</CLASSIFICATIONS>
<CLASSIFICATIONS-THIRD>H04M	H04M	H04M	H04M	</CLASSIFICATIONS-THIRD>
<CLASSIFICATIONS-FOURTH>H04M1	H04M1	H04M9	H04M9	</CLASSIFICATIONS-FOURTH>
<ABSTRACT>
A control circuit for a speakerphone circuit 
which utilizes an event driven circuit to determine the 

appropriate gain for the receive and transmit channels is 
provided. Detectors monitor the relative magnitudes of 

the signal in the transmit and receive channels. 
Separate signal-to-noise detectors determine whether 

signals present in the two channels are voice signals. 
The event driven circuit receives these inputs, and 

dependent on the present state (i.e., transmit, receive, 
or idle) transitions to a new state in accordance with 

predefined criteria incorporated into the event driven 
circuit. In particular, the present invention allows a 

transition in a single step from a receive to a transmit 
state, without passing through an idle state. Transition 

or dummy states allow implementation with simple logic 
and provide hysteresis. 


</ABSTRACT>
<APPLICANTS>
<APPLICANT-NAME>
EXAR CORP
</APPLICANT-NAME>
<APPLICANT-NAME>
EXAR CORPORATION
</APPLICANT-NAME>
</APPLICANTS>
<INVENTORS>
<INVENTOR-NAME>
ROBINSON NEIL
</INVENTOR-NAME>
<INVENTOR-NAME>
ROBINSON, NEIL
</INVENTOR-NAME>
</INVENTORS>
<DESCRIPTION>
The present invention relates to control 
circuits for speakerphone circuits. A typical speakerphone circuit has a transmit 
channel coupled between a microphone and the telephone 
line, and a receive channel coupled between the telephone 
line and a speaker. Each of the channels has an 
attenuator or amplifier whose gain can be adjusted by a 
control circuit. In a typical "four-point" sensing 
scheme, the signal before and after the attenuator in the 
transmit and receive channels are monitored, providing 
four inputs to a control circuit. In conjunction with 
other signals, the control circuit uses the four-point 
sense inputs to switch the speakerphone to the channel 
with the greater speech signal. Where voice signals are detected in both 
channels, one scheme adjusts the gain of the two 
amplifiers so they are equal, and then measures the two 
signals to determine which is larger, switching to the 
channel which has the larger signal. This allows one 
party to break in on the other, even though the amplifier 
for the interrupting party is attenuated compared to the 
other channel. Such a system is shown, for instance, in 
Patent No. 4,724,540. This mode where both gains are 
equal is referred to as an "idle mode". Thus, a two-step 
process is followed to allow transition to another 
channel. First, the gains are equalized to enter into 
the "idle mode". Second, the amplitudes of the signals 
are compared while in the idle mode, and the channel with 
the highest amplitude signal is provided with the greater 
gain, to activate that channel. Only one channel at a time can be provided with 
high gain in order to avoid "singing", caused by signal 
from the speaker feeding back into the microphone through 
acoustic coupling or by signal from the microphone  
 
feeding back through the hybrid side tone to the speaker 
through electrical coupling. Patent No. 4,879,745, assigned to IBM, shows a 
speakerphone in which the signals are converted into 
digital form. That digital speakerphone then uses a 
synchronous state machine to control the selection of 
either the transmit or receive audio path. Such a system 
provides the advantage of more flexibility in switching 
paths, but at the cost of the additional complexity of 
the digital circuitry. The present invention provides a control 
circuit for a speakerphone circuit which utilizes an 
event driven system to determine the appropriate gain for 
the receive and transmit channels. Detectors monitor the 
relative magnitudes of the signal in the transmit and

</DESCRIPTION>
<CLAIMS>
In a speakerphone circuit having transmit 
and receive channels with transmit and receive 

amplifiers, a control circuit for varying the gain of the 
amplifiers, comprising: 

   means, coupled to said transmit and receive 
amplifiers, for measuring the relative magnitude of 

signals in said transmit and receive channels; 
   means, coupled to said transmit and receive 

channels, for detecting the presence of a voice 
signal on said signal paths; and 

   an event driven circuit, having inputs coupled 
to said means for measuring and said means for 

detecting and outputs coupled to said transmit and 
receive amplifiers, for varying the gain of said 

amplifiers in accordance with said inputs and a 
previous state of said event driven circuit; 

   said event driven circuit having a transmit 
state, a receive state, an idle state and at least 

one transition state between said transmit and 
receive states. 
The speakerphone circuit of claim 1 
wherein 

   in said transmit state the gain of said 
transmit amplifier is greater than the gain of said 

receive amplifier; 
   in said receive state the gain of said receive 

amplifier is greater than the gain of said transmit 
amplifier; and 

   in said idle state the gain of said transmit 
and receive amplifiers is equalized. 
The speakerphone circuit of claim 2 
wherein said event driven circuit further comprises:

 
   means for transitioning from said transmit 

state to said receive state when said means for 
detecting detects a voice signal in said receive 

channel and said means for measuring determines that 
the amplitude of signals in said receive channel is 

much greater than the amplitude of signals in said 
transmit channel; and 

   means for transitioning from said receive state 
to said transmit state when said means for detecting 

detects a voice signal in said transmit channel and 
said means for measuring determines that the 

amplitude of signals in said transmit channel is 
much greater than the amplitude of signals in said 

receive channel. 
The speakerphone circuit of claim 2 
wherein said means for measuring relative magnitude 

comprises: 
   a first comparator having a first input coupled 

to an output of said transmit attenuator, and a 
second input coupled to an input of said receive 

attenuator; and 
   a second comparator having a first input 

coupled to an input of said transmit attenuator and 
a second input coupled to an output of said receive 

attenuator. 
The speakerphone circuit of claim 4 
wherein said event driven circuit includes means for 

transitioning from said transmit state to said receive 
state when either of said comparators provides a signal 

indicating an amplitude of a receive signal is greater 

than an amplitude of a transmit signal by a predetermined 
amount. 
The speakerphone circuit of claim 4 
wherein said event driven circuit includes means for 

 
transitioning from said idle state to said receive state 

when both of said comparators indicate the receive signal 
is greater than the transmit signal, and said means for 

detecting the presence of a voice signal indicates the 
presence of a voice signal on said receive channel. 
The speakerphone circuit of claim 4 
wherein the relative magnitudes of the transmit and 

receive signals required to produce an output of said 
comparators vary between said idle state and said receive 

state. 
The speakerphone circuit of claim 2 wherein 
said transition state comprises a receive transition 

state for transitions from said transmit state to said 
receive state, and a transmit transition state for 

transitions from said receive state to said transmit 
state, the gains of said transmit and receive amplifiers 

in said transmit transition state and said receive 
transition state transitioning to the gains in said 

transmit and receive states, respectively. 
The speakerphone circuit of claim 8 wherein 
said event driven circuit transitions from said transmit 

state to said receive transition state when the magnitude 
of the signal in said receive channel is larger than the 

magnitude of the signal in said transmit channel by a 
first predetermined amount, and transitions from said 

receive transition state to said receive state when the 
magnitude of the signal in said receive channel is larger 

than the magnitude of the signal in said transmit channel 
by a second predetermined amount, larger than said first 

predetermined amount. 
The speakerphone circuit of claim 9 
wherein said event driven circuit transitions from said 

receive state to said transmit transition state when the 
 

magnitude of the signal in said transmit channel is 
larger than the magnitude of the signal in said receive 

channel by a third predetermined amount, and transitions 
from said transmit transition state to said transmit 

state when the magnitude of the signal in said transmit 
channel is larger than the magnitude of the signal in 

said recieve channel by a fourth predetermined amount, 
larger than said third predetermined amount. 
The speakerphone circuit of claim 8 
wherein said event driven circuit includes three dummy, 

delay states, located between said idle state and said 
receive state, between said receive transition state and 

said receive state, and between said transmit transition 
state and said transmit state. 
The speakerphone circuit of claim 1 
wherein said event driven circuit includes a plurality of 

latches. 
</CLAIMS>
</TEXT>
</DOC>
