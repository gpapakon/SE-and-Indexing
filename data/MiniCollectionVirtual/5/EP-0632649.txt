<DOC>
<DOCNO>EP-0632649</DOCNO> 
<TEXT>
<INVENTION-TITLE>
Video camera with electronic picture stabilizer and generation of addition data
</INVENTION-TITLE>
<CLASSIFICATIONS>H04N5232	H04N5232	H04N514	H04N514	</CLASSIFICATIONS>
<CLASSIFICATIONS-THIRD>H04N	H04N	H04N	H04N	</CLASSIFICATIONS-THIRD>
<CLASSIFICATIONS-FOURTH>H04N5	H04N5	H04N5	H04N5	</CLASSIFICATIONS-FOURTH>
<ABSTRACT>
A video camera (1⊘) includes a microcomputer (26) 
which determines whether each of detection areas defined 

within an image field (44) is valid or invalid. If there 
is a valid detection area, luminance addition data and 

color addition data are evaluated by an addition data 
generating circuit (46) for each of addition regions of 

64, for example, which are defined by dividing the image 
field (44). Differences of the addition data between a 

given addition region and a left adjacent addition region 
in a horizontal direction and an upper adjacent addition 

region in a vertical direction are evaluated, and the 
differences are compared with predetermined values. If 

comparisons satisfy predetermined conditions, a count 
value is incremented. On the basis of a total count 

value of the horizontal direction and a total count value 
of the vertical direction, it is determined whether or 

not an object is an object having repeated pattern, and a 
whole motion vector V
n
 is evaluated by methods being 
different from each other according to a determination 

result. Then, an integration vector S
n
 is evaluated 
according to a status of the video camera, whereby a 

blurring of an image due to an unintentional motion of 
the video camera can be corrected. 


</ABSTRACT>
<APPLICANTS>
<APPLICANT-NAME>
SANYO ELECTRIC CO
</APPLICANT-NAME>
<APPLICANT-NAME>
SANYO ELECTRIC CO., LTD.
</APPLICANT-NAME>
</APPLICANTS>
<INVENTORS>
<INVENTOR-NAME>
KOBAYASHI AKIO
</INVENTOR-NAME>
<INVENTOR-NAME>
TOBA AKIRA
</INVENTOR-NAME>
<INVENTOR-NAME>
KOBAYASHI, AKIO
</INVENTOR-NAME>
<INVENTOR-NAME>
TOBA, AKIRA
</INVENTOR-NAME>
</INVENTORS>
<DESCRIPTION>
The present invention relates to a video camera.
More specifically, the present invention relates to a
compact video camera with electronic picture stabilizer,
which is utilized as a camcorder, for example.One example of a method for detecting an
unintentional motion component of an image sensing device
is disclosed in, for example, the 20th image engineering
conference in 1989 by Matsushita Electric Industrial
Corporation. In this prior art method, by utilizing a
motion vector obtained by a representative point matching
method disclosed in, for example, Japanese Patent
Application Laying-open No. 61(1986)-2Ø1581 [H04N 7/137],
the motion component of the image sensing device is
detected according to image information In this prior
art, an attenuation coefficient is used for performing
the correction of a blurring of an image due to the
unintentional motion, i.e. the electronic picture
stabilization. Furthermore, four detection areas are
arranged in an image field or screen, and therefore, four 
portion motion vectors are obtained from the image field.Now, a method for performing the correction of the
blurring of the image due to the unintentional motion, i.
e. the electronic picture stabilization on the basis of
the portion motion vectors will be described. As a whole
motion vector, a mean value of the four portion motion
vectors, or a mean value of two portion motion vectors
having intermediate values in the four portion motion
vectors is utilized. If the whole motion vector is Vn,
an integration vector Sn is represented by the following
equation.
Sn = k·Sn-1 + Vn
where, k is called as an attenuation coefficient, being a
decimal number smaller than 1.As shown in Figure 9, for example, an image
extracting position is moved by utilizing the integration
vector Sn thus obtained, whereby a blurring of an image
due to the unintentional motion of the video camera is
corrected.However, in this prior art method, even if the whole
motion vector Vn is zero, the image extracting position
is centered such that the integration vector Sn
approaches zero with time lapse. That is, there was a
problem in the prior art method that the image in the
screen moves even when no movement occurs in the video 
camera."Electronic image stabilization system for video camera" by
K. Uomori et al., SMPT Journal, VOL. 101, No. 2, February
1992, New York, USA, pages 66 - 75 discloses a video camera
according to the pre-characterizing part of claim 1.Furthermore, US-A-5170255 discloses a video camera comprising
a first integration
</DESCRIPTION>
<CLAIMS>
A video camera comprises first integration vector calculating
means (26) for calculating an integration vector S
n

according to the following equation (1) on the basis of a
whole motion vector V
n
;

S
n
 = K
1
 · S
n-1
 + V
n
S
n
: an integration vector of n-th field or frame
S
n-1
: an integration vector of (n-1)th field or frame
V
n
: a whole motion vector between the (n-1)th field
or frame to the n-th field or frame

K
1
: an attenuation coefficient less than 1, and a blurring of
an image can be corrected by utilizing the integration vector

S
n
characterized in that
 said camera further comprises:

second integration vector calculating means (26) for calculating
a length S
n
' of an integration vector S
n
 of the image
according to the following equation (2) on the basis of

the whole motion vector V
n
,

S
n
' = S
n
'
-1
-K
2
 · |V
n
|
if the length of S
n
' 
<
0 then S
n
' = 0
K
2
: an attenuation coefficient less than 1
correction means (26) for correcting a blurring of an image
according to the integration vector calculated by one of

said first integration vector calculating means (26) and said
second integration vector calculating means (26), and
said video camera further comprising first detection
means (20, 26) for detecting at least one of a panning and a

tilting, wherein 
said correction means (26) performs correction by utilizing
the integration vector calculated by said second integration

vector calculating means (26) in response to detection
of said first detection means (20, 26) when correction utilizing

the integration vector calculated by said first integration
vector calculating means (26) is performed.
A video camera according to claim 1, further comprising
second detection means (20, 26) for detecting completion at

least one of the panning and the tilting; and

third detection means (20, 26) for detecting that the integration
vector is smaller than a first predetermined value,

wherein
said correction means (26) performs the correction by
utilizing the integration vector calculated by said first integration

vector calculating means (26) in response to detection
of said second detection means (20, 26) and detection of

said third detection means (20, 26) when the correction utilizing
the integration vector calculated by said second integration

vector calculating means (26) is performed.
A video camera according to claim 2, further comprising
third integration vector calculating means (26) for calculating

an integration vector S
n
 according to the following equation
(3) on the basis of the whole motion vector V
n
,

S
n
 = K
3
 · S
n-1
 + V
n
K
3
 : an attenuation coefficient less than 1
said third integration vector calculating means (26) calculating
said integration vector according to an equation S
n

= S
n-1
 when the whole motion vector is smaller than one pixel.
A video camera according to claim 3, further comprising
fourth detection means (26) for detecting that the whole motion

vector is smaller than a second predetermined value; and

fifth detection means (26) for detecting that the integration
vector is larger than a third predetermined value,

wherein
said correction means (26) performs correction by utilizing
the integration vector calculated by said third integration

vector calculating means (26) in response to detection
of said fourth detection means (26) and detection of said

fifth detection means (26) when the correction utilizing the
integration vector calculated by said first integration vector

calculating means (26) is performed.
A video camera according to claim 4, wherein said correction
means performs the correction by utilizing the integration

vector calculated by said first integration vector calculating
means in response to the detection of said third detection

means (26) when the correction utilizing the integration
vector calculated by said third integration vector calculating

means (26) is performed.
A video camera according to claim 5, wherein said correction
means performs the correction by utilizing the integration

vector calculated by said second integration vector calculating
means (26) in response to the detection of said

first detection means (26) when the correction utilizing the
integration vector calculated by said third integration vector

calculating means is performed.
A video camera according to claim 6, wherein said correction
means (26) performs the correction by utilizing the integration 

vector calculated by said third integration vector
calculating means (26) in response to the detection of said

second detection means (26) and the detection of said third
detection means (26) when the correction utilizing the integration

vector calculated by said second integration vector
calculating means (26) is performed.
A video camera according to claim 2, further comprising
fourth integration vector calculating means (26) for calculating

an integration vector S
n
 of the image according to the
following equation (4),


S
n
 = K
4
 · S
n-1
 + V
n
K
4
 : an attenuation coefficient less than 1
said fourth integration vector calculating means (26)
calculating said integration vector according to an equation

S
n
 = S
n-1
 when the whole motion vector is smaller than one
pixel.
A video camera according to claim 8, further comprising
fourth detection means (26) for detecting that the whole motion

vector is smaller than a second predetermined value; and

sixth detection means (26) for detecting that the integration
vector exists within a predetermined range, wherein
said correction means (26) performs correction by utilizing
the integration vector calculated by said fourth integration

vector calculating means (26) in response to detection
of said fourth detection means (26) and detection of said

sixth detection means (26) when the correction utilizing the
integration vector calculated by said first integration vector

calculating means (26) is performed.
A video camera according to claim 9, wherein said correction
means (26) performs the correction by utilizing the integration

vector calculated by said first integration vector
calculating means (26) in response to the detection of said

third detection means (26) when the correction utilizing the
integration vector calculated by said fourth integration vector

calculating means (26) is performed.
A video camera according to claim 10, wherein said correction
means (26) performs the correction by utilizing the

integration vector calculated by said second integration vector
calculating means (26) in response to the detection of

said first detection means (26) when the correction utilizing
the integration vector calculated by said fourth integration

vector calculating means (26) is performed.
A video camera according to claim 7, further comprising
fourth integration vector calculating means (26) for calculating

an integration vector S
n
 of the image according to the
following equation (4),


S
n
 = K
4
 · S
n-1
 + V
n
K
4
 : an attenuation coefficient less than 1
said fourth integration vector calculating means (26)
calculating said integration vector according to an equation

S
n
 = S
n-1
 when the whole motion vector is smaller than one
pixel.
A video camera according to claim 12, wherein said correction
means (26) performs the correction by utilizing the

integration vector calculated by said third integration vector
calculating means (26) in response to the detection of

said fifth detection means (26) when the correction utilizing 
the integration vector calculated by said fourth integration

vector calculating means (26) is performed.
A video camera according to claim 12, further comprising
sixth detection means (26) for detecting that the integration

vector exists within a predetermined range, wherein

   said correction means (26) performs the correction by
utilizing the integration vector calculated by said fourth

integration vector calculating means (26) in response to detection
of said sixth detection means (26) when the correction

utilizing the integration vector calculated by said
third integration vector calculating means (26) is performed.
A video camera according to claim 1, 6 ro 11, wherein
said first detection means (26) detects at least one of the

panning and the tilting at a time that a fourth predetermined
number of fields or frames in each of which the integration

vector S
n
 is equal to or larger than a correctable range are
continuously detected, or at a time that a fifth predetermined

number or fields of frames in each of which the whole
motion vector V
n
 has the same direction are continuously detected.
A video camera according to claim 2 or 7, wherein said
second detection means (26) detects the completion of at

least one of the panning and the tilting at a time that a
predetermined number of fields or frames in each of which the

whole motion vector becomes opposite to the whole motion vector
just before said correction means performs the correction

by utilizing the integration vector calculated by said second
integration vector calculating means are continuously detected. 
A video camera according to claim 1, further comprising:

addition means (36) for obtaining image signal addition
data by accumulating an image signal level for each of addition

regions which are formed by dividing an image field;
first arithmetic operation means (38) for evaluating differences
of said image signal addition data between each of

said addition regions and an adjacent addition regions in a
horizontal direction;
second arithmetic operation means (38) for evaluating
differences of said image signal addition data between each

of said addition regions and an adjacent addition region in a
vertical direction;
first count means (26) for counting the number of the addition
regions in each of which the difference evaluated by

said first arithmetic operation means is equal to or smaller
than a first threshold value;
second count means (26) for counting the number of the
addition regions in each of which the difference evaluated by

said second arithmetic operation means is equal to or smaller
than a second threshold value; and
determining means (26) for determining a method for calculating
the whole motion vector on the basis of a count

value of said first count means and a count value of said
second count means.
A video camera according to claim 17, wherein said determining
means (26) includes division means for dividing a

larger value of the count value of said first count means and
the count value of said second count value by a smaller value

of the count value of said first count means and the count
value of said second count means, and comparing means for

comparing a division result with a third threshold value. 
A video camera according to claim 18, further comprising
first means for making a mean value of portion motion vectors

of valid detection areas of said detection areas as the whole
motion vector between the fields or frames when the division

result is smaller than the third threshold value, and a second
means for making the whole motion vector one field or

frame before as the whole motion vector of a present field or
frame when the division result is equal to or larger than the

third threshold value.
A video camera according to claim 17, wherein said image
signal level includes a color signal level.
A video camera according to claim 17, wherein said image
signal level includes a luminance signal level.
</CLAIMS>
</TEXT>
</DOC>
