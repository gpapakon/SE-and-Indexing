<DOC>
<DOCNO>EP-0648359</DOCNO> 
<TEXT>
<INVENTION-TITLE>
CORRELATION SIGNAL PROCESSING
</INVENTION-TITLE>
<CLASSIFICATIONS>H04N732	G06F1715	H04N726	H04N726	H04N732	G06T720	G06F1715	G06T720	</CLASSIFICATIONS>
<CLASSIFICATIONS-THIRD>H04N	G06F	H04N	H04N	H04N	G06T	G06F	G06T	</CLASSIFICATIONS-THIRD>
<CLASSIFICATIONS-FOURTH>H04N7	G06F17	H04N7	H04N7	H04N7	G06T7	G06F17	G06T7	</CLASSIFICATIONS-FOURTH>
<ABSTRACT>
A method of correlation signal processing particularly for the processing of correlation surfaces which are utilised in estimating the motion within sequences of video pictures, involves matching an assumed quadratic surface in the region of a stationary value.
</ABSTRACT>
<APPLICANTS>
<APPLICANT-NAME>
SNELL 
&
 WILCOX LTD
</APPLICANT-NAME>
<APPLICANT-NAME>
SNELL 
&
 WILCOX LIMITED
</APPLICANT-NAME>
</APPLICANTS>
<INVENTORS>
<INVENTOR-NAME>
BORER TIMOTHY JOHN
</INVENTOR-NAME>
<INVENTOR-NAME>
BORER, TIMOTHY JOHN
</INVENTOR-NAME>
</INVENTORS>
<DESCRIPTION>
This invention relates to correlation signal processing and in the most 
important example to the processing of correlation surfaces which are utilised in 
estimating the motion within sequences of video pictures. By measuring the apparent movement in sequences of video images, it is 
possible to improve the processing which can be applied to such sequences. A 
particularly good method of motion estimation is disclosed in GB 2 188 510; 
this method can be referred to as phase correlation. Briefly, a correlation surface 
is derived by phase correlating two pictures selectively displaced in the x and y 
direction. Maxima in the correlation surface can be seen to relate to 
displacements of objects from one video picture to the next. Once these motion 
vectors have been identified, it is possible in further processing to assign to 
each pixel, the appropriate motion vector. It can be shown that a critical factor in motion estimation and in the further 
processing which relies upon the motion vectors, is the accuracy to which 
peaks in the correlation surface can be identified. A correlation surface will be 
sampled and appropriate steps taken to identify a sample point which is 
"higher" than its immediate neighbours". Locating the peak to an accuracy of 
one sample interval is not sufficient, however, and further processing is required 
to locate the peak to sub-sample intervals.  
 GB 2 188 510 suggests an approach by which correlation peaks can be 
identified in an x,y correlation surface (in the region of an assumed maximum) by 
fitting to the surface a quadratic function of x and a quadratic function of y. Maxima 
in the x and y functions can then be determined algebraically. The point having the 
coordinates xmax and ymax is assumed to be a peak in the surface. It is found in practice that this approach can give rise to significant errors. This 
is believed to happen because peaks in "real" correlation surfaces are frequently 
not both horizontally and vertically symmetric so that the assumptions behind the 
separable quadratic approach, breakdown. To give a practical example, if an object 
is moving diagonally in a video field, camera integration may blur the object in the 
direction of motion while leaving resolution, normal to the motion vector, unaffected. 
This, in turn, can give rise to a correlation peak which is stretched in the direction 
of motion. Edge like features in images can also give rise to elongated correlation 
peaks. It is an object of this invention to provide an improved method
</DESCRIPTION>
<CLAIMS>
A method of locating, to sub-sample interval accuracy, a stationary value in a 
sampled correlation surface S(x,y), comprising the step of locating a sample point 

x,y adjacent a stationary value, and characterised by the steps of: developing about x,y a quadratic function Z(x,y) 
where: 


Z(x,y) = ax
2
 + by
2
 + cxy + dx + ey + f; 
 
   determining the linear coefficients of Z(x,y) which represent a minimised 

error between S(x,y) and Z(x,y); and calculating x and y coordinates of the 
stationary value from said linear coefficients. 
A method according to Claim 1, wherein the linear coefficients of Z(x,y) 
which represent a minimised error between S(x,y) and Z(x,y) are determined in 

accordance with: 

c
 = (
M
T
M
)
-1
M
T
s
 
where: 


A method according to Claim 1 or Claim 2, wherein the x and y coordinates 
of the stationary value are calculated in accordance with 


x
 = 
ce
 - 2
bd
4
ab
 - 
c
2
 
&
 
y
 = 
ed
 - 2
ae
4
ab
 - 
c
2
Apparatus for locating, to sub-sample interval accuracy, a stationary 
value in a sampled correlation surface S(x,y); comprising means for generating a raster 

scanned sample signal from the correlation surface; a parallel array of spatial filters 
(100-105) each receiving said sample signal and arithmetic means (120) receiving 

the outputs of said filters and deriving coordinates of an assumed stationary value 
to sub-sample interval accuracy from the linear coefficients of Z(x,y)=ax²+by²+ 

cxy+dx+ey+f which represent a minimised error between S(x,y) and Z(x,y). 
Apparatus according to Claim 4, wherein said parallel array of spatial filters 
comprises five filters (100-105) corresponding respectively with the linear 

coefficients a, b, c, d and e. 
Apparatus according to Claim 5, wherein each said filter has an aperture of 
three scan lines and three samples. 
Apparatus according to Claim 6, wherein the apertures of the respective 
filters are as follows:-  

 

Apparatus according to any one of Claims 4 to 8, comprising peak detector 
means (203); a sub-pixel position processor (208) comprising said parallel array of 

spatial filters; scan line delay means (204, 205) providing three scan lines in  
 

parallel to said peak detector means and said sub-pixel processor; and means 
(206, 207, 209) for determining integral x and y values corresponding to a peak 

detected in said peak detector means and combining said values with x and y 
offset values provided by said sub-pixel position processor to provide to sub-sample 

interval accuracy the x and y values corresponding to a peak. 
</CLAIMS>
</TEXT>
</DOC>
