<DOC>
<DOCNO>EP-0615379</DOCNO> 
<TEXT>
<INVENTION-TITLE>
Colour conversion apparatus
</INVENTION-TITLE>
<CLASSIFICATIONS>G06T100	G06T100	G09G506	G09G506	H04N160	H04N146	H04N146	G06T120	H04N160	G06T500	G06T120	G06T500	</CLASSIFICATIONS>
<CLASSIFICATIONS-THIRD>G06T	G06T	G09G	G09G	H04N	H04N	H04N	G06T	H04N	G06T	G06T	G06T	</CLASSIFICATIONS-THIRD>
<CLASSIFICATIONS-FOURTH>G06T1	G06T1	G09G5	G09G5	H04N1	H04N1	H04N1	G06T1	H04N1	G06T5	G06T1	G06T5	</CLASSIFICATIONS-FOURTH>
<ABSTRACT>
A colour conversion apparatus (2) is disclosed maps image data from a input colour 
space (RGB) to an output colour space (CMYK). A transfer function between the colour 

spaces is known relevant to the appropriate display medium (e.g. printer (8)) and this is 
divided into intervals (22,23,24 - Fig.7,8) for interpolating between the colour spaces. The 

intervals vary in length depending on the behaviour of the transfer function with the 
intervals being shorter where the transfer function is not well behaved (i.e. rapid change in 

slope). Interpolation is performed over each interval based on a mapping a volume of input 
pixel data (8 points of RGB) to a corresponding volume of a component of output pixel 

data (e.g. 8 points of C, i.e.: C000, C001, C010 etc.) Interpolation is performed between 
those points to derive an output pixel colour component value. The process is repeated for 

each primary colour component of the output colour space to produce composite output 
pixels. Near-white and near-black colour correction is also disclosed. 


</ABSTRACT>
<APPLICANTS>
<APPLICANT-NAME>
CANON INFORMATION SYST RES
</APPLICANT-NAME>
<APPLICANT-NAME>
CANON KK
</APPLICANT-NAME>
<APPLICANT-NAME>
CANON INFORMATION SYSTEMS RESEARCH AUSTRALIA PTY LTD.
</APPLICANT-NAME>
<APPLICANT-NAME>
CANON KABUSHIKI KAISHA
</APPLICANT-NAME>
</APPLICANTS>
<INVENTORS>
<INVENTOR-NAME>
METCALFE JAMES ROBERT
</INVENTOR-NAME>
<INVENTOR-NAME>
METCALFE, JAMES ROBERT
</INVENTOR-NAME>
</INVENTORS>
<DESCRIPTION>
The present invention relates to the display of colour images on a display device
and in particular, the display of colour images by a colour printing device.The publication GB-A-2 050 751 discloses a colour scanner in which three
uncorrected colour components (CMY) are applied to a three dimensional look-up table
where are stored corresponding colour-corrected signal values for the three colours.
This scanner is concerned with correction of signals within the same colour space and
does not contemplate the conversion of an input image in one colour space to an output
image in another colour space,Background art concerning colour conversion from one colour space to another
colour space will now be described with reference to the following drawings in which:
Fig. 1 illustrates an ideal colour relationship; andFig. 2 illustrates a more realistic colour relationship which occurs in practice.Images are normally displayed by a CRT type display using an additive format
such as the Red, Green, Blue (RGB) format. In this format, separate colour
information is provided for each of the Red, Green and Blue primary colours and when
displayed together, they form any desired colour to be displayed.However, when it is desired to print out a colour representation of the image
displayed by a colour display, a subtractive colour format is generally used. One such
subtractive format is the Cyan, Magenta, Yellow and Black (CMYK) format. Such a
subtractive format is commonly used in colour printing devices and in particular is used
in the Canon CLC500 colour laser copier/printer manufactured by Canon Inc.Referring now to Fig. 1 there is shown an ideal colour relationship. In theory the
relationship between additive colours and subtractive colours is simple, as Cyan,
Magenta and Yellow are simply the complementary colours to Red, Green and Blue
respectively. They can be expressed by:
C = 1 - R;M = 1 - G;
and
Y= 1 - B.Black (K) is a function of all three additive primaries as follows:
K = rR + gG + bB,
   where r, g, and b are coefficients determined by relative human perception of red,
green and blue.Referring now to Fig. 2 there is shown a more realistic colour relationship which
occurs in practice. In practice the above equations are inadequate and the amount of
cyan for example is a complex non-linear equation that depends on the amount of red,
green, and blue. Non-linear transfer functions in the printing mechanism require a non-linear 
transfer function during conversion between the two colour formats. Fig. 1
shows the
</DESCRIPTION>
<CLAIMS>
A method for converting an input image in an input

colour space to an output image in an output colour
space, wherein said input colour space is formed of at

least one primary colour, the range of values of the or
each primary colour being divided into a series of

contiguous intervals each having two endpoints, said
method comprising the steps of:


storing (33), for each point in said input colour
space defined by one or more endpoints at respective ones of the or each

primary colour, an output colour value of a corresponding
point in said output colour space;
determining (11), for an input pixel in the input
image and for the or each said primary colour, the

interval at the respective primary colour that contains
the respective colour component value of said input

pixel;
determining (33), for said input pixel, the output
colour values of the points in said output colour space

that correspond to the endpoints of the interval or
intervals determined for said input pixel;
interpolating (15, 16) between the thus determined
output colour values to derive an output colour pixel

value in said output colour space that corresponds to the
colour value of said input pixel;

   the method being characterized by: 

said step of storing comprising storing the output
colour values in separate groups, such that for at least

one primary colour, the output colour values
corresponding to adjacent endpoints at the primary colour

are arranged in different groups stored in respective
separate groups of storage means (40, 42, 44, 46; 41, 43,

45, 47), enabling that the output colour values
corresponding to even-numbered endpoints at the primary

colour are stored separate from the colour values
corresponding to odd-numbered endpoints at the primary

colour; and
simultaneously retrieving stored output colour
values (C000, C100, ..., C111) corresponding to the

endpoints that define the interval or intervals
determined for the input pixel, wherein at said retrieval

of the stored output colour values from the storage
means, for said at least one primary colour, different

addressing offset values are used for accessing
respective different groups of storage means.
A method as claimed in claim 1, characterized in
that the output colour values corresponding to adjacent

endpoints of a primary colour are stored in respective different storage means.
A method as claimed in claim 1 or claim 2, wherein
each primary colour of the input colour space is divided

into a plurality of said intervals having endpoints so as to 
form a plurality of volumes in the input colour space, with each

volume having vertices each defined by endpoints one at each primary colour, characterized in
that said storage step comprises;


storing, for each volume, said output colour values
corresponding to the vertices of said volume in

respective storage means.
A method as claimed in any preceding claim,
characterized in that the interpolating step (16) further

includes determining a distance measure of said input
pixel from at least one of said endpoints of said determined interval or intervals by

means of a lookup table (15).
A method as claimed in any preceding claim,
characterized in that a relationship between the two

colour spaces is defined by a transfer function and the
input colour intervals at a primary colour vary in length depending on the

behaviour of the transfer function.
A method as claimed in claim 5, characterized in
that the length of the input colour intervals is shorter

at and about locations where the transfer function
undergoes a relatively rapid change in slope.
A method as claimed in claim 6, characterized in
that the length of the input colour intervals is adjusted

so that the magnitude of the change in slope of the 
transfer function between adjacent ones of the input

colour intervals is less than a predetermined value.
A method as claimed in any preceding claim,
characterized in that the output colour space is

configured for display by means of a printing system (8) and
the input colour intervals are predetermined based on a

transfer characteristic of the printing system.
A method as claimed in any preceding claim,
characterized in that the method comprises the further

step of detecting amongst said output pixels those output
pixels having a value near white and altering the same to

extend the perceived dynamic range of all said output pixels.
A method as claimed in claim 9, characterized in
that said altering involves dithering those output pixels

having a value near white over a range of pixel values.
A method as claimed in any preceding claim,
characterized in that, the method comprises the further

step of detecting amongst said output pixels those pixels
having a value near black and forcing the value of

selected ones of said those pixels to black.
Apparatus for converting an input image in an input
colour space to an output image in an output colour 

space, wherein said input colour space is formed of at
least one primary colour, the range of values of the or

each primary colour being divided into a series of
contiguous intervals each having two endpoints, said

apparatus comprising:

means (33) for storing, for each point in said input
colour space defined by one or more endpoints at respective ones of the or

each primary colour, an output colour value of a
corresponding point in said output colour space;
means (11) for determining, for an input pixel in
the input image and for the or each primary colour, the

interval at the respective primary colour that contains
the respective colour component value of said input

pixel;
means (33) for determining, for said input pixel,
the output colour values of the points in said output

colour space that correspond to the endpoints of the
interval or intervals determined for said input pixel;

and
means (15, 16) for interpolating between the thus
determined output colour values to derive an output

colour pixel value in said output colour space that
corresponds to the colour value of said input pixel;

   the apparatus being characterized by:

said means for storing effecting the storing of the output colour values in
separate groups, such that for at least one primary

colour, the output colour values corresponding to 
adjacent endpoints at the primary colour are arranged in

different groups stored in respective separate groups of
storage means (40, 42, 44, 46; 41, 43, 45, 47), enabling

that the output colour values corresponding to even-numbered
endpoints at the primary colour are stored

separate from the colour values corresponding to odd-numbered
endpoints at the primary colour; and
means for simultaneously retrieving stored output
colour values (C000, C100, ..., C111) corresponding to

the endpoints that define the interval or intervals
determined for the input pixel, wherein at said retrieval

of the stored output colour values from the storage
means, for the or each primary colour, different

addressing offset values are used for accessing
respective different groups of storage means.
Apparatus as claimed in claim 12, characterized in
that the output colour values corresponding to adjacent

endpoints at a primary colour are stored in respective different storage means.
Apparatus as claimed in claim 12 or claim 13,
wherein each primary colour of the input colour space is

divided into a plurality of said intervals having endpoints
so as to form a plurality of volumes in the input colour space,

with each volume having vertices each defined by endpoints one at each primary colour,
characterized in that said storage means comprises:


a plurality of memory means for respectively 
storing, for each volume, said output colour values

corresponding to the vertices of said volume in respective ones
of said memory means.
Colour conversion apparatus as claimed in claim 12
characterized in that said interpolation means (16)

comprises a lookup table for determining a distance
measure of said input pixel from at least one of said

endpoints of said determined interval or intervals.
Colour conversion apparatus as claimed in any one
of claims 13 to 15 characterized in that a relationship

between the two colour spaces is defined by a transfer
function and the input colour intervals at a primary colour vary in length

depending on the behaviour of the transfer function.
Colour conversion apparatus as claimed in claim 16
characterized in that the length of the input colour

intervals is shorter at and about locations where the
transfer function undergoes a relatively rapid change in

slope.
Colour conversion apparatus as claimed in claim 17
characterized in that the length of the input colour

intervals is adjusted so that the magnitude of the change
in slope of the transfer function between adjacent ones

of the input colour intervals is less than a
predetermined value. 
Colour conversion apparatus as claimed in any one
of claims 12 to 18 characterized in that the output

colour space is configured for display by means of a
printing system (8) and the input colour intervals are

predetermined based on a transfer characteristic of the
printing system.
</CLAIMS>
</TEXT>
</DOC>
