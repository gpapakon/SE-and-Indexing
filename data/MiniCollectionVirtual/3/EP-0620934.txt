<DOC>
<DOCNO>EP-0620934</DOCNO> 
<TEXT>
<INVENTION-TITLE>
COMPUTER MEMORY ARRAY CONTROL.
</INVENTION-TITLE>
<CLASSIFICATIONS>G06F306	G06F306	G06F1110	G06F1110	G06F1208	G06F1208	G06F1216	G06F1216	G11B2010	G11B2010	G11B2018	G11B2018	</CLASSIFICATIONS>
<CLASSIFICATIONS-THIRD>G06F	G06F	G06F	G06F	G06F	G06F	G06F	G06F	G11B	G11B	G11B	G11B	</CLASSIFICATIONS-THIRD>
<CLASSIFICATIONS-FOURTH>G06F3	G06F3	G06F11	G06F11	G06F12	G06F12	G06F12	G06F12	G11B20	G11B20	G11B20	G11B20	</CLASSIFICATIONS-FOURTH>
<ABSTRACT>
A computer memory controller for interfacing to a host computer comprises a buffer memory (26) for interfacing to a plurality of memory units (42) and for holding data read thereto and therefrom. A central controller (22) operative to control the transfer of data to and from the host computer and the memory units (42). The buffer memory (26) is controlled to form a plurality of buffer segments for addressably storing data read from or written to the memory units (42). The central controller (22) is operative to allocate a buffer segment for a read or write request from the host computer, of a size sufficient for the data. The central controller (22) is also operative in response to data requests from the host computer to control the memory units (42) to seek data stored in different memory units (42) simultaneously.
</ABSTRACT>
<APPLICANTS>
<APPLICANT-NAME>
ARRAY DATA LTD
</APPLICANT-NAME>
<APPLICANT-NAME>
ARRAY DATA LIMITED
</APPLICANT-NAME>
</APPLICANTS>
<INVENTORS>
<INVENTOR-NAME>
HILL ANDREW JAMES WILLIAM THOM
</INVENTOR-NAME>
<INVENTOR-NAME>
HILL, ANDREW, JAMES, WILLIAM 3 THOMSON WALK
</INVENTOR-NAME>
</INVENTORS>
<DESCRIPTION>
 COMPUTER MEMORY ARRAY CONTROLThis invention relates to computer memories, and in particular to a controller for controlling and a method of controlling an array of memory units in a computer.For high performance Operating Systems and Fileservers, an idealistic computer memory would be a memory having no requirement to "seek" the data. Such a memory would have instantaneous access to all data areas. Such a memory could be provided by a RAM disk. This would provide for access to data regardless of whether it was sequential or random in its distribution in the memory. However, the use of RAM is disadvantageous compared to the use of conventional magnetic disk drive storage media in view of the high cost of RAM and especially due to the additional high cost of providing "redundancy" to compensate for failure of memory units.Thus the most commonly used non-volatile computer memories are magnetic disk drives. However, these disk drives suffer from the disadvantage that they require a period of time to position the head or heads with the correct part of the disk corresponding to the location of the data. This is termed the seek and rotation delay. This delay becomes a significant portion of the data access time when only a small amount of data is to be read or written to or from the disk.For disk drives, the seek and rotational latency times- can considerably limit the operating speed of a computer. The input/output (I/O) speed of disk drives has not kept pace with the development of microprocessors and therefore memory access time can severely restrain the performance of modern computers. 

 In order to reduce the data access time for a large memory, a number of industry standard relativity- inexpensive disk drives have been used. Since a large array of these is used, some redundancy must be incorporated in the array to compensate for disk drive failure.It is known to provide disk drives in an array of drives in such a way that the contents of any one drive can, should that drive fail, be reconstructed in a replacement drive from the information stored in the other drives.Various classifications of arrangements that can perform this are described in more detail in a paper by D.A. Patterson, G. Gibson and R.H. Katz under the title "A Case for Redundant Arrays of Inexpensive Disks (RAID)", Report No. UCB/CSD 87/391 12/1987, Computer Science Division, University of California, U.S.A.This document describes two types of arrangements. The first of these arrangements is particularly adapted for large scale data
</DESCRIPTION>
<CLAIMS>
CLAIMS
1. A computer memory controller for interfacing to a host computer comprising a buffer means for interfacing to a plurality of memory units and for holding data read thereto and therefrom; - aHd control means operative to control the transfer of data to and from said host computer and said memory units; said buffer means being controlled to form a plurality of buffer segments for addressably storing data read from or written to said memory units; said control means being operative to allocate a buffer segment for a read or write request from the host computer, of a size sufficient for the data; said control means being further operative in response to data requests from said host computer to control said memory units to seek data stored in different memory units simultaneously.
2. A computer memory controller as claimed in Claim 1 for interfacing to a plurality of memory units arranged into a two dimensional array having at least three memory channels, each memory channel comprising a plurality of memory units connected by a bus such that each memory unit of said memory channel is independently accessible; respective memory units of said memory channels forming a memory bank; wherein said control means is operative in response to data requests from said host computer to store in said buffer segments bytes or groups of bits read from a memory bank; said controller comprising a logic circuit connected to said buffer means to recombine bytes or groups of bits read from a group of said memory units of a memory bank and stored in said buffer segments to generate the requested data; said logic circuit including parity means operative to use a check byte or group of bits read from one of said memory units of said memory bank to regenerate 


data read from said group of memory units if one of said group of memory units fails; said buffer means being divided into a number of channels corresponding to the number of memory channels, each channel being divided into associated portions of buffer segments; said control means being further operative to control said memory units to seek data stored in different memory banks simultaneously.
3. A computer memory controller as claimed in Claim 2, wherein said control means is adapted to queue host data requests which it is unable to carry out at the time of the request, until the memory bank containing the requested data is not busy.
4. A computer memory controller as claimed in Claim 3, wherein if a memory bank has more than one data request said control means is adapted to control the order in which the data is sought in order to optimise the time taken to accomplish the read operation.
5. A computer memory controller as claimed in any of Claims 2 to 4, wherein said logic circuit is operative to split data input from said host computer into a plurality of portions such that said portions are temporarily stored in a buffer segment before being applied to ones of a group of said memory channels for storage in a memory bank; and said parity means is operative to generate a check byte or group of bits from said data for temporary storage in a buffer segment before being stored in at least one memory unit of a memory bank.
6. A computer memory controller as claimed in Claim 5, wherein said control means is operative to effect the writing of data to a memory bank substantially immediately. 


 to the detriment of any pending read or write requests.
7. A computer memory controller as claimed in any of Claims 2 to 6, wherein said controller is adapted for interfacing to an array of memory units having five memory channels, one said memory channel holding said check byte or groups of bits.
8. A computer memory controller as claimed in any of Claims 2 to 7, comprising a plurality of said buffer means, and said logic circuits, each said buffer means being adapted for interface to one said two dimensional array of memory units; said control means being operative to control the transfer of data to and from said host computer and a three dimensional array of memory units formed of a plurality of said two dimensional arrays of memory units.
9. A computer memory controller as claimed in any preceding claim, wherein said controller is adapted for interfacing to magnetic disk drives.
10. A computer memory controller as claimed in any preceding claim , wherein said buffer means is adapted to hold data requested by said host computer and further data logically sequential thereto; said control means being further operative to control the transfer of data to said host computer in response to requests therefrom by first addressing said buffer segments to establish whether the requested data is contained therein and if so supplying said data to said host computer, and if the requested data is not contained in the buffer segments reading said data from said memory units, supplying said data to said host computer, reading from said memory units further data which is logically sequential to the data requested by said host 


computer and storing said further data in a buffer segment; said control means being further operative to control the buffer means to control the number and size of said buffer segments.
11. A computer memory controller as claimed in Claim 10, wherein said control means is operative to reduce the size of existing buffer segments on each occasion that a request for data from said host computer cannot be complied with from the further data stored in existing ones of said buffer segments, to dynamically allocate a new segment of said buffer means for further data to the data requested, and to continue this process until the size of each buffer segment is some predetermined minimum, whereupon, at the next request for data not available in a buffer segment, the buffer segment least frequently utilised is employed.
12. A computer memory controller as claimed in any preceding claim, wherein said control means is further operative to addressably segment a plurality of said memory units such that respective segments on sequential memory units have a sequential address, and to write sequential data to sequentially addressed segments on sequential segmented memory units.
13. A computer memory controller as claimed in any of Claims 2 to 11, wherein said control means is further operative to addressably segment a plurality of said memory banks into sequential bank segments on sequential memory banks such that respective segments on sequential banks have sequential address, and to write sequential data to sequentially addressed bank segments on sequential segmented memory banks. 


 14. A method of controlling a plurality of memory units for use with a host computer comprising the steps of repeatedly receiving from said host computer a read request for data stored in said memory units and allocating a- buffer segment of sufficient size for the data to be read; and seeking data in sa i plurality of memory units simultaneously.
15. A method as claimed in Claim 14, wherein said memory units are arranged into a two dimensional array having at least three memory channels, each memory channel comprising a plurality of respective memory units connected by a bus such that each memory unit of said memory channel is independently accessible; respective memory units of said memory channels forming a memory bank; said method including the steps of storing bytes or groups of bits read from a memory bank in said buffer segments in response to data requests from said host computer; reco bining bytes or groups of bits read from a group of said memory units of a memory bank and stored in said buffer segments to generate the requested data; reading a check byte or group of bits from one of said memory units of said memory bank; regenerating data read from said group of memory units using said check byte if one of said group of said memory units fails; and seeking data stored in different memory banks simultaneously.
16. A method as claimed in Claim 15, wherein host data requests which cannot be carried out at the time of request, are queued to be carried out at a time when the memory bank containing the requested data is not busy.
17. A method as claimed in Claim 16, wherein if a memory bank has more than one data request, the order in which the 


data is sought is controlled in order to optimise the time taken to accomplish the read operation.
18. A method as claimed in any one of Claims 15 to 17 including the steps of splitting data output from said host computer into a plurality of portions; storing said portions are in buffer segment; applying said split data to ones of a group of said memory units of a memory bank; generating a check byte or group of bits from said data; storing said check byte or group of bits in a buffer segment; applying said check byte or group of bits to at least one memory unit of a memory bank.
19. A method as claimed in Claim 18, wherein data is written to a memory bank substantially immediately to the detriment of any pending read or write request.
20. A method as claimed in any of Claims 15 to 19 including the step of controlling the transfer of data to and from said host computer and a three dimensional array of memory units formed of a plurality of said two dimensional arrays of memory units.
21 A method as claimed in any of Claims 14 to 20, including the steps of checking a plurality of buffer segments to establish whether the requested data is in said buffer segments, either complying with said request by transferring the data in said buffer segments to said host computer, or first reading said data from said memory units into one buffer segment and then complying with said request, reading from said memory units further data logically sequential to the data requested and storing said data in said buffer segment. 


 22. A method as claimed in Claim 21, further including the steps of reducing the size of existing buffer segments on each occasion that a request for data from said host computer cannot be complied with from the further data stored in existing ones of said buffer segments, dynamically allocating a. new segment of said buffer for further data to the data requested, and continuing this process until the size of each buffer segment is some predetermined minimum, whereupon at the next request for data not available in a buffer segment the buffer segment least frequently utilised is employed.
23. A method as claimed in any of Claims 14 to 22, including the steps of addressably segmenting a plurality of said memory units such that respective segements on sequential memory units have a sequential address, and writing sequential data to sequentially addressed segments of sequential segmented memory units.
24. A method as claimed in any of Claims 15 to 22, including the steps of addressably segmenting a plurality of said memory banks such that respective bank segments on sequential memory banks have a sequential address, and writing sequential data to sequentially addressed bank segments of sequential segmented memory banks.
25. A computer memory controller for a host computer comprising buffer means for interfacing to at least three memory channels arranged in parallel, each memory channel comprising a plurality of memory units connected by a bus such that each memory unit of said memory channel is independently accessible; respective memory units of said memory channels forming a memory bank; a logic circuit connected to said buffer means to split data input from 


said host computer into a plurality of portions such that said portions are temporarily stored in a buffer segment before being applied to ones of a group of said memory channels for storage in a memory bank; said logic circuit being further operative to recombine portions of data successively read from successive ones of a group of said memory units of a memory bank and into said buffer means; said logic circuit including parity means operative to generate a check byte or group of bits from said data for temporary storage in said buffer means before being stored in at least one said memory unit of said memory bank, and operative to use said check byte to regenerate said data read from said group of memory units of a memory bank if one of said group of memory units fails; said buffer means being divided into a number of channels corresponding to the number of memory channels, each said channel being divided into associated portion of buffer segments; and a control means operative to control the transfer of data and check bytes or groups of bits to and from said memory banks, including allocating a buffer segment for a read or write request from the host computer of a sufficient size for the data, and controlling said memory banks to seek requested data stored in different memory banks simultaneously.
26. A computer memory controller as claimed in Claim 25, wherein said control means is adapted to queue host data requests which it is unable to carry out at the time of the request, until the memory bank containing the requested data is not busy.
27. A computer memory controller as claimed in Claim 26, wherein if a memory bank has more than one data request, said control means is adapted to control the order in which 


the data is sought in order to optimise the time taken to accomplish the read operation.
28. A computer memory controller as claimed in any of Claims 25 to 27, wherein said control means is operative to effect the writing of data^to a memory bank substantially immediately, to the detriment of any pending read or write requests.
29. A computer memory controller as claimed in any of Claims 25 to 28, wherein said controller is adapted for interfacing to an array of memory units having five memory channels, one said memory channel holding said check byte or groups of bits.
30. A computer memory controller as claimed in any of Claims 25 to 29, comprising a plurality of said buffer means, and said logic circuits, each said buffer means being adapted for interface to one said two dimensional array of memory units; said control means being operative to control the transfer of data to and from said host computer and a three dimensional array of memory units formed of a plurality of said two dimensional arrays of memory units.
31. A computer memory controller as claimed in any of Claims 25 to 30, wherein said controller is adapted for interfacing to magnetic disk drives.
32. A computer memory controller as claimed in any of Claims 25 to 31, wherein said control means is operative to allocate a first portion of said buffer means for non sequential data, said control means being operative to allocate a buffer segment which is of sufficient size for 


the data, in said first portion for a read or write request from the host computer which is not sequential, to control said memory banks to seek a plurality of requested data stored in . different ones of said memory banks simultaneously, to allocate a second portion of said buffer means for sequential data, to control the transfer of sequential data to said host computer in response to requests therefrom by first addressing said buffer segments of the second portion to establish whether the requested data is contained therein and if so supplying said data to said host computer, and if the requested sequential data is not contained in the buffer segments of said second portion, reading said data from the memory units of said memory banks, supplying said data to said host computer, reading from said memory units further data which is logically sequential to the data requested by the host computer and storing said further data in a buffer segment in said second portion; said control means being further operative to control the second portion of said buffer means to control the number and size of said buffer segments.
33. A computer memory controller as claimed in any of Claims 25 to 31, wherein said control means is operative to allocate a first portion of said buffer means and a number of memory banks for non sequential data, said control means being operative to allocate a buffer segment which is of sufficient size for the data, in said first portion for a read or write request from the host computer which is not sequential, to control said memory banks to seek requested data stored in different ones of said number of memory banks simultaneously, to allocate a second portion of said buffer means and the remaining memory banks for sequential data, to control the transfer of sequential data to said 


 host computer in response to requests therefrom by first addressing said buffer segments of the second portion to establish whether the requested data is contained therein and if so supplying said data to said host computer, and if the requested sequential data is not contained in the buffer segments of said -second portion, reading said data from the memory units of the remaining memory banks, supplying said data to said host computer, reading from the memory units further data which is logically sequential to the data requested by the host computer and storing said further data in a buffer segment in said second portion; said control means being further operative to control the second portion of said buffer means to control the number and size of said buffer segments.
34. A computer memory controller as claimed in Claim 33, wherein said control means is further operative to addressably segment a plurality of said memory banks such that respective bank segments on sequential memory banks have a sequential address, to write sequential data to sequentially addressed bank segments of sequential segmented memory banks, and to seek and read requested data as well as any data sequential thereto stored in sequential bank segments in sequential ones of said plurality of memory banks simultaneously.
35. A computer storage system comprising a plurality of memory units arranged into a two dimensional array having at least three memory channels arranged in parallel, each said memory channel comprising a plurality of memory units connected by a bus such that each memory unit is independently accessible; respective memory units of said memory channels forming a memory bank; and a controller comprising buffer means interfaced to said memory units and 


for holding information read from said memory channels; said buffer means being controlled to form a plurality of buffer segments for addressably storing data read from or written to said memory units; a logic circuit connected to said buffer means to recombine bytes or groups of bits read from ones of a group of said memory units in a memory bank, parity means operative to use a check byte or group of bits read from one of said memory units in said memory bank to regenerate information read from said group of memory units if one of said group of memory units fails; and control means for controlling the transfer of data to and from said host computer and said memory units, including allocating a buffer segment for a read or write request from the host computer of a sufficient size for the data, and controlling said memory banks to seek data stored in different memory banks simultaneously.
36. A computer storage system as claimed in Claim 35 comprising five memory channels arranged in parallel, one said memory channel holding said check byte or groups of bits.
37. A computer storage system as claimed in Claim 35 or Claim 36, wherein each memory channel comprises seven memory units thus forming seven memory banks.
38. A computer storage system as claimed in any of Claims 35 to 37, wherein said memory units are magnetic disk drives and the rotation of magnetic disk drives of a memory bank is synchronised.
39. A computer storage system as claimed in Claim 35, wherein said controller includes a plurality of said buffer means, said logic circuits and said parity means, each said 


 buffer means being adapted for interface to one said two dimensional array of memory units; said control means being operative to control the transfer of data to and from said host computer and a three dimensional array of memory units formed of a plurality of said two dimensional arrays of memory units.
40. A computer storage system as claimed in any of Claims 35 to 39, further including a second controller interfaced to said memory channels in a like manner to the first controller and having a different address on said bus.
41. A computer memory controller for a host computer comprising a plurality of buffer means each for interfacing a plurality of memory units arranged into a two dimensional array having at least three memory channels, each memory channel comprising a plurality of memory units connected by a bus such that each memory unit is independently accessible; respective memory units of said memory channels forming a memory bank; a plurality of logic circuits connected to respective said buffer means to recombine bytes or groups of bits read from ones of a group of said memory units of a memory bank and stored in said buffer segments to generate the requested data; said logic circuits each including parity means operative to use a check byte or group of bits read from one of said memory units of said memory bank to regenerate data read from said group of memory units if one of said group of memory units fails; said buffer means being divided into a number of channels corresponding to the number of memory channels, each channel being divided into associated portion of buffer segments; and control means operative to control the transfer of data from a three dimensional array of memory units formed from a plurality of said two dimensional 



arrays to said host computer in response to requests therefrom by first addressing said buffer segments to establish whether the requested data is contained therein and if so supplying said data to said host computer, and if the requested data is not contained in the buffer segments, reading said data from the memory units, supplying said data to said host computer, reading from said memory units further data which is logically sequential to the data requested by said host computer and storing said further data in a buffer segment; said control means being further operative in response to data requests from said host computer to control said memory units to seek data stored in different memory banks simultaneously; said control means further controlling said buffer means to control the number and size of said buffer segments. 

</CLAIMS>
</TEXT>
</DOC>
