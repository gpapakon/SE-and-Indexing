<DOC>
<DOCNO>EP-0659994</DOCNO> 
<TEXT>
<INVENTION-TITLE>
Closed-loop control of a diesel engine
</INVENTION-TITLE>
<CLASSIFICATIONS>F02D2100	F02M2507	F02B300	F02D4100	F02D2108	F02D4100	F02B306	F02M2507	</CLASSIFICATIONS>
<CLASSIFICATIONS-THIRD>F02D	F02M	F02B	F02D	F02D	F02D	F02B	F02M	</CLASSIFICATIONS-THIRD>
<CLASSIFICATIONS-FOURTH>F02D21	F02M25	F02B3	F02D41	F02D21	F02D41	F02B3	F02M25	</CLASSIFICATIONS-FOURTH>
<ABSTRACT>
Closed-loop control of the quantity of diesel 
engine exhaust gas that is recirculated to an air intake 

(16) of the engine responds to a degree of deviation of a 
sensed air inlet rate away from a desired air inlet rate. 

A series of dedicated adaptive correction values are 
selectively updated and stored in memory in response to 

the degree of deviation for corresponding engine 
operating ranges. Proportional and integral correction 

for air inlet rate deviations is thereby provided to an 
otherwise open-loop desired EGR quantity. 


</ABSTRACT>
<APPLICANTS>
</APPLICANTS>
<INVENTORS>
</INVENTORS>
<DESCRIPTION>
This invention relates to closed-loop engine
control and, more particularly, to closed-loop control of
engine exhaust gas recirculated to an engine air intake.Recirculation of a controlled amount of diesel
engine exhaust gas to the engine air intake is generally
known to provide a beneficial reduction in diesel engine
emissions of oxides of nitrogen NOx. Limits are
conventionally imposed on the amount of recirculated
exhaust gas EGR to avoid excessive engine intake air
charge dilution which may degrade engine performance and
increase particulate emission levels. Both open-loop
and closed-loop EGR control approaches operate to deliver
EGR to the engine air intake in an amount reflecting a
compromise between the competing goals of minimising NOx
and particulate emissions in an engine that delivers a
satisfying level of performance. The open-loop
approaches deliver EGR according to an open-loop EGR
schedule determined through a modelled or calibrated
relationship between desired EGR and certain engine
parameters. Such open-loop approaches are sensitive to
variations in that modelled or calibrated relationship,
such as may result from sensor or actuator degradation
over time, or from gradual changes in such parameters as
engine exhaust backpressure.Closed-loop approaches attempt to compensate
for unmodelled or unmodellable system disturbances by
including some measure of the actual performance of the
EGR control in the determination of a desired EGR
quantity. For example, the approach described in
US-A-5,150,694 relies on actual engine air/fuel ratio
feedback from a conventional oxygen sensor in the diesel
engine exhaust gas path to compensate for deviations in
the actual performance of the EGR control away from a
desired performance. Sensitivity to unmodelled system 
disturbances is reduced through such closed-loop
operation, but at a cost. The oxygen sensors and their
supporting electronic circuitry add significant expense
to the EGR control. Additionally, sensor contamination
and sensor exposure to temperature extremes in the harsh
exhaust gas path environment can lead to reduced sensor
accuracy, which can result in reduced EGR control
precision.The present invention seeks to provide an
improved method of controlling recirculated engine
exhaust gas.According to an aspect of the present
invention, there is provided a method of controlling
recirculated engine exhaust gas as specified in claim 1.According to another aspect of the present
invention, there is provided a method of controlling
recirculation of
</DESCRIPTION>
<CLAIMS>
A method of controlling recirculated engine
exhaust gas in a diesel engine having a plurality of

cylinders and an EGR valve (38) responsive to an EGR
command for metering the recirculated exhaust gas to an

engine air intake (16) so as to dilute air admitted to
the cylinders to maintain a substantially beneficial

air/fuel ratio in the cylinders, comprising the steps of

generating a fuel command for an engine
cylinder from a fuel request;
determining (70) a desired air inlet rate to
the engine cylinder in response to the fuel command as

the air inlet rate estimated to provide the beneficial
air/fuel ratio for the generated fuel command;
estimating (74) actual air inlet rate to the
cylinder;
generating (76) an air inlet rate error as the
difference between the desired air inlet rate and the

estimated actual air inlet rate;
determining (78) an open-loop desired EGR
quantity in response to the fuel command as an estimate

of the quantity of recirculated engine exhaust gas needed
to dilute air admitted to the engine cylinder to provid
e
the beneficial air/fuel ratio;
sensing a predetermined set of engine
parameters indicative of an engine operating level;
selecting (82) an EGR gain value from a stored
schedule of gain values as the one of the stored schedule

of gains values corresponding to the sensed predetermined
set of engine parameters;
determining an EGR gain adjustment value as a
predetermined function of the air inlet rate error and of

the open-loop desired EGR quantity;
varying the selected EGR gain value by the
determined EGR gain adjustment value; and 
generating (96) an EGR command as a
predetermined function of the open-loop desired EGR

quantity, the varied selected EGR gain value, and the air
inlet rate error.
A method according to claim 1, comprising
the steps of


monitoring the predetermined set of engine
parameters indicative of an engine operating level over a

predetermined stability period;
determining (83) whether the monitored set of
engine parameters is substantially steady over the

predetermined stability period;

   wherein the step of determining an EGR gain
adjustment value determines the EGR gain adjustment value

to be zero, for no variation of the EGR gain value, when
the monitored set of engine parameters are determined not

to be substantially steady, and otherwise determines the
EGR gain adjustment value as a predetermined function of

the air inlet rate error and of the open-loop desired EGR
quantity.
A method according to claim 1 or 2, wherein
the step of estimating actual air inlet rate to the

cylinder comprises the steps of

sensing engine air inlet rate;
sensing engine speed; and
determining a ratio of sensed engine air inlet
rate to sensed engine speed as an estimate of air inlet

rate to the cylinder.
A method according to claim 1, 2 or 3,
comprising the steps of


determining at least one engine operating range
within which the estimate of cylinder air inlet rate from

the estimating step can be substantially inaccurate;
sensing when the engine is operating in such a
determined engine operating range;
 
   wherein the step of determining an EGR gain

adjustment value determines the EGR gain adjustment value
to be zero, for no variation of the EGR gain value, when

the engine is sensed to be operating in such a defined
engine operating range, and otherwise determines the EGR

gain adjustment value as a predetermined function of the
air inlet rate error and of the open-loop desired EGR

quantity.
A method of controlling recirculation of a
portion of exhaust gas emitted by a diesel engine having

a plurality of cylinders and EGR metering means (38)
actuated by an EGR command for metering the portion of

exhaust gas to an engine air intake (16), comprising the
steps of


storing a set of predetermined adaptive EGR
gains, wherein each of the set corresponds to a

predetermined one of a set of engine operating ranges;
determining a desired quantity of fuel to be
injected to a cylinder from a driver fuel request;
generating a desired engine cylinder air/fuel
ratio;
determining (70) a desired cylinder air inlet
rate in accordance with the determined desired quantity

of fuel as the cylinder air inlet rate estimated to
provide the desired engine cylinder air/fuel ratio;
sensing (74) actual cylinder air inlet rate;
calculating (76) cylinder air inlet rate error
as the difference between the desired cylinder air inlet

rate and the actual cylinder air inlet rate;
determining (78) a target EGR value as an
open-loop estimate of the EGR quantity needed to provide

the desired cylinder air/fuel ratio in accordance with
the desired fuel quantity;
determining an EGR proportional adjustment by
applying a predetermined proportional gain to the

cylinder air inlet rate error; 
sensing a predetermined set of engine
parameters indicative of an engine operating level;
identifying an active one of the set of engine
operating ranges as the engine operating range which

includes the engine operating level indicated by the
sensed predetermined set of engine parameters;
selecting an adaptive EGR gain as the one of
the set of adaptive EGR gains corresponding to the active

one of the set of engine operating ranges;
determining (90) an integral EGR gain
correction value as a predetermined proportion of a ratio

of the EGR proportional adjustment to the target EGR
value;
adjusting (94) the selected adaptive EGR gain
by the integral EGR gain correction value;
modifying (94) the target EGR value in accord
with the adjusted selected adaptive EGR gain; and

generating (96) an EGR command by combining the
EGR proportional adjustment with the modified target EGR

value.
A method according to claim 5, comprising
the steps of:


monitoring the predetermined set of engine
parameters over a predetermined test period;
determining whether the monitored set of engine
parameters are substantially constant in value over the

predetermined test period;

   wherein the step of determining an integral EGR
gain correction value determines the value to be zero

when the monitored set of engine parameters are
determined to not be substantially constant over the test

period, and determines the value as a predetermined
proportion of a ratio of the EGR proportional adjustment

to the target EGR value when the monitored set of engine
parameters are determined to be substantially constant

over the test period. 
A method according to claim 5 or 6,
comprising the steps of


determining at least one engine operating
region within which the sensed actual cylinder air inlet

rate can be substantially inaccurate;
sensing when the engine is operating in such a
determined engine operating region;

   wherein the step of determining an integral EGR
gain correction value determines the value to be zero

when the engine is sensed as operating in such a defined
engine operating region and determines the value as a

predetermined proportion of a ratio of the tEGR
proportional adjustment to the target EGR value when the

engine is sensed to not be operating in such a defined
engine operating region.
</CLAIMS>
</TEXT>
</DOC>
