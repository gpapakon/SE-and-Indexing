<DOC>
<DOCNO>EP-0613294</DOCNO> 
<TEXT>
<INVENTION-TITLE>
Gradation correction device and image sensing device therewith
</INVENTION-TITLE>
<CLASSIFICATIONS>H04N520	H04N520	H04N968	H04N968	</CLASSIFICATIONS>
<CLASSIFICATIONS-THIRD>H04N	H04N	H04N	H04N	</CLASSIFICATIONS-THIRD>
<CLASSIFICATIONS-FOURTH>H04N5	H04N5	H04N9	H04N9	</CLASSIFICATIONS-FOURTH>
<ABSTRACT>
A gradation correction device with a feature quantity extraction 
means (1105) for extracting feature quantities from input digital 

picture signals of a picture, which feature quantities reflecting 
luminace level distribution of the input digital picture signals;

 
   a gradation correction characteristic det
ermination means (1106) for 
determining a gradation correction characteristic based on the feature 

quantities received from the feature quantity extraction means, which 
gradation correction characteristic defining an output signal for an 

input signal; and
 

   a correction means for correcting each of the input digital picture 
signals by using the gradation correction characteristic determined by 

the gradation correction characteristic determination means;
 

   whereby the gradation correction characteristic for the input picture 
digital signals is varied according to features thereof. 


</ABSTRACT>
<APPLICANTS>
<APPLICANT-NAME>
MATSUSHITA ELECTRIC IND CO LTD
</APPLICANT-NAME>
<APPLICANT-NAME>
MATSUSHITA ELECTRIC INDUSTRIAL CO., LTD.
</APPLICANT-NAME>
</APPLICANTS>
<INVENTORS>
<INVENTOR-NAME>
SAKAUE SHIGEO
</INVENTOR-NAME>
<INVENTOR-NAME>
TAMURA AKIHIRO
</INVENTOR-NAME>
<INVENTOR-NAME>
SAKAUE, SHIGEO
</INVENTOR-NAME>
<INVENTOR-NAME>
TAMURA, AKIHIRO
</INVENTOR-NAME>
</INVENTORS>
<DESCRIPTION>
The present invention relates to a gradation
correction device for correcting gradation of input picture
signals and a device therewith such as a camcorder or a video
printer.When a dark object is taken in a picture with a
camcorder or the like, the object in an output picture becomes
darkened with poor gradation. In particular, when a back-lit
object is taken in a picture, extreme black or white portions
appear in the picture and an output picture becomes unnatural.
Therefore, a gradation correction device is needed to be
installed in a camcorder or the like which processes picture
signals of a 1-field picture. EP-A-0 255 949 representing the closest prior art from which the invention proceeds
discloses a method of and an apparatus for correcting gradation of an image
represented by image data. A standard gradation correction curve (f(X)) independent
of characteristics of an original image is prepared in advance. An accumulated
density histogram curve (h(X)) of the original is obtained from image data of the
original. A first gradation correction curve (F(X) is obtained by modifying the
standard gradation correction curve (f(X)), while a second gradation correction
curve (H(X) is obtained by modifying the accumulated density histogram curve
(h(X)). A third gradation curve (G(X)) is obtained by linear combination of the first
and second gradation conversion curves (F(X), H(X)), to perform gradation correction
of the image data on the basis of the third gradation correction curve (G(X)).A further prior art gradation correction circuit is disclosed in JP-A-2 125 589(1990).
In such gradation correction circuit, a luminance signal Y is first attenuated and
next amplified nonlinearly. A nonlinear portion is extracted from amplified signal
and added to the luminance signal Y. Thus, half tone 
signals are emphasized while signals of high and low
luminances are preserved. Thus, the image quality of a main
object and background under back light can be improved.However, in the above-mentioned prior art, only
intermediate luminance levels are expanded. Therefore, it is
a problem for a strongly back-lit object that gradation
becomes poor between intermediate and high levels of picture
signals. Further, though image quality can be increased a
little for an object under back light, gradation for a front-lit
object or for an object having gradation ranging from low
to high levels becomes poor in some portions or an output
image becomes unnatural.A still further prior art gradation correction circuit is
disclosed in
</DESCRIPTION>
<CLAIMS>
A gradation correction device comprising:

a feature quantity extraction means (102) for extracting feature quantities from
input digital picture signals of a picture, which feature quantities reflect luminance

level distribution of the input digital picture signals;
a gradation correction coefficient determination means (103) for determining a
gradation correction coefficient based on the feature quantities received from the

feature quantity extraction means (102);
a correction factor generation means (104) which generates a correction factor
(Y/Y') on the basis of the luminance level (Y) and the gradation correction coefficient

according to a signal level of the luminance signal; and
a gradation correction means (105) which operates the input digital picture signal
with the correction factor generated by said correction factor generation means

(104);
whereby the gradation correction coefficient for the input picture digital signals is
varied according to features thereof.
The gradation correction device according to Claim 1, wherein said input
picture signals comprise a luminance signal and color difference signals.
The gradation correction device according to Claim 1, further comprising a
luminance signal generation means for separating or synthesizing the luminance

signal from the input digital picture signals. 
The gradation correction device according to Claim 3, wherein said luminance
signal generation means comprises a matrix circuit (101) for generating the

luminance signal from R, G and B signals.
The gradation correction device according to Claim 1, wherein said feature
quantity extraction means (102) determines the luminance level distribution by

calculating a histogram of the luminance signals of the picture, the luminance
signals being classified into a plurality of sections, frequency values of the sections

being used as said feature quantities.
The gradation correction device according to Claim 5, wherein a number of
said sections is three.
The gradation correction device according to Claim 1, wherein said gradation
correction coefficient determination means (103) determines the gradation

correction coefficient by averaging two prescribed gradation correction coefficient
with a weight determined according to the feature quantities received from said

feature quantity extraction means (102).
The gradation correction device according to Claim 1, wherein said gradation
correction coefficient determination means (103) comprises:


a quantization means for quantizing the feature quantities received from said
feature quantity extraction means; and
a table means (801) for providing a correction coefficient to determine the gradation
correction characteristic according to quantized values quantized by the

quantization means.
The gradation correction circuit according to Claim 8, wherein said correction
coefficient determination means (103) further comprises:


a memory means for storing a correction coefficient in a previous picture;
a counting means for counting a number of successive pictures where the correction
coefficient received from said table means is successively greater than or

successively less than the correction coefficient stored in the memory means; and
an updating means for determining the correction coefficient to be sent to said
correction means according to the number of successive pictures received from

said counting means.
The gradation correction circuit according to Claim 8, wherein said correction
coefficient determination means (103) further comprises:


a memory means for storing a correction coefficient in a previous picture; and
an updating means for determining the correction coefficient to be sent to said
correction means according to a difference of the correction coefficient received

from said table means with the correction coefficient stored in the memory means.
The gradation correction device according to Claim 1, wherein said correction
factor generation means (104) generates a correction gain for the input digital

picture signals as the correction factor according to the input digital picture signals
and the correction coefficient determined by said gradation correction characteristic

determination means; and

said gradation correction means (105) multiplies the input digital picture signals
with the correction gain received from the correction factor generation means

(104).
The gradation correction device according to Claim 1, wherein said correction
factor generation means (104) comprises:


a first means (301) for generating a first output value of a first gradation correction
characteristic for an input digital picture signal;
a second means (302) for generating a second output value of a second gradation
correction characteristic for the input digital picture signal;
an adder means (303) for adding the input digital picture signal and the correction
coefficient determined by said gradation correction coefficient determination means

(103) to provide a weight; and
a weighted average means (304) for determining the correction gain by averaging
the first and second output values with the weight.
The gradation correction device according to Claim 1, wherein said correction
factor generation means (104) comprises:


a first means for generating an output value of a first gradation correction characteristic
for an input digital picture signal;
a second means for generating an output value of a second gradation correction
characteristic for the input digital picture signal;
an average means for obtaining an average of input digital picture signals including
the input digital picture signal and those thereabout;
an adder means for adding the average received from the average means and the
correction coefficient determined by said gradation correction characteristic determination 

means to provide a weight; and
a weighted average means for determining the correction gain by averaging the
two output values with the weight.
The gradation correction circuit according to Claim 12, wherein said first
gradation characteristic Y1 of the input picture signal Y changes according to a

following equation:

Y1 = {(1/a
2
 · (Y-a)
3
 + a},

wherein "a" is a constant, and said second gradation characteristic Y2 changes
according to a following linear equation:


Y2 = b · Y,

wherein "b" is a constant.
The gradation correction circuit according to Claim 13, wherein said first
gradation characteristic Y1 changes with the input picture signal Y according to a

following equation:

Y1 = {(1/a
2
 · (Y-a)
3
 + a},

wherein "a" is a constant, and said second gradation characteristic Y2 changes
with the input picture signal Y according to a following linear equation:


Y2 = b · Y,

wherein "b" is a constant.
The gradation correction circuit according to Claim 1, said correction factor
generation means comprises:


an average detection circuit for obtaining an average Ya of an input picture signal
Y and input digital picture signals thereabout;
a first adder for adding the average Ya with said correction coefficient;
a clip circuit for clipping an output signal of the first adder with a value "0" and a
maximum level of the input picture signal Y;
a second adder for adding the input picture signal Y to provide 3Y; 
a first multiplier for multiplying the input picture signal Y two times to provide Y
2
;
a third adder for adding an output signal of the first multiplier to a constant;
a first subtractor for subtracting an output signal of the second adder from an
output signal of the third adder;
a second subtractor for subtracting an output signal of the clip circuit from the
maximum level of the input picture signal;
a second multiplier for multiplying an output signal of the first subtractor with an
output signal of the second subtractor; and
a fourth adder for adding an output signal of the clip circuit with an output signal
of the second multiplier to provide the correction gain.
The gradation correction device according to Claim 1, wherein said correction
factor generation means comprises:


a correction difference generation means generates a correction difference of a
corrected signal from the input digital picture signals as the correction factor,

which corrected signal is calculated according to the input digital picture
signals and the correction coefficient determined by said gradation correction

coefficient determination means (103); and
said gradation correction means (105) adds the input digital picture signals with
the correction difference received from the correction difference generation means.
An image sensing device comprising:

an image sensor means (1101 -1103) for detecting input picture signals of a picture
and for providing input digital picture signals;
a feature quantity extraction means (1105) for extracting feature quantities from
the input digital picture signals of a picture, which feature quantities reflect

luminance level distribution of the input picture digital signals;
a gradation correction coefficient determination means (1106) for determining a
gradation correction coefficient based on the feature quantities received from the

feature quantity extraction means (1105), which gradation correction coefficient
defines an output signal for an input signal;
a correction factor generation means (1107) which generates a correction factor
on the basis of the luminance level and the gradation correction coefficient according

to a signal level of the luminance signal; and
a gradation correction means (1108) which operates the input digital picture signal
with the correction factor generated by said correction factor generation means

(1107); 
whereby the gradation correction coefficient for the input picture digital signals is
varied according to features thereof.
The image sensing device according to Claim 18, further comprising a
means for recording the corrected picture signals of the picture in an external

recording medium.
</CLAIMS>
</TEXT>
</DOC>
