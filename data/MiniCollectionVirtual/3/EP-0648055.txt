<DOC>
<DOCNO>EP-0648055</DOCNO> 
<TEXT>
<INVENTION-TITLE>
Scrambling system, scrambling apparatus and descrambling apparatus
</INVENTION-TITLE>
<CLASSIFICATIONS>H04N7167	H04N7167	</CLASSIFICATIONS>
<CLASSIFICATIONS-THIRD>H04N	H04N	</CLASSIFICATIONS-THIRD>
<CLASSIFICATIONS-FOURTH>H04N7	H04N7	</CLASSIFICATIONS-FOURTH>
<ABSTRACT>
A scrambling apparatus has at least one of 
following processing units: a signal inserting processor 

(2, 3, 4) for inserting a dummy pattern indicating the 
quantization width in the compressed video data; a conversion 

processor (50, 5) for scrambling a signal specifying 
whether field or frame processing is used; a DCT coefficient 

conversion processor (48, 7, 6) for scrambling a 
part of the code defining the DCT coefficient; an 

intra_dc_precision conversion processor (47, 5) for scrambling 
the intra_dc_precision signal; and an alternate_scan 

conversion processor (49, 5) for scrambling the alternate_scan 
signal. A descrambling apparatus reverses the conversion 

process on the video data scrambled by the scrambling 
apparatus to restore the video data to the original 

unscrambled state. 

</ABSTRACT>
<APPLICANTS>
<APPLICANT-NAME>
MATSUSHITA ELECTRIC IND CO LTD
</APPLICANT-NAME>
<APPLICANT-NAME>
MATSUSHITA ELECTRIC INDUSTRIAL CO., LTD.
</APPLICANT-NAME>
</APPLICANTS>
<INVENTORS>
<INVENTOR-NAME>
IBARAKI SUSUMU
</INVENTOR-NAME>
<INVENTOR-NAME>
KATTA NOBORU
</INVENTOR-NAME>
<INVENTOR-NAME>
MURAKAMI HIROKI
</INVENTOR-NAME>
<INVENTOR-NAME>
NAKAMURA SEIJI
</INVENTOR-NAME>
<INVENTOR-NAME>
IBARAKI, SUSUMU
</INVENTOR-NAME>
<INVENTOR-NAME>
KATTA, NOBORU
</INVENTOR-NAME>
<INVENTOR-NAME>
MURAKAMI, HIROKI
</INVENTOR-NAME>
<INVENTOR-NAME>
NAKAMURA, SEIJI
</INVENTOR-NAME>
</INVENTORS>
<DESCRIPTION>
The present invention relates to a system for
limiting access to transmitted or stored digitized signals
by scrambling the digitized signal and providing the
descrambling procedure to authorized devices only. More
specifically, the invention relates to an effects control
scrambling apparatus for controlling the degree of
scrambling according to the objective; a descrambling
apparatus for reproducing the scrambled signal; and a
scrambled transmission apparatus comprising this scrambling
apparatus and descrambling apparatus.Signal scrambling is commonly used today for
enhanced security in pay-TV broadcasts and similar applications.
Digital signal scrambling devices such as
described in Vol. 15, No. 14, pp. 1 - 6 of the Technical
Report of the Institute of Television Engineers of Japan
(ITEJ) are used to scramble the audio signal.This conventional scrambling apparatus comprises
an exclusive-OR device for adding a random number to the
input signal; a random number generator for generating a
random number according to the scrambling key; and a
control circuit for controlling the number of random
numbers applied to the input signal, and placed between the
random number generator and the exclusive-OR device.With this conventional apparatus, the input
signal is converted to a scrambled signal by bit inversion
using a pseudo-random number generated according to the
scrambling key by a pseudo-random number generator, and by
an exclusive-OR operation by the exclusive-OR device. The
degree of input signal bit inversion is controlled at this
time by the control circuit adding or not adding the random 
numbers to the input signal at an appropriate ratio.
During descrambling, the scrambled signal can be
descrambled by reapplying an exclusive-OR operation to the
scrambled signal using the random number from the random
number generator, but the pseudo-random number generated by
the random number generator is determined by the scrambling
key, and descrambling is only possible if the scrambling
key is known.When the input signal is fixed-length coded with
a conventional scrambling apparatus and descrambling
apparatus, the position and length of each code is known
even if random data bits are inverted. As a result, codes
without a random number can still be correctly reproduced
even without descrambling, and the amount that can be
reproduced without the scrambling key can be controlled by
Varying the ratio at which the random number is added.However, because random bit inversion is applied
to the scrambled signal with this
</DESCRIPTION>
<CLAIMS>
A scrambling system comprising a scrambling apparatus and a descrambling
apparatus for scrambling and descrambling compression-coded digital video signals,

respectively,

characterized in that said scrambling apparatus comprises signal insertion means
(1, 2, 3, 4) for inserting dummy data identifying the quantization width different

from the quantization width of the quantization process used during normal coding
and that said descrambling apparatus comprises removing means (8, 12, 9) for

removing the inserted dummy data.
A scrambling system according to claim 1,

wherein said scrambling apparatus further comprises:

detecting means (30) for detecting a predetermined position in said compression-coded
digital video signal;
dummy data generation means (3) for generating dummy data;

whereby
said insertion means (2, 4) inserts said dummy data at said predetermined position
in said compression-coded digital video signal; and

wherein said descrambling apparatus comprising:
dummy data detection means (70, 101, sequence_intra, sequence_non_intra) for
detecting said dummy data inserted in said compression-coded digital video signal.
A scrambling system according to Claim 2,

wherein said detecting means (70) of said descrambling apparatus detects a predetermined
position in said compression-coded digital video signal.
A scrambling apparatus for scrambling compression-coded digital video
signals, characterized by


detecting means (30) for detecting a predetermined position in said compression-coded
digital video signal;
dummy data generation means (3) for generating dummy data identifying the
quantization width different from the quantization width of the quantization process

used during normal coding; and
insertion means (2, 4) for inserting said dummy data at said predetermined
position in said compression-coded digital video signal.
A descrambling apparatus for descrambling a compression-coded digital video
signal, characterized by


dummy data detection means (70, 101, sequence_intra, sequence_non_intra)
for detecting dummy data inserted in said compression-coded digital video signal

for identifying the quantization width different from the quantization width of the
quantization process used during normal coding; and
removing means (9) for removing the detected dummy data from said compression-coded
digital video signal.
A scrambling apparatus according to Claim 4, wherein said insertion means
(2, 4) inserts dummy data identifying the quantization width in a compression-coded

digital video signal.
A scrambling apparatus according to Claim 4, wherein said insertion means
(2, 4) processes and inserts a signal identifying the quantization width of each

coefficient component in orthogonal transform coded video data.
A scrambling apparatus according to Claim 4, wherein said insertion means
(2, 4) inserts a selected quantization matrix code in said video signal conforming

to the MPEG standard.
A scrambling apparatus according to Claim 4, wherein the insertion means
(2, 4) scrambles a quantization matrix code already present in the video signal as

the inserting pattern. 
A scrambling apparatus according to Claim 7, wherein the insertion means
(2, 4) inserts the code identifying the quantization width of the coefficient component

identifying the AC component in the orthogonal transform coded video data
as a code identifying a value smaller than the quantization width value used for

actual coding.
A scrambling apparatus according to Claim 10, wherein the insertion means
(2, 4) inserts a quantization matrix in a video signal conforming to the MPEG

standard.
A scrambling apparatus according to Claim 11, wherein the insertion means
(2, 4) inserts a quantization matrix of which all components other than the component

in line one, column one of the quantization matrix have a value of one.
A scrambling apparatus according to Claim 4 wherein the insertion means
(2, 4) processes and inserts a quantization matrix code in the signal at the specified

position, wherein:

any one component in line one other than the line one, column one component

of the quantization matrix of the MPEG-standard video signal has a value greater
than the actual coding quantization width; and
the other high frequency components have a value smaller than the actual
coding quantization width of the video signal.
A scrambling apparatus according to Claim 13 wherein the insertion means
(2, 4) processes and inserts a quantization matrix code in the signal at the specified

position, wherein:

the line one, column two component identifying the quantization width of a
first order high frequency signal of the horizontal component of the quantization

matrix of the MPEG-standard video signal has a value greater than the actual
coding quantization width; and
the other high frequency components have a value smaller than the actual
coding quantization width of the video signal.
A scrambling apparatus according to Claim 14, wherein the insertion means
(2, 4) inserts a quantization matrix code wherein:


the value of the line one, column two component is 255; and
the value of all components other than the line one, column two and line one,
column one components is one.
A scrambling apparatus according to Claim 13, wherein the insertion means
(2, 4) processes and inserts a quantization matrix code in the signal at the specified

position, wherein:

any the line one, column three component identifying the quantization width
of a second order high frequency signal of the horizontal component of the quantization

matrix of the MPEG-standard video signal has a value greater than the
actual coding quantization width; and
the other high frequency components have a value smaller than the actual
coding quantization width of the video signal.
A scrambling apparatus according to Claim 16, wherein the insertion means
(2, 4) inserts a quantization matrix code, wherein:


the value of the line one, column three component is 255; and
the value of all components other than the line one, column three and line one,
column one components is one.
A scrambling apparatus according to Claim 4, wherein the insertion means
(2, 4) processes and inserts a quantization matrix code in the signal at the specified

position, wherein:

any one component in line one other than the line one, column one component
of the quantization matrix of the MPEG-standard video signal has a value greater

than the actual coding quantization width; and
the other high frequency components have a value smaller than the actual
coding quantization width of the video signal.
A scrambling apparatus according to Claim 18,

wherein the insertion means (2, 4) processes and inserts a quantization matrix
code in the signal at the specified position, wherein:


the line two, column one component identifying the quantization width of a
first order high frequency signal of the vertical component of the quantization

matrix of the MPEG-standard video signal has a value greater than the actual
coding quantization width; and
the other high frequency components have a value smaller than the actual
coding quantization width of the video signal.
A scrambling apparatus according to Claim 19, wherein the insertion means
(2, 4) inserts a quantization matrix code, wherein:


the value of the line two, column one component is 255; and 
the value of all components other than the line two, column one and line one,
column one components is one.
A scrambling apparatus according to Claim 18,

wherein the insertion means (2, 4) processes and inserts a quantization matrix
code in the signal at the specified position, wherein:
the line three, column one component identifying the quantization width of a
second order high frequency signal of the vertical component of the quantization

matrix of the MPEG-standard video signal has a value greater than the actual
coding quantization width; and
the other high frequency components have a value smaller than the actual
coding quantization width of the video signal.
A scrambling apparatus according to Claim 21, wherein the insertion means
(2, 4) inserts a quantization matrix code, wherein:


the value of the line three, column one component is 255; and
the value of all components other than the line three, column one and line one,
column one components is one.
A scrambling apparatus according to Claim 11,

wherein the insertion means (2, 4) processes and inserts a quantization matrix
code in the signal at the specified position, wherein:
any one component in line one other than the line one, column one component,
identifying the quantization width of the high frequency signal of the horizontal

component of the quantization matrix of the MPEG-standard video signal, and
any one component in column one identifying the quantization width of the
high frequency component of the vertical component, have a value greater than

the actual coding quantization width; and
the other high frequency components have a value smaller than the actual
coding quantization width of the video signal.
A scrambling apparatus according to Claim 23,

wherein the insertion means (2, 4) processes and inserts a quantization matrix
code in the signal at the specified position, wherein:
the line two, column one component identifying the quantization width of the
first order high frequency component of the vertical component of the quantization

matrix of the MPEG-standard video signal, and the line one, column two component
identifying the quantization width of the first order high frequency component 

of the horizontal component, have a value greater than the actual coding
quantization width; and the high frequency components other than the line one,

column one component have a value smaller than the actual coding quantization
width of the video signal.
A scrambling apparatus according to Claim 4, wherein the insertion means
(2, 4) comprises an insertion position information generating means for generating

a code identifying the inserted position of the quantization matrix inserted by the
insertion means (2, 4).
A scrambling apparatus according to Claim 25, wherein the insertion position
information generating means generates as position information inserted by the

insertion means (2, 4), and a signal indicating insertion in the sequence header
when the quantization matrix code is inserted in the sequence header, and a value

of a temporal_reference signal of the inserted signal when a quantization matrix
code is inserted in the quant_matrix_extension.
A scrambling apparatus according to Claim 4, wherein the insertion means
(2, 4) comprises pattern information 
generating means for generating a dummy
pattern of the quantization matrix code to be inserted by said insertion means.
A descrambling apparatus according to Claim 5, wherein the dummy data
detection means (70, 101, sequence_intra, sequence_non_intra) detects the

quantization matrix code existing in the position identified by an inserted position
information.
A descrambling apparatus according to Claim 28, wherein the dummy data
detection means (70, 101, sequence_intra, sequence_non_intra) detects the

pattern of the quantization matrix code identified by the pattern recognition code
of the inserted quantization matrix code.
A descrambling apparatus for descrambling a scrambled digital video signal
by receiving and decoding a compressed video signal conforming to the MPEG

standard having various codes, said descrambling apparatus comprises

decoding means (15) for receiving said compressed video signal and decoding
said various codes; and
reproducing means (16) for reproducing said compressed video signal;
characterized in that said descrambling apparatus further comprises dummy
data detection means (17) for detecting dummy data inserted in said compression-coded

digital video signal , said dummy data identifying the quantization width 
different from the quantization width of the quantization process used during

normal coding; and
in that said reproducing means (16) ignores the inputted signal inputted from
decoding means (15) when said inputted signal matches with said dummy data

obtained from dummy data detection means (17) inserted in said compression-coded
digital video signal.
A scrambling system according to Claim 2, wherein said scrambling apparatus
further comprises:


detecting means (30) for detecting a predetermined code selected anyone
from a group of a first code (dct_type) identifying which one of the two processing,

a field processing and a frame processing, is used in an orthogonal
transform coded video signal, a second code (intra_dc_precision) identifying

the coefficient of the DC component in the coefficient components after
orthogonal transform coding in the orthogonal transform coded video data, and

a third code (alternate_scan) identifying a scanning method when a DCT coefficient
is coded by two-dimensional Huffman coding; and
inversion means (5) for inverting said detected predetermined code; and
wherein said descrambling apparatus further comprises:
detection means (70) for detecting said inverted predetermined code in said
compression-coded digital video signal; and
returning means (10) for returning said inverted predetermined code back to
original state.
A scrambling apparatus according to Claim 4, further comprising:

detecting means (30) for detecting a predetermined code selected anyone
from a group of a first code (dct_type) identifying which one of the two processing,

a field processing and a frame processing, is used in an orthogonal transform
coded video signal, a second code (intra_dc_precision) identifying the coefficient

of the DC component in the coefficient components after orthogonal transform
coding in the orthogonal transform coded video data, and a third code (alternate_scan)
identifying a scanning method when a DCT coefficient is coded by two-dimensional
Huffman coding; and
inversion means (5) for inverting said detected predetermined code.
A descrambling apparatus according to Claim 5, further comprising:

detection means (70) for
detecting an inverted predetermined code in said compression-coded digital video 

signal, said inverted predetermined code selected anyone from a group of a first
code (dct_type) identifying which one of the two processing, a field processing and

a frame processing, is used in an orthogonal transform coded video signal, a
second code (intra_dc_precision) identifying the coefficient of the DC component

in the coefficient components after orthogonal transform coding in the orthogonal
transform coded video data, and a third code (alternate_scan) identifying a scanning

method when a DCT coefficient is coded by two-dimensional Huffman coding;
and
returning means (10) for returning said inverted predetermined code back to
original state.
A scrambling apparatus according to Claim 4, further comprising:

detecting means (30) for detecting a coefficient component in the orthogonal
transform coded video signal; and
scrambling means (7, 6) for scrambling the detected coefficient component.
A scrambling apparatus according to Claim 34, wherein said scrambling
means comprises:


random number generation means (7) for generating a random number
relative to said detected coefficient component; and
inversion means (6) for inverting said coefficient component based on said
generated random number.
</CLAIMS>
</TEXT>
</DOC>
