<DOC>
<DOCNO>EP-0628935</DOCNO> 
<TEXT>
<INVENTION-TITLE>
Portable object authentication method by an off-line terminal, corresponding portable object and terminal
</INVENTION-TITLE>
<CLASSIFICATIONS>H04L932	H04L932	G09C100	H04L910	G06F2120	G07F710	G06F2120	G09C100	H04L910	G07F710	</CLASSIFICATIONS>
<CLASSIFICATIONS-THIRD>H04L	H04L	G09C	H04L	G06F	G07F	G06F	G09C	H04L	G07F	</CLASSIFICATIONS-THIRD>
<CLASSIFICATIONS-FOURTH>H04L9	H04L9	G09C1	H04L9	G06F21	G07F7	G06F21	G09C1	H04L9	G07F7	</CLASSIFICATIONS-FOURTH>
<ABSTRACT>
The invention relates to a method of authentication by an off-line terminal (1) of a portable object (2) including a processing circuit (4) able to deliver a secondary value (Rx) which depends upon a primary value (Qi) transmitted by the terminal. According to the invention, an authentication table (5) which associates a series of primary values (Qi) and a series of check values (Ui) is installed in the terminal, each check value being the transform under a one-way function of the secondary value (Rx) calculated by the circuit for processing an authentic portable object, and upon connection of a portable object with the terminal, one of the primary values (Qi) from the table is transmitted to the portable object, the one-way function is applied to the secondary value (Rx) received from the portable object and the result obtained is compared with the corresponding check value (Ui) from the table. The invention also relates to the portable object and the terminal which are adapted for this method. 
<
IMAGE
>
</ABSTRACT>
<APPLICANTS>
<APPLICANT-NAME>
BULL CP8
</APPLICANT-NAME>
<APPLICANT-NAME>
BULL CP8
</APPLICANT-NAME>
</APPLICANTS>
<INVENTORS>
<INVENTOR-NAME>
PATARIN JACQUES
</INVENTOR-NAME>
<INVENTOR-NAME>
PATARIN, JACQUES
</INVENTOR-NAME>
</INVENTORS>
<CLAIMS>
Method of authentication by an offline terminal (1) of
a portable object (2) containing a secret

authentication code (K) and a processing circuit (4)
capable of delivering a secondary value (Rx), which is

a function of a primary value (Qi) transmitted by the
terminal and of said secret authentication code (K),

characterised in that, within the terminal, there is
placed an authentication table (5) associating a series

of primary values (Qi) and a series of control values
(Ui), each control value being the transform, by a one-way

function, of the secondary value (Ri) calculated by
the processing circuit of an authentic portable object,

based on a given primary value, and in that, during a
connection of a portable object to the terminal, one of

the primary values (Qi) of the table is transmitted to
the portable object, the portable object is caused to

calculate a secondary value (Rx), the one-way function
is applied in the terminal to the secondary value (Rx)

received from the portable object and the result
obtained is compared with the corresponding control

value (Ui) of the table.
Method according to Claim 1, characterised in that the
authentication table (5) further comprises, for each

primary value (Qi), a signature (Si), which is the
transform, by an asymmetric function, of a combination

of the primary value (Qi) and of the corresponding
control value (Ui), and in that, during a connection of

the portable object to the terminal, on the one hand
the combination of the selected primary value and of

the corresponding control value of the table is
effected, on the other hand an inverse function of the

asymmetric function is applied to the corresponding
signature of the table, and the results obtained are

compared. 
Method according to Claim 1 or Claim 2, characterised
in that a primary value is eliminated from the table

after said value has been transmitted once to a
portable object.
Method according to Claim 1 or Claim 2, characterised
in that at each primary value of the table there is

included an identifier (lt) thereof, the portable
object has stored in it the identifier of each table

for which a primary value has been transmitted to it
during its connection to a terminal, a counter (12) is

associated with each identifier stored, and the
secondary value corresponding to a new primary value

having the same identifier is blocked when the number
of primary values transmitted has reached a stored

threshold.
Method according to Claim 4, characterised in that,
when the table of a terminal is modified, the

corresponding counters of the portable objects are
reset to zero.
Method according to Claim 4 or Claim 5, characterised
in that, before the transmission of a primary value to

the portable object, it is ensured that the table
identifier that it contains actually correspond to the

table in question.
Method according to Claim 1, characterised in that:

several secret authentication codes (K) are
contained in several respective portable objects;
the terminal holds a plurality of authentication
tables (5), each table containing the control

values (Ui) that are a function of the same secret
authentication code (K); and 
the portable object transmits to the terminal,
during a connection, means of identifying the

table associated with its authentication code (K),
a primary value of which is then transmitted to

the portable object.
Portable object capable of implementing the method
according to Claim 1, comprising a memory (3) not

accessible in read mode from outside and containing a
secret authentication code (K), and a processing

circuit (4), characterised in that said circuit uses a
symmetrical encryption algorithm in order to deliver a

secondary value (Rx), which is a function of the secret
code (K) and of a primary value (Qi) transmitted to the

object by the terminal into which the object is
introduced, and in that this object comprises a memory

(15) capable of holding the identifier (lt) of a
terminal, associated with a counter (12) incremented on

each connection to the terminal, and a device blocking
the functioning of the portable object when the value

of the counter exceeds a predetermined threshold.
Terminal capable of implementing the method according
to Claim 1, characterised in that it comprises a series

of primary values (Qi) and a series of control value
(Ut), a device (6) capable of applying, to a secondary

value received during a procedure for authenticating a
portable object connected to the terminal, a one-way

function (f) and a comparator (7) of the result
obtained and of the corresponding control value of the

table.
Terminal according to Claim 9, characterised in that it
comprises a device (9, 10) capable of verifying, when

a portable object is authenticated, that the pair:
primary value and control value has not been modified.
</CLAIMS>
</TEXT>
</DOC>
