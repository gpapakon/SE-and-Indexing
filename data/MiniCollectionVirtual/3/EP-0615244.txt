<DOC>
<DOCNO>EP-0615244</DOCNO> 
<TEXT>
<INVENTION-TITLE>
System for non-linear video editing
</INVENTION-TITLE>
<CLASSIFICATIONS>G11B2734	G11B27031	G11B2710	G11B27032	G11B27024	G11B27034	G11B2734	G11B27022	G11B27028	G11B2710	</CLASSIFICATIONS>
<CLASSIFICATIONS-THIRD>G11B	G11B	G11B	G11B	G11B	G11B	G11B	G11B	G11B	G11B	</CLASSIFICATIONS-THIRD>
<CLASSIFICATIONS-FOURTH>G11B27	G11B27	G11B27	G11B27	G11B27	G11B27	G11B27	G11B27	G11B27	G11B27	</CLASSIFICATIONS-FOURTH>
<ABSTRACT>
A non-linear video editing apparatus having a randomly 
accessible image data storage unit, a FIFO, a video effects 

unit, and desired-shots storage unit. 
The image data from the image data storage unit and data 
transfer to the FIFO are controlled so that images are not 

interrupted during an editing operation. The apparatus 
dispenses with a great number of switches and manage with a 

FIFO having a small capacity. 

</ABSTRACT>
<APPLICANTS>
<APPLICANT-NAME>
MATSUSHITA ELECTRIC IND CO LTD
</APPLICANT-NAME>
<APPLICANT-NAME>
MATSUSHITA ELECTRIC INDUSTRIAL CO., LTD.
</APPLICANT-NAME>
</APPLICANTS>
<INVENTORS>
<INVENTOR-NAME>
KAJIMOTO KAZUO
</INVENTOR-NAME>
<INVENTOR-NAME>
KANNO KINYA
</INVENTOR-NAME>
<INVENTOR-NAME>
TSUBOTA RUMI
</INVENTOR-NAME>
<INVENTOR-NAME>
KAJIMOTO, KAZUO
</INVENTOR-NAME>
<INVENTOR-NAME>
KANNO, KINYA
</INVENTOR-NAME>
<INVENTOR-NAME>
TSUBOTA, RUMI
</INVENTOR-NAME>
</INVENTORS>
<DESCRIPTION>
The present invention relates to a system for non-linear
video editing in which a video is divided into shots and after
video effects have been applied, the shots are rearranged to
produce a new video.FIG. 1 is a block diagram showing the structure of a
conventional video editing system. The system includes a VTR
101 having a source tape, a VTR 102 having a master tape, a
sync signal generation unit 103 for generating signals to
synchronize the VTRs 101 and 102, a shot link information
memory 104 for holding information on the linking order of
shots set by the user, and an edition control unit 105 for
controlling the operations of the VTRs 101 and 102 in
accordance with the information.FIG. 2A shows a source tape 201 having Shots A, B and C
corresponding to frames 101-193, 250-289, and 320-416
respectively, and a master tape 202 on which Shots C, A, and
B are rearranged to correspond to frames 1-97, 98-190, and
191-230 respectively. FIG. 2B is a shot information table
showing selected shots Nos. and start frame Nos. and
termination frame Nos. in the source tape 201 and the master 
tape 202.FIGS. 3A and 3B shows a flow chart depicting a series of
operations of the edition control unit 105 for dubbing Shots
A, B, and C on the source tape 201 onto the master tape 202 as
shown in FIG. 2A, based on the shot information shown in FIG.
2B.
(a1) The operation is started when the user inputs a
direction to the edition control unit 105.(a2) All the shot link information shown in FIG. 2B is
inputted to the edition control unit 105.(a3) The shot No. shown in FIG. 2B is initialized to 1.(a4) The start frame 320 for shot No. 1 on the source tape
201 is accessed.(a5) After the completion of the access, the source tape
201 is rewound a little bit further than the accessed frame.
This is called pre-roll, which allows the source tape 201 to
reach a normal replay speed by the time the accessed frame
starts to replay.(a6) The start frame 1 for shot No. 1 on the master tap
202 is accessed.(a7) After the completion of the access, the pre-roll is
executed.(a8) The VTR 101 having the source tape 201 starts
replaying.(a9) The VTR 102 having the master tape 202 starts
recording. (a10) The timing of the replaying of VTRs 101 and the
recording of 102 is adjusted for synchronization with reference
to the synch signal sent from the sync signal generation unit
103.(a11) The adjustment is continued until the
synchronization is achieved. This process is called phase
modification.(a12) After the completion of the phase modification, it
is
</DESCRIPTION>
<CLAIMS>
A non-linear video editing system comprising:

source video storage means (1201;301,302) for storing digital video data, every
predetermined amount of data being assigned a unique storage position, and for outputting

video data stored in a desired storing position at a desired time;
edition input operation means for receiving the storing position of shots used for
edition and a time of the edition through an input operation of an operator;
shot information storage means (1208) for storing information on a start point and
an end point of each of the shots and the time of the edition;
edition contents storing means (1042) for storing contents of an edition to be
applied to the shots;
a FIFO (1202;1221,1222) for temporarily storing inputted video data;
video data transfer means (1211) for reading the shots, based on the information
stored in said shot information storage means (1208), for dividing the read shots into

blocks, and for transferring the blocks to said FIFO (1202;1221,1222) one by one;
video edition means (201) for applying an edition to the video data sent from said
FIFO, based on the storing contents stored in said edition contents storing means (1042)

and the information stored in said shot information storage means (1208); and
data transfer control means for controlling the shot reading performed by said video
data transfer means (1
211), said data transfer control means comprising a threshold frame
number memory (1206), a block transfer request means (1207), a block transfer start/end

frames storage means, a transfer parameter calculation means (1210), and a designated
transfer frame number memory (1209); wherein 
said threshold frame number memory (1206) stores a threshold of frames for a next
transfer request to said FIFO, the threshold being set to prevent said FIFO

(1202;1221,1222) from having no frames before receiving blocks based on said block
transfer request;
said block transfer request means (1207) requests said transfer parameter
calculation means (1210) to transfer next blocks when the number of frames in said FIFO

(1202;1221,1222) becomes below the threshold;
said designated transfer frame number memory (1209) stores a designation transfer
frame number, which is the number of frames composing a block, when said data transfer

means transfers blocks in response to the block transfer request, the designation transfer
frame number being set to make the number of frames in said FIFO (1202;1221,1222)

above the threshold when the next blocks are sent in response to the block transfer request;
said block transfer start/end frames storage means stores, as an initial value, said
start point and said end point of each of the shots stored in said shot information storage

means (1208) and for storing a start point of a next block by one of adding and subtracting
the number of transferred frames to and from a start frame number in a last transfer every

time a start of a block transfer is informed;
transfer parameter calculation means (1210) finds a start frame position and an end
frame position of a block transfer in said block transfer start/end frames storage means,

said start frame position and said end frame position correspond to the shot requested block
transfer start, thereby judging by calculation whether the number of frames between said

positions is above a predetermined multiple of the designated transfer frame number, if the
number is judged to be above the predetermined multiple, directs said data transfer means

to transfer the number of frames stored in said designated transfer frame number memory 
(1209), and if the number is judged to be below the predetermined multiple, directs said

data transfer means to transfer blocks for the number of times determined by the
predetermined multiple, the number of frames composing each of the blocks being

determined by a function between said threshold frame number and the predetermined
multiple.
A non-linear video editing system of claim 1, further comprising:

another source video storage means (301,302) for storing digital video data, every
predetermined amount of data being assigned a unique storage position, and for outputting

video data stored in a desired storing position at a desired time; and wherein
the edition input operation means is arranged to receive information on the source
video storage means (301,302) to which shots used for edition belong,
the shot information storage means (1208) is arranged to store information on the
source video storage means (301,302) to which the shots belong,
the video data transfer means (1211) is arranged to read the shots from each of said
source video storage means (301,302), and
said block transfer start/end frames storage means also stores, as an initial value, the
source video storage means (301,302) to which the shots belong .
A non-linear video editing system of claim 1 or 2, further comprising:

another FIFO (1221,1222) for temporarily storing inputted video data; and
FIFO selection means (2002) for reading the information outputted from said video
data transfer means (1211) through said shot information storage means (1208) and edition

contents storing means (1042), thereby inputting each block to a respective FIFO 
(1221,1222); and wherein
the edition input operation means is also arranged to receive information on which
FIFO (1221,1222) the shots are inputted,
the edition contents storing means (1042) is also arranged to store information on
which FIFO (1221,1222) each of the shots is inputted,
said threshold frame number memory (1206) stores a threshold of frames for a next
transfer request to a given one of said FIFOs (1221,1222),
said block transfer request means (1207) requests a transfer when the number of
frames in each of said FIFOs (1221,1222) becomes below the threshold; and
the designated transfer frame number is set to make the number of frames in the
given one of said FIFOs (1221,1222) above the threshold when the next blocks are sent in

response to the block transfer request.
The non-linear video editing system of any preceding claim, wherein said transfer
parameter calculation means (1210) sets the predetermined multiple to 1.5.
The non-linear video editing system of claim 4, wherein said transfer parameter
calculation means (1210) makes each block have frames which are determined by a

function between said threshold frame number and the predetermined multiple, and sets the
number of transfer times to one of 1 and 2.
The non-linear video editing system of claim 4 or 5, wherein said data transfer
control means further comprises:


data transfer speed detection means (603) for finding an average of data transfer 
time, for the or each of the source video storage means, by repeatedly transferring a great

amount of data and then dividing a time needed for the transfer by transferred data, thereby
finding a lowest data transfer speed;
rotation wait detection means (603) for finding an average rotation wait time, for
the or each of the source video storage means, by repeating to transfer a small amount of

consecutive data and then subtracting clear transfer time from an entire time spent for the
transfer operation and for further finding a longest rotation wait time by doubling the

average rotation wait time;
longest seek time detection means (603) for first repeatedly transferring a small
amount of consecutive data in order to find a time needed for each of the repeated transfers,

for the or each of the source video storage means, and finding a value greater than the
predetermined multiple, based on a value expected from the average transfer speed found

by said data transfer speed detection means (603) and the average rotation wait time found
by said rotation wait detection means, thereby detecting a storing area having a non-consecutive

sector, and further detecting a longest seek time; and
threshold frame calculation means (671) for finding a threshold from the lowest
data transfer speed, the longest rotation wait time, and the longest seek time, for the or each

of the source video storage means, thereby either storing the found threshold to said
threshold frame number memory (1206), or determining a capacity of the or each FIFO

(1202;1221,1222).
The non-linear video editing system of any preceding claim, wherein said data
transfer control means further comprises:


following shot detection means (607) for detecting whether each of the shots stored 
in said shot information storage means (1208) is followed by another shot to be edited;
between-shots frame number calculation means for, when said other shot is
detected, finding the nu
mber of frames corresponding to a time needed after a termination
frame in a preceding shot has been edited until a start frame in a following shot has been

edited; and
between-shots fill-up means for either extending a termination frame position of
a preceding shot backwards or extending a start frame position of a following shot

forwards, thereby adding frames between the preceding and following shots, the number of
frames to be added being found by said between-shots frame number calculation means,

said between-shots fill-up means further allowing the or each FIFO (1202;1221,1222) to
read all the frames composing the preceding and following shots and the frames added

therebetween, and prohibiting said video edition means (201) from outputting the added
frames as frames to be edited.
The non-linear video editing system of any preceding claim, wherein said data
transfer control means further comprises:


a command FIFO (341) for directing said data transfer means for transferring a
block which is composed of a predetermined number of frames and which starts from a

frame position found by said transfer parameter calculator means (1210), in response to a
block transfer request from said block transfer request means (1207), said command FIFO

(341) storing a command for the transfer;
a threshold command number memory (342) for storing a threshold command
number determined by a time needed for a CPU to process a special operation of an

operator, the number of frames outputted from the or each FIFO (1202;1221,1222) during 
the time, and the threshold frame number;
command transfer request means (343) for detecting the command number in said
command FIFO (341) when the command number becomes below the threshold stored in

said threshold command number memory (342); and
transfer command parameter calculation means (344) for comparing, in response
to a direction from said command transfer request means (343), the number of frames

determined by multiplying a command number of a predetermined number of times by a
predetermined transfer frame number, with the number of frames which are not transferred

yet in the or a corresponding video storage means (1201;301,302), for inputting said
command number of the predetermined number of times to said command FIFO (341)

when the former number in the comparison is larger, and for generating a block transfer
command array composed of the number of blocks needed to transfer all the remaining

frames, thereby inputting the generated block transfer command array to said command
FIFO (341), wherein
said transfer command parameter means (344) further finds a start frame which is
supposed to be positioned first in a next block transfer, after each block transfer, and stores

the found start frame to said block transfer start/end frames storage means and said
command FIFO (341).
The non-linear video editing system of any of claims 1 to 7, wherein said data
transfer control means further comprises:


a command FIFO (381) for directing said data transfer means for transferring a
block which is composed of a predetermined number of frames and which starts from a

frame position found by said transfer parameter calculator means (1210), in response to a 
block transfer request from said block transfer request means (1207), said command FIFO

(381) storing a command for the transfer;
a threshold command number memory (382) for storing a threshold command
number determined by a time needed for a CPU to process a special operation of an

operator, the number of frames outputted from the or each FIFO (1202;1221,1222) during
the time, and the threshold frame number;
command transfer request means (383) for detecting the command number in the
command FIFO (381) when the command number becomes below the threshold stored in

said threshold command number memory (382); and
transfer command parameter calculation means (384) for comparing, in response
to a direction from said command transfer request means (383), the number of frames

determined by multiplying a command number of a predetermined number of times by a
predetermined transfer frame number, with the number of frames which are not transferred

yet, in the or a corresponding video storage means (1201;301,302), for inputting said
command number of the predetermined number of times to said command FIFO (381)

when the former number in the comparison is larger, and for generating a block transfer
command array composed of the number of blocks needed to transfer all the remaining

frames, thereby inputting the generated block transfer command array to said command
FIFO (381), said transfer command parameter calculation means (384) further finding a

start frame which is supposed to be positioned first in a next block transfer, after each
block transfer, and storing the found start frame to said block transfer start/end frames

storage means and said corresponding command FIFO (381); and
transfer command parameter calculation adjusting means for determining which
one of a plurality of requests sent from said command transfer request means (383) has a 

priority.
The non-linear video editing system of claim 6 or any of claims 7 to 9 as dependent
on claim 6, wherein said data transfer control means further comprises:

   defective area detection means for detecting a defective area in the or each source
video storage means (1201;301,302), based of information on the longest seek time sent

from said longest seek time detection means (603).
The non-linear video editing system of any preceding claim further comprising:
division information input operation means for receiving an input operation of the operator

to input contents of divided video data;

division information storage means (261,262) for storing the information
inputted to said division information input operation means;
divisional video data synthesis means (263) for synthesising the divided video data
into an original video data, based on the information read from said division information

storage means (261,262), said synthesising being carried out at least one of before each of
the divided video image is inputted to the or each FIFO (1201;1221,1222), when it is in the

or each FIFO (1201;1221,1222), and after it is outputted from the or each FIFO
(1201;1221,1222), wherein
the or each source video storage means (1201;301,302), said edition input operation
means, said shot information storage means (1208), said video data transfer means (1211),

said data transfer control means, and the or each FIFO (1202;1221,1222), each can provide
the divided video data with the same input operation and a respective process as the

original video data.
</CLAIMS>
</TEXT>
</DOC>
