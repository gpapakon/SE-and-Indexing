<DOC>
<DOCNO>EP-0611014</DOCNO> 
<TEXT>
<INVENTION-TITLE>
A communications device
</INVENTION-TITLE>
<CLASSIFICATIONS>H04Q1104	H04Q1104	H04L1256	H04L1256	</CLASSIFICATIONS>
<CLASSIFICATIONS-THIRD>H04Q	H04Q	H04L	H04L	</CLASSIFICATIONS-THIRD>
<CLASSIFICATIONS-FOURTH>H04Q11	H04Q11	H04L12	H04L12	</CLASSIFICATIONS-FOURTH>
<ABSTRACT>
A communications device, particularly but not exclusively for 
use with a routing circuit is arranged to transmit and receive 

message packets. It comprises an output buffer (42) which 
operates to convert data and flow control information into a 

plurality of bit sequences and to transmit them at a 
predetermined frequency. An input buffer is operable to 

decode incoming sequences into data items and flow control 
information. The input buffer (44) can store the data items 

and count them and transmit flow control information to the 
output buffer. 
A method of encoding the bit sequences as balanced six-bit 
codes is also described. 


</ABSTRACT>
<APPLICANTS>
</APPLICANTS>
<INVENTORS>
</INVENTORS>
<DESCRIPTION>
This invention relates to a communications device for use in message
routing, particularly routing messages in a computer network, and to a
routing switch having such a communications device.It is frequently desired to connect processing devices such as
microcomputers in a network so that one microcomputer can communicate
with others in the network. In such networks it is unduly restrictive
if a microcomputer can communication only with its immediate
neighbours, i.e. those devices hardwired to it. It is currently known
for microcomputers in a network to be capable of executing a process
whose function is to route messages through the network. That is, the
process would receive a message and execute an instruction the effect
of which would be to pass the message to the appropriate neighbouring
microcomputer where it might be required to repeat the procedure. This
is costly both in terms of process execution time on the microcomputer
and in terms of the work required to allocate processes of a program to
different microcomputers in a particular network architecture.Message routing devices of various kinds are known. Some are specific
to a particular network architecture while others operate by providing
switched channels between processing devices connected to the routing
device. In many networks, routing devices each input a packet,
determine its destination, and then forward the packet to the next
device. This is undesirable because it requires storage in each device
for transmitted packets and it causes potentially long delays between
the output of a packet and its reception. To date, there is not
available a flexible, fast and efficient routing device for routing
messages in a network.Reference is made to an article entitled "Hop-by-Hop Flow Control on
Unreliable Connections", IEEE International Conference on 
Communications, '87, Communications-Sound to Light, Volume 3, 7-10 July
1987, Seattle, pages 1683-1687. This discusses flow control in
segments of a virtual circuit through a computer network.US 4,740,958 describes a data transmission system with a plurality of
processing nodes. The aim is to ensure that buffers within the
processing nodes do not overflow and to achieve this a system of
acknowledgement signals is adopted. The nodes are interconnected by a
bundle of six optical fibres, each fibre carrying a Manchester encoded
signal. Five of the fibres carry a data digit consisting of four data
bits and an associated parity bit. The sixth fibre carries an
acknowledgement signal in the reverse
</DESCRIPTION>
<CLAIMS>
A communications device for transmitting and receiving messages
and comprising input circuitry having storage means for storing data

and a receiving input (4) for receiving input data, a counter for
counting the amount of data stored in the storage means, and output

circuitry transmitting a flow control code from an output thereof when
there is sufficient storage capacity in the storage means for a

predetermined amount of data;

   said output circuitry (42) having a data input (40) for receiving
a first stream of data and a flow control request input (43) for

receiving flow control information;

   the input circuitry being coupled to the output circuitry to
supply said flow control information via the flow control request input

(43);

   
characterised in that
 said output circuitry is effective to
convert said data of the first stream and said flow control information

into a plurality of outgoing codes (6) each of a predetermined bit
length and to transmit said outgoing codes as an output stream from

said output, said codes being selected from a group of codes, a set of
which are designated as data codes and one of which, not in said set,

is designated as said flow control code;

   and 
in that
 said input data is in the form of a stream of
incoming codes and the input circuitry is effective to decode incoming

codes of the input stream into data items stored by said storage
circuitry and said flow control information, whereby the output

circuitry is caused to transmit said flow control code in said output
stream when there is said sufficient storage capacity in the storage

means.
A communications device as claimed in claim 1, wherein the
storage means has storage capacity sufficient to hold exactly said

predetermined number of data items. 
A communications device as claimed in claim 1, wherein the
storage means has sufficient storage capacity for more than said

predetermined number of data items.
A first communications device for transmitting messages to and
receiving messages from a second communications device connected to the

first communications device, the first communications device comprising
a communications device according to any preceding claim wherein said

outgoing codes are in use transmitted as an output stream to the second
communications device, and said input stream of incoming codes are in

use received from the second communications device whereby said flow
control information supplied via the flow control request input causes

said output circuitry of the first communications device to transmit
said flow control code to the second communications device when there

is said sufficient storage capacity in the storage means of the first
communications device.
A communications device according to any preceding claim, wherein
the output circuitry has a counter for counting the number of data

items which the output circuitry is permitted to transmit, the counter
being incremented by said predetermined number in response to receipt

of a said flow control code at the input circuitry, and being effective
to be decremented by one for each data item then sent by the output

circuitry.
A communications device according to claim 5, wherein the output
circuitry sends no further data items when the counter reaches zero,

until it has been incremented in response to receipt of a flow control
code.
A method for transmitting a plurality of bit sequences from a
first communications device to a second communications device, the bit 

sequences each having the same number of bits and constituting a group,
the method comprising:


designating one of said group of bit sequences as a flow control
code and others of said group of bit sequences as data items; and
at the second communications device, counting the number of data
items transmitted from the first communications device and stored at

the second communications device and, when there is capacity at the
second communications device for a predetermined number of data items

transmitting said flow control code from the second communications
device to the first communications device to authorize transmission of

said predetermined number of data items to the second communications
device.
A method according to claim 7, further comprising:

incrementing a counter at the first communications device by said
predetermined number on receipt of a flow control code and decrementing

the counter each time a data item has been transmitted, whereby the
counter maintains a count of the number of data items which the first

communications device is permitted to transmit.
A method according to claim 9, wherein the first communications
device sends no further data items when the counter reaches zero, until

it has been incremented in response to receipt of a flow control code.
A routing switch for routing messages between computer devices in
a network having a plurality of nodes at least some of which have

respective identifications, each computer device including packet
generating circuitry for generating message packets each with a header

portion indicating a destination node identification and a message
portion following the header portion, said routing switch including at

least one input for receiving message packets from a source node in the
form of an input stream of codes each of a predetermined bit length,

and a communications device as claimed in claim 1;
 
   a plurality of output at each of which is arranged said output

circuitry;

   header reading circuitry for reading the header portion of a
packet received at the input; and

   switch circuitry for selectively interconnecting said input to a
selected one of said outputs in dependence on reading of said header

portion.
A routing switch as claimed in claim 10, wherein said at least
one input comprises a plurality of inputs, each selectively connectable

to any of said plurality of outputs.
A routing switch as claimed in claim 10 or 11, in which the
routing switch further comprises header deletion circuitry for deleting

the header portion of a packet received thereby so that on receipt of
the packet by a successive routing switch connected thereto a

subsequent portion of the packet forms the header portion.
A routing switch as claimed in claim 10 or 11, in which the
routing switch further comprises random header generation circuitry

operable to generate random addresses to form new header portions for
incoming packets.
A method of encoding data for transmitting messages through a
plurality of routing devices in bit sequences in which method the bit

sequences are selected from a finite set of twenty bit sequences, each
bit sequence having six bits comprising three ones and three zeros,

wherein a first subset of said finite set consisting of sixteen bit
sequences is designated for use as data codes and a second subset of

said finite set is designated for use as control codes for controlling
transmission of said data codes, said second subset consisting of four

bit sequences which do not form part of said first subset, wherein
 
   a first one of said control codes is designated as a flow control

code for controlling the quantity of data codes transmitted between a
source device and a destination device;

   a second one of said control codes is designated as a null code
for maintaining continuous transmission when there is no data code to

be transmitted; and

   a third one of said control codes is designated as an end of
packet code which identifies the end of a packet including with said

end of packet code at least one code.
</CLAIMS>
</TEXT>
</DOC>
