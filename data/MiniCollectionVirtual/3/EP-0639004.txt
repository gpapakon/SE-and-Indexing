<DOC>
<DOCNO>EP-0639004</DOCNO> 
<TEXT>
<INVENTION-TITLE>
Digital time delay apparatus and method
</INVENTION-TITLE>
<CLASSIFICATIONS>H03K5135	H03L706	H03K513	H03K513	H03H1708	H04L7033	H03H1708	H04L7033	H03K5135	H03L706	</CLASSIFICATIONS>
<CLASSIFICATIONS-THIRD>H03K	H03L	H03K	H03K	H03H	H04L	H03H	H04L	H03K	H03L	</CLASSIFICATIONS-THIRD>
<CLASSIFICATIONS-FOURTH>H03K5	H03L7	H03K5	H03K5	H03H17	H04L7	H03H17	H04L7	H03K5	H03L7	</CLASSIFICATIONS-FOURTH>
<ABSTRACT>
An on-chip digital servo scheme for providing continuous calibration of 
integrated circuit on-chip time delay devices to provide real-time regulation 

against various parameter or environmental changes, such as processing, 
temperature and power supply variations. The techniques are particularly useful 

for semiconductor delay lines comprised of a selectable number of identical unit 
delay circuits having the same propagation time. This scheme constantly 

monitors the delay changes in the unit delay elements and calibrates the delay 
line by comparing the delay against a stable, crystal controlled reference clock 

period to determine, in each instance, how many unit delay elements in the 
delay line is needed to effectively delay the amount of time to equal the 

reference clock period. A real time digital pointer number is generated and 
updated while the device is in operation. This pointer can be used to inform or 

update other delay or time bases on the same integrated circuit substrate which 
are constructed from the same type of unit delay cell and which may choose 

to use a different number of unit delay cells. Accordingly, this scheme can then 
be used for various delay regulation purposes in and all-digital circuit, such as 

clock multiplication, pulse width regulation, and other applications where 
accurate, regulated, digital command controlled delay or time bases are 

needed. 

</ABSTRACT>
<APPLICANTS>
<APPLICANT-NAME>
ADVANCED MICRO DEVICES INC
</APPLICANT-NAME>
<APPLICANT-NAME>
ADVANCED MICRO DEVICES INC.
</APPLICANT-NAME>
</APPLICANTS>
<INVENTORS>
<INVENTOR-NAME>
GERSHON EUGEN
</INVENTOR-NAME>
<INVENTOR-NAME>
GUO BIN
</INVENTOR-NAME>
<INVENTOR-NAME>
KUBINEC JIM
</INVENTOR-NAME>
<INVENTOR-NAME>
GERSHON, EUGEN
</INVENTOR-NAME>
<INVENTOR-NAME>
GUO, BIN
</INVENTOR-NAME>
<INVENTOR-NAME>
KUBINEC, JIM
</INVENTOR-NAME>
</INVENTORS>
<DESCRIPTION>
This invention relates to digital circuit time delay elements, such as
calibration methods and apparatus for such time delays.In data transmission and many analogue and digital systems, accurate
and stable delay elements are often necessary for various purposes such as
the generation of predetermined width pulses, clock synchronization, clock
multiplication and clock/data recovery. In traditional phase locked loop (PLL)
or other mixed analog-digital approaches, the clock rate of a controlled
oscillator or the time delay value of a delay element can be obtained by
applying an analog voltage or current as the control signal to its voltage
controlled oscillator locked to a reference oscillator. This control signal is often
a filtered or smoothed output from a phase detector, frequency range
controller, a timing detection circuit, or a combined control signal from several
detectors. The analog nature of the control signal enables a continuous, step-less
tuning of the controlled frequency or time delay value, however, the high
loop gain due to high frequency or high data rate operations, makes the
operation very sensitive to noise. Performance optimization becomes difficult
especially when integration with very large scale high speed digital functions is
necessary, since digital switching operations tends to induce a large amount of
switching noise.An all-digital phase locked loop, based on use of time delay elements,
can eliminate these concerns. By using a plurality of small delay elements in
series to construct time delays, time delay values can be obtained having a
"resolution" determined by the delay value of the individual element. The delay 
element could be a standard integrated circuit inverter device. However, the delay
of the inverters are not fixed and will be variable due to process variations,
temperature change, and power supply noise. Therefore, where a constant, accurate
delay is required, such as in most of the precise applications mentioned above, the
standard inverter is not adequate.As CMOS and other processing technologies provide more density of devices,
long strings of cascaded inverters of small delay can be obtained at lower and lower
cost and the inverters can be used as the basic high resolution unit delay element. In
addition, all-digital solutions are becoming attractive to replace many more
applications which are implemented now in analog technique or mixed analog-digital
schemes.In applications where a plurality of unit delav cells are used to form various
timing bases, a need
</DESCRIPTION>
<CLAIMS>
A method for periodically providing a signal which is accurately representative
of propagation delay in an integrated circuit comprising:


launching a reference clock signal into a serially connected chain of unit delay
cells (11);
providing taps at the outputs of a plurality of said serially connected unit delay
cells;
comparing the phase of signals at said plurality of output taps to the phase of
said reference clock signal;

characterised in that

   the method includes identifying on a periodic basis the zero tap, said zero tap
being the tap at which a change of logic level of the output signal is closest to being

in phase with a change of logic level of said reference clock signal, by establishing
a window region and determining the zero tap position by establishing the average tap

position between the two border taps of said window.
The method of claim 1 wherein the method for comparing the phase of signals
at said plurality of output taps to the phase of said reference clock signal includes

comparing the logic levels of said output signals and said reference clock signal.
The method of claim 2 wherein the method for comparing the phase of signals
at said plurality of output taps to the phase of said reference clock signal further

includes periodically sampling and holding a binary representation of the result of said
comparison of the logic levels of said output signals and said reference clock signal. 
The method of claim 3 wherein the method for comparing includes operating
on said output signals and said reference clock signal with XOR means.
The method of claim 4 wherein said comparing step is repeated periodically
at a rate which is fast enough to compensate for ambient temperature and power

supply variations which induce propagation delay changes in said integrated circuit
and to maintain precision.
The method of claim 5 wherein the step of establishing the average tap number
is obtained by adding the tap number at the low border of said window to the tap

number at the high border of said window, and dividing said sum by two.
Apparatus for providing a signal which is accurately representative of
propagation delay in an integrated circuit comprising:


an input terminal, said input terminal for receiving a clock reference signal
(10);
a serially connected chain of unit delay cells (13) including a first unit delay
cell, said first unit delay cell being connected to said input terminal to launch said

clock reference signal (10) for propagation down said chain of unit delay cells, each
cell having an input and an output;
a plurality of taps, each tap being connected to a said unit delay cell, said tap
providing a signal representative of said delay cell output;

   characterised in that the apparatus further includes means to identify on a
periodic basis the zero tap, said zero tap being the tap at which a change of logic level

of the output signal is closest to being in phase with a change of logic level of said
reference clock signal, comprising means (21,31,41,51,61,81) to establish a window 

region and determine the zero tap position by establishing the average tap position
between the two border taps of said window.
The apparatus of claim 7 wherein said means to identify said zero tap
comprises a phase comparator array (21) providing a plurality of output signals,

means (31) to periodically sample and hold a binary representation of said output
signals and provide a plurality of outputs,


means (41,51,61) to analyse said sample and hold means output and to
determine an address of a tap where said output values change from 1 to 0, this being

the window low address (43) and an address of a tap where said output values change
from 0 to 1, this being the window high address (44) and
means (81) for determining a zero tap address by averaging said window low
address and said window high address.
The apparatus of claim 8 wherein said phase comparator array (21) comprises
a plurality of logic level comparator means for comparing logic levels of said

propagating clock signal to said reference clock signal.
The apparatus of claim 9 wherein said logic level comparator means comprises
XOR means.
The apparatus of claim 10 wherein each said XOR means is connected to a
corresponding tap and to said input terminal for receiving said clock reference signal

(10)
The apparatus as claimed in claim 10 or claim 11 wherein said XOR means
have transient output pulses which have energy, and wherein said energy, in the ouput

pulses of the XOR circuits having addresses between said window low address (43)
and said window high address (44), is too low to cause said sample and hold means

(31) outputs to register a logic 1 state. 
The apparatus as claimed in any one of claims 7 to 12 wherein said zero tap
identifying means includes means to provide a digital signal representative of the

physical position of said tap which is said zero tap.
The apparatus as claimed in any one of claims 8 to 13 wherein said sample and

hold means (31) has substantially identical threshold response to falling signals and
to rising signals so that a threshold change which lowers the said window low address

will have a matching increase in said window high address so that said average
address is substantially unchanged as a function of threshold changes.
The apparatus as claimed in any one of claims 7 to 14 wherein said zero tap
identifying means includes means (101) for periodically updating said zero tap

address, said periodic updating means including means for filtering whereby new
address values must be consistent with an arbitrary number of previous addresses.
The apparatus as claimed in any one of claims 7 to 15 wherein said zero tap
identifying means includes,


means for shifting serially (41);
a counter (51), said counter being connected to a clock signal;
means for parallel loading said sample and hold means outputs into said means
for shifting serially, and
a transition detector (61), said transition detector being connected to said
means for shifting, whereby in operation, said transition detector provides and output

indication of the occurrence of transitions 0 to 1 and 1 to 0; and
means (91,71,72) responsive to said transition detector output signals for
sampling said counter to provide said window low address and said window high

address.
The apparatus as claimed in any one of claims 8 to 16 wherein said sample and
hold means (31) includes, a plurality of counter means, said counter means including

a plurality of flip-flop circuits connected as a binary up counter, each said counter 
having an input and an output, said counter input being connected to one said phase

comparator output.
The apparatus of claim 17 wherein the number of flip-flops in said counter is
large enough to provide a filtering so that a few noise triggers will not fill the

counter.
</CLAIMS>
</TEXT>
</DOC>
