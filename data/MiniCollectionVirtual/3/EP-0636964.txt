<DOC>
<DOCNO>EP-0636964</DOCNO> 
<TEXT>
<INVENTION-TITLE>
Desktop computer system having multi-level power Management
</INVENTION-TITLE>
<CLASSIFICATIONS>G06F132	G06F132	G06F1216	G06F1216	G06F1114	G06F1114	G06F9445	G06F9445	</CLASSIFICATIONS>
<CLASSIFICATIONS-THIRD>G06F	G06F	G06F	G06F	G06F	G06F	G06F	G06F	</CLASSIFICATIONS-THIRD>
<CLASSIFICATIONS-FOURTH>G06F1	G06F1	G06F12	G06F12	G06F11	G06F11	G06F9	G06F9	</CLASSIFICATIONS-FOURTH>
<ABSTRACT>
A computer system having four states of power management: a normal 
operating state, a standby state, a suspend state, and an off state. The 

standby state is characterized by devices, such as a video controller and 
a hard drive, being placed into a low-power mode transparent to the 

operating system and the applications executing on the computer system. 
The suspend state is characterized by executing code being interrupted 

and the state of the computer system being saved to a file on the hard 
drive in such a manner that system power may be removed after the state 

of the computer system is saved to the hard drive. Later, after system 
power is restored, the state of the computer system is resumed by reading 

from the hard drive and loading it in such a manner that the operating 

system and application programs are not adversely affected. The normal 
operating state and the off state correspond to the typical on and off 

states of more conventional computer systems. The suspend/resume/standby 
feature is implemented at a low cost using many standard components. 
</ABSTRACT>
<APPLICANTS>
<APPLICANT-NAME>
IBM
</APPLICANT-NAME>
<APPLICANT-NAME>
INTERNATIONAL BUSINESS MACHINES CORPORATION
</APPLICANT-NAME>
</APPLICANTS>
<INVENTORS>
<INVENTOR-NAME>
COMBS JAMES L
</INVENTOR-NAME>
<INVENTOR-NAME>
CRUMP DWAYNE T
</INVENTOR-NAME>
<INVENTOR-NAME>
PANCOAST STEVEN T
</INVENTOR-NAME>
<INVENTOR-NAME>
COMBS, JAMES L.
</INVENTOR-NAME>
<INVENTOR-NAME>
CRUMP, DWAYNE T.
</INVENTOR-NAME>
<INVENTOR-NAME>
PANCOAST, STEVEN T.
</INVENTOR-NAME>
</INVENTORS>
<DESCRIPTION>
The present invention relates to a computer system having multiple
levels of readiness in addition to the usual normal operating state and
the usual off state.Personal computer systems are well known in the art. Personal
computer systems in general, and IBM Personal Computers in particular,
have attained wide- spread use for providing computer power to many
segments of today's modern society. Personal computers can typically be
defined as a desktop, floor standing, or portable microcomputer that is
comprised of a system unit having a single central processing unit (CPU)
and associated volatile and non-volatile memory, including all RAM and
BIOS ROM, a system monitor, a keyboard, one or more flexible diskette
drives, a fixed disk storage drive (also known as a "hard drive"), a so-called
"mouse" pointing device, and an optional printer. One of the
distinguishing characteristics of these systems is the use of a
motherboard or system planar to electrically connect these components
together. These systems are designed primarily to give independent
computing power to a single user and are inexpensively priced for
purchase by individuals or small businesses. Examples of such personal
computer systems are IBM's PERSONAL COMPUTER AT and IBM's PERSONAL
SYSTEM/1 (IBM PS/1).Personal computer systems are typically used to run software to
perform such diverse activities as word processing, manipulation of data
via spread-sheets, collection and relation of data in databases, displays
of graphics, design of electrical or mechanical systems using system-design
software, etc.IBM PS/1s and PS/2s are desktop computers designed to be used at a
single location. For example, in today's society many individuals have
desktop computers at their desks or in rooms dedicated to computer-aided
tasks. Desktop computers are typically set up at a location and used by
one or many users without ever moving the computer.Desktop systems may be classified into networked and non-networked
computer systems. Networked computer systems are part of a larger
computer system and are connected to other computers or servers via local 
area networks (LANs) or wide area networks (WANs). Such networks, using
special interfaces and protocols, allow computers to share data and
programs in an efficient way. Desktop computer systems used in
businesses are typically networked computer systems. Non-networked
computers, on the other hand, are not connected to any other computers.
Data transfer from one computer to another is accomplished by writing
data to
</DESCRIPTION>
<CLAIMS>
A computer system having a central processing unit (40) a switch
(21); and a power supply control unit (106) in circuit communication with

the central processing unit (40) and the switch (21); a power supply (17)
in circuit communication with the central processing unit (40) and the

control unit (106) and comprising power selection means for selectively
providing system power from an external source to the computer system, the

power supply (17) being operable in a selected one of a first power supply
state and a second power supply state, the power supply (17) changing

between the first and second power supply states in response to the control
unit (106), the power supply control unit (106) changing the power supply

(17) between the first and second power supply states in response to at
least one of a plurality of preselected power supply control events,

wherein one of said first and said second power supply states is a power
supply state corresponding to a suspend state; the computer system being


characterised in that
 it comprises:

means for saving a system state to a non-volatile peripheral storage
medium (31) for storage while said system is in said suspend state; and
means for saving a suspend flag indicating that the computer system
has been suspended to a non-volatile internal storage medium (96) for

storage while said system is in said suspend state; and

   wherein only the switch (21) receives power while said system is in
said suspend state.
A computer system as claimed in claim 1, further comprising:

an enter suspend flag; wherein
said control unit (106) causes said computer system to transition
from a normal operating state to an off state responsive to a closure event

of said switch while said enter suspend flag is in a first flag state; and
said control unit (106) causes said computer system to transition
from a normal operating state to a suspend state responsive to a closure

event of said switch while said enter suspend flag is in a second flag
state.
A computer system as claimed in claim 1 or claim 2 wherein the power
supply (17)includes secondary circuitry for providing auxiliary power;

wherein, in the first power supply state, the power selection circuitry 
provides system power from the external source to the CPU (40), the control

unit (106), and the peripheral device; and wherein, in the second power
supply state, system power from the external source to the CPU (40) is

interrupted while the secondary circuitry continues to supply auxiliary
power to the control unit (106) from the external source.
A computer system as claimed in any of claims 1 to 3 wherein the
power management states include an off state, and wherein, in the off

state, the power supply (17)is in the second power supply state and the
code executing on the CPU (40) has been irreversibly interrupted.
A computer system as claimed in any preceding claim operable in any
selected one of a plurality of power management states, including a normal

operating state in which code is executed normally by the computer system,
a standby state in which code continues in execution by the computer system

and the computer system consumes less electrical power than in the normal
operating state and a suspend state in which execution of code by the

computer system is interrupted and the computer system consumes less
electrical power in than in the standby state, the system further

comprising:

a control unit (106) for changing the computer system between each of
the states and at least one other of the states in response to at least one

of a plurality of preselected events, the control unit (106) being operable
in response to the at least one of a plurality of preselected events for

transferring the memory data from the volatile memory to the non-volatile
storage unit and back and transferring the register data from the volatile

registers to the non-volatile storage unit and back and for causing the
memory data and register data to be stored in the non-volatile storage unit

as the computer system enters the suspend state and to be delivered from
the non-volatile storage unit to the volatile memory and the register

memory as the computer enters the normal operating state.
A computer system as claimed in any preceding claim, the system
further comprising:


a video display controller (56) for generating a video signal;
an inactivity suspend timer;
an inactivity standby timer; and
a power management controller (106) for generating a first power
management command and a second power management command.
A method for managing the use of power in a computer system as
claimed in claim 6, the method comprising the steps of:


starting the standby timer to expire after a first preselected time
interval;
starting the suspend timer to expire after a second preselected time
interval;
operating the computer system in the normal operating state until
expiration of one of the first and second time intervals;
responding to user activity occurring while the computer system is in
the normal operating state by restarting the standby timer and the suspend

timer;
responding to expiration of the first time interval during normal
operation of the computer system by removing the computer system from the

normal operating state and placing the computer system into the standby
state;
responding to expiration of the second time interval by placing the
computer system into the suspend state;
responding to user activity occurring while the computer system is in
the standby state by placing the computer system into the normal operating

state;
responding to user activity occurring while the computer system is in

the standby state by restarting the standby timer and changing the state of
the computer system from the standby state to the normal operating state;
responding to an occurrence of a first power management command while
the computer system is in one of the normal operating state and the standby

state by changing the state of the computer system from the one state to
the suspend state; and
responding to an occurrence of a second power management command
while the computer system is in the suspend state by changing the computer

system to the normal operating state; wherein
a system state is saved to a non-volatile peripheral storage medium
for storage while said system is in said suspend state; and 
a suspend flag indicating that the computer system has been suspended
is saved to a non-volatile internal storage medium (96) for storage while

said system is in said suspend state.
A method as claimed in claim 7 wherein the computer system has a
momentary pushbutton switch (21) for communicating with the power

management controller (106), the method including the step of generating
the first and second power management commands by a closure event of the

switch (21).
A method as claimed in claim 7 or claim 8 wherein the computer system
has a toggle switch (21) movable between a first switch position and a

second switch position for communicating with the power management
controller, the method including the step of generating the first and

second power management commands by placing the switch (21) into a
corresponding one of the first and second switch positions.
A method as claimed in any of claims 7 to 9 wherein the step of
responding to expiration of the first time interval includes steps of:


ceasing generation of the video signal by the video display
controller (56); and
ceasing rotation of the fixed medium by the fixed disk storage device
(31).
A method as claimed in any of claims 7 to 10 wherein the step of
responding to expiration of the second time interval includes the steps of:


ascertaining the system state of the computer system;
saving the system state to the fixed disk storage device (31); and
ceasing the delivery of system power from the power supply (17).
A method as claimed in any of claims 7 to 11 wherein the step of
responding to an occurrence of a second power management command includes

the steps of:

resuming delivery of system power from the power supply (17);
performing an abbreviated power-on self-test; 
reading the saved system state from the fixed disk storage device
(31); and
restoring the system state of the computer system.
A method as claimed in any of claims 7 to 12, in a computer system
having a central processing unit (40), a memory in circuit communication

with the CPU (40), and an interrupt controller (92) for processing a
plurality of interrupt events in coordination with the CPU (40), the

interrupt controller (92) having a first set of interrupt vectors located
in memory, a first set of interrupt service routines located in the memory,

and one or more base addresses corresponding to the first set of interrupt
service routines, the method further comprising ascertaining the state of

one or more base addresses of an interrupt by:

writing a second set of interrupt vectors to the memory;
writing a second set of interrupt service routines to the memory,
each of the interrupt service routines corresponding to one or more of the

interrupt vectors from the second set of interrupt vectors;
generating an interrupt event to be serviced by one of the interrupt
service routines corresponding to one or more of the interrupt vectors from

the second set of interrupt vectors;
processing the interrupt event in the CPU (40) in coordination with
the interrupt controller;
servicing the interrupt with one of the interrupt service routines
corresponding to one or more of the interrupt vectors from the second set

of interrupt vectors; and
determining the state of one or more of the base addresses of the
interrupt controller from the state of the memory after the step of

servicing the interrupt.
A method as claimed in claim 13, including the step of copying the
first set of interrupt vectors and the first set of interrupt service

routines from their respective locations in the memory to different
locations in memory before both of the steps of writing a second set of

interrupt vectors to the memory and writing a second set of interrupt
service routines to the memory.
</CLAIMS>
</TEXT>
</DOC>
