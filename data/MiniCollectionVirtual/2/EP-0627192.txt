<DOC>
<DOCNO>EP-0627192</DOCNO> 
<TEXT>
<INVENTION-TITLE>
Method and apparatus for deducing bioelectric current sources
</INVENTION-TITLE>
<CLASSIFICATIONS>A61B504	A61B504	</CLASSIFICATIONS>
<CLASSIFICATIONS-THIRD>A61B	A61B	</CLASSIFICATIONS-THIRD>
<CLASSIFICATIONS-FOURTH>A61B5	A61B5	</CLASSIFICATIONS-FOURTH>
<ABSTRACT>
A method and apparatus for deducing physical 
quantities such as positions, sizes and orientations of 

bioelectric current sources. Minute magnetic fields 
formed by the bioelectric current sources in a region 

under examination of an examinee are measured with a 
plurality of magnetic sensors arranged adjacent the 

region under examination. A plurality of lattice 
points are set in the region under examination. 

Physical quantities of the current sources are derived 
by solving a relational expression of unknown current 

sources at the lattice points and field data provided 
by the magnetic sensors, with a condition added thereto 

to minimize a norm of a vector having the current 
source at each of the lattice points. The lattice 

points are moved toward a lattice point having a large 
current value among the current sources computed. 

Checking is made whether a minimum distance among the 
lattice points having been moved is below a predetermined 

value. The current source computing step to the 
checking step are repeated for the lattice points 

having been removed, when the minimum distance exceeds 
the predetermined value, and the current source corresponding 

to a magnetic field occurring when the minimum 
distance is determined to be below the predetermined  

 
value is identified to be a true current source. 


</ABSTRACT>
<APPLICANTS>
<APPLICANT-NAME>
SHIMADZU CORP
</APPLICANT-NAME>
<APPLICANT-NAME>
SHIMADZU CORPORATION
</APPLICANT-NAME>
</APPLICANTS>
<INVENTORS>
<INVENTOR-NAME>
KAJIHARA SHIGEKI
</INVENTOR-NAME>
<INVENTOR-NAME>
TOMITA SADAMU
</INVENTOR-NAME>
<INVENTOR-NAME>
YAMAKI NAOKAZU
</INVENTOR-NAME>
<INVENTOR-NAME>
YOSHIDA YOSHIKAZU
</INVENTOR-NAME>
<INVENTOR-NAME>
KAJIHARA, SHIGEKI
</INVENTOR-NAME>
<INVENTOR-NAME>
TOMITA, SADAMU
</INVENTOR-NAME>
<INVENTOR-NAME>
YAMAKI, NAOKAZU
</INVENTOR-NAME>
<INVENTOR-NAME>
YOSHIDA, YOSHIKAZU
</INVENTOR-NAME>
</INVENTORS>
<DESCRIPTION>
This invention relates to a method and apparatus
for deducing positions, orientations and sizes of
bioelectric current sources.A stimulus given to a living body breaks polarization
across cell membranes and generates bioelectric
currents. Such bioelectric currents take place in the
brain and the heart, and are recorded as an electrooencephalogram
or an electrocardiogram. The magnetic
fields formed by such bioelectric currents are recorded
as a magnetoencephalogram or a magnetocardiogram.In recent years, a sensor using a SQUID (Superconducting
Quantum Interface Device) has been developed
as a device for measuring minute magnetic fields in the
living body. This sensor may be placed outside the
head to measure, in a painless and harmless way, minute
magnetic fields formed by current dipoles (hereinafter
simply called current sources also) which are bioelectric
current sources occurring in the brain. The
positions, orientations and sizes of the current 
sources relating to a lesion are deduced from the
magnetic field data thus gained. The current sources
deduced are superposed on sectional images obtained
from a radiographic CT apparatus or MRI apparatus, to
determine a physical position and other features of a
disease or the like.One example of conventional methods for deducing
current sources uses a least norm method (see, for
example, W. H. Kullmann, K. D. Jandt, K. Rehm, H. A.
Schlitte, W. J. Dallas and W. E. Smith, Advances in
Biomagnetism, pp. 571-574, Plenum Press, New York,
1989).The conventional method of deducing current
sources using the least norm method will be described
hereinafter with reference to Fig. 1.As shown in Fig. 1, a multichannel SQUID sensor 1
is disposed adjacent an examinee M. The multichannel
SQUID sensor 1 has a multiplicity of magnetic sensors
(pickup coils) S1 to Sm immersed in a coolant such as
liquid nitrogen within a vessel called a Dewar.On the other hand, a multiplicity of lattice
points "1" to "n" are set in a region to be diagnosed,
e.g. the brain, of the examinee M. Unknown current
sources (current dipoles) are assumed for the respective
lattice points, which are expressed by three-dimensional 
vectors VPj (j = 1 to n). Then, the
respective magnetic sensors S1 to Sm of the SQUID
sensor 1 detect magnetic fields B1 to Bm which are
expressed by the following equations (1):
In the equations (1),
VPj = (Pjx, Pjy, Pjz),
and
αij = (αijx, αijy, αijz).
αij is a known coefficient
representing intensity of a magnetic field detected in
the position of each magnetic sensor S1 to
</DESCRIPTION>
<CLAIMS>
A method of deducing physical quantities such as positions,
sizes and orientations of bioelectric current sources, comprising:


a magnetic field measuring step for measuring minute magnetic
fields formed by said bioelectric current sources in a region

under examination of an examinee, with a plurality of magnetic
sensors arranged adjacent said region under examination;
a lattice point setting step 541 for setting a plurality of lattice
points in said region under examination, said lattice points being

smaller in number than said magnetic sensors;
a first current source computing step 542 for deriving unknown
current sources by adding a condition to minimize a square error

of a magnetic field formed by an unknown current source at each
of said lattice points and a magnetic field measured by each of

said magnetic sensors; characterised by
a checking step 543 for checking whether the square error of the
magnetic field computed from said current source derived and the

magnetic field actual measured by each of said magnetic sensors
is a global minimum;
a lattice point rearranging step 544 for moving said lattice
points toward a lattice point having a large current value among

the current sources computed at said first current source computing
step, when said square error is determined to differ from

said global minimum; and
a current source identifying step 545 for repeating said first
current source computing step to said lattice point rearranging

step, and regarding as a true current source the current source
corresponding to a magnetic field occurring when said square

error is determined to be said global minimum at said checking
step;

wherein said square error being said global minimum
means that said square error has the smallest value among

minimum square errors derived in said first current source computing
step after said lattice points are moved and rearranged in

said lattice point rearranging step while repeating said first
current source computing step to said lattice point rearranging
A method as defined in claim 1, further comprising: 

a second current source computing step for deriving

current sources at said lattice points, when said
square error is determined to differ from said global

minimum, by adding a condition to minimize a sum of the
square error of the magnetic field formed by the

current source derived at said first current source
computing step and the magnetic field measured by each

of said magnetic sensors, and a weighted sum of squares
of said current source;
wherein said lattice point rearranging step is
executed to move said lattice points toward a lattice

point having a large current value among the current
sources computed at said second current source computing

step; and
said current source identifying step is executed
to repeat said first current source computing step to

said lattice point rearranging step, and to regard as a
true current source the current source corresponding to

a magnetic field occurring when said square error is
determined to be said global minimum at said checking

step.
A method as defined in claim 1, wherein:

said first current source computing step is
executed to derive current sources at said lattice 

points by adding a condition to minimize a sum of the
square error of the magnetic field formed by the

unknown current source at each lattice point and the
magnetic field measured by each of said magnetic

sensors, and a weighted sum of squares of said current
source;
said checking step is executed to check whether
the sum of the square error of the magnetic field

computed from said current source derived and the
magnetic field actual measured by each of said magnetic

sensors and the weighted sum of squares of said current
source computed is a global minimum;
said lattice point rearranging step is executed,
when said sum of the square error and the weighted sum

of squares of said current source is determined to
differ from said global minimum, to move said lattice

points toward a lattice point having a large current
value among the current sources computed at said first

current source computing step; and
said current source identifying step is executed
to repeat said first current source computing step to

said lattice point rearranging step, and to regard as a
true current source the current source corresponding to

a magnetic field occurring when said sum of the square
error and the weighted sum of squares of said current 

source is determined to be said global minimum at said
checking step.
A method as defined in claim 1, wherein:

said first current source computing step is
executed to derive current sources at said lattice

points by adding a condition to minimize a sum of the
square error of the magnetic field formed by the

unknown current source at each lattice point and the
magnetic field measured by each of said magnetic

sensors, and a weighted sum of squares of said current
source, a weight for said current source having the

smaller value the smaller a distance is between said
lattice points; and
said lattice point rearranging step is executed,
when said square error is determined to differ from

said global minimum, to move said lattice points toward
a lattice point having a large current value among the

current sources computed at said first current source
computing step.
An apparatus for deducing physical quantities such as positions,
sizes and orientations of bioelectric current sources, comprising:


a plurality of magnetic sensors arranged adjacent a region
under examination of an examinee for measuring minute magnetic

fields formed by said bioelectric current sources in said
region under examination;
data converting means for converting field data measured
by said magnetic sensors into digital data;
data collecting means for collecting and storing the field
data converted into the digital data;
lattice point setting means for setting a plurality of lattice
points in said region under examination, said lattice points being

smaller in number than said magnetic sensors;
first current source computing means for deriving unknown
current sources by adding a condition to minimize a square error

of a magnetic field formed by an unknown current source at each
of said lattice points and the field data stored in said data

collecting means;
checking means for checking whether the square error of the
magnetic field computed from said current source derived and the

field data actual measured by each of said magnetic sensors and
stored in said data collecting means is a global minimum;
lattice point rearranging means for moving said lattice
points toward a lattice point having a large current value among

the current sources computed by said first current source computing
means, when said square error is determined to differ from

said global minimum;
current cource identifying means for repeatedly causing said
first current source computing means, said checking means and

said lattice point rearranging means to process said lattice points
having been removed, when said minimum distance exceeds said

predetermined value, and regarding as a true current source the 
current source corresponding to a magnetic field occurring when

said square error is determined to be said global minimum by said
checking means; and
display moans for displaying said current source identified
by said current source identifying means, in superposition on a

sectional image of said region under examination.

wherein said square error being said global minimum
means that said square error has the smallest value among

minimum square errors derived by said first current source computing
means after said lattice points are moved and rearranged

by said lattice point rearranging means while said lattice points
are repeatedly moved and rearranged.
An apparatus as defined in claim 5, further
comprising:


second current source computing means for deriving
current sources at said lattice points, when said

square error is determined to differ from said global
minimum, by adding a condition to minimize a sum of the

square error of the magnetic field formed by the
current source derived by said first current source

computing means and the magnetic field measured by each
of said magnetic sensors and stored in said data

collecting means, and a weighted sum of squares of said
current source; 
wherein said lattice point rearranging means is
operable to move said lattice points toward a lattice

point having a large current value among the current
sources computed by said second current source computing

means; and
said current source identifying means is operable
to repeatedly actuate said first current source computing

means, said checking means and said lattice point
rearranging means, and to regard as a true current

source the current source corresponding to a magnetic
field occurring when said square error is determined to

be said global minimum by said checking means.
An apparatus as defined in claim 5, wherein:

said first current source computing means is
operable to derive current sources at said lattice

points by adding a condition to minimize a sum of the
square error of the magnetic field formed by the

unknown current source at each lattice point and the
magnetic field measured by each of said magnetic

sensors and stored in said data collecting means, and a
weighted sum of squares of said current source;
said checking means is operable to check whether

the sum of the square error of the magnetic field
computed from said current source derived and the 

magnetic field actual measured by each of said magnetic
sensors and stored in said data collecting means and

the weighted sum of squares of said current source
computed is a global minimum;
said lattice point rearranging means is operable,
when said sum of the square error and the weighted sum

of squares of said current source is determined to
differ from said global minimum, to move said lattice

points toward a lattice point having a large current
value among the current sources computed by said first

current source computing means; and
said current source identifying means is operable
to repeatedly actuate said first current source computing

means, said checking means and said lattice point
rearranging means, and to regard as a true current

source the current source corresponding to a magnetic
field occurring when said sum of the square error and

the weighted sum of squares of said current source is
determined to be said global minimum by said checking

means.
An apparatus as defined in claim 5, wherein:

said first current source computing means is
operable to derive current sources at said lattice

points by adding a condition to minimize a sum of the 
square error of the magnetic field formed by the

unknown current source at each lattice point and the
magnetic field measured by each of said magnetic

sensors and stored in said data collecting means, and a
weighted sum of squares of said current source, a

weight for said current source having the smaller value
the smaller a distance is between said lattice points;

and
said lattice point rearranging means is operable,
when said square error is determined to differ from

said global minimum, to move said lattice points toward
a lattice point having a large current value among the

current sources computed by said first current source
computing means.
</CLAIMS>
</TEXT>
</DOC>
