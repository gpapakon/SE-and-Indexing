<DOC>
<DOCNO>WO-2000056013</DOCNO> 
<TEXT>
<INVENTION-TITLE>
METHOD FOR AVOIDING OUT-OF-ORDERING OF FRAMES IN A NETWORK SWITCH
</INVENTION-TITLE>
<CLASSIFICATIONS>H04L1242	H04L1242	H04L1246	H04L1246	H04L1256	H04L1256	H04L2906	H04L2906	H04L2908	H04L2908	</CLASSIFICATIONS>
<CLASSIFICATIONS-THIRD>H04L	H04L	H04L	H04L	H04L	H04L	H04L	H04L	H04L	H04L	</CLASSIFICATIONS-THIRD>
<CLASSIFICATIONS-FOURTH>H04L12	H04L12	H04L12	H04L12	H04L12	H04L12	H04L29	H04L29	H04L29	H04L29	</CLASSIFICATIONS-FOURTH>
<ABSTRACT>
A method for avoiding out-of-ordering of frames in a network, wherein the method includes the steps of providing at least one first type of queue in a network switch, providing at least one second type of queue in a network switch, receiving an incoming packet, first storing the incoming packet in the at least one first type of queue if the packet is from a first source, second storing the incoming packet in the at least one second type of queue if the packet is from a second source, and sending the incoming packet to a desired destination.
</ABSTRACT>
<APPLICANTS>
<APPLICANT-NAME>
AMBE SHEKHAR
</APPLICANT-NAME>
<APPLICANT-NAME>
BROADCOM CORP
</APPLICANT-NAME>
<APPLICANT-NAME>
KADAMBI SHIRI
</APPLICANT-NAME>
<APPLICANT-NAME>
KALKUNTE MOHAN
</APPLICANT-NAME>
<APPLICANT-NAME>
AMBE, SHEKHAR
</APPLICANT-NAME>
<APPLICANT-NAME>
BROADCOM CORPORATION
</APPLICANT-NAME>
<APPLICANT-NAME>
KADAMBI, SHIRI
</APPLICANT-NAME>
<APPLICANT-NAME>
KALKUNTE, MOHAN
</APPLICANT-NAME>
</APPLICANTS>
<INVENTORS>
<INVENTOR-NAME>
AMBE SHEKHAR
</INVENTOR-NAME>
<INVENTOR-NAME>
KADAMBI SHIRI
</INVENTOR-NAME>
<INVENTOR-NAME>
KALKUNTE MOHAN
</INVENTOR-NAME>
<INVENTOR-NAME>
AMBE, SHEKHAR
</INVENTOR-NAME>
<INVENTOR-NAME>
KADAMBI, SHIRI
</INVENTOR-NAME>
<INVENTOR-NAME>
KALKUNTE, MOHAN
</INVENTOR-NAME>
</INVENTORS>
<DESCRIPTION>
TITLE OF THE INVENTION:METHOD FOR AVOIDING OUT-OF-ORDERING OF FRAMES IN A NETWORK SWITCH REFERENCE TO RELATED APPLICATIONS:This application claims priority of United States Provisional Patent Application Serial No. 60/124,878, filed on March 17, 1999, U.S. Provisional Patent Application Serial No. 60/124,882, filed on March 17, 1999, U.S. Provisional Application Serial No. 60/124,716, filed on March 17, 1999, U.S. Provisional Patent application serial no. 60/124,881 , filed on March 17, 1999, U.S. Provisional Patent application serial no. 60/127,587, filed on April 2, 1999, U.S. Provisional Patent Application Serial No.60/135,603, filed on May 24, 1999, and United States Provisional Patent Application Serial No. 60/149,706, filed on August 20, 1999. This application is a continuation-in-part (CIP) of United States Patent Application Serial No. 09/343,409, filed on June 30, 1999. The subject matter of these earlier filed applications is hereby incorporated by reference. BACKGROUND OF THE INVENTION: Field of the Invention: The invention relates to a method and apparatus for high performance switching of data packets in local area communications networks such as token ring, ATM, Ethernet, fast Ethernet, and gigabit Ethernet environments, all of which are generally known as LANs. In particular, the invention relates to a new switching architecture in an integrated, modular, single chip solution, which can be implemented on a semiconductor substrate such as a silicon chip. Description of the Related Art:The present invention advances network switching technology in a switch suitable for use in Ethernet, fast Ethernet, gigabit Ethernet, and other types of network environments which require high performance switching of data packets or data cells. A switch utilizing the disclosed elements, and a system performing the disclosed steps, provides cost and operational advantages over the prior art. 

SUMMARY OF THE INVENTION:The present invention provides a method for avoiding out-of-ordering of frames in a network, wherein the method includes the steps of providing at least one first type of queue in a network switch, providing at least one second type of queue in a network switch, receiving an incoming packet, first storing the incoming packet in the at least one first type of queue if the packet is from a first source, second storing the incoming packet in the at least one second type of queue if the packet is from a second source, and sending the incoming packet to a desired destination. The present invention
</DESCRIPTION>
<CLAIMS>
CLAIMS:
1. A method for avoiding out-of-ordering of frames in a network, said method comprising the steps of: providing at least one first type of queue in a network switch; providing at least one second type of queue in a network switch; receiving an incoming packet; first storing said incoming packet in said at least one first type of queue if said packet is from a first source; second storing said incoming packet in said at least one second type of queue if said packet is from a second source; and sending said incoming packet to a desired destination.
2. The method as recited in claim 1 , further comprising the steps of: determining if said incoming packet is from said first source; determining if a number of packets within a first queue of said at least one first type of queue is less than or equal to a first predetermined threshold; said first storing step comprising storing said incoming packet in said first queue of said at least one first type of queue if said number of packets within said first queue of said at least one first type of queue is determined to be less than or equal to said first predetermined threshold; and said method further comprising a step of inserting a marker packet in said first queue of said at least one first type of queue if said number of packets within said first queue of said at least one first type of queue is determined not to be less than or equal to said first predetermined threshold, 


 wherein said first storing step further comprises storing said incoming packet in a second queue of said at least one first type of queue if said number of packets within said first queue of said at least one first type of queue is determined not to be less than or equal to said first predetermined threshold.
3. The method as recited in claim 2, wherein said step of inserting a marker packet further comprises the steps of: inserting the marker packet in said first queue of said at least one first type of queue; and setting said first queue of said at least one first type of queue as unavailable to receive additional incoming packets.
4. The method as recited in claim 2, wherein said step of storing said incoming packet in a second queue of said at least one first type of queue further comprises the steps of: selecting said second queue of said at least one type of first queue in accordance with a predetermined sequence; switching packet flow to receive said incoming packet on said second queue of said at least one first type of queue; and updating a table to reflect the switching of said packet flow to said second queue of said at least one first type of queue.
5. The method as recited in claim 1 , wherein said step of providing at least one first type of queue further comprises exclusively designating said at least one first type of queue for receiving said incoming packets from a high speed source. 

6. The method as recited in claim 1.further comprising the steps of: determining if said incoming packet is from said first source; determining if a number of packets in said at least one first queue is less than or equal to a second threshold; and setting said at least one first queue as available if said number of packets in said at least one first queue is less than or equal to said second threshold.
7. A method for avoiding out-of-ordering of frames in a network comprising the steps of: receiving an incoming packet at a network switch determining if said incoming packet is from a high speed source; first storing said incoming packet in a first type of queue if said incoming packet is from said high speed source; second storing said incoming packet in a second type of queue if said incoming packet is from a lower speed source; and sending said incoming packet stored in one of said first queue and said second queue using a first-in first-out operation.
8. The method as recited in claim 7, wherein said step of first storing said incoming packet in a first type of queue further comprises the steps of: determining if a number of packets currently stored in a first queue of said first type of queue is greater than or equal to a first predetermined threshold; 



 storing said incoming packet in said first queue if said number of packets currently stored in said first queue is less than said first predetermined threshold; inserting a marker data unit into said first queue and setting said first queue as unavailable to receive incoming packets if said number of packets currently stored in said first queue is greater than or equal to said first predetermined threshold; and switching a packet flow of said incoming packets to a second queue of said first type of queue if said number of packets currently stored in said first queue is greater than or equal to said first predetermined threshold .
9. The method recited in claim 7, wherein said step of sending said incoming packet stored in said one of said first queue and said second queue using a first-in first-out operation, further comprises the steps of: determining if said incoming packet is from said high speed source; determining if said number of packets currently stored in said first queue is less than or equal to a second predetermined threshold; and setting said first queue as available to receive an additional incoming packet if said number of packets currently stored in said first queue is less than or equal to said second predetermined threshold.
10. A method for preventing out-of-ordering of frames in a network switch, comprising the steps of: receiving a first portion of a string of packets from a source port on a first port; 


 transferring said first portion of said string of packets to a second port for transmission to a destination; sending an indicator from said first port to said second port; receiving said indicator at said second port; sending a response indicator from said second port to said first port; and receiving a second portion of said string of packets from said source port on a third port.
11. The method as recited in claim 10, wherein said step of sending the response indicator further comprises the step of determining if said first portion of said string of packets transferred to said second port has been transmitted to said destination prior to sending said response indicator.
12. A method for preventing out-of-ordering of frames in network switch, said method comprising the steps of: receiving packets on a first ingress port from a source port; transmitting said packets from said first ingress port to an egress port for transmission to a destination; determining to switch said receiving of said packets to a second ingress port; sending a switch indicator from said first ingress port to said egress port; determining when to send a response switch indicatorfrom said egress port to said first ingress port; 


 sending said response switch indicator from said egress port to said first ingress port; forwarding said response switch indicator to said source port; and switching said receiving of said packets to said second ingress port.
13. The method recited in claim 12, wherein said step of determining when to send a response switch indicator further comprises the step of waiting to send said response switch indicator until a number of packets in said egress port are transmitted from said egress port to said destination.
14. A method for load balancing in a link aggregation environment comprising the steps of: determining if a packet flow in a network switch exceeds a predetermined threshold; determining if said packet flow is a candidate for link switching from a first link to a second link if said packet flow exceeds said predetermined threshold ; and switching said packet flow from said first link to said second link if said packet flow is determined to be a candidate for link switching.
15. The method as recited in claim 14, wherein said step of determining if said packet flow is a candidate for link switching further comprises the steps of: determining if a first packet in said packet flow is larger than a second packet in said packet flow; and 


 determining if a transmitting queue depth is sufficient to receive said second packet in the packet flow.
16. The method as recited in claim 15, wherein said step of determining if a transmitting queue depth is sufficient to receive said second packet further comprises the step of determining if a queue depth at said first link plus a number of bits in a current packet is greater than a queue depth at said second link.
17. The method as recited in claim 14, wherein said switching step further comprises the step of updating a rules table to reflect said switching of said packet flow to said second link.
18. A method for load balancing in a link aggregation environment comprising the steps of: determining a length of a first frame and a length of a second frame entering the link aggregation environment; determining a flow rate of said first frame and said second frame entering the link aggregation environment; determining if said flow rate exceeds a predetermined flow rate threshold; determining if said first frame and said second frame are candidates for link switching; and switching a transmission link for said second frame from a first transmission link to a second transmission link. 

19. The method as recited in claim 18, wherein said step of determining if said first frame and said second frame are candidates for link switching further comprises the steps of: determining if a link switching value has exceeded a predetermined link switching threshold; determining if said first frame entering the environment is larger than said second frame entering the environment; and determining if a transmitting queue depth of said second transmission link is sufficient to receive said second frame switched to said second link.
20. The method as recited in claim 18, wherein said step of switching a transmission link for said second frame further comprises the steps of: selecting said second transmission link; switching a packet transmission flow to said second transmission link; and updating a rules logic to reflect said switch.
21. A method for switching a packet flow from a first link to a second link network switch comprising the steps of: determining if the packet flow is a candidate for link switching; and switching the packet flow from the first link to the second link.
22. The method as recited in claim 8, wherein said determining step further comprises the steps of: determining if a switching frequency is below a predetermined threshold; 


 determining if a first frame in the packet flow is larger than a second frame in the packet flow; and determining if a transmitting queue depth ofthe second link is sufficient to receive said second frame.
23. The method as recited in claim 22, wherein said step of determining if a first frame in the packet flow is larger than a second frame in the packet flow further comprises the steps of: counting a number of bits in said first frame; counting a number of bits in said second frame; comparing said number of bits in said first frame plus a number of bits in a preamble to said number of bits in said second frame; and determining if said first frame is larger than said second frame based on the comparison.
24. The method as recited in claim 22, wherein said step of determining if a transmitting queue depth of the second link is sufficient to receive said second frame further comprises the step of comparing a queue depth of the first link plus a number of bits in the second frame to a queue depth of the second link. 


</CLAIMS>
</TEXT>
</DOC>
