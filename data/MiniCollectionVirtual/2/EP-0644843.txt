<DOC>
<DOCNO>EP-0644843</DOCNO> 
<TEXT>
<INVENTION-TITLE>
A METHOD AND SYSTEM FOR COMPUTER-CONTROLLED GEAR SHIFTING
</INVENTION-TITLE>
<CLASSIFICATIONS>B62M2508	B62M900	B62M9133	B62M9123	</CLASSIFICATIONS>
<CLASSIFICATIONS-THIRD>B62M	B62M	B62M	B62M	</CLASSIFICATIONS-THIRD>
<CLASSIFICATIONS-FOURTH>B62M25	B62M9	B62M9	B62M9	</CLASSIFICATIONS-FOURTH>
<ABSTRACT>
A method and system for computer-controlled shifting of a bicycle is provided. In preferred embodiments, the present invention provides a computer system that detects speed, hub speed, and crank speed, determines the optimum bicycle gear selection to maintain a desired cadence, and shifts the bicycle to the optimum bicycle gear. The computer also inputs a shift up and shift down signals from the cyclist to override the computer-selected gear. When the cyclist indicates a shift up or down, the computer adjusts the desired cadence. The computer determines the gear selection to ensure a uniform transition from the current gear to the next gear. The computer ensures that when shifting from the current gear to the next gear, the bicycle does not transition through a gear that is not between the current and next gears.
</ABSTRACT>
<APPLICANTS>
</APPLICANTS>
<INVENTORS>
</INVENTORS>
<DESCRIPTION>
This invention relates generally to the shifting
of a bicycle chain and, more particularly, to computer
controlled automatic shifting of a bicycle chain.Multigeared bicycles typically are shifted
manually under the control of the cyclist. Generally,
multigeared bicycles have a gear assembly at the rear
wheel (rear gear assembly), and one at the pedal-crank
assembly (front gear assembly). The cyclist can
independently select a front gear and a rear gear. By
selecting appropriate front and rear gears, a cyclist
determines a gear ratio that is suitable for the riding
conditions. For example, a cyclist may select a low gear
ratio when traveling uphill and a high gear ratio when
traveling downhill at a high rate of speed. The gear
ratio specifies the number of revolutions that the rear
wheel turns per revolution of the pedal crank assembly.
Each combination of a front and rear gear is referred to
as a bicycle gear. The bicycle gears are ordered from
gear 1 (low gear) based on the gear ratio. In the
following, the term "bicycle gear" refers to a particular
front and rear gear combination.Many cyclists find it desirable and comfortable
to travel at a constant cadence. The cadence is the speed
at which the cyclist pedals. To maintain a constant
cadence, the cyclist shifts gears based on the riding
conditions. For example, a cyclist may select a desired
cadence. The cyclist may be comfortable pedalling at this
cadence when the bicycle is in the highest gear traveling 
on level terrain. If, however, the cyclist encounters a slight
rise in the terrain, it may be uncomfortable (too hard) to pedal
at the desired cadence, The cyclist shifts to a lower gear so
that the desired cadence can be maintained. It is, however,
often difficult for a cyclist to maintain a constant candence.
The cyclist may not know which gear should be selected to
maintain the desired candence . Also, the cyclist may have to
shift both the front and rear gears to maintain the desired
cadence. This can be cumbersome, especially when the terrain
changes often.In order to overcome this deficiency WO 91/17078 discloses a
computer-controlled bicycle shifting system as indicated in the
precharacterizing parts of claims 1 and 38.It is the object of the invention to improve this computer-controlled
bicycle shifting system such that the shifting from
the current gear to the next gear is performed without shifting
into gears which are not between the gear ratio of the current
gear and that of the next gear.This object is solved by the teachings of claims
</DESCRIPTION>
<CLAIMS>
A method in a computer-controlled device shifting system
for determining a next device gear in which to shift,

the device having a plurality of device gears ordered by
gear ratios, the method comprising the steps of:


determining the current device gear selected;
determining legal device gears associated with the
current device gear, whereby a legal device gear is any device
 gear that may be shifted into from the current device gear;
and selecting the next device gear from the determined
legal device gears;
characterized in that

a legal device gear is further defined as being limited to a device gear that can be
shifted into from the current device gear without

intermediately shifting into another device gear that
has a gear ratio that is not between the gear ratio of

the current device gear and the next device gear. 
The method of claim 1, wherein the device includes a
front gear assembly (170) with a plurality of front

gears (171, 172, 173), each front gear having a
plurality of teeth, the front gears being ordered by

number of teeth, and a rear gear assembly (180) with a
plurality of rear gears (181,182,183,184), each rear 

gear having a plurality of teeth, the rear gears being
ordered by number of teeth, wherein the gear ratio is

the ratio of the number of teeth in a front gear to
the number of teeth in a rear gear, wherein each

device gear has an associated front gear and a rear
gear, and wherein the determined legal device gears

associated with the current device gear include only
those device gears whose associated front gear is

ordered next to the current front gear or whose
associated rear gear is ordered next to the current

rear gear.
The method of claim 2, wherein the step of selecting
the next device gear includes the steps of determining

a desired range of device speeds for the current
device gear and selecting the next device gear when

the current device speed is outside that range.
The method of any one of claims 1 to 3, wherein the
method comprising the steps of


shifting the device into a current device gear;
setting a shift speed with a hysteresis factor to
avoid re-shifting into a previous gear based on a

minor variation in the current speed, the shift speed
being the speed at which the shifting occurs from the

current device gear to another device gear;
while the device is in the current device gear,
adjusting the shift speed to remove the hysteresis

factor; and
shifting into a new device gear based on the shift
speed and the current speed.
The method of claim 4, wherein the step of setting a 
shift speed sets the shift speed to greater than the

current speed.
The method of claim 5, wherein the step of shifting
into a new device gear shifts when the current speed 

becomes greater than or equal to the shift speed.
The method of claim 5, wherein the step of adjusting
the shift speed resets the shift speed when the

current speed becomes less than or equal to a desired
speed for the current device gear.
The method of claim 7, wherein the desired speed is
based on a user selection.
The method of claim 5, wherein the step of adjusting
the shift speed sets the shift speed closer to the

current speed.
The method of claim 4, wherein the step of setting a
shift speed sets the shift speed to less than the

current speed.
The method of claim 10, wherein the step of shifting
into a new device gear shifts when the current speed

becomes less than or equal to the shift speed.
The method of claim 10 wherein the step of adjusting
the shift speed resets the shift speed when the

current speed becomes greater than or equal to a
desired speed for the current device gear.
The method of claim 12, wherein the desired speed is
based on a user selection.
The method of claim 10, wherein the step of adjusting
the shift speed sets the shift speed closer to the

current speed.
The method of any one of claims 1 to 14, wherein the
method comprising the steps of: 


when the current speed decreases to the shift down
speed,
shifting into a new device gear that is lower than the
current device gear;
setting the shift up speed to be greater than the
current speed;
setting the shift down speed to be less than the
current speed; and
resetting the shift up speed to closer to the current
speed when the current speed decreases to a predefined

speed based on the desired cadence; and
when the current speed increases to the shift up
speed,
shifting into a new device gear that is higher than
the current device gear;
setting the shift up speed to be greater than the
current speed;
setting the shift down speed to be less than the
current speed; and
resetting the shift down speed to closer to the
current speed when the current speed increases to a

predefined speed based on the desired cadence.
The method of claim 15, wherein the current speed
decreases to the shift down speed, the shift up speed

is set to the speed when the device is in the current
device gear and being pedalled at the desired cadence

and the shift down speed is set to the average of the 
speed when the device is in the new device gear and

being pedalled at the desired cadence and the speed
when the device is in a device gear lower than the new

device gear and being pedalled at the desired cadence.
The method of claim 16, wherein the shift up speed is
reset to the speed that is the average of the speed

when the device is the new device gear and being
pedalled at the desired cadence and the speed when the

device is in the current device gear and being
pedalled at the desired cadence.
The method of claim 15, wherein the shift up speed is
reset when the current speed decreases to the speed

when the device is in the new device gear and being
pedalled at the desired cadence.
The method of claim 15, wherein the current speed
increases to the shift up speed, the shift down speed

is set to the speed when the device is in the current
device gear and being pedalled at the desired cadence

and the shift up speed is set to the average of the
speed when the device is in the new device gear and

being pedalled at the desired cadence and the speed
when the device is in a device gear higher than the

new device gear and being pedalled at the desired
cadence.
The method of claim 19, wherein the shift down speed
is reset to the speed that is the average of the speed

when the device is the new device gear and being
pedalled at the desired cadence and the speed when the

device is in the current device gear and being
pedalled at the desired cadence.
The method of claim 15, wherein the shift down speed
is reset when the current speed increases to the speed 

when the device is in the new device gear and being
pedalled at the desired cadence.
The method of any one of claims 1 to 21, wherein the
method comprising the steps of:


during a specified interval, determining an angle of
movement of the first gear assembly (170) and a

corresponding angle of movement of the second gear
assembly (180); and
determining the current device gear based on the
determined angles of movement of the first and second

gear assemblies.
The method of claim 22, wherein a first sensor (120)
generates a first signal each time the first gear

assembly (170) rotates through a predetermined
first-sensor angle and wherein a second sensor (130)

generates a second signal each time the second gear
assembly (180) rotates through a second predetermined

second-sensor angle, the method including the steps
of:


selecting a number of second signals to define the
specified interval;
counting the number of first signals generated during
the specified interval;
for each device gear, calculating the number of first
signals that are generated during the specified

interval; and
determining the device gear in which the calculated
number of first signals most closely corresponds to

the counted number of first signals wherein the 
determined device gear represents the current device

gear.
The method of claim 23, wherein the selected number of
second signals is selected such that the counted

number of first signals corresponds to a unique device
gear.
The method of claim 24 including the step of
generating a table containing a plurality of entries,

the table indexed by a count of first signals, wherein
each entry contains an identifier of the unique device

gear corresponding to the indexed count of first
signals, whereby the current device gear is determined

by retrieving the entry from the table indexed by the
counted number of first signals.
The method of claim 23, wherein the device has a crank
assembly and a hub assembly and the first gear

assembly (170) is the crank assembly and the second
gear assembly (180) is the hub assembly.
The method of claim 26, wherein the crank sensor (120)
generates a quadrature signal indicating the angular

rotation of the crank assembly (170), and wherein the
step of determining whether the bicycle is being

pedalled in the forward direction includes the steps
of:


sending a quadrature signal from the crank sensor
(120) to the computer (100); and
detecting the direction of pedalling based on the
quadrature signal sent from the crank sensor (120).
The method of claim 27, wherein the step of shifting
to the new bicycle gear shifts the crank assembly 

(170) only after the crank assembly has been rotated
in the forward direction for a predetermined angular

distance.
The method of claim 27, wherein the step of shifting
to the new bicycle gear shifts the hub assembly (180)

only after the crank assembly (170) has been rotated
in the forward direction for a predetermined angular

distance.
The method of any one of claims 1 to 29, wherein the
method comprising the steps of:


detecting a signal indicating that the
computer-generated bicycle gear selection is to be

overridden;
determining an overriding bicycle gear selection;
controlling the shifting mechanism to shift the
bicycle into the overriding bicycle gear; and
resetting the desired cadence to a new desired cadence
based on a current bicycle speed and the determined

overriding bicycle gear selection.
The method of claim 30, wherein the computer maintains
a shift up and a shift down bicycle speed indicating

the bicycle speeds at which the computer will
automatically shift from a current bicycle gear to a

higher and lower bicycle gear, respectively, and
wherein the step of resetting the desired cadence to a

new desired cadence includes the steps of:

determining the current bicycle speed;
when the overriding bicycle gear is higher than the 
current bicycle gear, multiplying the desired cadence

by the shift up bicycle speed divided by the current
bicycle speed; and
when the overriding gear is lower than the current
bicycle gear, multiplying the desired cadence by the

shift down bicycle speed divided by the current
bicycle speed.
The method of claim 30, wherein the system includes a
cyclist operated shift up and shift down indicator

(110) operatively connected to the computer (100), and
wherein the step of determining the overriding bicycle

gear selection includes the steps of:

when the cyclist indicates a shift up, selecting a
bicycle gear that is higher than the current bicycle

gear; and
when the cyclist indicates a shift down, selecting a
bicycle gear that is lower than the current bicycle

gear.
The method of any one of claims 1 to 32, wherein a
bicycle shift selector, for shifting gears of the

bicycle having a reversible motor (26), a pair of
latch arms (32, 33), a lobe (34) positioned between

the latch arms and driven by the motor, wherein when
the motor is turned in a first direction the lobe

strikes a latch arm which effects a shift of the
bicycle to a first gear and wherein when the motor is

turned in a second direction the lobe strikes the
other latch arm which effects a shift of the bicycle

to a second gear, the method comprising the steps of:

when shifting into the first gear, 
turning the motor (26), in the second direction for a
period of time that is not sufficient to effect a

shift of the bicycle into the second gear; and
turning the motor (26), in the first direction for a
period of time that is sufficient to effect a shift

into the first gear.
The method of claim 33, wherein the bicycle is in a
current gear, wherein the first gear is higher than

the current gear, and wherein the second gear is lower
than the current gear.
The method of claim 33, wherein the bicycle is in a
current gear, wherein the first gear is lower than the

current gear, and wherein the second gear is higher
than the current gear.
The method of claim 33, after the motor (26) is turned
in the second direction for a period of time, delaying

for a period of time before turning of the motor (26)
in the first direction.
The method of claim 33, wherein the step of turning
the motor (26) in the second direction is suppressed

when the last shift of the bicycle was effected by
turning the motor (26), in the second direction.
A gear shifting system for shifting gears on a
bicycle, comprising:


a front gear assembly (170), having a plurality of
front gears (171,172,173), with varying number of

teeth;
a rear gear assembly (180), having a plurality of rear
gears (181,182,183,184) with varying number of teeth;
a 
chain (190) coupled to the front gear assembly (170),

for engaging any one of the front gears and to the
rear gear assembly (180), for engaging any one of the

rear gears;
a front shift mechanism (160) for shifting the chain
(190), from engaging one front gear to engaging

another;
a rear shift mechanism (150), for shifting the chain
(190), from engaging one rear gear to engaging

another, wherein the bicycle has a plurality of
bicycle gears, each bicycle gear associated with a

front gear and a rear gear combination, the bicycle
gears being ordered by gear ratios, the gear ratios

being the ratio of the number of teeth in the

associated front gear to the number of teeth in the
associated rear gear; and
a computer (100), operatively connected to the front
and rear shifting mechanisms (160,150), wherein the

computer determines a current bicycle gear, the
current bicycle gear being defined by the front gear

and the rear gear currently engaged by the chain
(190),
characterized in that

said computer (100), determines a next bicycle gear
wherein when shifting from the current bicycle gear

to the next bicycle gear, the bicycle does not shift
into a gear that is outside the range of the current

bicycle gear and the next bicycle gear, and the
computer (100), controls the front and rear shift

mechanisms (160,150), to effect a shift from the
current bicycle gear to the next bicycle gear, and

there are provided: 

means (140), for determining a current speed of the
bicycle, the cadence indicating the pedalling rate;
means for shifting the bicycle into a current bicycle
gear;
means for setting a shift speed;
means for resetting the shift speed when the bicycle
is in the current bicycle gear; and
means for shifting into a new bicycle gear when the
current speed approaches the shift speed.
The system of claim 38, comprising:

a first sensor (120), for generating a first signal
indicating the angular movement of the first gear

assembly (170);
a second sensor (130), for generating a second signal
indicating the angular movement of the second gear

assembly (180); and
said computer (100), receiving the first and second
signals, for determining angle of movement of the

first gear assembly (170) and the angle of movement of
the second gear assembly (180) during an interval, and

for determining the current bicycle gear based on the
determined angles of movement of the first and second

gear assemblies.
The system of claims 38 or 39, comprising:

means for determining a new bicycle gear;
means for determining whether the bicycle is being 
pedalled in the forward direction; and

means for shifting to the new bicycle gear when the
bicycle is being pedalled in the forward direction.
The system of claim 40, wherein the front gear
assembly (170) is a crank assembly, a crank sensor

(120) is said first sensor for generating a quadrature
signal indicating the angular rotation of the crank

assembly (170), wherein the means for determining
whether the bicycle is being pedalled in the forward

direction receives a quadrature signal from the crank
sensor (120), and detects the direction of pedalling

based on the quadrature signal received from the crank
sensor.
</CLAIMS>
</TEXT>
</DOC>
