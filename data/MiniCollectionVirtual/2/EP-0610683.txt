<DOC>
<DOCNO>EP-0610683</DOCNO> 
<TEXT>
<INVENTION-TITLE>
Digital timing recovery circuit
</INVENTION-TITLE>
<CLASSIFICATIONS>H03L706	H04L7033	H03L706	H04L7033	H04L2738	H04L2738	H04L7027	H04L7027	H04L2722	H04L2722	</CLASSIFICATIONS>
<CLASSIFICATIONS-THIRD>H03L	H04L	H03L	H04L	H04L	H04L	H04L	H04L	H04L	H04L	</CLASSIFICATIONS-THIRD>
<CLASSIFICATIONS-FOURTH>H03L7	H04L7	H03L7	H04L7	H04L27	H04L27	H04L7	H04L7	H04L27	H04L27	</CLASSIFICATIONS-FOURTH>
<ABSTRACT>
An implementation efficient digital timing recovery 
circuit capable of being implemented without the use of 

multipliers. The circuit includes a voltage controlled 
crystal oscillator ("VCXO"), a signal generator, a non-linear 

operation circuit, a digital bandpass filter, a 
bi-quadratic filter, a digital phase lock loop circuit 

(DPLL) and a zero crossing detector circuit. The circuit 
implements a spectral line extraction technique for 

symbol timing recovery. A signal is received by a tuner, 
passed through an analog to digital converter, whose 

sampling rate is controlled by the timing recovery 
circuit, and is then supplied to a Nyquist filter. The 

In-phase and quadrature-phase signals output by the 
Nyquist filter are passed through the non-linear 

operation circuit to produce a signal which is then 
passed through the bandpass filter and then the bi-quadratic 

filter which has a passband centered at the 
symbol rate of the received signal. A quadrature output 

signal of the bi-quadratic filter is cross-correlated 
with an internal signal, generated by the signal 

generator as a function of the sampling rate, to produce 
a frequency error signal. The DPLL circuit receives the 

frequency error signal and uses it to generate a control 
signal to control the sampling rate of the A/D converter. 

The DPLL circuit adjusts the sampling rate until the bi-quadratic 
filter's output is phase locked to the output 

signal of the internal signal generator. A symbol 
decision clock signal is generated by the zero crossing 

detector from the signal generator. 

</ABSTRACT>
<APPLICANTS>
<APPLICANT-NAME>
HITACHI LTD
</APPLICANT-NAME>
<APPLICANT-NAME>
HITACHI, LTD.
</APPLICANT-NAME>
</APPLICANTS>
<INVENTORS>
<INVENTOR-NAME>
SCARPA CARL G
</INVENTOR-NAME>
<INVENTOR-NAME>
SCARPA, CARL G.
</INVENTOR-NAME>
</INVENTORS>
<DESCRIPTION>
The present invention is directed to digital timing
recovery circuits and, more particularly, to an
implementation efficient digital symbol timing recovery
circuit that can be implemented without the use of
multipliers.Various transmission services, e.g., high definition
television ("HDTV") services, currently use or are
expected to use a Quadrature Amplitude Modulated ("QAM")
signal for the transmission of data. The data
transmitted by such services, in the form of a QAM analog
transmission signal, represents a bitstream comprising a
series of symbols, each symbol comprising a number of
bits.To recover the data from a QAM or other signal comprising
a series of symbols, a receiver is required to convert
the analog signal received into a digital signal and to
distinguish between the individual symbols which comprise
the signal bitstream. Symbol timing recovery is used to
recover a clock signal at the symbol rate, or a multiple
of the symbol rate, from the modulated waveform that is
received. This clock signal may then be used by the 
receiver to convert the continuous-time received signal
into a discrete-time sequence of data symbols.QAM demodulators usually rely on symbol timing recovery
before any other form of synchronization. Symbol timing,
also known as symbol synchronization or bit
synchronization, is required for correct sampling of a
received QAM analog waveform to minimize inter-symbol
interference ("ISI") distortion and to establish a
baseline for symbol timing.Numerous techniques presently exist for symbol timing
recovery, such as spectral line extraction and use of
least mean square ("LMS") timing circuits. Currently,
the spectral line extraction technique is the most
popular method of symbol timing recovery and is
frequently implemented using analog circuits.Known timing recovery circuits commonly use analog timing
recovery techniques. Such timing recovery circuits may
pass a received QAM signal through diodes and then use
the envelope of the QAM signal to extract bit timing
information. Such known analog circuits have several
disadvantages over digital timing recovery circuits. One
disadvantage is that such analog circuits fail to make
use of the digital matched filtering principle of Nyquist
filters which is important when the transmitted signal
has only small amounts of excess bandwidth for pulse
shaping.In the case of HDTV signals which may have only 10
percent excess bandwidth for pulse shaping, the resulting
tone after a non-linear operation has a very low signal
to noise ratio
</DESCRIPTION>
<CLAIMS>
A symbol timing recovery circuit, comprising:

an oscillator (34) for generating a sampling
frequency control signal, having a frequency of Fs, as a

function of an average frequency error signal,
the oscillator having an average frequency
error signal input for receiving the average frequency

error signal and an output for outputting the sampling
frequency control signal;
an analog to digital converter (14) for generating a
digital signal from an analog signal,
the analog to digital converter having an
output for outputting the digital signal generated by the

analog to digital converter, an analog signal input
adapted for coupling to a tuner for receiving the analog

signal from the tuner, and a sampling frequency control
signal input coupled to the output of the oscillator for

receiving the sampling frequency control signal and for
controlling the rate at which the analog to digital

converter samples the analog signal;
a Nyquist filter (16) for filtering the digital
signal to generate an in-phase signal (I),
the Nyquist filter having an input coupled to
the digital signal output of the analog to digital

converter for receiving the digital signal, and a first
output for outputting the in-phase signal;
a non-linear operation circuit (22) for performing a
non-linear operation on the in-phase signal (I) to generate a 

timing signal,
the non-linear operation circuit having a first
input coupled to the first output of the Nyquist filter

for receiving the in-phase signal, and an output for
outputting the timing signal;
a digital bi-quadratic filter (28) for filtering the
timing signal to generate a quadrature-phase reference

signal,
the bi-quadratic filter having a passband
centered at a frequency of Fs/4, wherein Fs/4 is a

fraction of the frequency Fs, an input coupled to the
output of the non-linear operation circuit for receiving

the timing signal and an output for outputting the
quadrature-phase reference signal;
a signal generator (38) for generating, as a
function of the sampling frequency control signal, an

internal clock signal having the frequency of Fs/4,
the signal generator having an input coupled to
the output of the oscillator for receiving the sampling

frequency control signal and an output for outputting the
internal clock signal;
a cross-correlator (70) for cross-correlating the
internal clock signal and the quadrature-phase reference

signal to generate a frequency error signal,
the cross-correlator having a first input
coupled to the output of the signal generator for

receiving the internal clock signal and a second input
coupled to the output of the bi-quadratic filter for 

receiving the quadrature-phase reference signal, and an
output for outputting the frequency error signal; and
a digital phase lock loop circuit (30) for
generating an average frequency error signal for

adjusting the frequency of the sampling control signal
generated by the oscillator,
the digital phase lock loop circuit having an
input coupled to the output of the cross-correlator and

an output coupled to the input of the oscillator; and
a means (36) for generating a symbol decision clock
signal from the internal clock signal coupled to the

signal generator.
The symbol timing recovery circuit of claim 1,
further comprising:


a digital bandpass filter (26) having a gain of zero
at 0 Hz for receiving and filtering the timing signal to

attenuate the direct current component of the timing
signal,
the digital bandpass filter having an input
coupled to the output of the non-linear operation circuit

for receiving the timing signal and an output coupled to
the input of the bi-quadratic filter for outputting the

timing signal after filtering.
The symbol timing recovery circuit of claim 1,

wherein the Nyquist filter (16) further comprises a
second output for outputting a quadrature-phase signal (Q) 

generated by the Nyquist filter; and
wherein the non-linear operation circuit
further comprises a second input coupled to the second

output of the Nyquist filter for receiving the
quadrature-phase signal, and a summer for summing 
a
result of the non-linear operation performed on the in-phase

signal and a result of a non-linear operation
performed on the quadrature-phase signal to generate the

timing signal.
The symbol timing recovery circuit of claim 2,
wherein the non-linear operation circuit (22) comprises:


a first absolute value circuit (40) for performing
an absolute value operation on the in-phase signal (I) to

generate a first absolute value signal, the first
absolute value circuit having an input coupled to the in-phase

signal output of the Nyquist filter and an output
for outputting the first absolute value signal;
a second absolute value circuit (42) for performing
an absolute value operation on the quadrature-phase

signal (Q) to generate a second absolute value signal, the
second absolute value circuit having an input coupled to

the quadrature-phase signal output of the Nyquist filter
and a second absolute value signal output for outputting

the second absolute value signal;
a first adder (44) for adding the first and second
absolute value signals, the adder having a first summing

input coupled to the output of the first absolute value 
circuit, a second summing input coupled to the output of

the second absolute value circuit, and an output coupled
to the output of the non-linear operation circuit.
The symbol timing recovery circuit of claim 4,
wherein the digital bandpass filter comprises:


a seven tap bandpass finite impulse response (FIR)
filter (26) comprising,
a second adder (54) having a first and a second
summing input and a first and a second subtracting input

and an output coupled to the timing signal output of the
bandpass FIR filter;
a first-order unit delay element comprising a
shift register having an input coupled to the output of

the non-linear operation circuit and an output coupled to
the first summing input of the second adder;
a first second-order unit delay element
comprising a shift register having an input coupled to

the output of the first-order unit delay element and
having an output coupled to the first subtracting input

of the second adder;
a second second-order unit delay element
comprising a shift register having an input coupled to

the output of the first second-order unit delay element
and an output coupled to the second summing input of the

second adder; and
a third second-order unit delay element
comprising a shift register having an input coupled to 

the output of the second second-order unit delay element
and an output coupled to the second subtracting input of

the second adder.
The symbol timing recovery circuit of claim 2,
wherein the digital bi-quadratic filter (28) comprises a

digital bi-quadratic infinite impulse response filter
including:


an input coupled to the output of the bandpass
filter;
a quadrature-phase reference signal output
coupled to the second input of the cross-correlator; and
means for generating a quadrature-phase
reference signal that, in the frequency domain, has the

following relationship to the input signal:

Y(Z)
X(Z)
 = 
A
n
 + B
n
Z
-1
A
d
 + B
d
Z
-1
 + Z
-2

   where,

A
n
 = alpha / (1 - alpha),
B
n
 = - alpha * cos(π/2) / (1 - alpha),
A
d
 = 1 / (1 - alpha), and
B
d
 = -(2 - alpha) * cos(π/2) / (1 - alpha)

and where alpha is a real number.
The symbol timing recovery circuit of claim 2,
wherein the means (36) for generating a symbol decision clock 

signal comprises a zero crossing detector (36) for generating
a symbol decision clock signal in response to transitions

in the internal clock signal.
The symbol timing recovery circuit of claim 2,
wherein the oscillator comprises:


a voltage controlled crystal oscillator (34) for
generating an oscillator output signal having a frequency

that is a multiple of Fs, the voltage controlled crystal
oscillator having an input coupled to the output of the

digital phase lock loop circuit and an output; and
a frequency divider for generating the sampling
frequency control signal as a function of the oscillator

output signal, the frequency divider having an input
coupled to the output of the voltage controlled crystal

oscillator and an output coupled to the sampling
frequency control signal input of the analog to digital

converter and to the input of the oscillator.
The symbol timing recovery circuit of claim 6,
further comprising a digital to analog converter (32) for

converting the average frequency error signal output by
the digital phase lock loop circuit (30), in digital form,

into an analog average frequency error signal, the
digital to analog converter having an input coupled to

the output of the digital phase lock loop circuit for
receiving the digital average frequency error signal and

an output coupled to the input of the oscillator for 
outputting the analog average frequency error signal.
The symbol timing recovery circuit of claim 2,
further comprising a digital to analog converter (32) for

converting the average frequency error signal output by
the digital phase lock loop circuit in digital form, into

an analog average frequency error signal, the digital to
analog converter having an input coupled to the output of

the digital phase lock loop circuit for receiving the
digital average frequency error signal and an output

coupled to the input of the oscillator for outputting the
analog average frequency error signal.
The symbol timing recovery circuit of claim 2,
wherein the digital phase lock loop circuit comprises a

second order digital phase lock loop including

a first adder for summing a first and a second
error signal to generate the average frequency error

signal, the first adder having a first and a second
summing input, and an output coupled to the output of the

digital phase lock loop circuit for outputting the
average frequency error signal;
a first weight element having a gain of β1 for
generating the first error signal, the first weight

element comprising a shift register having an input
coupled to the input of the digital phase lock loop

circuit for receiving the frequency error signal, and an
output, coupled to the first summing input of the first 

adder, for outputting the first error signal;
a second adder for generating the second error
signal, the second adder having a first and a second

summing input and an output, the output coupled to the
second summing input of the first adder for outputting

the second error signal;
a second weight element having a gain of β1,
the second weight element having an input coupled to the

input of the digital phase lock loop circuit for
receiving the frequency error signal and an output

coupled to the first summing input of the second adder;
and
a first-order unit delay element for generating

an error feedback signal having an input coupled to the
output of the second adder and an output for outputting

the error feedback signal coupled to the second summing
input of the second adder.
A symbol timing recovery circuit, comprising:

an oscillator (34) for generating a sampling
frequency control signal with a frequency of Fs as a

function of an average frequency error signal,
the oscillator having an average frequency
error signal input for receiving the average frequency

error signal and an output for outputting the sampling
frequency control signal;
an analog to digital converter (14) for generating a
digital signal from an analog signal, 
the analog to digital converter having an
output for outputting the digital signal generated by the

analog to digital converter, an analog signal input
adapted for coupling to a tuner for receiving the analog

signal from the tuner, and a sampling frequency control
signal input coupled to the output of the oscillator for

receiving the sampling frequency control signal and for
controlling the rate at which the analog to digital

converter samples the analog signal;
a Nyquist filter (16) for filtering the digital
signal to generate a quadrature-phase signal (Q),
the Nyquist filter having an input coupled to
the digital signal output of the analog to digital

converter for receiving the digital signal, and a first
output for outputting the quadrature-phase signal;
a non-linear operation circuit (22) for performing a
non-linear operation on the quadrature-phase signal to

generate a timing signal,
the non-linear operation circuit having a first
input coupled to the first output of the Nyquist filter

for receiving the quadrature-phase signal, and an output
for outputting the timing signal;
a digital bi-quadratic filter (28) for filtering the
timing signal to generate a quadrature-phase reference

signal,
the bi-quadratic filter having a passband
located at a frequency Fs/4, wherein Fs/4 is a fraction

of the frequency Fs, an input coupled to the output of 
the non-linear operation circuit for receiving the timing

signal and an output for outputting the quadrature-phase
reference signal;
a signal generator (38) for generating, as a
function of the sampling frequency control signal, an

internal clock signal having the frequency of Fs/4,
the signal generator having an input coupled to
the output of the oscillator for receiving the sampling

frequency control signal and an output for outputting the
internal clock signal;
a cross-correlator (70) for cross-correlating the
internal clock signal and the quadrature-phase reference

signal to generate a frequency error signal,
the cross-correlator having a first input
coupled to the output of the signal generator for

receiving the internal clock signal and a second input
coupled to the output of the bi-quadratic filter for

receiving the quadrature-phase reference signal, and an
output for outputting the frequency error signal; and
a digital phase lock loop circuit (30) for
generating an average frequency error signal for

adjusting the frequency of the sampling control signal
generated by the oscillator,
the digital phase lock loop circuit having an
input coupled to the output of the cross-correlator and

an output coupled to the input of the oscillator; and
a means (36) for generating a symbol decision clock
signal from the internal clock signal coupled to the 

signal generator.
A receiver, comprising:

a tuner (12) for receiving an analog signal,
an oscillator (34) for generating a sampling
frequency control signal, having a frequency of Fs, as a

function of an average frequency error signal,
the oscillator having an average frequency
error signal input for receiving the average frequency

error signal and an output for outputting the sampling
frequency control signal;
an analog to digital converter (14) for generating a
digital signal from the analog signal,
the analog to digital converter having an
output for outputting the digital signal generated by the

analog to digital converter, an analog signal input
coupled to a tuner for receiving the analog signal from

the tuner, and a sampling frequency control signal input
coupled to the output of the oscillator for receiving the

sampling frequency control signal and for controlling the
rate at which the analog to digital converter samples the

analog signal;
a Nyquist filter (16) for filtering the digital
signal to generate an in-phase signal (I) and a quadrature-phase

signal (Q),
the Nyquist filter having an input coupled to
the digital signal output of the analog to digital

converter for receiving the digital signal, a first 
output for outputting the in-phase signal and a second

output for outputting the quadrature-phase signal;
a non-linear operation circuit (22) for performing a
non-linear operation on each of the in-phase and

quadrature-phase signals and for summing the result of
the non-linear operations to generate a timing signal,
the non-linear operation circuit having a first
input coupled to the first output of the Nyquist filter

for receiving the in-phase signal, a second input coupled
to the second output of the Nyquist filter for receiving

the quadrature-phase signal, and an output for outputting
the timing signal;
a digital finite impulse response bandpass
filter (26) having a gain of zero at 0 Hz for receiving and

filtering the timing signal to attenuate the direct
current component of the timing signal,
the digital finite impulse response bandpass
filter having an input coupled to the output of the non-linear

operation circuit for receiving the timing signal
and an output for outputting the filtered timing signal
a digital bi-quadratic infinite impulse filter (28)
for filtering the bandpass filtered timing signal to

generate a quadrature-phase reference signal,
the bi-quadratic infinite impulse response
filter having a passband located at a frequency of Fs/4,

wherein Fs/4 is a fraction of the frequency Fs, an input
coupled to the output of the bandpass filter for

receiving the bandpass filtered timing signal and an 
output for outputting the quadrature-phase reference

signal;
a signal generator (38) for generating, as a
function of the sampling frequency control signal, an

internal clock signal having the frequency of Fs/4,
the signal generator having an input coupled to
the output of the oscillator for receiving the sampling

frequency control signal and an output for outputting the
internal clock signal;
a cross-correlator (70) for for cross-correlating the
internal clock signal and the quadrature-phase reference

timing signal to generate a frequency error signal,
the cross-correlator having a first input
coupled to the output of the signal generator for

receiving the internal clock signal and a second input
coupled to the output of the bi-quadratic filter for

receiving the quadrature-phase reference signal, and an
output for outputting the frequency error signal; and
a second order digital phase lock loop circuit
for generating an average frequency error signal for

adjusting the frequency of the sampling control signal
generated by the oscillator,
the second order digital phase lock loop
circuit havin
g an input coupled to the output of the
cross-correlator and an output coupled to the input of

the oscillator;
a means (36) for generating a symbol decision clock
signal from the internal clock signal coupled to the 

signal generator.
A method of generating a symbol timing signal from
an analog signal, the method comprising the steps of:


operating a tuner to receive and output the
analog signal;
operating an oscillator in response to an
average frequency error signal to generate a sampling

frequency control signal having a frequency of Fs;
operating an analog to digital converter to
receive the analog signal, to receive the sampling

frequency control signal, and to generate a digital
signal by sampling the analog signal at the frequency Fs;
filtering the digital signal to generate an in-phase
signal and a quadrature-phase signal from the

digital signal;
performing a non-linear operation on the in-phase
signal to generate a first signal;
performing a non-linear operation on the
quadrature-phase signal to generate a second signal;
summing the first and second signals to
generate a bit tone timing signal;
filtering the bit tone timing signal using a
bandpass finite impulse response filter with a gain of

zero at zero Hz to attenuate the direct current component
of the bit tone timing signal;
filtering the bit tone timing signal with the
attenuated direct current component using a digital bi-quadratic 

passband filter having a passband located at
Fs/4 to generate a quadrature-phase reference signal,

Fs/4 is a fraction of Fs;
generating as a function of the sampling
frequency control signal an internal clock signal with a

frequency of Fs/4;
cross-correlating the internal clock signal and
the quadrature-phase reference signal to generate a

frequency error signal;
operating a second order digital phase lock
loop circuit to generate an average frequency error

signal from the frequency error signal to control the
frequency of the oscillator;
detecting when the internal clock signal
transitions to a value equal to zero; and
generating a symbol decision clock signal as a
function of the detected transitions in the internal

clock signal.
The method of claim 14, wherein the step of
performing the non-linear operation on the in-phase

signal comprises the step of performing an absolute value
operation on the in-phase signal; and


wherein the step of performing the non-linear
operation on the quadrature-phase signal comprises the

step of performing an absolute value operation on the
quadrature-phase signal.
</CLAIMS>
</TEXT>
</DOC>
