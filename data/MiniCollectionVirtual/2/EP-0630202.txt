<DOC>
<DOCNO>EP-0630202</DOCNO> 
<TEXT>
<INVENTION-TITLE>
SELF-OPTIMIZING DETERGENT CONTROLLER
</INVENTION-TITLE>
<CLASSIFICATIONS>A47L1544	B08B310	G05D2100	G05B1302	B08B310	G01N2710	G05D2100	A47L1544	D06F3902	D06F3902	G05B1302	G01N2706	</CLASSIFICATIONS>
<CLASSIFICATIONS-THIRD>A47L	B08B	G05D	G05B	B08B	G01N	G05D	A47L	D06F	D06F	G05B	G01N	</CLASSIFICATIONS-THIRD>
<CLASSIFICATIONS-FOURTH>A47L15	B08B3	G05D21	G05B13	B08B3	G01N27	G05D21	A47L15	D06F39	D06F39	G05B13	G01N27	</CLASSIFICATIONS-FOURTH>
<ABSTRACT>
An apparatus and method for programming a detergent controller (12) to vary the detergent concentration set-point (14) according to the time of day and to achieve detergent concentration levels quickly without incurring overshoot. Thus, the present invention insures that the warewashing machine is operated at optimum efficiency and cost. To vary the set-point according to the time of day, the invention combines the features of a microprocessor, a clock and a controller into one unit. The user enters the time setting (16) and set point into the controller (12). The microprocessor (10) then compares the real-time clock signal with the user time settings and outputs an appropriate set-point value from the microprocessor (10) to the controller (12). To achieve detergent concentration levels quickly without incurring overshoot, the controller (12) senses the detergent concentration and dispenses the proper detergent level to the warewashing machine according to a predetermined detergent feed time based on the previous response time and the programmed set-point (14). Thus, the controller (12) can change the response function if and when conditions change.
</ABSTRACT>
<APPLICANTS>
</APPLICANTS>
<INVENTORS>
</INVENTORS>
<DESCRIPTION>
This invention relates primarily to a method and
apparatus for controlling the automatic addition of
detergent into a commercial warewashing machine. There
are two key problems addressed by the invention. One is
the detergent addition itself. The other is the
determination of an appropriate concentration setpoint.
By making the detergent feed dependent upon the real-time
concentration change rate, detergent overuse is reduced
during the detergent addition. Adjusting detergent
concentration setpoints to correspond to changing account
conditions also helps to maximize the performance of the
warewashing process.It is known in the art to provide warewashing machine
systems with detergent controllers. Typically, such
systems operate in an on-off mode, proportional mode or a
combination thereof. The systems control the detergent
concentration level to a pre-set detergent concentration
level (set-point).European patent application 0-229-038, filed January
8, 1987, by Ecolab Inc., discloses an automatic chemical
solution dispenser used in cleaning processes. The 
dispenser includes a means for initiating dispensing a
concentrated chemical solution and means for directing the
concentration chemical solution to its utilization point.
Then a sensor measures the conductivity and temperature of
the solution. Based upon the conductivity and temperature
of the chemical solution, the amount of chemical solution
dispensed may be calculated. Accordingly, the flow of the
chemical can be terminated when the dispenser determines
that a predetermined amount of chemical has been
dispensed.U.S. Patent No. 4,756,321, issued July 12, 1988 to
Livingston et al. discloses a chemical dispenser and
controller for dispensing a cleaning solution. The
dispenser includes a sensor for measuring logarithmically
the conductivity and temperature of the wash water. An
alarm is activated if the detergent concentration level
fails to increase by at least a predetermined amount
during the time that the chemical solution is being
dispensed or fails to achieve a predetermined
concentration level by a predetermined period of time.The major perceived benefits of these type of
controllers are that the addition of, and concentration
maintenance of, detergent to the warewashing machine are
achieved without manual intervention.However, these controllers do have some major
shortcomings. These systems do not compensate for varying 
chemical injection rates and therefore exceed this set-point.
These systems indirectly sense detergent
concentration by
</DESCRIPTION>
<CLAIMS>
An apparatus for controlling variable
detergent concentration levels in a warewashing machine,

comprising a controller (12) coupled to a sensor (24)
for measuring a detergent concentration level of a wash

tank solution, the apparatus characterized by:

data entry means, connected to the controller (12),
for entering a plurality of time settings (16) and

detergent concentration set-point values (14)
corresponding thereto; and
timer means (20), connected to the controller (12),
for providing a real-time clock signal;
the controller (12) further comprising:

means (10) for receiving the time settings (16),
corresponding detergent concentration set-point values

(14), and real-time clock signal (22), and for comparing
the real-time clock signal (22) with the time settings

(16) and outputting the corresponding detergent
concentration set-point value (14) in response thereto;

and
means (10) for receiving and comparing the
outputted detergent concentration set-point value (14)

to the measured detergent concentration level (28) from
the sensor (24), and for regulating a detergent feed

time based on the comparison to minimize overshoot in
the detergent concentration.
The apparatus of claim 1, wherein each
detergent concentration set-point value (14) comprises a

desired conductivity value based upon a type of soil
expected for a particular time setting.
The apparatus of claim 1, wherein each time
setting (16) comprises a date and time.
The apparatus of claim 1, wherein the data
entry means comprises a keypad and a display. 
The apparatus of claim 1, wherein the sensor
(24) further comprises means for sending signals (28)

based upon a conductivity of the wash tank solution to
the controller (12).
The apparatus of claim 5, wherein the
controller (12) further comprises means for detecting

wash tank changeovers, detergent feed, and detergent
consumption based upon the conductivity signals received

from the sensor (24).
The apparatus of claim 1, wherein the sensor
(24) further comprises means for sending signals (28)

based upon a temperature of the wash tank solution to
the controller (12).
A method of controlling variable detergent
concentration levels in a warewashing machine, the

method performed by a controller (12) for the
warewashing machine coupled to a sensor (24) for

measuring a detergent concentration level of a wash tank
solution, and the method being characterized by the

steps of:

entering a plurality of time settings (16) and
detergent concentration set-point values (14)

corresponding thereto;
providing a real-time clock signal (22);
comparing the real-time clock signal (22) with the
time settings (16) and outputting the corresponding

detergent concentration set-point value (18);
receiving and comparing the outputted detergent
concentration set-point value (14) and the measured

detergent concentration level (28), and regulating a
detergent feed time based on the comparison to minimize

overshoot in the detergent concentration.
The method of claim 8, wherein each detergent
concentration set-point value (14) is a desired

conductivity value based upon a type of soil expected
for a particular time setting.
The method of claim 8, wherein each time

setting (16) comprises a date and time.
The method of claim 8, wherein the plurality
of time settings (16) and detergent concentration set-point

values (14) corresponding thereto are entered
using a keypad and a display.
The method of claim 8, further comprising the
step of sending signals (28) based upon a conductivity

of the wash tank solution from the sensor (24) to the
controller (12).
The method of claim 12, further comprising the
step of detecting wash tank changeovers, detergent feed,

and detergent consumption at the controller (12) based
upon the conductivity signals received from the sensor

(24).
The method of claim 8, further comprising the
step of sending signals (28) based upon a temperature of

the wash tank solution from the sensor (24) to the
controller (12).
An apparatus for optimizing detergent
concentration in a warewashing machine with minimal

overshoot, the apparatus comprising a controller (12)
coupled to a means (6) for feeding a detergent into a

wash solution and a sensor (24) for measuring a
detergent concentration level of a wash tank solution,

the controller (12) further characterized by: 

a processor (10) comprising means for calculating a
rate of increase for the detergent concentration level

in the wash solution and means for determining both an
appropriate on-time and an appropriate off-time for a

detergent feed based on the rate of increase for the
detergent concentration level in the wash solution to

minimize overshoot in the detergent concentration level.
The apparatus of claim 15, wherein the means
for determining further comprises means for

discontinuing the detergent feed when overshoot in the
detergent concentration level is anticipated based upon

the rate of increase.
The apparatus of claim 15, wherein the means
for determining further comprises:


means for incrementing an accumulated on-time
measurement;
means for calculating an on-time;
means for comparing the accumulated on-time with
the calculated on-time; and
means for ending the detergent feed when the
accumulated on-time is greater than the calculated on-time.
The apparatus of claim 17, wherein the means
for ending further comprises:


means for advancing an off-time timer;
means for resolving whether a flag indicating
cessation of the detergent feed has been set; and
means for continuing the means for feeding when the
flag has not been set.
The apparatus of claim 15, wherein the means
for determining further comprises:


means for deciding whether a predetermined number
of values representing detergent concentration levels 

have been stored in a memory device;
means for computing an intermediate detergent flow-rate
once the predetermined number of values have been

stored;
means for ascertaining whether the computed
intermediate detergent flow-rate has changed; and
means for setting the intermediate detergent flow-rate
to the latest calculated detergent flow-rate when

the intermediate detergent flow-rate has changed.
The apparatus of claim 19, wherein the means
for deciding further comprises:


means for establishing the detergent concentration
level once every predetermined interval;
means for storing a value representing the
detergent concentration level in the memory device;
means for incrementing a register of the memory
device; and
means for recalculating the intermediate detergent
flow-rate when less than the predetermined number of

values have been stored.
The apparatus of claim 19, wherein the means
for ascertaining further comprises:


means for increasing a latency time when the
intermediate detergent flow-rate has not changed;
means for discovering whether an accumulated
latency time exceeds a predetermined period of time;
means for recomputing the intermediate detergent
flow-rate when the predetermined period of time has not

occurred;
means for fixing the intermediate detergent flow-rate
to the latest computed detergent flow-rate when the

latency time exceeds the predetermined period of time;
and 
means for resetting the intermediate detergent
flow-rate when the off-time is not greater than the

latency time.
A method of optimizing detergent concentration
in a warewashing machine with minimal overshoot, the

method being performed by a controller (12) coupled to a
means (6) for feeding a detergent into a wash solution

and a sensor (24) for measuring a detergent
concentration level of a wash tank solution, the method

characterized by the steps of:

calculating (10) a rate of increase for the
detergent concentration level in the wash solution and

determining (10) both an appropriate on-time and an
appropriate off-time for the detergent feed based on the

rate of increase for the detergent concentration level
in the wash solution to minimize overshoot in the

detergent concentration level.
The method of claim 22, wherein the step of
determining further comprises the step of discontinuing

the detergent feed when overshoot in the detergent
concentration level is anticipated based upon the rate

of increase.
The method of claim 22, wherein the step of
determining further comprises the steps of:


incrementing an accumulated on-time measurement;
calculating an on-time;
comparing the accumulated on-time with the
calculated on-time; and
ending the detergent feed when the accumulated on-time
is greater than the calculated on-time.
The method of claim 24, wherein the step of
ending the detergent feed further comprises the steps

of: 

advancing an off-time timer;
resolving whether a flag indicating cessation of
the detergent feed has been set; and
continuing the feeding step when the flag has not
been set.
The method of claim 22, wherein the step of
determining further comprises the steps of:


deciding whether a predetermined number of values
representing the detergent concentration level have been

stored in a memory device;
computing an intermediate detergent flow-rate once
the predetermined number of values have been stored;
ascertaining whether the computed intermediate
detergent flow-rate has changed; and
setting the intermediate flow-rate to the latest
calculated detergent flow rate when the intermediate

detergent flow-rate has changed.
The method of claim 26, wherein the step of
deciding further comprises the steps of:


establishing the detergent concentration level once
every predetermined inte
rval;
storing the value representing the detergent
concentration level in the memory device;
incrementing a register of the memory device; and
recalculating the intermediate flow-rate when less
than the predetermined number of values have been

stored.
The method of claim 26, wherein the step of
ascertaining further comprises the steps of:


increasing a latency time when the intermediate
detergent flow-rate has not changed;
discovering whether an accumulated latency time
exceeds a predetermined period of time;
recomputing the intermediate detergent flow-rate 
when the predetermined period of time has not occurred;
fixing the intermediate detergent flow-rate to the
latest computed detergent flow-rate when the latency

time exceeds the predetermined period of time; and
resetting the intermediate detergent flow-rate when
the off-time is not greater than the latency time.
</CLAIMS>
</TEXT>
</DOC>
