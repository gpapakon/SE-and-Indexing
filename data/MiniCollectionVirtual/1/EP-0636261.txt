<DOC>
<DOCNO>EP-0636261</DOCNO> 
<TEXT>
<INVENTION-TITLE>
IMPROVED METHOD FOR INTERPRETING COMPLEX DATA AND DETECTING ABNORMAL INSTRUMENT OR PROCESS BEHAVIOR.
</INVENTION-TITLE>
<CLASSIFICATIONS>G01N3000	G01N3086	G06F1700	G06F1700	</CLASSIFICATIONS>
<CLASSIFICATIONS-THIRD>G01N	G01N	G06F	G06F	</CLASSIFICATIONS-THIRD>
<CLASSIFICATIONS-FOURTH>G01N30	G01N30	G06F17	G06F17	</CLASSIFICATIONS-FOURTH>
<ABSTRACT>
An improved method is provided for determining when a set of multivariate data (such as a chromatogram or a spectrum) is an outlier. The method involves using a procedure such as Principal Component Analysis to create a model describing a calibration set of spectra or chromatograms which is known to be normal, and to create residuals describing the portion of a particular spectrum or chromatogram which is not described by the model. The improvement comprises using an average residual spectrum calculated for the calibration set, rather than the origin of the model as a reference point for comparing a spectrum or chromatogram obtained from an unknown sample. The present invention also includes separating a complex set of data into various sub-parts such as sub-chromatograms or sub-spectra, so that outliers in any sub-part can be more readily detected. In one particular embodiment, the invention is directed towards a method for dividing a chromatogram into the sub-parts of peak information, baseline shape, baseline offset, and noise.
</ABSTRACT>
<APPLICANTS>
<APPLICANT-NAME>
DOW CHEMICAL CO
</APPLICANT-NAME>
<APPLICANT-NAME>
THE DOW CHEMICAL COMPANY
</APPLICANT-NAME>
</APPLICANTS>
<INVENTORS>
<INVENTOR-NAME>
BEEBE KENNETH R
</INVENTOR-NAME>
<INVENTOR-NAME>
HUGHES GLEN H
</INVENTOR-NAME>
<INVENTOR-NAME>
RUHL HARRY D
</INVENTOR-NAME>
<INVENTOR-NAME>
WINTERTON RICHARD C
</INVENTOR-NAME>
<INVENTOR-NAME>
BEEBE, KENNETH, R.
</INVENTOR-NAME>
<INVENTOR-NAME>
HUGHES, GLEN H.
</INVENTOR-NAME>
<INVENTOR-NAME>
RUHL, HARRY, D.
</INVENTOR-NAME>
<INVENTOR-NAME>
WINTERTON, RICHARD, C.
</INVENTOR-NAME>
</INVENTORS>
<DESCRIPTION>
 IMPROVED METHOD FOR INTERPRETING COMPLEX DATA AND DETECTING ABNORMALINSTRUMENT OR PROCESS BEHAVIOR This invention relates to a method of analyzing multivariate data generated by an instrument in order to determine whether abnormal features are present. More particularly, this invention relates to an improved method for rapidly identifying instrumentation or process failures in a chemical system.On-line analytical instrumentation generates data that is used in a wide variety of applications, such as closed-loop control of a process, quality assurance of a product, or environmental and safety functions. Often, this data is in the form of multivariate data such as o absorbance readings at various wavelengths, a detector response at various times, or any other set of data that consists of multiple measured values on each individual sample. The reliability of the data depends largely upon the performance of the instrument used to generate the data. If the instrument fails to work properly, the data generated may contain little if any valid information. 5 Problems with analytical instruments are often first detected when an individual notices that unusual data is being generated. Unexpected peaks, larger than expected noise levels, and baseline offsets are just a few of the features that may lead the individual to question the validity of a chromatogram or spectrum. Monitoring the data as it is generated for the appearance of these unusual features allows for the detection of developing problems 0 before they become severe enough to affect the ongoing analysis. Individuals monitoring the raw chromatogram or spectrum data perform the largely unconscious activity of learning from experience what a " normal " set of data looks like and then deciding whether the present set of data is reasonably similar. Unfortunately, it is not practical to manually monitor all of the data, as many on-line instruments produce more than a thousand sets of data per day. 5 Repetitive manual tasks, such as monitoring large amounts of produced data, are generally capable of being automated through the use of computers. Furthermore, computers are widely used to collect the data generated by on-line instruments, and so are readily available to perform routine monitoring. Unlike an analyst, however, computers cannot perform any "unconscious" activity. Accordingly, in order to monitor the data for abnormal 0 features, the computer must first be programmed to identify normal features in a spectrum or chromatogram.The field of study that
</DESCRIPTION>
<CLAIMS>
1. In a method for examining multivariate data to determine outliers, of the type in which a procedure is used to create a model of a calibration set and to create residuals describing the portion of each member of the calibration set which is not described by the model, the improvement comprising: (a) creating an average residual by averaging the residuals of all of the calibration set members;
(b) determining the distance between the residual for each member of the calibration set and the average residual;
(c) determining the distance between a residual obtained from an o unknown sample and the average residual;
(d) labeling as an outlier any sample whose distance obtained in step (c) is statistically different from the set of distances determined in step (b).
2. The method of Claim 1 wherein the procedure used to create the model of the calibration set is Principal Component Analysis. 5 3. The method of Claim 1 wherein the multivariate data is separated into a plurality of sub-parts prior to creating a model so that an outlier in one or more selected sub- parts can be detected.
4. The method of Claim 3 wherein at least one of the sub-parts includes a member of the group consisting of peak information, baseline shape, baseline offset and 0 noise.
5. The method of Claim 4 wherein one ofthe sub-parts includes peak information, separated by a method which comprises the following steps:
(a) obtaining a set of multivariate data which includes peak information;
(b) identifying the portions of the multivariate data which contain peak 5 information;
(c) subtracting the portions identified in step (b) from the set of multivariate data obtained in step (a);
(d) replacing the points subtracted in step (c) from the set of multivariate data obtained in step (a), so that a first approximation of the baseline is formed; 0 
and
(e) subtracting the first approximation of the baseline formed in step (d) from the set of multivariate data obtained in step (a), thereby forming a set of data containing peak information.
6. The method of Claim 5 wherein step (e) further comprises smoothing out the 5 peak information data.
7. The method of Claim 6 wherein a second sub-part includes baseline shape, separated by a method which comprises: 


 (f) subtracting the set of data formed in step (e) from the set of multivariate data obtained in step (a), thereby forming a set of data containing baseline shape.
8. The method of Claim 7wherein a third sub-part includes noise separated by a method which comprises:
(g) subjecting the set of data formed in step (f) to a Fourier transformation and then a filtering operation; and
(h) subtracting the set of data formed i n step (g) from the set of data formed in step (f) thereby forming a set of data containing noise information. 9- The method of Claim 8 wherein a fourth sub-part includes the baseline offset which is defined as being the least positive point in the set of multivariate data obtained i n step (a).
10. The method of Claim 5 wherein step (b) comprises: calculating the values for the second derivative ofthe set of multivariate data obtained in step (a); selecting a region in the set of multivariate data which is known notto contain peaks; averaging the values for the second derivative ofthe points in the region; calculating a standard deviation for the values for the second derivative of the points in the region; and defining any point whose second derivative is furtherthan a preselected number of standard deviations from the average value forthe second derivative in the region to be part of a peak.
11. The method of Claim 10 further comprising defining any point within a preselected number of points from a point defined as a peak in Claim 9 to be part of a peak.
12. The method of Claim 5 wherein step (d) includes using linear interpolation to replace the points subtracted in step (c).
13. The method of Claim 7 wherein step (f) further comprises: defining the baseline offset to be the least positive point in the set of data formed in step (d); subtracting the baseline offset from the set of data containing baseline shape; and subjecting the resulting set of data to a Fourier transformation and then a filtering operation. 14. A method for examining multivariate data to determine outliers, comprising the steps of:
(a) selecting a calibration set of multivariate data; 


 (b) representing each member of the calibration set as a single point in a multidimensional axes system;
(c) constructing a model describing the points of step (b);
(d) obtaining a residual for each member of the calibration set by
5 calculating the portion of each member which is not depicted by the model constructed in step (c);
(e) creating an average residual by averaging the residuals of all of the calibration set members;
(f) determining the distance between each of the residuals obtained in 10 step (d) and the average residual obtained in step (e);
(g) determining the average and standard deviation of the distances obtained in step (f);
(h) calculating a t-distance for each member of the calibration set according to the formula:
15
 DISi - AVE
'
 t-distancei = -
STD where Disj is the distance obtained in step (f) for any member i, and AVE and STD are the average and standard deviation values obtained in step (g);
(i) acquiring a set of multivariate data from a sample; ___.fi
(j) obtaining a residual for the sample by calculating the portion of the sample which was not depicted by the model constructed in step (c);
(k) determining the distance between the residual obtained in step (j) and the average residual obtained in step (e);
(I) calculating a t-distance for the sample according to the formula:
25
DIS
sam
 - AVE t-d i stance. = -
STD where Dis
sa
 is the distance obtained in step (k), and AVE and STD are the average and standard deviation values obtained in step (g); and
(m) labeling as an outlier any sample whose t-distance is statistically
30 different from the t distances obtained in step (h).
15. The method of Claim 14 wherein principal Component Analysis is used to construct the model in step (c).
16. A method of separating a set of multivariate data into a plurality of sub-parts, wherein each sub-part comprises at least one member selected from the group consisting of
35 peak information, baseline shape, baseline offset, comprising the steps of:
(a) obtaining a set of multivariate data which includes peak information; 


 (b) identifying the portions ofthe multivariate data which contain peak information;
(c) subtracting the portions identified in step (b) from the set of multivariate data obtained in step (a); (d) replacing the points subtracted in step (c) from the set of multivariate data obtained in step (a), sothata first approximation ofthe baseline is formed; and
(e) subtracting the first approximation ofthe baseline formed in step (d) from the set of multivariate data obtained in step (a), thereby forming a set of o data comprising peak information.
17. The method of Claim 16 wherein step (d) includes using linear interpolation to replace the points subtracted in step (c).
5
0
5
0
5 


 18. The method of Claim 16 further comprising:
(f)smoothing out the set of data formed in step (e).
19. The method of Claim 18 further comprising:
(g)subtracting the set of data formed in step (f) from the set of multivariate data obtained in step (a), thereby forming a set of data comprising baseline shape, noise and baseline offset.
20. The method of Claim 19 further comprising:
(h) subjecting the set of data formed in step (g) to a Fourier transformation and then a filtering operation; and o (i) subtracting the set of data formed in step (h) from the set of data formed in step (g) thereby forming a set of data comprising noise.
21. The method of Claim 20 further comprising:
(j) defining the baseline offset to be the least positive point in the set of multivariate data obtained in step (a). 5 22. The method of Claim 21 further comprising:
(k) subtracting the baseline offset defined in step (j), and the set of data formed in step (i) from the set of data obtained in step (g).
23. The method of Claim 16 wherein step (b) comprises: calculating the values for the second derivative of the set of multivariate 0 data obtained in step (a); selecting a region in the set of multivariate data which is known not to contain peaks; averaging the values for the second derivative of the points in the region; calculating a standard deviation for the values for the second derivative of 5 the points in the region; and defining any point whose second derivative is further than a preselected number of standard deviations from the average value for the second derivative in the region to be part of a peak.
24. The method of Claim 23 further comprising defining any point within a 0 preselected number of points from a point defined as a peak in Claim 23 to be part of a peak.
5 

</CLAIMS>
</TEXT>
</DOC>
