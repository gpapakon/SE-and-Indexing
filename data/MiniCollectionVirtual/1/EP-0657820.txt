<DOC>
<DOCNO>EP-0657820</DOCNO> 
<TEXT>
<INVENTION-TITLE>
Method for preventing unauthorised data modification in an apparatus with a non-volatile memory
</INVENTION-TITLE>
<CLASSIFICATIONS>G06F1214	G06F2100	G06F2100	G06F1214	</CLASSIFICATIONS>
<CLASSIFICATIONS-THIRD>G06F	G06F	G06F	G06F	</CLASSIFICATIONS-THIRD>
<CLASSIFICATIONS-FOURTH>G06F12	G06F21	G06F21	G06F12	</CLASSIFICATIONS-FOURTH>
<ABSTRACT>
In the case of an apparatus having a central processor (CPU), a program memory (ROM) and a non-volatile memory (NVM), data in the non-volatile memory (NVM) can only be modified if a check bit has been set in a control (monitoring) register (KR) prior to checking the data modification authorisation. To this end, the instruction for setting the check bit must be in a defined address range of the data modification program and is checked with regard to this by the control register (KR). 
<
IMAGE
>
</ABSTRACT>
<APPLICANTS>
<APPLICANT-NAME>
SIEMENS AG
</APPLICANT-NAME>
<APPLICANT-NAME>
SIEMENS AKTIENGESELLSCHAFT
</APPLICANT-NAME>
</APPLICANTS>
<INVENTORS>
<INVENTOR-NAME>
POCKRANDT WOLFGANG DIPL-PHYS
</INVENTOR-NAME>
<INVENTOR-NAME>
SCHRENK HARTMUT DR RER NAT
</INVENTOR-NAME>
<INVENTOR-NAME>
POCKRANDT, WOLFGANG, DIPL.-PHYS.
</INVENTOR-NAME>
<INVENTOR-NAME>
SCHRENK, HARTMUT, DR.RER.NAT.
</INVENTOR-NAME>
</INVENTORS>
<CLAIMS>
Method of preventing unauthorized data
modification in a device having a non-volatile memory

(NVM), a central processing unit (CPU) and a program
memory (ROM) assigned to the central processing unit

(CPU) having the following steps:

giving an instruction to set a control bit in a
control register (KR), which can be driven by the

central processing unit, by a program for
modifying the data in a memory range of the

non-volatile memory (NVM),
checking whether this instruction originates from
a defined address range of the data modification

program,
if the instruction does originate from the defined
address range, carrying out the instruction by

setting the control bit in the control register
(KR),
checking for permission for a data modification in
a memory range of the non-volatile memory (NVM),
if the special permission is given, checking
whether the control bit is set,
if a control bit is set, modifying the data in the
memory range,
resetting the control bit in the control register
(KR) and revoking the write permission, both after

an allowed data modification and if a data

modification has not been allowed or if no control
bit was set.
Application of a method according to Claim 1 to
a smart card.
</CLAIMS>
</TEXT>
</DOC>
