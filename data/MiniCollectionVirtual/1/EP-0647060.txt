<DOC>
<DOCNO>EP-0647060</DOCNO> 
<TEXT>
<INVENTION-TITLE>
Method and apparatus for image-dependent color shifting
</INVENTION-TITLE>
<CLASSIFICATIONS>H04N160	G03G1501	H04N146	G06T500	H04N964	H04N160	G06T500	G03G1501	H04N964	H04N146	</CLASSIFICATIONS>
<CLASSIFICATIONS-THIRD>H04N	G03G	H04N	G06T	H04N	H04N	G06T	G03G	H04N	H04N	</CLASSIFICATIONS-THIRD>
<CLASSIFICATIONS-FOURTH>H04N1	G03G15	H04N1	G06T5	H04N9	H04N1	G06T5	G03G15	H04N9	H04N1	</CLASSIFICATIONS-FOURTH>
<ABSTRACT>
A method of correcting color shifts produced by improper imaging in a natural scene 
image including the steps of: converting by convertor (100) an electronically encoded natural 

scene image described in terms of red-green-blue color space to electronic encoding terms of 
luminance, chrominance color space; sorting in a sorter (102) each luminance signal forming the 

image into one of a plurality of predetermined luminance magnitude bands; for each luminance 
magnitude band, calculating in averaging circuitry (104,150) the band average chrominance 

signal of each pixel in the band to determine the relative amounts of each color in the band; for 
each band average chrominance signals, averaging in an interband averaging circuit (108) the 

band average chrominance signals over a subset of the luminance magnitude bands to derive an 
interband average chrominance value; comparing at a comparator (120) each interband average 

chrominance value with neutral gray color to determine a correction signal; for each luminance 
magnitude band, adding the correction signal to the color of each pixel in the band. 


</ABSTRACT>
<APPLICANTS>
<APPLICANT-NAME>
XEROX CORP
</APPLICANT-NAME>
<APPLICANT-NAME>
XEROX CORPORATION
</APPLICANT-NAME>
</APPLICANTS>
<INVENTORS>
<INVENTOR-NAME>
ESCHBACH REINER
</INVENTOR-NAME>
<INVENTOR-NAME>
ESCHBACH, REINER
</INVENTOR-NAME>
</INVENTORS>
<DESCRIPTION>
The present invention is directed towards a method and apparatus for image-dependent
color shifting in electronic documents of strongly color shifted natural scene images.In the past, a typical application for copiers or scan-to-print image processing systems
was to reproduce an input image as accurately as possible, i.e., render a copy. Thus, copies have
been rendered as accurately as possible, flaws and all. However, as customers become more
knowledgeable in their document reproduction requirements, they recognize that an exact copy
is often not what they want. Instead, they would rather obtain the best possible document
output. Until recently, image quality from the output of a copier or a scan-to-print system was
directly related to the input document quality. One very common set of input documents includes
photographs. Unfortunately, photography is an inexact science, particularly among amateurs,
and original photographs are often poor. Alternately, technology, age or image degradation
variations result in pictures having an unsatisfactory and undesirable appearance. What is desired
then, is a copy giving the best possible picture, and not a copy of the original.One improvement that can be made to an image is correction of color shifts. When
photographic color prints (a significant image source for electronic images) are made from
negative or positive color images, the overall colors of the print frequently do not correspond to
those desired. This may arise from a number of causes, such as change in sensitivity of the film due
to aging, use of incorrect lighting, error in print processing and the like. If an exact print is made
from such pictures based on the sensitivity which the film should have had, i.e, assuming that the
positive or negative was correct, then the printer, particularly if a reflection prints (as opposed to a
transparency) will display the errors to a greater extent than the transparency because such
printers are nearly always viewed under conditions in which there are comparison objects. Of
course, electronic images can only reproduce what is recorded, but given the possibility of pixel by
pixel color editing.US-A 2,571,697 to Evans teaches that in photographic processes, an overall color shift
can be made to the image without knowledge of the original colors. Starting with the assumption
that if light passes though the printing apparatus onto a printing material without a color image
or other obstruction in the light beam, the printing light should produce a neutral gray
(approx
</DESCRIPTION>
<CLAIMS>
A method of correcting color shift produced by
improper imaging in a natural scene image including:


converting an electronically encoded natural scene
image described in terms of color density color space

signals to an electronic encoding in terms of
luminance/chrominance color space signals (Y,E,S) each

having a luminance component (Y) and a chrominance

component (E,S);
sorting each luminance/chrominance color space signal
(Y,E,S) forming the image into one of a plurality of

predetermined luminance magnitude bands (L
1
-L
N
) in
accordance with the magnitude of its luminance component

(Y);
for each luminance magnitude band (Li), calculating a
band average chrominance signal (
<
E
>
;
<
S
>
) from the
chrominance component (E,S) of the luminance/chrominance

color space signals (Y,E,S) in that band to determine an
average color in the band;
for each calculated band average chrominance signal,
smoothing interband differences between band average

chrominance signals, by averaging each calculated band
average chrominance signal with at least one calculated

band average chrominance signal, and less than all the
calculated band average chrominance signals, to calculate

an interband average chrominance value for each calculated
band average chrominance signal;
comparing each interband average chrominance value
with neutral gray color signal to determine a color shift

correction signal for a corresponding luminance magnitude
band and
for each luminance magnitude band, adding the
correction signal to the color of each pixel in the band to

shift the color of the natural scene image.
A method as claimed in claim 1, wherein after sorting,
the step of detecting strongly shifted color images is

provided, including: 

comparing variation in color of the natural scene
image as defined by the chrominance components of signals

within a luminance magnitude band with the band average
chrominance signal, to determine whether the image is

strong color shifted; and
directing the signals to an output if the comparison
does not indicate a strongly color shifted color image.
A method as claimed in claim 1 or claim 2, wherein the
color density space is defined in terms of red-green-blue

signals and/or wherein the luminance color space is defined
in terms of Xerox YES signals.
A method as claimed in any one of claims 1 to 3,
wherein the luminance and chrominance components are

defined in terms of 8 bit values, and the luminance
components so defined are sorted into approximately 16

bands.
A method as claimed in any one of claims 1 to 4,
wherein the step of smoothing interband differences between

band average chrominance signals, includes weighting the
contribution to the interband average chrominance value in

accordance with the difference in value of the luminance
magnitude of the luminance magnitude band.
A color shift correcting system for correcting the
color shifts produced by improper imaging in a natural

scene image including:

a source of electronically encoded natural scene
images encoded in terms of color density color space

signals;
a color space converter (100), for receiving as an
input the electronically encoded natural scene image and

providing as an output an electronically encoding natural
scene image in terms of luminance/chrominance color space

signals (Y,E,S) each having a luminance component (Y) and
a chrominance component (E,S);
a luminance signal sorter (102) for receiving as an
input at least the luminance components of the

luminance/chrominance color space signals from the color 
space converter (100), and mapping each

luminance/chrominance color space signal forming the image
to one of a plurality of predetermined luminance magnitude

bands in accordance with the magnitude of its luminance
component (Y);
an averaging circuit (104,105) for receiving as an
input for each luminance magnitude band the chrominance

component of the luminance/chrominance color space signals
(Y,E,S) in that band, and producing as an output signal a

band average chrominance signal representing an average
color in the band;
an interband averaging circuit (108) for receiving as
an input for each luminance magnitude band the calculated

band average chrominance signal and at least one calculated
band average chrominance signal, and less than all the

calculated band average chrominance signals, from other
luminance magnitude bands, and producing as an output

signal an interband average chrominance signal for each
calculated band average chrominance signal whereby

interband differences between band average chrominance
signals are smoothed;
a comparator (120), having as inputs each interband
average chrominance value, and a signal representing

neutral gray, and providing as an output a difference
signal representing the different therebetween, whereby a

color shift correction for a corresponding luminance
magnitude band is determined; and
a signal adder (122), having as inputs the difference
signal, and the electronically encoded natural scene image

in terms of luminance/chrominance color space signals for
each luminance magnitude band corresponding to the

difference signals, and producing as an output a color
shifted signals.
A system as claimed in claim 6, additionally providing
a strongly shifted color image detector including:


a comparator (105) having as inputs the chrominance
components of the sorted signals and the band average 

chrominance signal, and producing an output signal
indicative of whether the image is strong color shifted;

and
switching means for directing the electronically
encoding natural scene image in terms of

luminance/chrominance color space signals from the
luminance signals sorter to an output if the comparator

does not indicate a strongly color shifted color image.
A system as claimed in claim 6 or claim 7, wherein the
color density space is defined in terms of red-green-blue

signals and/or wherein the luminance/chrominance color
space is defined in terms of Xerox YES signals.
A system as claimed in any one of claims 6 to 8,
wherein the luminance and chrominance color space

components are defined in terms of 8 bit values, and the
luminance components defined are sorted into approximately

16 bands.
A system as claimed in any one of claims 6 to 9,
wherein the interband averaging circuit further comprises:


means for weighting the contribution to the interband
average chrominance value of each of at least one

calculated band average chrominance signal in accordance
with the difference in value of the luminance magnitude

with luminance magnitude of the given band average
chrominance signal.
</CLAIMS>
</TEXT>
</DOC>
