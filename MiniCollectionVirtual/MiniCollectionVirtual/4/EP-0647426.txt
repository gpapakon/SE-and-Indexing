<DOC>
<DOCNO>EP-0647426</DOCNO> 
<TEXT>
<INVENTION-TITLE>
A dynamic filter for real-time artifact removal from waveforms
</INVENTION-TITLE>
<CLASSIFICATIONS>B01F1728	A61B50402	A61B50452	A61B50428	A61B50452	B01F1728	</CLASSIFICATIONS>
<CLASSIFICATIONS-THIRD>B01F	A61B	A61B	A61B	A61B	B01F	</CLASSIFICATIONS-THIRD>
<CLASSIFICATIONS-FOURTH>B01F17	A61B5	A61B5	A61B5	A61B5	B01F17	</CLASSIFICATIONS-FOURTH>
<ABSTRACT>
During sampling, a finite impulse response (FIR) 
filter (6) separates a composite signal into two 

components, non-cardiac physiological phenomena and 
cardiac artifacts. The length of the filter window 

dynamically varies to produce an output signal in which 
the cardiac frequency and any associated harmonics are 

suppressed. The FIR filter (6) is applied to the 
patient signal and lags the patient signal by at least 

one interval between triggering events. When the 
present interval between triggering events passes by the 

filter window, the window length is gradually adjusted 
to have the same length as the next period such that the 

triggering events are synchronized with the endpoints of 
the filter window at the start of each interval. The 

difference between the present interval and the next 
interval is evenly distributed or subtracted across the 

filter window between synchronizations. 

</ABSTRACT>
<APPLICANTS>
<APPLICANT-NAME>
HEWLETT PACKARD CO
</APPLICANT-NAME>
<APPLICANT-NAME>
HEWLETT-PACKARD COMPANY
</APPLICANT-NAME>
</APPLICANTS>
<INVENTORS>
<INVENTOR-NAME>
GOODNATURE DON
</INVENTOR-NAME>
<INVENTOR-NAME>
LINDAUER JAMES M
</INVENTOR-NAME>
<INVENTOR-NAME>
PERING RICHARD D
</INVENTOR-NAME>
<INVENTOR-NAME>
GOODNATURE, DON
</INVENTOR-NAME>
<INVENTOR-NAME>
LINDAUER, JAMES M.
</INVENTOR-NAME>
<INVENTOR-NAME>
PERING, RICHARD D.
</INVENTOR-NAME>
</INVENTORS>
<DESCRIPTION>
The invention pertains generally to patient monitors, for example
to an apparatus and method for isolating physiological phenomena in real-time
by removing cardiac artifacts that occur at a varying cardiac frequency and
harmonics of that frequency.Transducers are commonly used in patient monitoring to gather
information about a patient's condition. The resulting signals are often a
mixture of physiological phenomena. In general, this is an inherent property in
all electrical and pressure signals derived from mechanical movement in the
body, in particular, organ movement such as that by the diaphragm and the
heart. Unfortunately, the intrinsic characteristics of these measured signals are
often overwhelmed by the strength of the artifacts introduced by the heart. Of
the organs, the heart usually has the most pronounced and most rapid motion,
which can be picked up very easily by the transducers when measuring another
phenomenon. In other words, the electrical signals from the heart often "drown
out" the signals of interest. For example, respiratory impedance is a mixture of
electrical changes due to respiration and electrical changes due to mechanical
cardiac events. Observing each phenomena in isolation is desirable for medical
analysis and patient monitoring.One technique to isolate the phenomena is fixed-frequency filtering. This
method has limited success since the frequency ranges overlap for heart and
respiration rates. As a result, removing the cardiac artifacts at fixed frequencies
often fails altogether or significantly distorts the filtered respiration signal. Since
the physiological artifacts, such as those due to cardiac or other muscle activity, 
vary in time with response to stress and illness, fixed-frequency filtering is
ineffective at artefact removal.In "Methods of filtering the heart beat artefact from the breathing waveform
of infants obtained by impedance pneumography", Medical and Biological
Engineering and Computing, May 1982 (No. 3), pp. 293-298, Freeston et al
assesses digital filtering as a method for use in reducing heart beat artefact.In "Canceling the Cardiogenic Artifact in Impedance Pneumography",
IEEE/Seventh Annual Conference of the Engineering in Medicine and Biology
Society, pp855-859, Sahakian et al. attempted adaptive filtering by applying a
cardiac artifact template which was then subtracted from the respiratory
impedance (RI) waveform. The timing signal for adapting the signal averaged
cardiac artifact template was the output of a conventional QRS detector. The
QRS
</DESCRIPTION>
<CLAIMS>
A patient monitor (4) operable to receive a first input signal, which
corresponds to a cyclical cardiac signal (10), and a second input signal, which

corresponds to a composite signal (12) containing cardiac artifacts from a patient
(2), comprises:


A. a sampler (18) operable to receive an input signal which corresponds to
the composite signal received at a fixed rate, and to generate an output signal which

corresponds to composite samples;
B. a cardiac event detector (28) operable to receive an input signal which
corresponds to the cardiac signal, and to generate an output signal which

corresponds to a marked stable reference point contained within each cardiac cycle;
C. a cardiac interval detector (30) operable to receive an input signal which
corresponds to the reference points, and to generate an output signal which

corresponds to a cardiac interval between adjacent reference points;
D. a memory (20) operable to receive and store the composite samples and
has a newest and an oldest composite sample pointer;
E. a first digital filter (6), including means for defining a window correction
factor by dividing the difference between the first and second cardiac intervals by the

sampling rate, the filter being connected to the memory and having an adaptive
window with two edges, wherein one edge corresponds to the newest composite

sample pointer and the other edge corresponds to the oldest composite sample
pointer; and
F. a memory controller (22) connected to the memory, operable to receive
the cardiac interval and (1) to average the discrete composite values between the

newest and oldest pointers, inclusively, (2) to update the newest pointer to the next
discrete composite value and the oldest pointer such that the window length is

changed at multiples of the window correction factor when the multiples correspond
to an integral number of discrete composite values, and (3) to repeat the steps of

averaging and updating until the newest pointer points at the address containing the
discrete composite value of the second cardiac event; 
G. whereby the cardiac artifacts in the composite signal are reduced by
removing events that occur at a varying cardiac frequency and harmonics of the

cardiac frequency.
A patient monitor (4) as defined in claim 1, wherein the first digital
filter (8) is a finite impulse response filter.
A patient monitor (4) as defined in claim 2, comprising:

a feature extractor operable to receive an input signal which corresponds to
the filtered composite signal, and to generate a first output which corresponds to

signal features of the filtered composite signal, and a second output which
corresponds to the durations between the signal features; and
a rate detector operable to receive an input signal which corresponds to the
durations between the signal features and to generate an output signal which

corresponds to a rate at which the signal features occur.
A patient monitor (4) as defined in claim 3, comprising:

a patient condition indicator (26);
evaluation means connected to the patient condition indicator, and operable
to receive an input signal which corresponds to the rate, to evaluate the rate with

at least one patient threshold and to activate the patient condition indicator.
A patient monitor (4) as defined in claim 1 or 4, comprising a second
finite impulse
 response filter operable to receive a first input signal which
corresponds to the filtered composite signal and a second input signal which

corresponds to the composite signal, and to generate an output which corresponds
to the composite signal with the filtered composite signal substantially removed.
A patient monitor (4) as defined in claim 2, wherein the first finite
impulse response filter (6) has zeros which correspond to the varying cardiac

frequency and its harmonics. 
A patient monitor (4) as defined in claim 6, wherein
the cardiac interval is the length of the adaptive window.
A patient monitor (4) as defined in claim 7, wherein
the first finite impulse response filter (6) is a rectangular

filter.
A filtering method for reducing the cardiac
artifacts in the composite signal by receiving from a patient

a first, second, and third cardiac event and a composite
signal containing cardiac artifacts, the filtering method

comprising the steps of:

A. measuring a first and a second cardiac period,
wherein the first cardiac period is the duration between the

first and second cardiac events, wherein the second cardiac
period is the duration between the second and third cardiac

events;
B. sampling the composite signal at a sampling rate so
as to produce discrete composite values;
C. storing the discrete composite values in a series of
memory addresses;
D. defining a window correction factor by dividing the
difference between the first and second cardiac periods by the

sampling rate;
E. pointing a first pointer to the address containing
the discrete composite value corresponding to the first

cardiac event and a second pointer to the address containing
the discrete composite value corresponding to the second

cardiac event; and
F. producing a filtered composite signal using a finite
impulse response filter having a dynamic window length, the

step of producing the filtered composite signal comprising the
following sub-steps:


1) averaging the discrete composite values between
the first and second pointers, inclusively,
2) updating the first pointer to the next discrete
composite value and the second pointer such that the 

window length is changed at multiples of the window
correction factor when the multiples correspond to an

integral number of discrete composite values, and
3) repeating, the steps of averaging, and updating
until the first pointer points at the address containing

the discrete composite value of the second cardiac event.
A filtering method as defined in claim 9, further
comprising the steps of:


detecting signal features of the filtered composite
signal; and
determining a rate at which the signal features occur.
A filtering method as defined in claim 10, further
comprising the steps of:


evaluating the rate with at least one patient threshold;
and
activating an alarm when the rate is less than the
patient threshold.
A filtering method as defined in claim 11, further
comprising the step of subtracting the filtered composite

signal from the composite signal such that the filtered
composite signal is substantially removed from the composite

signal.
</CLAIMS>
</TEXT>
</DOC>
