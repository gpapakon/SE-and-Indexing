<DOC>
<DOCNO>EP-0617387</DOCNO> 
<TEXT>
<INVENTION-TITLE>
File management apparatus for IC card
</INVENTION-TITLE>
<CLASSIFICATIONS>G07F710	G06F2124	G06F1200	G06F1214	G06K19073	G06F2100	G06K19073	G06F1200	G06F1214	G07F710	G06K1907	G06K1907	</CLASSIFICATIONS>
<CLASSIFICATIONS-THIRD>G07F	G06F	G06F	G06F	G06K	G06F	G06K	G06F	G06F	G07F	G06K	G06K	</CLASSIFICATIONS-THIRD>
<CLASSIFICATIONS-FOURTH>G07F7	G06F21	G06F12	G06F12	G06K19	G06F21	G06K19	G06F12	G06F12	G07F7	G06K19	G06K19	</CLASSIFICATIONS-FOURTH>
<ABSTRACT>
A file management apparatus in which a memory (12) 
is divided into a plurality of files in an IC card (1), 

and the divided files are defined as upper and lower 
files and managed in a tree structure. The file management 

apparatus has an access limiting unit (11) for 
limiting access to one of the lower files belonging to 

the upper file, relaxing the access, and limiting a set 
of a plurality of specific files of lower files belonging 

to an upper file, and an access relaxing unit (11) 
for relaxing the limitation of the access. 


</ABSTRACT>
<APPLICANTS>
</APPLICANTS>
<INVENTORS>
</INVENTORS>
<DESCRIPTION>
The present invention relates to a file management
apparatus for an IC card incorporating an IC chip having
a nonvolatile memory and a control element such as a CPU
for controlling the nonvolatile memory, which apparatus
serves to manage a plurality of files separately set in
the memory.In recent years, as a portable data storage medium,
an IC card incorporating an IC chip having a nonvolatile
memory and a control element such as a CPU for controlling
the memory has received a great deal of attraction.The IC card of this type is known in U.S. Patent
No. 4,985,615 having a memory whose memory area is
divided in correspondence with a plurality of files. In
each file, data or the like required for performing a
corresponding application is stored. When an application
identification name is input from a terminal device
in which the IC card is inserted, the IC card can be set
in a state in which only a corresponding file can be
selectively used. In this manner, when a plurality of
application data are divided and stored into files provided
in one IC card, the IC card can be multi-purposely
utilized.In some application, a specific IC card must be
inhibited from being used by the user of this IC card.
For example, in a credit application, when a card user
is written on a black list, the use of this card by the 
user must be inhibited in the credit application.When the method described above is used, with an
increase in the number of users written on the black
list, the amount of operation performed to check IC
cards increases. In particular, when this application
is employed world-wide scale, a black list to be
referred to becomes enormous, the amount of operation to
check IC cards becomes conspicuously increases.For this reason, the following method is
considered. That is, in each IC card, access to a file
corresponding to an application whose use must be
limited is forcibly inhibited to make reference of the
black list unnecessary.It is an object of the present invention to provide
a file management apparatus for an IC card, in which an
enormous black list used in the execution of an application
need not be referred to, and the flexibility of
file management of the application is improved.Reference to such an enormous black list upon each IC-card validity check is avoided
by an IC-card system as known from US-A-3 655 946. There, this advantage is
achieved by erasing the card number from the IC card which has been recognized by
the validity check to be invalid. In this way, ie by storing of access inhibit
</DESCRIPTION>
<CLAIMS>
An IC card (1) connected to a terminal device (10) for
transmitting to and receiving from a command and data,

comprising:

a memory (12) including a plurality of files (121)
each having a plurality of areas (123) depending to

the files;
first storage means (DFAC, DFST) for storing access
inhibit information to the files of the memory

(12);
second storage means (DFAC, DFST) for storing
access inhibit information to the areas depending

to the files;
first inhibiting means (11) for inhibiting an access operation to a
specific file and the areas depending to the

specific file when the access operation to the
specific file is inhibited by the inhibit

information stored in said first storage means; and
second inhibiting means (11) for inhibiting an access operation to
the areas depending to the specific file by the

inhibit information stored in said second storage
means when the access operation to the specific

file is not inhibited by the inhibit information
stored in said first storage means.
An IC card according to claim 1,
characterized by
 further comprising:

first renewing means for renewing the inhibit
information stored in said first storage means in

accordance with a command from said terminal
device; and
second renewing means for renewing the inhibit
information stored in said second storage means in

accordance with a command from said terminal
device.
An IC card according to claim 1, comprising:

directory information storage means (121) for
storing directory information including file

definition information having position information
of a file in said data storage means (12) and

access inhibit information to inhibit accessing to
the file and area definition information having

position information of a plurality of areas
depending to the file and access inhibit

information to inhibit accessing to the areas;
first determining means (11, 13, 14) for
determining whether the accessing to the file by

referring to the inhibit information included in
the file definition information;
second determining means (11, 13, 14) for
determining whether the accessing to the areas by

referring to the inhibit information included in
the area definition information; 
means (11, 13, 14) for allowing the accessing to
the areas when it is determined by said first and

second determining means that the accessing is not
inhibited.
An IC card (1) according to claim 3,
characterized in
 that each of said areas includes a data
area for storing data (DF) and a key area for storing

identification key, and the area definition information
with respect to the data area and the key area is stored

in the directory area.
An IC card according to claim 4,
characterized in
 that the inhibit information included
in the file definition information (DFAC) represents

access inhibition to definition information of the data
areas and key areas depending to the specific file, and

the first inhibiting means inhibits accessing to the areas when the
accessing to the area definition information is

inhibited by the inhibit information.
An IC card according to claim 5,
characterized by
 further comprising:

first renewing means for renewing the inhibit
information stored in said first storage means in

response to a command from the terminal device
(10); and
second renewing means for renewing the inhibit
information stored in said second storage means in

response to a command from the terminal device
(10).
A method for controlling a file stored in an IC card
connected to a terminal device for transmitting to and

and receiving from a command and data, comprising the
steps of:


storing a plurality of files each having a
plurality of areas depending to the files;
storing first access inhibit information to the files;
storing second access inhibit information to the areas
depending to the files;
inhibiting an access operation to a specific file
and the areas depending to the specific file when

the access operation to the specific file is
inhibited by the first inhibit information; and
inhibiting an access operation to the areas
depending to the specific file by the second inhibit

information when the access operation to the
specific file is not inhibited by the first inhibit

information.
</CLAIMS>
</TEXT>
</DOC>
