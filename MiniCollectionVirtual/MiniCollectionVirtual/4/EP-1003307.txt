<DOC>
<DOCNO>EP-1003307</DOCNO> 
<TEXT>
<INVENTION-TITLE>
Method and system for communicating with a device attached to a computer using electronic mail messages
</INVENTION-TITLE>
<CLASSIFICATIONS>H04L1224	G03G2100	G06F1300	G06F1300	G03G2100	H04L1258	H04L1224	H04L1258	</CLASSIFICATIONS>
<CLASSIFICATIONS-THIRD>H04L	G03G	G06F	G06F	G03G	H04L	H04L	H04L	</CLASSIFICATIONS-THIRD>
<CLASSIFICATIONS-FOURTH>H04L12	G03G21	G06F13	G06F13	G03G21	H04L12	H04L12	H04L12	</CLASSIFICATIONS-FOURTH>
<ABSTRACT>
A method, system, and computer program product for communicating with machines
connected to a network. Information sent to or from the machines is transmitted using

electronic mail. The electronic mail may be transmitted over the Internet, but also may
remain within a local or wide area network. When receiving electronic mail, the electronic

mail message may be sent to a user who reads information regarding the purpose of the
electronic mail message in the body of the message. When the user is satisfied that it is safe

to perform the functions requested by the email, the user may execute a file which is attached
to the incoming email message in order to perform the appropriate diagnostic or control

operations. Alternatively, the incoming email message may contain a code or is sent to an
address which causes automatic execution of the desired functions. In this embodiment, it

may not be necessary for the user to manually perform any action in order to allow the
appropriate processing to begin. Email messages may also be transmitted from the computer

which is attached to the device which is being monitored or controlled and include
information regarding the status or capabilities of the attached device.


</ABSTRACT>
<APPLICANTS>
<APPLICANT-NAME>
RICOH KK
</APPLICANT-NAME>
<APPLICANT-NAME>
RICOH COMPANY, LTD.
</APPLICANT-NAME>
</APPLICANTS>
<INVENTORS>
<INVENTOR-NAME>
MOTOYAMA TETSURO
</INVENTOR-NAME>
<INVENTOR-NAME>
MOTOYAMA, TETSURO
</INVENTOR-NAME>
</INVENTORS>
<DESCRIPTION>
This invention generally relates to the use of electronic mail messages for communicating information to and from a device connected to a computer. The invention is more particularly related to the processing performed within the computer in order to forward the appropriate information to or from the device. The invention is further related to a method and system for receiving an electronic mail message by the computer and determining if the electronic mail message contains information which is designated for the attached device. Still further, the invention is related to the transmission of information originating from a device attached to a computer using electronic mail as a transmission device.Electronic mail ("email") has become very popular for communicating information between people and provides the benefits of being inexpensive and convenient to a user. Extensive information and protocols are available explaining how email including Internet email operates and many commercially available programs are available to implement email functions.While there exists many commercially available programs specifically designed to communicate electronic mail messages between humans, there are no known commercially available email programs for communicating information which originates from or is intended to be delivered to control a machine. US Patent 5715393 discloses a method for removely monitoring a computer by sending an e-mail from a monitoring computer to the monitored computer. The monitored computer replies to this e-mail with an e-mail comprising its status.Accordingly, it is an object of this invention to provide a method and a system in accordance with claims 1 and 22. Specific embodiments of the invention are set forth in the dependent claims.A more complete appreciation of the invention and many of the attendant advantages thereof will be readily obtained as the same becomes better understood by reference to the following detailed description when considered in connection with the accompanying drawings, wherein:
Figure 1 illustrates three networked business office machines connected to a network of computers and data bases through the Internet;Figure 2 illustrates the components of a digital copier/printer;Figure 3 illustrates the electronic components of the digital copier/printer illustrated in Figure 2;Figure 4 illustrates details of the multi-port communication interface illustrated in Figure 3;Figure 5 illustrates an alternative system configuration in which business office devices are
</DESCRIPTION>
<CLAIMS>
A method of processing messages, comprising the steps of:

receiving (490; 520) an electronic mail message by a computer (17);
 
determining (496; 526) whether the message which has been received is for a device (24, 28, 32) connected to the computer (17);
transmitting (498; 528) a communication from the computer (17) to the device (24, 28, 32), when the step of determining determines that the message is for the device (24, 28, 32);
receiving, by the device (24, 28, 32), the communication transmitted from the computer (17); and
transmitting parameters from the device (24, 28, 32) to the computer (17), in response to the communication, which has been received by the device (24, 28, 32),
wherein:

said transmission from the device (24, 28, 32) to the computer includes information relating to the operation of the device (24, 28, 32), and
said device (24, 28, 32) is at least one of a printer (32) digital copier (24) and facsimile machine (28).
The method according to claim 1, wherein the determining step comprises:

determining whether the message which has been received is for the device or whether the message which has been received has been received has a user of the computer as an end recipient.
The method according to claim 1, further comprising the step of:
displaying, after the receiving step of receiving the electronic message by the computer (17), a message to the user comprising the electronic mail message containing information to be forwarded to the device,
wherein the determining step comprises;
determining, by a user reading the message which has been displayed, whether the message which has been received is for the device.
The method according to claim 3, further comprising the step of:

executing a command which causes the step of transmitting the communication from the computer (17) to the device (24, 28, 32) to be performed.
The method according to claim 4, wherein the executing step comprises:

executing program code of a file which is attached to the message wherein the execution of the program code of a file starts by a manual action by the user.
The method according to claim 5, wherein the executing step comprises:

executing the program code of the file by pointing, using a pointing device and a graphical user interface, to an object representing the file.
The method according to claim 6, wherein the executing step comprises:

executing the code by pressing a button while pointing to the object representing the file.
The method according to claim 1, wherein the receiving step of receiving the electronic mail by the computer (17) comprises:

receiving an Internet electronic mail message.
The method according to claim 4, wherein:

the step of executing a command comprises transmitting information to a device driver executing within the computer; and
the step of transmitting the communication from the computer (17) to the device (24, 28, 32) is performed using the device driver (440).
The method according to claim 1, further comprising the step of:
performing a mechanical action by the device, in response to the communication which has been received by the device.
The method according to claim 1, wherein the determining step comprises:

determining that the message is for a device automatically by detecting a characteristic of the email.
The method according to claim 11, wherein the determining step comprises:

determining that the message is for a device automatically by detecting a code within the message.
The method according to claim 12, wherein the determining step comprises:

determining that the message is for a device automatically by detecting the code which is the subject of the message.
The method according to claim 12, wherein the determining step comprises:

determining that the message is for a device automatically by detecting the code which is in a body of the message.
The method according to claim 11, wherein the determining step is performed in response to a receipt of an incoming electronic mail message.
The method according to claim 15, wherein the determining step is performed in response to a receipt of an incoming electronic mail message which is detected by monitoring an existence of a file stored at a predetermined location in memory.
The method according to claim 1, further comprising the steps of:

processing the information relating to the operation of the device (24, 28, 32) by a device driver (440) within the computer (17); and
transmitting (544, 566), by the computer (17), an electronic mail message corresponding to the information relating to the operation of the device (24, 28, 32).
The method according to claim 17, further comprising the step of:
transmitting the information from the device driver to a messaging application programming interface (MAPI) of the computer; and
processing the information by the MAPI,
wherein the step of transmitting the electronic mail message comprises transmitting the electronic mail message corresponding to the information which has been processed by the MAPI.
The method according to claim 17, wherein:

the computer is a message transfer agent,
the step of transmitting information from the device transmits the information from the device directly to the computer which is the message transfer agent, and
the step of transmitting the electronic mail message transmits the electronic mail message using a TCP connection from the computer which is a message transfer agent.
The method according to claim 17, wherein the processing step comprises:

creating a file corresponding to the information; and
writing the file to a mail spool directory of the computer, and
wherein the step of transmitting the electronic mail message comprises transmitting the electronic mail message corresponding to the information using the file stored in the mail spool directory.
The method according to claim 20, wherein:

the step of creating and writing comprises creating a plurality of files and writing the plurality of files in the mail spool directory; and
the step of transmitting comprises transmitting the electronic mail message using each of the plurality of files stored in the mail spool directory.
A system for processing messages, said system comprising:

a computer (17) and a device (24, 28, 32) connected to the computer (17), the computer (17) comprises
means for receiving an electronic mail message;
means for determining whether the message, which has been received, is for a device (24, 28, 32) connected to the computer (17);
means for transmitting a communication from the computer (17) to the device (24, 28, 32), when the means for determining determines that the message is for the device (24, 28, 32);
means for receiving, by the device (24, 28, 32), the communication transmitted from the computer (17); and
means for transmitting parameters from the device (24, 28, 32) to the computer (17), in response to the communication, which has been received by the device (24, 28, 32);
wherein :

said means for transmitting transmits information relating to the operation of the device (24, 28, 32); and
said device (24, 28, 32) is at least one of a printer (32), digital copier(24) and facsimile machine (28).
The system according to claim 22, wherein the means for determining comprises:

means for determining whether the message which has been received is for the device or whether the message which has been received has been received has a user of the computer as an end recipient.
The system according to claim 22, further comprising:

means for displaying a message to the user indicating the electronic mail message contains information to be forwarded to the device,
wherein the means for determining comprises:
means for determining, by a user reading the message which has been displayed, whether the message which has been received is for the device.
The system according to claim 24, further comprising:

means for executing a command which causes the means for transmitting the communication from the computer (17) to the device (24, 28, 32) to operate.
The system according to claim 25, wherein the means for executing comprises:

means for executing program code of a file which is attached to the message,

wherein the execution of the program code of a file starts by a manual action by the user.
The system according to claim 26, wherein the means for executing comprises:

means for executing the program code of the file by pointing, using a pointing device and a graphical user interface, to an object representing the file.
The system according to claim 27, wherein the means for executing comprises:

means for executing the code by pressing a button while pointing to the object representing the file.
The system according to claim 22, wherein the means for receiving the electronic mail message comprises:

means for receiving an Internet electronic mail message.
The system according to claim 25, wherein:

the means for executing a command comprises means for transmitting information to a device driver (440) executing within the computer (17); and
the means for transmitting the communication from the computer (17) to the device (24, 28, 32) operates using the device driver (440).
The system according to claim 22, further comprising:

means for performing a mechanical action by the device, in response to the communication which has been received by the device.
The system according to claim 22, wherein the means for determining comprises:

means for determining that the message is for a device automatically by detecting a characteristic of the email.
The system according to claim 32, wherein the means for determining comprises:

means for determining that the message is for a device automatically by detecting a code within the message.
The system according to claim 33, wherein the means for determining comprising:

means for determining that the message is for a device automatically by detecting the code which is the subject of the message.
The system according to claim 33, wherein the means for determining comprises:

means for determining that the message is for a device automatically by detecting the code which is in a body of the message.
The system according to claim 33, wherein the means for determining operates in response to a receipt of an incoming electronic mail message.
The system according to claim 36, wherein the means for determining operates in response to a receipt of an incoming electronic mail message which is detected by monitoring an existence of a file stored at a predetermined location in memory.
The system according to claim 22, further comprising:

means for processing the information relating to the operation of the device (24, 28, 32) by a device driver (440) within the computer (17); and
means for transmitting, by the computer, an electronic mail message corresponding to the information relating to the operation of the device (24, 28, 32).
The system according to claim 38, further comprising:

means for transmitting the information from the device driver to a messaging application programming interface (MAPI) of the computer; and
means for processing the information by the MAPI,
wherein the means for transmitting the electronic mail message comprises means for transmitting the electronic mail message corresponding to the information which has been processed by the MAPI.
The system according to claim 38, wherein:

the computer is a message transfer agent,
the means for transmitting information from the device transmits the information from the device directly to the computer which is the message transfer agent, and
the means for transmitting the electronic mail message transmits the electronic mail message using a TCP connection from the computer which is a message transfer agent.
The system according to claim 38, wherein the means for processing comprises:

means for creating a file corresponding to the information; and
means for writing the file to a mail spool directory of the computer, and
wherein the means for transmitting the electronic mail message comprises means for transmitting the electronic mail message corresponding to the information using the file stored in the mail spool directory.
The system according to claim 41, wherein:

the means for creating and writing comprises means for creating a plurality of files and writing the plurality of files in the mail spool directory; and
the means for transmitting comprises means for transmitting the electronic mail message using each of the plurality of files stored in the mail spool directory.
</CLAIMS>
</TEXT>
</DOC>
