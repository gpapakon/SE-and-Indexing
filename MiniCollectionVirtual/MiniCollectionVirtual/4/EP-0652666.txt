<DOC>
<DOCNO>EP-0652666</DOCNO> 
<TEXT>
<INVENTION-TITLE>
System and method for computer data transmission.
</INVENTION-TITLE>
<CLASSIFICATIONS>G06F1300	G06F1300	H04L2906	H04L2906	H04L2910	H04L2910	H04N100	H04N100	H04N132	H04N132	</CLASSIFICATIONS>
<CLASSIFICATIONS-THIRD>G06F	G06F	H04L	H04L	H04L	H04L	H04N	H04N	H04N	H04N	</CLASSIFICATIONS-THIRD>
<CLASSIFICATIONS-FOURTH>G06F13	G06F13	H04L29	H04L29	H04L29	H04L29	H04N1	H04N1	H04N1	H04N1	</CLASSIFICATIONS-FOURTH>
<ABSTRACT>
The system of the present invention processes data for communication 
between first and second computers by linearizing the communications message. The 

message comprises a linear header portion, an extended header portion, and a message 
body. The linear header portion identifies the number of message recipients and 

message types. The extended header contains detailed information about the message 
recipients, such as recipient name and address. The extended header may also contain 

message subject information, polling information, and password data. The header 
information is used by the receiving computer to prepare to process the expected data 

type. The message body may be transferred in a form that takes advantage of the data 
processing capabilities of the first and second computers. The computers may 

exchange data processing capabilities so that the most efficient transfer form may be 

selected. The extended header and message body are encoded using a well-known 
ASN-1 data encoding process. In addition, the message body may be compressed and 

encrypted. The system may be readily used in facsimile communication where the 
first and second computers are facsimile machines. 


</ABSTRACT>
<APPLICANTS>
<APPLICANT-NAME>
MICROSOFT CORP
</APPLICANT-NAME>
<APPLICANT-NAME>
MICROSOFT CORPORATION
</APPLICANT-NAME>
</APPLICANTS>
<INVENTORS>
<INVENTOR-NAME>
GINSBERG MICHAEL
</INVENTOR-NAME>
<INVENTOR-NAME>
MATHUR SHARAD
</INVENTOR-NAME>
<INVENTOR-NAME>
MENEZES ARUL
</INVENTOR-NAME>
<INVENTOR-NAME>
GINSBERG, MICHAEL
</INVENTOR-NAME>
<INVENTOR-NAME>
MATHUR, SHARAD
</INVENTOR-NAME>
<INVENTOR-NAME>
MENEZES, ARUL
</INVENTOR-NAME>
</INVENTORS>
<DESCRIPTION>
The invention relates generally to a system and method for 
formatting and processing data, and more particularly, for formatting processing 
facsimile data. Computers are commonly used in the workplace for data 
processing and storage. Access to computer information is a key element in the 
successful use of computers. Communication between computers has become a 
critical aspect of access to the computer information. A local area network 
(LAN) allows several computers to be coupled together to enhance their 
computing capability. One computer can access information stored in another 
computer through the LAN. When information is exchanged between two 
computers, the information must be in a format that the computers can recognize 
and process. Information is often exchanged in a standard format such as ASCII, 
for example. However, an ASCII format exchange may require that the 
information be converted from its original format to ASCII format. The 
computer transferring information has no way of determining the data processing 
capabilities of the receiving computer and, therefore, must convert the 
information to ASCII on the assumption that ASCII is a "universal" format that 
all computers can recognize. One form of computer is a facsimile (FAX) machine. A FAX 
machine may comprise an interface board within a computer, or may be a stand-alone 
device employing well-known computer technology. FAX machines are 
used to transfer information from one location to another. FAX machines of 
older design had little or no computing power and were limited to scanning a 
page and transmitting a digitized version of the page to a receiving FAX machine 
that reproduced the page. Modern FAX machines are essentially a form of 
computer and often have storage capability allowing the FAX machine to scan a 
document and store the digitized version of the machine for transmission at a 
later time, such as when telephone rates decrease at night. The receiving FAX 
machine can store received messages that are confidential and print them out 
only when the proper identification code is entered.  To minimize transmission time, FAX machines use data 
compression techniques well known in the art. An international standard for 
facsimile transmission has been established by the International Telegraph and 
Telephone Consultative Committee (CCITT) and published as Terminal 
Equipment and Protocols for Telematic Services (1989). References to CCITT 
standards are made throughout this disclosure. These standards are well known
</DESCRIPTION>
<CLAIMS>
A system for controlling communication between first and 
second computers, the system comprising: 

   a formatter to generate formatted data according to a predetermined 
format comprising a message object having a plurality of data headers and 

corresponding data attachments, each of said data headers containing header data 
describing said corresponding data attachment; and 

   a controller controlling transfer of said formatted data from the first 
computer to the second computer, said controller transferring said plurality of data 

headers prior to transferring any of said corresponding data attachments. 
The system of claim 1 wherein the second computer receives said 
data headers prior to receiving said corresponding data attachments and uses said data 

headers to prepare in advance of receiving said corresponding data attachments for 
processing said corresponding data attachments. 
The system of claim 1 wherein the first and second computers are 
facsimile machines. 
The system of claim 1 wherein each of said plurality of data 
headers contains a plurality of header data fields, and said plurality of header data 

fields comprises one of a header size data field indicating the size of said header, a 
message type data field indicating the type of data being transferred in said 

corresponding data attachment, a recipient number data field indicating the number of 

intended recipients of said formatted data, and a recipient type data field indicating 
recipient parameters. 
The system of claim 4 wherein said plurality of header data fields 
includes a flag data field indicating the presence of encrypted data in said formatted 

data. 
The system of claim 4 wherein said plurality of header data fields 
includes a flag data field indicating the presence of image map data in said formatted 

data. 
The system of claim 1 wherein said predetermined format 
includes an extended header for providing detailed recipient information about an 

intended recipient of said formatted data. 
The system of claim 7 wherein said extended header contains at 
least a first data field, said extended header data field comprising one of a subject data 

field containing information relating to the subject of said formatted data, a poll name 
data field indicating a filename if one of the first and second computers is sending a 

poll request, a password data field containing an authorized user identification, and a 
message originator data field containing data indicating the identity of the sender of 

said formatted data. 
The system of claim 7 wherein said formatted data is transferred 
to at least a first recipient, said extended header containing a message recipient data 

field containing data indicating a list of all recipients of said message. 
The system of claim 9 wherein said message recipient data field 
comprises a recipient name, and a recipient address. 
The system of claim 1 wherein said formatter generates said 
formatted data in a linearized format having a linearized sequence indicative of a 

transfer sequence in which said controller will transfer said formatted data. 
The system of claim 11 wherein said linearized sequence 
includes a routing header containing data indicative of a transmission path from the 

first computer to the second computer, a recipient header containing data indicative of 
an intended recipient of said formatted data, said data headers, and said corresponding 

data attachments. 
A system for controlling communication between first and 
second computers, the system comprising: 

   a formatter to generate formatted data according to a predetermined 
linearized format indicative of a sequence in which said formatted data will be 

transferred from the first computer to the second computer, said linearized format 
comprising an unsigned and unencrypted linear header containing routing data 

indicative of a transfer path from the first computer to the second computer, an 
 

extended header containing data indicative of an intended recipient of said formatted 
data, said extended header containing a digital signature to permit detection of 

alterations to said extended header, at least a first attachment data block containing 
information to be transferred from the first computer to the second computer, and an 

attachment header corresponding to each attachment data block and containing data 
related to a type of processing to be performed on said corresponding attachment data 

block by the second computer; and 
   a controller controlling transfer of said formatted data from the first 

computer to the second computer. 
The system of claim 13 wherein the second computer receives 
said attachment header prior to receiving said corresponding attachment data block 

and uses said attachment header to prepare in advance of receiving said corresponding 
data attachment block for processing said corresponding attachment data block. 
The system of claim 13 wherein said linear header contains a data 
field containing a plurality of flags, said flags being used by said linearizer to describe 

said parameters. 
The system of claim 15 wherein one of said plurality of flags 
indicates the presence of encrypted data in said data. 
The system of claim 15 wherein one of said plurality of flags 
indicates the presence of image data in said data. 
The system of claim 13 wherein said linear header data field 
comprises a plurality of data fields comprising a size data field indicating the size of 

said linear header, a message type data field indicating the type of said data, a 
recipient number data field indicating the number of message recipients, and a 

recipient type data field indicating recipient parameters. 
The system of claim 13 wherein said extended header contains at 
least a first data field, said first extended header data field comprising one of a subject 

data field containing information relating to the subject of said data, a poll name data 
field indicating a filename if one of the first and second computers is sending a poll 

request, a password data field containing an authorized user identification, and a 
 

message originator data field containing data indicating the identity of the sender of 
said data. 
The system of claim 13 wherein said formatted data is transferred 
to the second computer through a relay computer, said relay computer altering said 

linear header to indicate transfer through said relay computer. 
The system of claim 13 wherein said extended header contains a 
message recipient data field containing data indicating a list of all recipients of said 

formatted data. 
The system of claim 21 wherein said message recipient data field 
comprises a recipient name, and a recipient address. 
The system of claim 13 wherein said attachment data block is 
encoded using ASN-1 encoding. 
The system of claim 13 wherein said attachment data block is 
compressed before transmission to the second computer. 
The system of claim 13 wherein said attachment data block is 
encrypted before transmission to the second computer. 
The system of claim 13 wherein said type of processing to be 
performed by the second computer is printing said corresponding attachment data 

block. 
The system of claim 13 wherein said recipient is the second 
computer and said type of processing to be performed by the second computer is 

storing said corresponding attachment data block. 
The system of claim 13 wherein the first and second computers 
are first and second facsimile machines, respectively, and said type of processing to be 

performed by said second facsimile machine is a poll request, said corresponding 
attachment data block containing polling data. 
The system of claim 28 wherein said polling data includes 
pathway data indicating the location of a selected data file stored within said second 

facsimile machine. 
A method for controlling communication between first and 
second computers, the method comprising the steps of: 

   formatting data according to a predetermined format comprising a 
message object having a plurality of data headers and corresponding data attachments, 

each of said data headers containing header data describing said corresponding data 
attachment; 

   transferring said plurality of data headers from the first computer to the 

second computer; and 
   transferring said corresponding data attachments from the first computer 

to the second computer. 
The method of claim 30 wherein each of said plurality of data 
headers contains a plurality of data fields, and said plurality of header data fields 

comprises a header size data field indicating the size of said header, a message type 
data field indicating the type of said message, a recipient number data field indicating 

the number of intended message recipients of said message, and a recipient type data 
field indicating recipient parameters. 
The method of claim 31 wherein said plurality of header data 
fields includes a flag data field indicating the presence of encrypted data in said 

formatted data. 
The method of claim 31 wherein said plurality of header data 
fields includes a flag data field indicating the presence of image data in said formatted 

data. 
The method of claim 30 wherein said plurality of data headers are 
transferred from the first computer to the second computer prior to transfer of said 

corresponding data attachments. 
The method of claim 30 wherein said step of formatting generates 
formatted data in a linearized format having a linearized sequence indicative of a 

transfer sequence in which said controller will transfer said formatted data. 
The method of claim 35 wherein said linearized sequence 
includes a routing header containing data indicative of a transmission path from the 

first computer to the second computer, a recipient header containing data indicative of 
an intended recipient of said formatted data, said data headers, and said corresponding 

data attachments. 
The method of claim 30 wherein the first and second computers 
are first and second facsimile machines, respectively, said formatted data being 

transferred using a telephone communication link coupling said first and second 
facsimile machines. 
The method of claim 30 wherein said predetermined format 
includes an extended header for providing detailed recipient information about an 

intended recipient of said formatted data. 
The method of claim 38 wherein said extended header contains at 
least a first data field, said extended header data field comprising one of a subject data 

field containing information relating to the subject of said formatted data, a poll name 
data field indicating a filename if one of the first and second computers is sending a 

poll request, a password data field containing an authorized user identification, and a 
message originator data field containing data indicating the identity of the sender of 

said formatted data. 
The method of claim 38 wherein said formatted data is 
transferred to at least a first intended recipient, said extended header containing a 

message recipient data field containing data indicating a list of all intended recipients 
of said formatted data. 
The method of claim 40 wherein said message recipient data field 
comprises a recipient name, and a recipient address. 
A method for controlling communication between first and 
second computers, the method comprising the steps of: 

   generating an unsigned and unencrypted linear header containing 
routing data indicative of a transfer path from the first computer to the second 

computer;
 

   generating an extended header containing data indicative of an intended 
recipient of said formatted data, said extended header containing a digital signature to 

permit detection of alterations to said extended header; 
   generating at least a first attachment data block containing information 

to be transferred from the first computer to the second computer; 
   generating an attachment header corresponding to each attachment data 

block and containing data related to a type of processing to be performed on said 
corresponding attachment data block by the second computer; and 

   transferring said formatted data from the first computer to the second 
computer. 
The method of claim 42 wherein the second computer receives 
said attachment header prior to receiving said corresponding attachment data block. 
The method of claim 43 wherein said formatted data is 
transferred to the second computer through a relay computer, the method further 

including the step of altering said linear header to indicate transfer through said relay 
computer. 
The method of claim 42 wherein said type of processing to be 
performed by the second computer is printing said corresponding attachment data 

block. 
The method of claim 42 wherein said recipient is the second 
computer and said type of processing to be performed by the second computer is 

storing said corresponding attachment data block. 
The method of claim 42 wherein the first and second computers 
are first and second facsimile machines, respectively, and said type of processing to be 

performed by said second facsimile machine is a poll request, said corresponding 
attachment data block containing polling data. 
The method of claim 47 wherein said polling data includes 
pathway data indicating the location of a selected data file stored within said second 

facsimile machine. 
The method of claim 42 wherein said linear header contains a 
data field containing a plurality of flags to describe said parameters, said step of 

generating said linear header including the formatting of said flags. 
The method of claim 49 wherein one of said plurality of flags 
indicates the presence of encrypted data in data. 
The method of claim 49 wherein one of said plurality of flags 
indicates the presence of image data in the data. 
The method of claim 42 wherein said linear header data field 
comprises a plurality of data fields comprising a size data field indicating the size of 

said linear header, a message type data field indicating the type of said formatted data, 
a recipient number data field indicating the number of message recipients, and a 

recipient type data field indicating recipient parameters. 
The method of claim 42 wherein said extended header contains at 
least a first data field, said first extended header data field comprising one of a subject 

data field containing information relating to the subject of said formatted data, a poll 
name data field indicating a filename if one of the first and second computers is 

sending a poll request, a password data field containing an authorized user 
identification, and a message originator data field containing data indicating the 

identity of the sender of daid formatted data. 
The method of claim 42 wherein said extended header contains a 
message recipient data field containing data indicating a list of all recipients of said 

formatted data. 
The method of claim 54 wherein said message recipient data field 
comprises a recipient name, and a recipient address. 
The method of claim 42 wherein said attachment data block is 
encoded using ASN-1 encoding before transmissio
n to the second computer. 
The method of claim 42 wherein said attachment data block is 
compressed before transmission to the second computer. 
The method of claim 42 wherein said attachment data block is 
encrypted before transmission to the second computer. 
</CLAIMS>
</TEXT>
</DOC>
