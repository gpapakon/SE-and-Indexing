<DOC>
<DOCNO>EP-0652536</DOCNO> 
<TEXT>
<INVENTION-TITLE>
Method and apparatus for estimating motion vector fields by rejecting local outliers
</INVENTION-TITLE>
<CLASSIFICATIONS>H04N732	G06T720	H04N732	G06T720	H04N701	H04N701	</CLASSIFICATIONS>
<CLASSIFICATIONS-THIRD>H04N	G06T	H04N	G06T	H04N	H04N	</CLASSIFICATIONS-THIRD>
<CLASSIFICATIONS-FOURTH>H04N7	G06T7	H04N7	G06T7	H04N7	H04N7	</CLASSIFICATIONS-FOURTH>
<ABSTRACT>
An image analysis system generates a motion 
vector field from first and second images in a sequence 

of steps. First, random, initial motion vector values 
are assigned to each pixel in the image frame. Next, an 

objective function is defined for each motion vector and 
its corresponding motion vector in the other frame. The 

differences between the motion vectors of the target 
pixel value in the current frame and the other frame are 

minimized by minimizing the objective function values, 
first based on all neighboring pixel values. Next, the 

motion vector differences are further minimized by 
reducing the objective function values by rejecting 

motion vectors which correspond to the neighboring pixel 
values for which the value of the difference between the 

respective objective functions is outside of a threshold 
range. In one embodiment of the invention, pixel values 

in the first image frame are compared to neighboring 
pixel values in a second image frame which occurs after 

the first image and to other neighboring pixel values in 
a third image frame which occurs before the first image 

frame. This embodiment substantially eliminates motion 
vector errors due to both motion discontinuities and 

occlusion of pixels in the image. 

</ABSTRACT>
<APPLICANTS>
<APPLICANT-NAME>
MATSUSHITA ELECTRIC IND CO LTD
</APPLICANT-NAME>
<APPLICANT-NAME>
MATSUSHITA ELECTRIC INDUSTRIAL CO., LTD.
</APPLICANT-NAME>
</APPLICANTS>
<INVENTORS>
<INVENTOR-NAME>
IU SIU-LEONG
</INVENTOR-NAME>
<INVENTOR-NAME>
IU, SIU-LEONG
</INVENTOR-NAME>
</INVENTORS>
<DESCRIPTION>
The present invention relates to the analysis
of sequences of images, made up of picture elements
(pixels), which exhibit motion and, in particular, to
apparatus and a method for estimating motion vector
fields in a sequence of moving images.A motion vector field is a pixel-by-pixel map
of image motion from one image frame to the next image 
frame. Each pixel in the frame has a motion vector which
defines a matching pixel in the next frame or in a
previous frame. The combination of these motion vectors
is the motion vector field.Although the techniques described herein could
easily be applied to image components other than frames,
such as image fields or portions of image frames, the
description below refers only to image frames so as to
avoid confusion in terminology with the fields of motion
vectors.The estimation of motion vector fields is an
important task in many areas of endeavor such as computer
vision, motion compensated coding of moving images, image
noise reduction and image frame-rate conversion. The
problem of estimating motion vector fields is inherently
difficult to understand. This is because many different
sets of motion vector fields can be used to describe a
single image sequence.One simple approach is to assume that a block
of pixels moves with the same kind of motion such as
constant translation or an affine motion. This kind of
block matching approach frequently fails to produce a
good estimation of motion because it disregards the
motion of pixels outside of the block. Thus, the motion
model may be incorrect for describing the true motion of 
pixels within a block when the block size is large and
may be significantly affected by noise when the block
size is small.Conventional approaches to the problem of
estimating motion vector fields typically require
simultaneously solving equations having several thousand
unknown quantities. Numerous techniques, based on
gradients, correlation, spatiotemporal energy functions
and feature matching have been proposed. These
techniques have relied upon local image features such as
the intensity of individual pixels and on more global
features such as edges and object boundaries.Recently, two processes have been proposed
which have successfully solved two problems in motion
vector estimation: motion vector discontinuity and
occlusion. The first of these is these processes is the
"line process" described in a paper by J. Konrad et al
entitled "Bayesian Estimation of Motion Vector Fields"
IEEE Transactions on Pattern Analysis and Machine
Intelligence,
</DESCRIPTION>
<CLAIMS>
Apparatus for generating sample values representing a motion vector
field (d
l
) which describes motion of individual image components (x
i
) of a current
image frame (g
k
) and corresponding image components of at least one other image
frame (g
k+1
) in a sequence of image frames (..., g
k-1
, g
k
, g
k+1,
...), the apparatus
comprising:


initialization means (P
0-0
 - P
Nv-1
, 
Nh-1
) for generating a plurality of motion
vectors (d
l
(x
i
)), each of said plurality of motion vectors (d
l
(x
i
)) corresponding to an
estimate of motion between one of the image components (x
i
) in the current image
frame (g
k
) and a corresponding image component in the one other image frame;
means for generating an energy function value (U
GS
(d
l
)) for a target
motion vector of the plurality of motion vectors (d
l
(x
i
)) which target motion vector
corresponds to a current image component (x,) in the current image frame (g
k
), said
energy function value (U
GS
(d
l
)) being a function of the target motion vector and of
neighboring motion vectors which neighboring motion vectors are ones of the plurality

of motion vectors which correspond to ones of the image components that surround the
current image component (x
i
) in the current image frame (g
k
), wherein each one of the
neighboring motion vectors is ignored as being an outlier motion vector if the one

neighboring motion vector differs from the target motion vector by more than a
threshold which is defined by a predetermined constant (T
or
) and the differences
between the target motion vector and each of a predetermined number (r) of

neighbouring motion vectors; and
means for iteratively minimizing the energy function value (U
GS
(d
l
)) of
the current image frame (g
k
) by iteratively modifying the plurality of motion vectors
(d
l
(x
i
)) to produce the sample values representing the motion vector field and for
iteratively generating energy function values for the plurality of motion vectors.
Apparatus according to claim 1, wherein each image component is an
individual picture element (pixel) of the image.
Apparatus according to claim 1, wherein each image component
includes a plurality of individual picture elements (pixels).
Apparatus according to one of the preceding claims, wherein the
means for generating an energy function value (U
GS
(d
l
)) for the target motion vector
includes means for rejecting the outlier motion vector as a function of only the

neighboring motion vectors which are adjacent to the target motion vector in the motion
vector field.
Apparatus according to claim 4, wherein the means for generating the
energy function value (U
GS
(d
l
)) includes:

means for comparing each of N
C
 neighboring motion vectors which
surround the target motion vector, where N
C
 is a positive integer, to identify a
predetermined number of the N
C
 neighboring motion vectors which have larger
magnitudes than any other ones of the N
C
 neighboring motion vectors; and
means for rejecting the identified neighboring motion vectors as the
outlier motion vectors.
Apparatus according to claim 4, wherein the means for generating the
energy function value (U
GS
(d
l
)) includes:

means for evaluating each of N
C
 neighboring motion vectors which
surround the target motion vector, where N
C
 is a positive integer, to assign a magnitude
value to each of the N
C
 neighboring motion vectors;
means for identifying one of the assigned magnitude values as being a
median magnitude value for the N
C
 neighboring motion vectors; and
means for rejecting the identified neighboring motion vectors which have
magnitude values greater than the median magnitude value as being the outlier motion

vectors.
Apparatus according to claim 4, wherein the means for minimizing
the respective energy function includes means for switching the means for generating

the energy function value, at a predetermined instant in the iterative process, from
using a first energy function to generate the energy function values, which first energy

function uses all neighboring motion vectors, to use a second energy function to
generate the energy function values, which second energy function rejects outlier

motion vectors.
Apparatus according to one of the preceding claims, wherein the
motion vector field describes the motion of individual image components of the current

image frame and corresponding image components in a first and second image frame
which differ from the current frame, wherein:


the initialization means includes means for generating a first plurality of
motion vectors, each of said first plurality of motion vectors corresponding to an

estimate of motion between one of the image components in the current image frame
and a corresponding image component in the first image frame, and for generating a

second plurality of motion vectors, each of said second plurality of motion vectors
corresponding to an estimate of motion between one of the image components in the

current image frame and a corresponding image component in the second image frame;
and
the means for generating an energy function value for the target motion
vector includes:


means for generating a first energy function value for the target motion
vector, the first energy function value being a function of the target motion vector and

respective neighboring ones of the first plurality of motion vectors;
means for generating a second energy function value for the target
motion vector, the second energy function value being a function of the target motion

vector and respective neighboring ones of the second plurality of motion vectors; and
means for selecting, as the generated energy function value, one of the
first and second energy function values based on differences in magnitude between the

first and second energy function values.
Apparatus according to claim 8, wherein the means for generating an
energy function value for the target motion vector includes:


means for generating a third energy function value for the target motion
vector, the third energy function value being a function of the target motion vector, the

neighboring ones of the first plurality of motion vectors and the neighboring ones of the
second plurality of motion vectors; and
means for selecting, as the generated energy function value, one of the
first, second and third energy function values based on differences in magnitude among

the first, second and third energy function values.
Apparatus according to one of the preceding claims, wherein the
means for minimizing the energy function value in the current image frame includes

means for processing a plurality of the energy function values using a simulated
annealing algorithm.
A method of generating sample values representing a motion vector
field (d
l
) which describes motion of individual image components (x
i
) of a current
image frame (g
k
) and corresponding image components of at least one other image
frame (g
k+1
) in a sequence of image frames (..., g
k-1
, g
k
, g
k+1
, ...), the method
comprising the steps of:


a) generating (712) a plurality of motion vectors (d
l
(x
i
)), each of the plurality of
motion vectors (d
l
(x
i
)) corresponding to a respectively different one of the image
components (x
i
) in the current image frame (g
k
);
b) generating (714) an energy function value (U
GS
(d
l
)) for a target motion vector
(d
l
(x
i
)) of the plurality of motion vectors (d
l
(x
i
)), which target motion vector
(d
l
(x
i
) corresponds to a current image component (x
i
) in the current image frame
(g
k
), said energy function (U
GS
(d
l
)) being a function of the target motion vector
(d
l
(x
i
)) and of neighboring motion vectors (d
l
(x
i
)) which neighboring motion
vectors (d
l
(x
i
)) are ones of the plurality of motion vectors that correspond to ones
of image components (x
j
) that surround the current image component (x
i
) in the
current image frame (g
k
), wherein each one of the neighboring motion vectors 
(d
l
(x
j
)) is ignored as being an outlier motion vector if the one neighboring motion
vector (d
l
(x
j
)) differs from the target motion vector (d
l
(x
i
)) by more than a
threshold which is defined by a predetermined constant (T
or
) and the differences
between the target motion vector and each of a predetermined number (r) of

neighbouring motion vectors; and
c) iteratively minimizing the energy function value (U
GS
(d
l
)) of the current image
frame (g
k
) by iteratively modifying the motion vectors to produce the sample
values representing the motion vector field and iteratively generating energy

function values (U
GS
(d
l
)) for the plurality of motion vectors (d
l
(x
i
)).
A method according to claim 11, wherein each image component is
an individual picture element (pixel) of the image.
A method according to claim 11, wherein each image component
includes a plurality of individual picture elements (pixels).
A method according to one of claims 11 to 13, wherein step b)
includes the step of rejecting the outlier motion vector based only on the neighboring

motion vectors which are adjacent to the target motion vector in the motion vector
field.
Method according to claim 14, wherein step b) includes the step of
switching, at a predetermined instant in the iterative process, from using a first energy

function, which uses all neighboring motion vectors, to generate the energy function
value to using a second energy function, which rejects outlier motion vectors, to

generate the energy function value.
A method according to claim 11, wherein the motion vector field
describes the motion of individual image components of the current image frame and

corresponding image components in first and second image frames which differ from
the current image frame, wherein: 


step a) includes the steps of generating a first plurality of motion vectors,
each of the first plurality of motion vectors corresponding to an estimate of motion

between one of the pixels in the current image frame and a corresponding pixel in the
first image frame, and generating a second plurality of motion vectors, each of the

second plurality of motion vectors corresponding to an estimate of motion between one
of the image components in the current image frame and a corresponding image

component in the second image frame; and
step b) includes the steps of:

generating a first energy function value for the target motion vector, the
first energy function value being a function of the target motion vector and respective

neighboring ones of the first plurality of motion vectors;
generating a second energy function value for the target motion vector,
the second energy function being a function of the target motion vector and respective

neighboring ones of the second plurality of motion vectors; and
selecting, as the generated energy function value, one of the first and
second energy function values based on differences in magnitude between the first and

second energy function values.
A method according to claim 16, wherein the step of generating an
energy function value for the target motion vector includes the steps of:


generating a third energy function value for the target motion vector, the
third energy function value being a function of the target motion vector, the

neighboring ones of the first plurality of motion vectors and the neighboring ones of the
second plurality of motion vectors; and
selecting, as the generated energy function value, one of the first, second
and third energy function values based on differences in magnitude among the first,

second and third energy function values.
A method according to claim 11, wherein step c) includes the step of
processing a plurality of the energy function values using a simulated annealing

algorithm.
</CLAIMS>
</TEXT>
</DOC>
