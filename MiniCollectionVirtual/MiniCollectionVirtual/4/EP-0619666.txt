<DOC>
<DOCNO>EP-0619666</DOCNO> 
<TEXT>
<INVENTION-TITLE>
Rotationally invariant trellis coded modulation system
</INVENTION-TITLE>
<CLASSIFICATIONS>H03M1300	H04L2734	H03M1323	H03M1325	H04L2734	H04L2508	H04L2508	H04L2700	H04L2700	</CLASSIFICATIONS>
<CLASSIFICATIONS-THIRD>H03M	H04L	H03M	H03M	H04L	H04L	H04L	H04L	H04L	</CLASSIFICATIONS-THIRD>
<CLASSIFICATIONS-FOURTH>H03M13	H04L27	H03M13	H03M13	H04L27	H04L25	H04L25	H04L27	H04L27	</CLASSIFICATIONS-FOURTH>
<ABSTRACT>
A trellis-coded modulation system is provided in which the output of the trellis encoder 
(110) is used to select a subset of a multidimensional QAM constellation. The selection 

process is performed such that a) the minimum square Euclidean distance between valid 
sequences of successive selected subsets is maximized, b) the resulting code is rotationally 

invariant, and c) the selected subset corresponding to a transition of the trellis encoder from 
a present state i to a different next state j is different from the selected subset that corresponds 

to a transition of the trellis encoder from a present state j to a next state i. 

</ABSTRACT>
<APPLICANTS>
<APPLICANT-NAME>
AT 
&
 T CORP
</APPLICANT-NAME>
<APPLICANT-NAME>
AT
&
T CORP.
</APPLICANT-NAME>
</APPLICANTS>
<INVENTORS>
<INVENTOR-NAME>
WEI LEE-FANG
</INVENTOR-NAME>
<INVENTOR-NAME>
WEI, LEE-FANG
</INVENTOR-NAME>
</INVENTORS>
<DESCRIPTION>
This invention relates to methods for selecting a sequence of signal
points from a 4-dimensional QAM constellation, to transmitter apparatus, to methods
for use in a receiver, to receiver apparatus, and to trellis encoders, and finds application,
for example, in voiceband data transmission (e.g. modem) applications.Various techniques have been used to improve the bandwidth efficiency
and noise immunity of communication channels. One particularly useful technique is
rotationally-invariant, multidimensional trellis-coded modulation. Such codes have
been disclosed, for example, in U.S. Patent 4,713,817, issued December 15, 1987,
entitled "Multidimensional, Convolutionally Coded Communication Systems."
However, certain prior art codes had a defect in that the same sequence of signal points
can be generated by the trellis encoder when the trellis encoder traverses two different
paths of trellis states.This defect in the prior art is not easily corrected, especially when the
code must, at the same time, achieve rotational invariance and a large amount of coding
gain.According to a first aspect of this invention there is provided a method as
claimed in claim 1.According to a second aspect of this invention there is provided
transmitter apparatus as claimed in claim 6.According to a third aspect of this invention there is provided a method
as claimed in claim 11.According to a fourth aspect of this invention there is provided receiver
apparatus as claimed in claim 16. The defect of the prior art is overcome, while maintaining rotational
invariance and a large amount of coding gain, by providing a novel trellis code in which
the trellis encoder is operated such that the selected subset corresponding to a transition
of the trellis encoder from a present state i to a different next state j is different from the
selected subset that corresponds to a transition of the trellis encoder from a present state
j to a next state i.Fig. 1 is a block diagram of the transmitter portion of a communication
system utilizing a trellis-coded modulation scheme embodying the principles of the
invention; FIG. 2 is a block diagram of the receiver portion of a communication system capable
of receiving and processing the signals generated by the transmitter of FIG. 1;FIG. 3 shows a two-dimensional constellation that may be used in the transmitter of
FIG. 1 either by itself or as a constituent of a higher-dimensional constellation;FIG. 4 is a schematic diagram of an exemplary embodiment of the trellis encoder of
the transmitter of FIG.
</DESCRIPTION>
<CLAIMS>
A method for selecting a sequence of signal points from a 4-dimensional,
herein after referred to as 4D, QAM constellation to represent a sequence of input bits,

the constellation having four phase symmetries, the method comprising the steps of:

applying, during each 4D signaling interval, a first portion of the input bits to a
rate-4/5 trellis encoder which transitions from a present state to a next state and generates

trellis encoded bits;
selecting, in response to the trellis encoded bits, one of a plurality of subsets of
the 4D constellation;
identifying, in response to a second portion of the input bits, a 4D signal point
from the selected subset; and
generating an output signal representing a valid sequence of successive identified
4D signal points; and

   wherein a valid sequence of signal points becomes another valid sequence of
signal points after 90, 180, and 270 degree rotations, and 
characterized in that
 the trellis
encoder is configured to select a different subset for a transition of the trellis encoder

from a present state i to a next state j than the subset selected for a transition of the trellis
encoder from the present state j to the next state i when the states i and j are different.
A method as claimed in claim 1 wherein:

the plurality of subsets form first and second families of subsets, each family of
subsets being evenly divided into a plurality of groups of subsets having four subsets in

each group, the subsets within each group being obtainable from each other through 90
degree phase rotations;
the trellis encoder occupies one of a plurality of states being divided into first and
second categories, and from each present state, half of the transitions will lead to next

states in the first category and half of the transitions will lead to next states in the second
category;
the subsets that are associated with state transitions from present states in the first
category belong to the first family and the subsets that are associated with state

transitions from present states in the second category belong to the second family; and 
for each group of subsets that is associated with state transitions from a present
state, two subsets of the group are associated with state transitions from a present state to

next states in the first category and two subsets of the group are associated with state
transitions from a present state to next states in the second category.
A method as claimed in claim 1 comprising the step of:

differentially encoding, prior to trellis encoding, selected ones of the first portion
of the input bits.
A method as claimed in claim 1 wherein the rate -4/5 trellis encoder is a
finite state machine having 64 states.
A method as claimed in claim 1 wherein the rate -4/5 trellis encoder is
invariant to 90, 180, and 270 degree rotations of the constellation.
Transmitter apparatus comprising:

a rate -4/5 trellis encoder (110) which, for each 4-dimensional, hereinafter
referred to as 4D, signal interval, transitions from a present state to a next state and

generates trellis encoded bits:

means (104) for applying to the trellis encoder first predetermined ones of a

plurality of input bits received by the transmitter during a 4D signaling interval; and
mapping means (116) for providing channel signal points selected from a
predetermined 4D QAM signal constellation in response to the output of the trellis

encoder and second predetermined ones of the input bits,

   wherein a valid sequence of successive channel signal points becomes another
valid sequence of signal points after 90, 180, and 270 degree rotations of the

constellation, and

   
characterized in that
 the trellis encoder is configured to output different patterns
of bits for a transition of the trellis coder from a present state i to a next state j and for a

transition of the trellis encoder from the present state j to the next state i when the states i
and j are different. 
Apparatus as claimed in claim 6 wherein:

the signal points are grouped into a plurality of subsets, the plurality of subsets
forming first and second families of subsets, each family of subsets being evenly divided

into a plurality of groups of subsets having four subsets in each group, the subsets within
each group being obtainable from each other through 90 degree phase rotations;
the trellis encoder occupies one of a plurality of states, the plurality of states being
divided into first and second categories, and from each present state, half of the

transitions will lead to next states in the first category and half of the transitions will lead
to next states in the second category;
the subsets that are associated with state transitions from present states in the first
category belong to the first family and the subsets that are associated with state

transitions from present states in the second category belong to the second family; and
for each group of subsets that is associated with state transitions from a present
state, two subsets of the group are associated with state transitions from a present state to

next states in the first category and two subsets of the group are associated with state
transitions from a present state to next states in the second category.
Apparatus as claimed in claim 6 comprising:

means (106) for differentially encoding, prior to trellis encoding, selected ones of
the first portion of the input bits.
Apparatus as claimed in claim 6 wherein the rate -4/5 trellis encoder is a
finite state machine having 64 states.
Apparatus as claimed in claim 6 wherein the rate -4/5 trellis encoder is
invariant to 90, 180, and 270 degree rotations of the constellation.
A method for use in a receiver to which has been transmitted a signal
representing a sequence of signal points selected from a 4-dimensional, herein after 

referred to as 4D, QAM constellation to represent a sequence of input bits, the
constellation having four phase symmetries, the method comprising the steps of:


receiving said transmitted signal; and
recovering the sequence of input bits from the received signal based on the
transmitted signal having been generated by:


applying, during each 4D signaling interval, a first portion of the input bits to a
rate-4/5 trellis encoder which transitions from present states to next states and generates

trellis encoded bits;
selecting, in response to the trellis encoded bits, one of a plurality of subsets of
the 4D constellation;
identifying, in response to a second portion of the input bits, a 4D signal point
from the selected subset; and
generating an output signal representing a valid sequence of successive identified
4D signal points; and

   wherein a valid sequence of signal points becomes another valid sequence of
signal points after 90, 180, and 270 degree rotations; and

   
characterized in that
 the selected subset corresponding to a transition from a
present state i to a next state j is different than the selected subset corresponding to a

transition from the present state j to the next state i when the states i and j are different
A method as claimed in claim 11 wherein:

the plurality of subsets form first and second families of subsets, each family of
subsets being evenly divided into a plurality of groups of subsets having four subsets in

each group, the subsets within each group being obtainable from each other through 90
degree phase rotations;
the states being divided into first and second categories, and from each present
state, half of the transitions will lead to next states in the first category and half of the

transitions will lead to next states in the second category;
the subsets that are associated with state transitions from present states in the first
category belong to the first family and the subsets that are associated with state

transitions from present states in the second category belong to the second family; and 
for each group of subsets that is associated with state transitions from a present
state, two subsets of the group are associated with state transitions from a present state to

next states in the first category and two subsets of the group are associated with state
transitions from a present state to next states in the second category.
A method as claimed in claim 11 wherein the means for recovering is
configured to differentially decode, after maximum-likelihood-type decoding, selected

ones of the first portion of the input bits.
A method as claimed in claim 11 wherein the transitions are capable of
between 64 states.
A method as claimed in claim 11 wherein the constellation is invariant
under 90, 180, and 270 degree rotations.
Receiver apparatus for receiving a signal representing a sequence of signal
points selected from a 4-dimensional, hereinafter referred to as 4D, QAM constellation to

represent a sequence of input bits, the constellation having four phase symmetries, the
apparatus comprising:


means (input of 200) for receiving said signal; and
means (200, 202, 204, 206, 208) for recovering the sequence of input bits from
the received signal, the means for recovering based on the transmitted signal having been

generated by the steps of:

applying, during each 4D signaling interval, a first portion of the input bits to a
rate-4/5 trellis encoder which transitions from present states to next states and generates

trellis encoded bits;
selecting, in response to the trellis encoded bits, one of a plurality of subsets of
the 4D constellation;
identifying, in response to a second portion of the input bits, a 4D signal point
from the selected subset; and 
generating an output signal representing a valid sequence of successive identified
4D signal points; and

   wherein a valid sequence of signal points becomes another valid sequence of
signal points after 90, 180, and 270 degree rotations; and

   
characterized in that
 the selected subset for a transition from a present state i to a
next state j differs from the selected subset for a transition from the present state j to the

next state i when the states i and j are different.
Apparatus as claimed in claim 16 wherein:

the plurality of subsets form first and second families of subsets, each family of
subsets being evenly divided into a plurality of groups of subsets having four subsets in

each group, the subsets within each group being obtainable from each other through 90
degree phase rotations;
the states being divided into first and second categories, and from each present
state, half of the transitions will lead to next states in the first category and half of the

transitions will lead to next states in the second category;
the subsets that are associated with state transitions from present states in the first
category belong to the first family and the subsets that are associated with state

transitions from present states in the second category belong to the second family; and
for each group of subsets that is associated with state transitions from a present
state, two subsets of the group are associated with state transitions from a present state to

next states in the first category and two subsets of the group are associated with state
transitions from a present state to next states in the second category.
Apparatus as claimed in claim 16 wherein the means for recovering
comprises a Viterbi decoder (202) whose output connects to a differential decoder (204).
Apparatus as claimed in claim 16 wherein the transitions occur between
64 states. 
Apparatus as claimed in claim 16 wherein the constellation is invariant
under 90, 180, and 270 degree rotations.
</CLAIMS>
</TEXT>
</DOC>
