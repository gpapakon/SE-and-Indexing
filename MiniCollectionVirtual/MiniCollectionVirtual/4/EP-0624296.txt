<DOC>
<DOCNO>EP-0624296</DOCNO> 
<TEXT>
<INVENTION-TITLE>
MEANS TO AVOID DATA DISTORSION IN CLOCK-SYNCHRONIZED SIGNAL SAMPLING.
</INVENTION-TITLE>
<CLASSIFICATIONS>H04L700	H04L700	H04L7027	H04L7027	H04L2538	H04L2538	</CLASSIFICATIONS>
<CLASSIFICATIONS-THIRD>H04L	H04L	H04L	H04L	H04L	H04L	</CLASSIFICATIONS-THIRD>
<CLASSIFICATIONS-FOURTH>H04L7	H04L7	H04L7	H04L7	H04L25	H04L25	</CLASSIFICATIONS-FOURTH>
<ABSTRACT>
Signal-sampling apparatus wherein information signals are directed to a register (24) under the control of first clock pulses (CLK 1) and are latched into the register under the control of second clock pulses (CLK 2). A calibrator (40) monitors the timing of the first and second clock pulses to determine if they are so close together that data signals subsequently output from the register will be distorted so as to cause errors in downstream devices. If such condition is found, the calibrator (40) inverts the phase of the second clock pulses (CLK 2) to assure proper time spacing to avoid data corruption.
</ABSTRACT>
<APPLICANTS>
<APPLICANT-NAME>
ANALOG DEVICES INC
</APPLICANT-NAME>
<APPLICANT-NAME>
ANALOG DEVICES, INCORPORATED
</APPLICANT-NAME>
</APPLICANTS>
<INVENTORS>
<INVENTOR-NAME>
MORLEY SEAN
</INVENTOR-NAME>
<INVENTOR-NAME>
MORLEY, SEAN
</INVENTOR-NAME>
</INVENTORS>
<DESCRIPTION>
 MEANS TO AVOID DATA DISTORTION IN CLOCK-SYNCHRONIZED SIGNAL SAMPLINGBACKGROUND OF THE INVENTION1. Field of the InventionThis invention relates to clock-pulse-activated sampling and/or storage of signal information. More par¬ ticularly, this invention relates to means for preventing distortion of the transferred data when the data input can change at a time which is close to the sampling time.2. Description of the Prior ArtIt is known that data alteration can occur in a clock-controlled signal sampling system if a change in input signal occurs too close in time to the active clock edge. The data alteration is caused by an abnormally long propagation delay within a storage device (such as a register) before the output of the storage data becomes valid; such abnormal propagation delay in turn is caused by meta-stable behavior within the device. The distortion may appear as an error in the device output (e.g. a zero rather than a one) , or it may appear as an undue delay in the output data becoming valid. 

 Such data distortion can occur both for signal transitions preceding the clock edge as well as for tran¬ sitions following the clock edge. That is, there is a tim¬ ing "window" around the active clock edge within which a change in input signal will have a finite probability of causing an error in either stored data, or the data transferred to a downstream device.Figure 1 shows an exemplary application where such data distortion (sometimes referred to as data corruption) can occur. The apparatus of Figure 1 is based on a prior art video sub-system such as shown in U.S. Patent Applica¬ tion Serial No. 655,309 filed March 6, 1991 by Denis O'Mahony (see for example Figure 10 thereof) . In such a system, the video signals for controlling a CRT are stored in a Frame Store 20 for subsequent transfer to a video RAM-DAC 22 forming part of an integrated-circuit (IC) chip. The data (I) is transferred from the Frame Store to a first flip-flop register 24 where it is clocked in by a signal identified as CLK1. This clock signal is developed by the clock logic 26 associated with the Frame Store 20 as part of the graphics board. The initially stored data then is transferred (Q) to a second flip-flop register 28 where it is clocked in by CLK2. This clock signal is derived from a pulse- frequency divider 30 activated by an external oscillator 32. The output of the divider also is directed to the clock logic 26 and is used among other things to generate CLK1.Referring now also to Figure 2, there is shown a timing diagram
</DESCRIPTION>
<CLAIMS>
What is Claimed is:
1. In a system where a signal is supplied under control of first clock pulses CLKl to the input of a device, and wherein the signal is clocked into the device under the control of second clock pulses CLK2 synchronous with the first clock pulses but having an arbitrary time relationship therewith; that improvement for effecting proper timing relations between CLKl and CLK2 for avoiding errors due to distortion of the data clocked into said device, comprising: monitor means responsive to the two clock pulses CLKl and CLK2 to analyze the phase relationship between those pulses and to determine whether CLKl occurs too close to CLK2; and correction means under the control of said monitor means to alter the timing of at least one of said clock pulses when necessary to assure that the CLKl pulses occur sufficiently time-spaced from the CLK2 pulses.
2. Apparatus as claimed in Claim 1, wherein said correction means includes means to alter the phase of said CLK2 pulses.
3. Apparatus as claimed in Claim 2, wherein said correction means includes means to alter the phase of said CLK2 pulses by inverting those pulses.
4. Apparatus as claimed in Claim 1, wherein said device has setup and hold time requirements which must be met to insure valid data transfer; said monitor means comprising first means responsive to said CLKl pulses to produce a first control pulse (WIN) having a duration at least equal to the combined setup and hold times of said device; 


 second means responsive to said CLK2 pulses to produce a second control pulse (TEST) the leading edge of which is delayed by at least said hold time beyond the CLK2 pulse; and output means responsive to both said first and second control pulses for generating a control signal for said correction means whenever said second control pulse is initiated while said first control pulse is high.
5. Apparatus as claimed in Claim 4, wherein the leading edge of said first control pulse is delayed by an inherent time delay (T3) after CLKl; said second control pulse being delayed after CLK2 by a time corresponding to said hold time combined with said time delay (T3) .
6. Apparatus as claimed in Claim 5, wherein said hold time is combined subtractively with said time delay (T3) .
7. A calibrator for monitoring first and second syn¬ chronous clock signals controlling the input to a receiving device and for producing an output signal whenever one of the clock signals occurs within a forbidden time window with respect to the other clock signal, said time window representing both a setup time and a hold time for said device, said calibrator comprising: first pulse-generating means responsive to said first clock signal for producing a window pulse having a duration at least as wide as said forbidden time window; second pulse-generating means responsive to said second clock signal for producing a test pulse at a specified time delay after said second clock signal, said specified time delay including said hold time; and means responsive to said window and test pulses for producing said output signal when said test pulse is activated during the time of said window pulse. 


8. Apparatus as claimed in Claim 7, wherein said first pulse-generating means comprises a set-reset flip-flop wherein the set input is coupled to the output of a pulse generator activated by said first clock pulses; and the reset input of said flip-flop is coupled to the output of a pulse-generator activated by said first pulses through a delay means corresponding to at least said setup and hold times, thereby to control the time duration of said window pulse.
9. Apparatus as claimed in Claim 8, wherein said second pulse-generating means comprises a time-delay means responsive to said second clock signals and operable to produce said test pulse.
10. Apparatus as claimed in Claim 9, wherein said time-delay means delays said test pulse by a time period which includes said hold time.
11. Apparatus as claimed in Claim 10, wherein the leading edge of said window pulse is delayed by a predetermined time period (T3) ; said test pulse delay means being operable to delay said test pulse by a time corresponding to said hold time and to said particular time period.
12. Apparatus as claimed in Claim 7, including means responsive to power-up of the apparatus incorporating said register to activate said calibrator upon such power-up. 


13. Apparatus as claimed in Claim 7, wherein said means responsive to said window and test pulses has setup and hold time requirements which should be met to assure that said output signal thereof is valid; means responsive to said output signal and to a control signal for producing a toggle signal to effect a change in timing of one of said clock signals when said output signal goes high; and means to delay application of said control signal to said responsive means to provide sufficient time to enable said output signal to reach a valid state if the setup or hold time requirements of said means responsive to said window and test pulses are not met.
14. Apparatus as claimed in Claim 13, wherein said means responsive to said window and test pulses is a Test flip-flop clocked by said test pulses.
15. Apparatus as claimed in Claim 14, wherein said means responsive to said output signal is a flip-flop the output of which is said toggle signal.
16. In a system where a signal is supplied under control of first clock pulses CLKl to the input of a device, and wherein the signal is clocked into the device under the control of second clock pulses CLK2 synchronous with the first clock pulses but having an arbitrary time relationship therewith; the method of assuring proper timing relations between CLKl and CLK2 for avoiding errors due to distortion of data clocked into said device comprising the steps of: monitoring said first and second clock pulses; determining whether the time spacing between said first and second clock pulses is so close as to be likely to cause data distortion in said device; and 


 automatically adjusting the time spacing between said clock pulses to assure that data distortion is avoided.
17. The method as claimed in Claim 16, including the step of controlling the start of said monitoring operation upon power-up of said system.
18. The method as claimed in Claim 16, wherein said adjusting is effected by altering the phase of one of said clock pulses.
19. The method as claimed in Claim 18, wherein said phase is altered by inverting one of said clock pulses. 

</CLAIMS>
</TEXT>
</DOC>
