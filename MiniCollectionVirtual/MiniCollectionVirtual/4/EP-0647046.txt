<DOC>
<DOCNO>EP-0647046</DOCNO> 
<TEXT>
<INVENTION-TITLE>
Procedure and device for phase ambiguity resolution in a trellis coded modulation system.
</INVENTION-TITLE>
<CLASSIFICATIONS>H04L2700	H04L2700	H04L27233	H04L27233	</CLASSIFICATIONS>
<CLASSIFICATIONS-THIRD>H04L	H04L	H04L	H04L	</CLASSIFICATIONS-THIRD>
<CLASSIFICATIONS-FOURTH>H04L27	H04L27	H04L27	H04L27	</CLASSIFICATIONS-FOURTH>
<ABSTRACT>
The device for phase ambiguity resolution uses the same 
branch metrics of the correlation type used by the Viterbi decoder. 

At each symbol time it chooses the best branch metric among those 
departing from the final state of the most probable path identified 

by the Viterbi decoder and accumulates it for a pre-set number of 
symbol times while observing whether the sum obtained exceeds or 

not a given threshold. In the former case the demodulated signal 
phase is considered to be correct while in the latter case the phase is 

considered to be erroneous and an algorithm for performing phase 
counter-rotation on the received signal is 

activated. 

</ABSTRACT>
<APPLICANTS>
<APPLICANT-NAME>
SITS SOC IT TELECOM SIEMENS
</APPLICANT-NAME>
<APPLICANT-NAME>
ITALTEL S.P.A.
</APPLICANT-NAME>
</APPLICANTS>
<INVENTORS>
<INVENTOR-NAME>
BENEDETTO SERGIO C O POLITECNI
</INVENTOR-NAME>
<INVENTOR-NAME>
MAGNANI VILMA
</INVENTOR-NAME>
<INVENTOR-NAME>
MONDIN MARINA C O POLITECNICO
</INVENTOR-NAME>
<INVENTOR-NAME>
PASELLO FABIO
</INVENTOR-NAME>
<INVENTOR-NAME>
BENEDETTO, SERGIO, C/O POLITECNICO DI TORINO
</INVENTOR-NAME>
<INVENTOR-NAME>
MAGNANI, VILMA
</INVENTOR-NAME>
<INVENTOR-NAME>
MONDIN, MARINA, C/O POLITECNICO DI TORINO
</INVENTOR-NAME>
<INVENTOR-NAME>
PASELLO, FABIO
</INVENTOR-NAME>
</INVENTORS>
<DESCRIPTION>
The present invention relates to a procedure and device for 
phase ambiguity resolution in demodulators with trellis coded 
numerical modulation and Viterbi decoding. The invention which is the object of the present invention is 
applicable to numerical transmission systems with coding integrated 
in the modulation. In this environment coding of the digital signal 
and modulation process are not independent but intimately integrated 
to permit achieving performance in terms of error probability and 
band occupation better overall than the adoption of transmission 
systems without coding or employing a separate code. The modulation diagrams referred to use the known trellis codes, 
i.e. codes with memory, which work in such a manner that the sequence 
of signals transmitted is not made up of independent symbols but, on 
the contrary, each symbol is correlated with a certain number of 
preceding symbols. The trellis code theory is well known: see e.g. the article by 
S.S. Pietrobon and others entitled "Trellis-Coded Multidimensional 
Phase Modulation", IEEE Trans. on Information Theory, Vol. 36, No. 1, 
January 1990. The demodulator receives a sequence of signals potentially 
affected by noise and must establish which sequence of signals is 
transmitted, among those admissible in the paths defined by the 
trellis code, which with the highest probability corresponds to that 
received. For this purpose one of the systems most used makes use of a 
decoder operating on the basis of the known Viterbi algorithm. The 
Viterbi algorithm associates with each possible sequence transmitted, 
corresponding to each possible path in the trellis code, a metric, 
i.e. a measurement linked to the probability that that is the 
sequence actually transmitted, and rejects one by one the less 
probable paths while saving at each symbol time only one path for 
each state as explained in detail below. In this type of demodulator the problem of the presence of a  
 
phase ambiguity introduced from the carrier recovery circuits, 
present in the receiver upstream of the decoder, in the sequence of 
symbols received becomes critical. This is due to the fact that if 
trellis codes of the type invariant with phase rotations are not 
used, in the presence of undesired phase rotations errors not 
otherwise recoverable are introduced in the received symbols. The problem becomes that of recovering the phase rotations or 
ambiguities so that the Viterbi decoder works correctly. A first possible solution to this problem would consist of
</DESCRIPTION>
<CLAIMS>
Procedure for phase ambiguity resolution in demodulators 
with trellis coded numerical modulation and Viterbi decoding, said 

trellis coding causing successions of states which identify coding 
paths in the trellis, said numerical modulation transforming each 

state in a symbol represented by a pair of components in phase (P) 
and in quadrature (Q) in the modulation constellation plane, said 

Viterbi decoding calculating state metrics on the basis of branch 
metrics (Mn) for the possible paths in the trellis to determine at 

each symbol time a final state of the most probable path to be 
reconstructed, characterised in that for phase ambiguity resolution 

and Viterbi decoding are used branch metrics of the correlation 
type which calculate a correlation function of said component pairs 

in phase (P) and quadrature (Q) received; and in that at each 
symbol time is chosen the best branch metric (Mmaxk) among those 

departing from the final state of the most probable path, and are 
accumulated, said best branch metric (Mmaxk) for a pre-set number 

of symbol times (N), while observing whether the sum found exceeds 
or not a given threshold (THR), and if it does not exceed the 

threshold the phase being considered erroneous and there being 
activated a phase counter-rotation control procedure to be 

performed on said components pairs in phase (P) and in quadrature - 
(Q) received until said threshold (THR) is exceeded and the phase 

is considered correct. 
Procedure for phase ambiguity resolution as set forth in 
claim 1, characterized in that said phase counter-rotation control 

procedure to be performed on the signal received calls for rotation 
of said components in phase (P) and in quadrature (Q) alternately 

increasing and decreasing by progressive multiples of an angle of 
symmetry of the modulation signal constellation, and for repeating 

at each rotation said operations of choice and accumulation of the 
best branch metrics and comparison with the threshold until said 

threshold is exceeded and the phase is considered correct. 
Procedure for phase ambiguity resolution as set forth in 
claim 1 or 2, characterized in that said branch metrics (Mn) of the 

correlation type are calculated in accordance with the expression:   Mn = PrPn + QrQn  

 where the components Pr, Qr are those of the 
 

signal received optionally phase rotated and the components Pn, Qn 
are those of each of the possible modulation constellation signals. 
Device for phase ambiguity resolution in demodulators with 
trellis coded numerical modulation and Viterbi decoding, a trellis 

coder causing successions of states which identify coding paths in 
the trellis, a numerical modulator transforming each state in a 

symbol represented by a pair of components in phase (P) and in 
quadrature (Q) in the constellation modulation plane, a Viterbi 

decoder calculating state metrics on the basis of branch metrics 
(Mn) for possible paths in the trellis to determine at each symbol 

time a final state of the most probable path (SPP) to be 
reconstructed, characterised in that it comprises: 


calculation means (CMR) for the branch metrics of the 
correlation type for said component pairs in phase (P) and in 

quadrature (Q) in reception; 
first comparison means (CMP1) of said branch metrics, which 
determine for each symbol time the highest branch metric (Mmaxk) 

among those received from said calculation means (CMR) and chosen 
on the basis of said final state of the most probable path (SPP) 

which it receives from the Viterbi decoder; 
accumulator means (ACC) which calculate sums (S) of said 
highest branch metrics (Mmaxk) for a pre-set number of symbol times 

(N); 
second comparison means (CMP2) for the sums (S) received 
from said accumulator means (ACC) with a given threshold (THR), 

which emit an erroneous phase signal (FE) if said threshold is not 
exceed; 
phase rotation sequence generation means (GSR,ROT) which, 
when activated by said erroneous phase signal (FE), cause 

counter-rotation of phase on the component pairs in phase (P) and 
in quadrature (Q) of the signal received, to find corresponding 

component pairs in phase (Pr) and in quadrature (Qr) rotated in 
phase, which supply then to said calculation means (CMR) branch 

metrics of the correlation type, until said threshold (THR) is 
exceeded and said erroneous phase signal (FE) is deactivated. 
Device for phase ambiguity resolution as set forth in claim 
4, characterised in that said phase rotation sequence generation 

 
means (GSR,ROT) rotate said components in phase (P) and in 

quadrature (Q) of the signal received, in the plane of the 
modulation constellation, alternately increasing and decreasing by 

progressive multiples of an angle of symmetry of the modulation 
signal constellation. 
Device for phase ambiguity resolution as set forth in claim 
5, characterised in that said phase rotation sequence generation 

means (GSR,ROT) comprise essentially: 

a first counter which, when activated upon reception of the 
erroneous phase signal (FE), counts the number of angular rotations 

performed while increasing or decreasing, and is zeroed again when 
the phase again becomes correct and said erroneous phase signal 

(FE) changes state; 
a memory containing pairs of constants which are addressed 
by the content of said first counter and supplied at output; 
a phase rotator (ROT) which receives said pairs of constants 
from said memory and changes correspondingly said component pairs 

in phase (P) and in quadrature (Q) in reception, to find said pairs 
of components in phase (Pr) and in quadrature (Qr) rotated in 

phase. 
Device for phase ambiguity resolution as set forth in any 
of claims 4 through 6, characterised in that said calculation means 

(CMR) of the branch metrics of the correlation type calculate the 
following expression:   Mn = PrPn + QrQn  

 where the components Pr, Qr are those 
received from said phase rotator (ROT), and the components Pn and 

Qn are those of each of the possible signals of the modulation 
constellation. 
Device for phase ambiguity resolution as set forth in claim 
4, characterised in that it comprises also a second counter (CNT) 

which counts for said pre-set number of symbol times (N) after 
which it supplies a zeroing command to said accumulator means 

(ACC). 
Device for phase ambiguity resolution as set forth in claim 
8, characterised in that said second counter (CNT) is of the 

programmable type, and said erroneous phase signal (FE) is used for 
choosing between two values of symbol times (N) for the two cases 

 
of correct and erroneous phase, the one with erroneous phase being 

the lesser. 
</CLAIMS>
</TEXT>
</DOC>
