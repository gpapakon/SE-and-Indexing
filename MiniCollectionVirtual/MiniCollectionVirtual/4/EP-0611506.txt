<DOC>
<DOCNO>EP-0611506</DOCNO> 
<TEXT>
<INVENTION-TITLE>
METHOD, SENDER APPARATUS AND RECEIVER APPARATUS FOR MODULO OPERATION
</INVENTION-TITLE>
<CLASSIFICATIONS>H04L932	H04L932	</CLASSIFICATIONS>
<CLASSIFICATIONS-THIRD>H04L	H04L	</CLASSIFICATIONS-THIRD>
<CLASSIFICATIONS-FOURTH>H04L9	H04L9	</CLASSIFICATIONS-FOURTH>
<ABSTRACT>
In access control systems, e.g. pay TV systems, square, or more general, d-th roots modulo X are used where X is a composite number having at least two large prime factors. If a sender, e.g. a smart-card, communicates with a receiver only few data are transmitted in order to save time. But this results in an increased number of computation operations in the sender and/or receiver. The invention is applicable when a first cryptographic device (28) communicates with a second cryptographic device (27), especially when the devices use a modulo-based protocol. Thereby the required number of modular operations is reduced or even eliminated. It can be avoided to do modular operations by the first device. This is particularly advantageous when said first device has a weaker computational power (e.g. less RAM and/or ROM capacity, slower clock rate) than said second device.
 
</ABSTRACT>
<APPLICANTS>
<APPLICANT-NAME>
THOMSON MULTIMEDIA SA
</APPLICANT-NAME>
<APPLICANT-NAME>
THOMSON MULTIMEDIA
</APPLICANT-NAME>
</APPLICANTS>
<INVENTORS>
<INVENTOR-NAME>
NACCACHE DAVID
</INVENTOR-NAME>
<INVENTOR-NAME>
NACCACHE, DAVID
</INVENTOR-NAME>
</INVENTORS>
<DESCRIPTION>
The present invention relates to a method, to a sender apparatus 
and to a receiver apparatus for modulo operation. In access control systems, e.g. pay TV systems, square, or 
more general, d-th roots modulo X are used where X is a composite 
number having at least two large prime factors. Typically 
the length of such a number X (denoted |X|) is 64 
bytes. 
If a sender, e.g. a smart-card, communicates with a receiver 
only few data are transmitted in order to save time. But this 
results in an increased number of computation operations in 
the sender and/or receiver. European Patent Application No. 0 428 252 discloses a system for controlling access to broadcast transmissions. It is one object of the invention to disclose a method for 
time-reduced modulo operations. This object is reached by the 
inventive method disclosed in claim 1. In principle the inventive method consists in secure sending 
of a number S = D mod X or of a set of numbers S(j) = D(j) 
mod X, j = 1,...,i, from a sender device 28 to a receiver 
device 27, whereby X is a product of at least two big prime 
numbers and D is greater than X, comprising the following 
steps: 
picking a random number A or a set of random numbers A(j) 
by said sender device; calculating in said sender a value E = D+A*X or a set of 
values E(j) = D(j)+A(j)*X, whereby X is stored in said sender, 
or calculating in said sender a set of values E(j) =  
 
D(j)*B, whereby a fixed number B = A*X is stored in said 
sender;  transmitting via an interface 10 said value and said values, 
respectively, from said sender to said receiver; calculating by said receiver S = E mod X or S(j) = E(j) mod 
X, whereby the number X is stored in said receiver device. Advantageous additional embodiments of the inventive method 
are resulting from the respective dependent claims. It is a further object of the invention to disclose a sender 
apparatus which utilizes the inventive method. This object is 
reached by the inventive apparatus disclosed in claim 6. In principle the inventive sender apparatus consists in first 
computation means 25, first memory means 26 which are 
connected to said first computation means and first data exchange 
means 24 which are connected to said first computation 
means, whereby either  said first memory means store said modulus X and said first 
computation means select said random number A or random numbers 
A(j) and calculate said value E = D+A*X or calculate 
said set of values E(j) = D(j)+A(j)*X  or said first memory means store said fixed number B
</DESCRIPTION>
<CLAIMS>
Method for secure sending of a number S = D mod X or of 
a set of numbers S(j) = D(j) mod X, j = 1,...,i, from a 

sender device (28) to a receiver device (27), whereby X 
is a product of at least two big prime numbers and D is 

greater than X, 
characterized in
 the following steps: 

picking a random number A or a set of random numbers 
A(j) by said sender device; 
calculating in said sender a value E = D+A*X or a set 
of values E(j) = D(j)+A(j)*X, whereby X is stored in 

said sender, or calculating in said sender a set of values 
E(j) = D(j)*B, whereby a fixed number B = A*X is 

stored in said sender; 
transmitting via an interface (10) said value and said 
values, respectively, from said sender to said receiver; 
calculating by said receiver S = E mod X or S(j) = 
E(j) mod X, whereby the number X is stored in said receiver 

device. 
Method according to claim 1, 
characterized in
 that the 
transmitted length of value E or of each of values E(j) 

is less than four times the length of X. 
Method according to claim 1 or 2, 
characterized in
 that 
the length of X is in the range from 64 to 128 bytes. 
Method according to any of claims 1 to 3, 
characterized 
in
 that said sender device (28) calculates, using |X| 
cells of memory means (26), and transmits in a first 

step |X| lower bytes and in a second step |X| higher 
bytes of said value E or of each of said values E(j), 

whereby said receiver device (27) reconstructs said 
value E or of each of said values E(j) by concatenating 

High(E) and Low(E) or High(E(j)) and Low(E(j)).  
 
Method according to any of claims 1 to 4, 
characterized 
in
 that said sender device (28) is a smart-card. 
Sender apparatus (28) for a method according to any of 
claims 1 to 5 for secure sending of a number S = D mod x or of a set of numbers S(j) = D(j) mod x, j = 1,....., i, from said sender to a receiver device (27) consisting of first computation means 

(25), first memory means (26) which are connected to 
said first computation means and first data exchange 

means (24) which are connected to said first computation 
means, whereby either 


said first memory means store said modulus X and said 
first computation means select said random number A or 

random numbers A(j) and calculate said value E = D+A*X 
or calculate said set of values E(j) = D(j)+A(j)*X 

or 
said first memory means store said fixed number B and 
said first computation means calculate said set of values 

E(j) = D(j)+B 
and whereby said first data exchange means (24) send 
said value E or said set of values E(j) to said receiver 

device (27). 
Receiver apparatus (27) for a method according to any of 
claims 1 to 5, consisting of second computation means 

(22), second memory means (21) which are connected to 
said second computation means and second data exchange 

means (23) which are connected to said second 
computation means, whereby said second memory means 

store said modulus X and said second computation means 

calculate the modulo function S = E mod X of said value 
E or calculate a set of modulo functions S(j) = E(j) mod 

X of said set of values E(j). 
Sender device according to claim 6, 
characterized in
 
that said sender device (28) is a smart-card or a credit-card 

or a passport or a door-key.  
 
Receiver device according to claim 7, 
characterized in
 
that said receiver device (27) is a pay TV decoder or a 

credit-card verifier or a passport verifier or an 
electronic lock. 
</CLAIMS>
</TEXT>
</DOC>
