<DOC>
<DOCNO>EP-0656587</DOCNO> 
<TEXT>
<INVENTION-TITLE>
Detecting computer viruses during power on self test.
</INVENTION-TITLE>
<CLASSIFICATIONS>G06F100	G06F100	G06F2100	G06F2100	</CLASSIFICATIONS>
<CLASSIFICATIONS-THIRD>G06F	G06F	G06F	G06F	</CLASSIFICATIONS-THIRD>
<CLASSIFICATIONS-FOURTH>G06F1	G06F1	G06F21	G06F21	</CLASSIFICATIONS-FOURTH>
<ABSTRACT>
A computer system includes a system processor, an information 
storage apparatus, at least one booting device from which the computer 

system can be booted, and a detection apparatus for detecting a computer 
virus during a boot sequence for the computer system. The information 

storage apparatus contains information including cyclic redundancy check 
values for the Master Boot Record and for the operating system selected 

for booting. These CRC values are computed when the Master boot record 
and the operating system boot record are known to be free from computer 

viruses. The detection apparatus comprises: (1) apparatus for reading 
the master boot record and operating system boot record from the selected 

booting device; (3) apparatus for determining whether the boot records 
are valid; (4) apparatus for passing control of the CPU to the boot 

record of the device when it is determined that the boot record of the 
device is valid and for presenting a message to a user indicating that 

the boot record of the device is not valid, in the event that the boot 
record of the device is not valid. 
</ABSTRACT>
<APPLICANTS>
<APPLICANT-NAME>
IBM
</APPLICANT-NAME>
<APPLICANT-NAME>
INTERNATIONAL BUSINESS MACHINES CORPORATION
</APPLICANT-NAME>
</APPLICANTS>
<INVENTORS>
<INVENTOR-NAME>
KHATRI BHARAT
</INVENTOR-NAME>
<INVENTOR-NAME>
MERKIN STANLEY LEONARD
</INVENTOR-NAME>
<INVENTOR-NAME>
KHATRI, BHARAT
</INVENTOR-NAME>
<INVENTOR-NAME>
MERKIN, STANLEY LEONARD
</INVENTOR-NAME>
</INVENTORS>
<DESCRIPTION>
This invention relates to personal computer systems and in 
particular to the detection of computer viruses therein. Personal computer systems in general and IBM personal computers in 
particular have attained widespread use for providing computer power to 
many segments of today's modern society. Personal computer systems can 
usually be defined as a desk top, floor standing, or portable 
microcomputer that consists of a system unit having a single system 
processor, a display monitor, a keyboard, one or more diskette drives, a 
fixed disk storage, and an optional printer. One of the distinguishing 
characteristics of these systems is the use of a motherboard (or system 
planar) to electrically connect these components together. These systems 
are designed primarily to give independent computing power to a single 
user and are inexpensively priced for purchase by individuals or small 
businesses. Beginning with the earliest personal computer, such as the IBM 
Personal Computer, it was recognized that software compatibility would be 
of utmost importance. In order to achieve this goal, an insulation layer 
of system resident code, also known as "firmware", was established 
between the hardware and software. This firmware provided an operational 
interface between a user's application program/operating system and the 
hardware device to relieve the user of the concern about the 
characteristics of hardware devices. Eventually, the code developed into 
a BASIC input/output system (BIOS), for allowing new devices to be added 
to the system, while insulating the application program from the 
peculiarities of the hardware. The importance of BIOS was immediately 
evident because it freed a device driver from depending on specific 
device hardware characteristics while providing the device driver with an 
intermediate interface to the device. Since BIOS was an integral part of 
the system and controlled the movement of data in and out of the system 
processor, it was resident on the system planar and was shipped to the 
user in a read only memory (ROM). For example, BIOS in the original IBM 
Personal Computer occupied 8K of ROM resident on the planar board. Newer 
versions of BIOS are stored both in ROM and in EEPROM or in the hard 
drive.  A problem encountered by many personal computer users is the 
inadvertent introduction of so-called computer viruses into the computer 
system. Computer viruses are programs that generally are able to make 
copies of themselves and are capable of affecting the operation of
</DESCRIPTION>
<CLAIMS>
A computer system comprising: 
   a system processor (26) for executing at least one operating 

system, each operating system having an operating system boot 
record associated therewith; 

   first non-volatile information storage means (36), coupled to the 
system processor, for storing information including identification 

data for identifying a selected storage device from which the 
computer system is to boot; characterised by 

   detection means for detecting a computer virus during a boot 
sequence, said detection means comprising: 

   means for reading a master boot record from the selected 
storage device specified in the information storage means; 

   means for determining whether the master boot record of the 
selected storage device is valid; and 

   means for passing control of the computer system to the 
master boot record when it is determined that the master boot 

record is valid and for presenting a message to a user 
indicating that the master boot record is not valid, in the 

event that the master boot record is not valid. 
A computer system as claimed in claim 1 further comprising: 
   at least one bootable device, each bootable device having a master 

boot record associated therewith; 
   second non-volatile information storage means for storing 

information including a selected boot sequence, and a first cyclic 
redundancy check (CRC) value for each master boot record of each 

bootable device in a predetermined set of bootable devices, and for 
each operating system boot record of a predetermined set of 

operating systems, each first CRC value having been computed at a 
time when neither the master boot records nor the operating 
system 
boot records were contaminated with any computer virus;

 
   means for reading a master boot record from a selected bootable 

device and for reading an operating system boot record from a 
selected operating system for booting the computer system; 

   means for checking the validity of the master boot record of the 
selected bootable device and of the operating system boot record, 

comprising 
   check means for computing, during the boot sequence, a second 

CRC value for the operating system boot record of the 
selected operating system and for the master boot record of 

the selected bootable device; 
   comparing means for comparing each second CRC value with each 

corresponding first CRC value; and 
   means for passing control of the computer system to the 

master boot record of the selected bootable device, when the 
first and second CRC values of the master boot record match, 

and when the first and second CRC values for the selected 
operating system match. 
A computer system as claimed in claim 2 further comprising: 
   means for presenting an indication of virus detection to a user 

when the first and second CRC values of the master boot record do 
not match, or when the first and second CRC values for the selected 

operating system do not match. 
A method, for detecting a computer virus during a boot sequence in 
a computer system comprising a central processor unit (CPU) for executing 

an operating system having an associated operating system boot record, at 
least one bootable device, and an information storage device, comprising 

the steps of: 

(a) storing an identification code in the information storage 
device, the identification code corresponding to a selected 

bootable device, the selected bootable device including a master 
boot record; 
(b) reading the master boot record and the operating system boot 
record from the device; 
(c) determining whether the master boot record and the operating 
system boot record are valid; and 
(d) passing control of the CPU to the boot record of the device 
when it is determined that the master boot record and the operating 

system boot record are valid. 
A method as claimed in claim 4, further comprising the step of: 

(e) in the event that the boot record of the device is not valid, 
presenting a message to a user indicating that the boot record of 

the device is not valid. 
A method as claimed in claim 4 or claim 5, wherein step (c) further 
comprises the steps of: 


(c1) storing first cyclic redundancy check values, for the 
selected booting device master boot record and for the selected 

operating system boot record, in the information storage device, 
the first cyclic redundancy check values having been computed at a 

time when it is known that neither the master boot record nor the 
operating system boot record were contaminated with any computer 

virus; 
(c2) computing, during a boot sequence, second cyclic redundancy 
check values for the master boot record of the selected booting 

device and for the boot record of a selected operating system to be 
loaded into the computer system during boot; 
(c4) comparing the first and second cyclic redundancy check 
values; and 
(c5) passing control of the computer system to the operating 
system boot record, when the first and second cyclic redundancy 

check values match. 
A method as claimed in claim 6, wherein step (c) further comprises 
the step of: 
(c6) presenting an indication of virus detection to a user when 
the first and second cyclic redundancy check values do not match. 
A computer system comprising: 
   a system processor for executing an operating system, the operating 

system having an operating system boot record associated therewith; 
   storage means, coupled to the system processor, for storing 

information including a master boot record for a selected booting 
device; 

   detection means for detecting a computer virus during a boot 
sequence, said detection means comprising: 

   means for storing an identification code in the storage means, the 
identification code corresponding to the selected booting device; 

means for reading a boot record from the device; 
   means for determining whether the boot record is valid; and 

   means for passing control of the CPU to the boot record of the 
device when it is determined that the boot record of the device is 

valid and for presenting a message to a user indicating that the 
boot record of the device is not valid, in the event that the boot 

record of the device is not valid. 
</CLAIMS>
</TEXT>
</DOC>
