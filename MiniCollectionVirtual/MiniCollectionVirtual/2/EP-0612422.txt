<DOC>
<DOCNO>EP-0612422</DOCNO> 
<TEXT>
<INVENTION-TITLE>
MICROCONTROLLER WITH FUSE-EMULATING LATCHES AND METHOD OF TESTING
</INVENTION-TITLE>
<CLASSIFICATIONS>G06F11267	G06F930	G06F1578	G06F11267	G06F1126	G06F930	G06F938	G06F1576	G06F1126	G06F938	</CLASSIFICATIONS>
<CLASSIFICATIONS-THIRD>G06F	G06F	G06F	G06F	G06F	G06F	G06F	G06F	G06F	G06F	</CLASSIFICATIONS-THIRD>
<CLASSIFICATIONS-FOURTH>G06F11	G06F9	G06F15	G06F11	G06F11	G06F9	G06F9	G06F15	G06F11	G06F9	</CLASSIFICATIONS-FOURTH>
<ABSTRACT>
A microcontroller (10) fabricated on a semiconductor chip has an on-chip EPROM program memory (17) with programmable EPROM configuration fuses located in a limited number of addresses (32) of the on-chip EPROM program memory, the condition of each of EPROM fuses being defined as blown or not blown according to the value of the bit stored in the respective address on the on-chip EPROM program memory. The operating modes of the microcontroller are configurable by appropriately programming at least some of the EPROM fuses. Testing of the microcontroller in at least some of the operating modes is achieved by using latches outside the on-chip EPROM program memory to emulate the EPROM fuses, while suppressing the capability to set the condition of the EPROM fuses during the testing. Upon completion of the testing, control of the operating modes of the microcontroller is returned to EPROM fuses, and the latches are precluded from further emulating the EPROM fuses.
</ABSTRACT>
<APPLICANTS>
<APPLICANT-NAME>
MICROCHIP TECH INC
</APPLICANT-NAME>
<APPLICANT-NAME>
MICROCHIP TECHNOLOGY INC.
</APPLICANT-NAME>
</APPLICANTS>
<INVENTORS>
<INVENTOR-NAME>
ALLEN RAY
</INVENTOR-NAME>
<INVENTOR-NAME>
BERMAN ERIC
</INVENTOR-NAME>
<INVENTOR-NAME>
ITALIANO GREG
</INVENTOR-NAME>
<INVENTOR-NAME>
PADGAONKAR AJAY
</INVENTOR-NAME>
<INVENTOR-NAME>
ALLEN, RAY
</INVENTOR-NAME>
<INVENTOR-NAME>
BERMAN, ERIC
</INVENTOR-NAME>
<INVENTOR-NAME>
ITALIANO, GREG
</INVENTOR-NAME>
<INVENTOR-NAME>
PADGAONKAR, AJAY
</INVENTOR-NAME>
</INVENTORS>
<DESCRIPTION>
The present invention relates generally to semiconductor
microcontrollers, and more particularly to a microcontroller
having operating states configured by EPROM fuses and
in which the EPROM configuration fuses are emulated by latches
for purposes of testing.Microprocessors have evolved into complex
instruments and machines which require sophisticated, fast
real-time control capability. Instead of using large
microprocessors of 16 or 32 bit capability along with
interrupt handler chips, programmable timer chips, ROM and
RAM chips, the field has gone to a single chip
microcontroller in which all peripherals are embedded on the
same chip. Operation of the chip in an expanded mode allows
gaining the versatility of all on-chip features.
Microcontrollers are used in a wide diversity of present-day
applications, with new applications found almost daily. In
hand-held instruments such as tiny pocket-sized pagers, the
microcontroller is responsive to received characters to
interpret them, produce a beep to notify the user of an
incoming message (or not if the user prefers an inaudible
mode), and poduces multiple mesages among the several last
of those received on a suitable display, typically an LCD.
The microcontroller can also recall from its internal memory
any or all of the messages received in a given period of
time. The chip is also used in other instrumentation such
as meters and testers, capable of carrying out thousands of
tests, each in a millisecond or less.Other applications include keyboard controllers for
personal computers, in which the microcontroller serves to
offload many tasks formerly handled by the processor. The
chip continuously performs a series of diagnostic procedures,
and notifies the processor if it detects a problem. Among
other personal computer applications, microcontrollers are
used in modems for command interpretation and data 
transmission, in printer buffers for high speed dumping of
data in preparation for driving the printer at the
considerably lower speed at which the printer operates or for
color plotters, in color copiers, electronic typewriters,
cable television terminal equipment, lawn sprinkling
controllers, credit card phone equipment, automotive
applications such as engine control modules, antilock braking
systems, automobile suspension control for desired desination
of ride softness or rigidity depending on user preference,
and a host of other applications used daily by industrial and
consumer customers.A real time microcontroller is a microcomputer
adapted to
</DESCRIPTION>
<CLAIMS>
A microcontroller (10) fabricated on a semiconductor chip for executing
instructions for controlling external apparatus and comprising:


on-chip programmable memory (17) having non-volatile memory cells
occupying addressable locations of the programmable memory, and
means, including a plurality of configuration fuses comprising addressable
locations of the programmable memory (17), for configuring the

microcontroller (10) in any one of a plurality of operation configurations,

characterized in that the microcontroller comprises
test means for enabling the testing of the operation of the microcontroller in at
least some of said operation configurations and including a plurality of test

latches comprising bits in a test mode register (TSTMD1) which can be
written and rewritten to emulate the configuration fuses to allow

configuration of the microcontroller without programming the configuration
fuses, and
means (TSTMUX) for inhibiting the test latches from controlling the
microcontroller configuration upon completion of testing.
A microcontroller according to claim 1, wherein the microcontroller includes
code protection fuses (FPMM1, FGLWP) at addressable locations of the

programmable memory (17) and wherein test latches of the test mode register
are able to override the code protection fuses regardless of the means for

inhibiting the test latches if the code protection fuses are erased and
test latches of the test mode register are not able to override the code protection fuses

if the code protection fuses are programmed. 
A microcontroller according to claim 1 or claim 2 wherein the test means
further comprises programmed memory (Test EPROM) containing program

code for performing a series of subroutines to test the instructions of the
microcontroller in response to an input program counter value.
A method of testing a microcontroller (10) fabricated on a semiconductor chip
including an on-chip programmable memory (17) having configuration fuses

comprising non-volatile memory cells occupying addressable locations of the
programmable memory, wherein the microcontroller is configurable in any of

a plurality of operating configurations by programming selected ones of the
configuration fuses, characterized in that the method comprises setting latches

to emulate the configuration fuses in order to control the microcontroller
configuration, the latches comprising bits in a test mode register (TSTMD1) which can be

written and rewritten to emulate the configuration fuses to allow
configuration of the microcontroller without programming the configuration

fuses and that the method comprises:

(i) setting a bit in the test mode register
(ii) reading and writing to the bits in the test mode register to emulate the
configuration fuses
(iii) performing a series of tests for at least some of said configurations; and
(iv) setting means (TSTMUX) to inhibit test mode bits from controlling the
microcontroller configuration after such testing.
A method according to claim 4 wherein said step of performing a series of
tests comprises performing a series of sub-routines programmed into the

microcontroller to test at least some of the operating instructions of the
microcontroller in response to an input program counter value.
</CLAIMS>
</TEXT>
</DOC>
