<DOC>
<DOCNO>EP-0653692</DOCNO> 
<TEXT>
<INVENTION-TITLE>
Method and apparatus for controlling the power of a battery power source
</INVENTION-TITLE>
<CLASSIFICATIONS>G05F166	H02J338	G05F167	H02J338	</CLASSIFICATIONS>
<CLASSIFICATIONS-THIRD>G05F	H02J	G05F	H02J	</CLASSIFICATIONS-THIRD>
<CLASSIFICATIONS-FOURTH>G05F1	H02J3	G05F1	H02J3	</CLASSIFICATIONS-FOURTH>
<ABSTRACT>
A power control method and apparatus for extracting the 
maximum power from a battery power source are disclosed. Voltage 

signals and current signals are read while varying the operating 
point of a solar cell acting as the battery power source. The 

variation in the intensity of solar radiation that has occurred 
during a sampling time interval is estimated from a plurality of 

current signals, sampled at the same voltage, or, according to a 
plurality of power values, calculated from current signals and 

voltage signals. Based on the estimated variation in the 
intensity of solar radiation, the current signals or power 

signals are corrected. According to the corrected current 
signals or according to the corrected power values and the 

voltage values, the operating point is controlled so that the 
maximum output power is provided from the solar cell. 


</ABSTRACT>
<APPLICANTS>
<APPLICANT-NAME>
CANON KK
</APPLICANT-NAME>
<APPLICANT-NAME>
CANON KABUSHIKI KAISHA
</APPLICANT-NAME>
</APPLICANTS>
<INVENTORS>
<INVENTOR-NAME>
KUROKAMI SEIJI
</INVENTOR-NAME>
<INVENTOR-NAME>
TAKEHARA NOBUYOSHI
</INVENTOR-NAME>
<INVENTOR-NAME>
KUROKAMI, SEIJI
</INVENTOR-NAME>
<INVENTOR-NAME>
TAKEHARA, NOBUYOSHI
</INVENTOR-NAME>
</INVENTORS>
<DESCRIPTION>
The present invention concerns a method of
regulating the power output of a power converter,
particularly one connected across a solar battery power
source, or the like. It also concerns an
apparatus including a controller for regulating the power
output of such a power converter.The global environment has become a serious problem.
To solve this problem, one of promising clean energy
sources is a battery power system, such as a solar cell,
aerogenerator, etc. When a solar cell is used as a
battery power source that is connected to a utility grid,
the utility grid acts as a substantially infinite load.
Under this condition, it is required to establish a
technique that can provide the highest 
efficiency in the operation of the battery power system as a
whole. Not only should the total efficiency of the battery power
system be high, but also the total power system including the
utility grid should have high efficiency. Thus, it is required
to establish a technique to achieve the highest efficiency in
the total power system. In a solar cell, since it is based on
photoelectric conversion, the output power greatly depends on
the intensity of solar radiation, temperature, or the voltage at
the operating point. Therefore, the load seen from the solar
cell system should be adjusted such that the solar cell system
can always provide the maximum power. One of the techniques
known for the above purposes is to change the operating-point
voltage or current of a solar cell array, including a plurality
of solar cells, and to detect the resultant change in power
thereby determining the optimum operating point for the solar
cell array to provide the maximum, or nearly maximum, power. One
of techniques of this kind is disclosed in Japanese Patent No.
63-57807, that is based on the derivative of the power with
respect to the voltage. Another technique of this kind is the
so-called "hill-climbing method" in which the optimum operating
point is searched by varying the power in a direction that leads
to an increase in the power, as disclosed, for example, in
Japanese Patent Laid-Open No. 62-85312 or US-A-4 899 269. These methods are widely
used in conventional solar cell systems to control a power
conversion apparatus so as to provide the maximum power. However, the conventional methods have the following
problems.In the hill-climbing method, when the voltage is initially
set to V1, shown in Figure 14 (wherein the horizontal axis
represents voltage V, and the vertical axis represents power P),
and the voltage is increased,
</DESCRIPTION>
<CLAIMS>
A method of regulating the power output of a power
converter (2;14), the inputs of which are connected

across a battery power source (1) and the outputs of
which are connected across a load (3;15), which method

is performed by:

adjusting said power converter (2;14) to set the
operating point input voltage (V) thereof to different

set values (V1,V2;V1,V2,V3) for respective different
sampling times (t
1
,t
2
,...) of a sampling cycle;
obtaining a sample value (P1,P2;...;I1,I2) of a
parameter (P;I) of said power converter for each said

different sampling time of said sampling cycle, which
parameter is one of the input or output power (P), input

or output current (I), of said power converter; and
regulating said power converter by resetting the
operating point input voltage (V) thereof to optimise,

or at least increase towards optimum, the power output
thereof, on the basis of the obtained sample values of

said parameter;

   which method is characterised in that:

   said adjusting said power converter includes setting
the operating point input voltage (V) to a same set value

(V1) for each of a plurality of different sampling times
(t
1
,t
3
;t
1
,t
4
) of said sampling cycle; and

   said method includes: 

correcting one or more sample values
(P2;P2,P3;I2;I2,I3) of said parameter by a respective

correction amount to compensate for a change of the power
characteristic of said battery power source, which

respective correction amount is dependant on the
corresponding sampling times (t
2
;t
2
,t
3
) of said one or
more sample values and is determined using the sample

values (P1,P3;P1,P4;I1,I3;I1,I4) of said parameter
obtained for said same set value (V1) of said operating

point input voltage; and
regulating said power converter on the basis of
samplevalues (P3,P2';P4,P2',P3',I3,I2';I4,I2',I3') which

include said one or more sample values
(P2';P2',P3';I2';I2',I3') corrected by said respective

correction amounts.
A method according to claim 1 wherein:

the operating point input voltage (V) is set twice
only to the same set value (V1) for different respective

sampling times (t
1
,t
3
;t
1
,t
4
) of said sampling cycle; and
said correcting includes calculating the rate of
change (ΔP/Δt; Δi/ΔT) of said parameter (P,I) at constant

voltage (V1) as the ratio of the difference of the sample
values (P
1
P
3
;P
1
,P
4
;I
1
,I
3
;I
1
,I
4
) obtained for the same set
value (V1) of the operating point input voltage (V) to

the difference of these different respective sampling 
times (t
1
,t
3
;t
1
,t
4
), and calculating a respective
correction amount for each of said one or more sample

values (P
2
;P
2
,P
3
;I
2
;I
2
,I
3
) using the calculated rate of
change.
A method according to claim 2 wherein the operating
point input voltage (V) is set to said same set value

(VI) at the beginning time (t
1
) and at the end time
(t
3
;t
4
) of said sampling cycle.
A method according to claim 3 wherein said sample
values used as basis for regulating said power converter

(2,14) consist of the sample value (P
3
,P
4
;I
3
;I
4
) obtained
for the end time (t
3
;t
4
) of said sampling cycle and said
one or more sample values (P
2
' ;P
2
',P
3
';I
2
',I
2
,I
3
')
corrected by said respective correction amounts.
A method according to any preceding claim wherein
said parameter is one of either input power or output

power and the regulating of said power converter is
performed by determining from a comparison of two sample

values (P
3
,P
2
'), including one (P
2
') corrected by its
respective correction amount, the direction of the change

of said power with respect to input voltage, and
increasing or decreasing the value of the operational

point input voltage (V) from its last set value (V1) in 
the direction of increasing power determined from said

comparison.
A method according to any preceding claim 1 to 4
wherein said parameter is one of either input power or

output power and the regulating of said power converter
is performed by resetting the operational point input

voltage (V) to a value calculated to correspond to
maximum power (P), which value is calculated from the

simultaneous solution of equations in which the power is
expressed as a quadratic function of the input voltage,

using three sample values of power (P
2
',P
3
',P
4
) obtained
for three different values (V2,V3,V1) of the operating

point input voltage (V), including two corrected sample
values (P
2
',P
3
'), and the corresponding three different
values (V2,V3,V1) of the operating point input voltage

(V).
A method according to any preceding claim 1 to 4
wherein the regulating of said power converter is

performed by calculating a power gradient (dP/dV)
corresponding to the last setting (V1) of the operating

point input voltage, and resetting the operating point
input voltage by increasing, maintaining or decreasing

the setting value (V1) in dependance on the calculated
value of said power gradient (dP/dV) being positive,

zero, or negative, the power gradient being calculated 
as the ratio of the difference in power, corresponding

to two different setting values of said operating point
input voltage, to the difference in operating point input

voltage.
A method according to claim 7 wherein said parameter
is input current I, and the power gradient (dP/dV) is

calculated using two sample values (I
3
,I
2
') obtained for
said two different value settings (V1,V2), including one

(I
2
') corrected by its respective correction amount, and
the two different setting values.
A method according to any preceding claim 1 to 4,
wherein said power converter is an inverter (14) operable

to supply power at a fixed output voltage, and said
parameters is the output current.
A method according to claim 9 wherein the regulating
of said power converter is performed by resetting the

operational point input voltage (V) to a value calculated
to correspond to maximum output power (P), which value

is calculated from the simultaneous solution of equations
in which the output current is expressed as a quadratic

function of the input voltage, using three sample values
of current (I
2
',I
3
',I
4
) obtained for three different
values (V2,V3,V1) of the operating point input voltage 

(V), including two corrected sample values (I
2
',I
3
'), and
the corresponding three different values (V2,V3,V1) of

the operating point input voltage (V).
Apparatus for regulating the power supplied from a
power source (1) to a load (3,15) via a power converter

(2,14), the power converter having means of adjusting the
operational point input voltage (V) developed across its

inputs, said apparatus comprising:

a servo-control (4,7) for controlling the power
converter to adjust and set the operational point input

voltage (V) to a set value (V1,V2;...) corresponding to
a target value;
sampling means (5;4-6;10;16) for obtaining samples
of one of the input or output current, input or output

power of the power converter, corresponding to different
times (t
1
,t
2
,...) of a sample cycle; and
a controller (6) to set target values for setting
the operating point input voltage for each different time

of the sampling cycle, and to determine and set, on the
basis of the samples obtained in said sampling cycle, a

target value for resetting the operating point input
voltage to optimise, or at least increase towards

optimum, the power output of the power converter;

   which apparatus is characterised in that:

said controller is adapted to set the target values
for setting the operating point input voltage to a same
value (V1) for a plurality of times (t
1
,t
3
;t
1
,t
4
) of said
sampling cycle, and to one or more respective different

values (V2;V2,V3) at other one or more respective
different times (t
2
;t
2
,t
3
) of said sampling cycle;
said controller is adapted to correct one or more of
said samples by a respective correction amount, to

compensate for a change of the power characteristic of
the power source, which respective correction amount is

dependant on the corresponding sampling times (t
2
;t
2
,t
3
)
of said one or more samples and is determined by said

controller from those of said samples
(P1,P3;P1,P4;I1,I3;I1,I4) obtained for the same set value

(V1) of the operating point input voltage (V1); and
said controller is adapted to determine the target
value for resetting the input voltage on the basis of

samples (P3,P2';P4,P2',P3';I3,I2';I4,I2',I3') which
include said one or more samples

(P2';P2',P3';I2';I2',I3') corrected by said respective
correction amounts.
Apparatus according to claim 11 wherein said
sampling means is for obtaining samples of power and

includes means (5) of sampling current and means (6) of
producing said samples of power by calculating the

products of the sampled current values and the respective
values o
f the corresponding set voltage.
Apparatus according to claim 12 wherein said means
of producing said samples is embodied in said 

controller (6).
An apparatus according to claim 11 wherein:

said controller is arranged to set said target
values to a same value (V1) for two times (t
1
,t
3
;t
1
,t
4
) of
said sampling cycle; and
said controller is arranged to calculate the
respective correction amount by first calculating the

rate of change at constant voltage of the current or
power represented by said samples (P1 to P3; P1 to P4;I1

to I3;I1 to I4) as the ratio of the difference of the two
sample values of the samples (P1,P3;P1,P4;I1,I3,I1,I4)

obtained for the same set voltage, to the difference of
their different respective times (t
1
,t
3
;t
1
,t
4
) and then
calculates the correction amount using the calculated

rate of change.
An apparatus according to claim 14 wherein said
controller is arranged to set said target values to the

same value (V1) at the beginning time (t
1
) and the end
time (t
3
;t
4
) of said sampling cycle.
An apparatus according to claim 15 wherein:

said controller is arranged to correct the one or
more samples (P2;P2,P3;I2;I2,I3) obtained corresponding

to times (t
2
;t
2
,t
3
) of the sampling cycle other than the
beginning time (t
1
) and the end time (t
3
,t
4
); and
said controller is arranged to determine and set the 
target value, for resetting the operating point input

voltage, on the basis of a set of samples consisting of
the sample (P3;P4;I3;I4) obtained corresponding to the

end time (t
3
;t
4
) of the sampling cycle, and the corrected
one or more samples (P2';P2',P3';I2';I2',I3').
An apparatus according to any of claims 11, and 14
to 16 wherein:


said controller is arranged to compare two of the
samples (P2',P3) obtained for different set values

(V2,V1) of the operating point input voltage, one of
which samples (P2') is a corrected sample, to determine

from this comparison and from the direction of voltage
change between their corresponding different set values

(V2,V1), a direction of change to be applied next to the
operating point input voltage; and
to increment and reset the target value in the
direction of change determined.
An apparatus according to any of claims 11, and 14
to 16 wherein said controller is arranged to determine

and set the target value for resetting the operating
point input voltage on the basis of three samples

(P2',P3',P4) obtained for three different target values
(V2,V3,V1), including two corrected samples (P2',P3'),

and the three different set voltage values (V2,V3,V1) of
the operating point input voltage corresponding thereto,

by solving simultaneously three quadratic equations in
which sample value is expressed as a quadratic function 

of voltage, to determine the value of voltage
corresponding to the maximum sample value given by these

quadratic equations, and resetting the target value for
resetting the operating point input voltage to this

value.
An apparatus according to claim 16 wherein said
controller is arranged to determine and set the target

value for resetting the operating point input voltage on
the basis of two samples (I3,I2') of current, one of

which is a sample (I3) obtained for the end time (t
3
) of
the sampling cycle, the other of which is a corrected

sample (I2') corresponding to a sample (I2) obtained at
a time (t
2
) between the beginning time (t
1
) and the end
time (t
3
) of the sampling cycle, which controller is
arranged to calculate a gradient value by summing the

value of the sample (I3) obtained for the end time (t
3
)
with the product of the set value (V1) of voltage set for

the other sample (I2) and the ratio of the difference in
value of the sample (I3) and the corrected sample (I2')

to the difference in value of the set operating point
input voltages (V1,V2) for which they are obtained, and

sets the target value to increase, maintain or decrease
the operating point input voltage depending on the

calculated gradient value being positive, zero or
negative.
An apparatus according to any of claims 11 and 14 to
19, wherein said controller is a microcomputer having a 

memory programmed to cause it to function as a setting
means, a determining means and a correction means.
A programmed memory for use as the memory of the
microcomputer implemented controller of claim 20, which

memory includes executable instructions to carry out the
method as claimed in any of the claims 1 to 11.
A power regulator comprised of the apparatus of any
of claims 11 to 21 and a power converter (2;14) having

means of adjusting an operational point input voltage
applied across its inputs.
A power supply comprised of the power regulator of
claim 22 and a power source (1) connected across the

inputs of said power converter (2;14).
A power supply according to claim 23 wherein said
power source (1) is a solar cell battery.
The combination of the power supply of claim 23 or
24 and a load (3;15) connected across the outputs of said

power converter (2;14).
</CLAIMS>
</TEXT>
</DOC>
