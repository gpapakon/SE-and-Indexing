<DOC>
<DOCNO>EP-0641103</DOCNO> 
<TEXT>
<INVENTION-TITLE>
Method and apparatus for key distribution in a selective braodcasting system
</INVENTION-TITLE>
<CLASSIFICATIONS>H04L908	H04L2906	H04L908	H04L2906	</CLASSIFICATIONS>
<CLASSIFICATIONS-THIRD>H04L	H04L	H04L	H04L	</CLASSIFICATIONS-THIRD>
<CLASSIFICATIONS-FOURTH>H04L9	H04L29	H04L9	H04L29	</CLASSIFICATIONS-FOURTH>
<ABSTRACT>
A selective broadcasting method operative to transmit a 
plurality of message data signals to a corresponding plurality of 

subscriber subsets within a set of subscribers, the method comprising 
receiving an indication of a privileged set comprising an 

individual subset and transmitting a message data signal from 
which a key can be extracted by members of the privileged set and 

cannot be extracted by any set of members outside the privileged 
set whose number of members is less than a predetermined resiliency, 

wherein the length of the message data signal is less than 
the sum of lengths of the message data signals required if an 

individual message data signal is transmitted to each subscriber 
in the privileged set. 


</ABSTRACT>
<APPLICANTS>
<APPLICANT-NAME>
ALGORITHMIC RES LTD
</APPLICANT-NAME>
<APPLICANT-NAME>
ALGORITHMIC RESEARCH LTD.
</APPLICANT-NAME>
</APPLICANTS>
<INVENTORS>
<INVENTOR-NAME>
FIAT AMOS
</INVENTOR-NAME>
<INVENTOR-NAME>
FIAT, AMOS
</INVENTOR-NAME>
</INVENTORS>
<DESCRIPTION>
The present invention relates to apparatus and methods
for selective communications generally and more particularly to
apparatus and methods for selective broadcasting of television
signals. State of the art broadcast encryption methods are described in the following publications
   N. Alon and J. Spencer, The Probabilistic Method, Wiley, 1992;
   J. L. Carter and M. N. Wegman, Universal Classes of Hash Functions, Journal of Computer
and System Sciences 18 (1979), pp. 143-154;
   W. Diffie and M. Hellman, New Directions in Cryptography, IEEE Trans. on Information
Theory, vol. IT-22, 6 (1976), pp. 644-654;
   M.L. Fredman, J. Komlós and E. Szemerédi, Storing a Sparse Table with O(1) Worst
Case Access Time, Journal of the ACM, Vol 31, 1984, pp. 538-544;
   O. Goldreich, S. Goldwasser and S. Micali, How to Construct Random Functions Journal
of the ACM 33, 1986;
   R. Impagliazzo, L. Levin and M. Luby, Pseudo-random Generation given from a One-way
Function, Proc. of the 20th ACM Symp. on Theory of Computing, 1989;
   K. Mehlhorn, Data Structures and Algorithms: Sorting and Searching, Springer-Verlag,
Berlin Heidelberg, 1984;
   R. Rivest, A. Shamir and L. Adleman, A Method for Obtaining Digital Signature and
Public Key Cryptosystems, Comm. of ACM, 21 (1978), pp. 120-126;
   A. Shamir, On the Generation of Cryptographically Strong Pseudo-Random Number
Sequences, ACM Trans. Comput. Sys., 1 (1983), pp. 38-44; and
   M. N. Wegman and J. L. Carter, New Hash Functions and Their Use in Authentication
and Set Equality, Journal of Computer and System Sciences 22, pp. 265-279 (1981). The present invention seeks to provide a central broadcast site which broadcasts secure
transmissions to an arbitrary set of recipients while minimizing key management related
transmissions. Several methods are described that allow a center to broadcast a secret to
any set of privileged users out of a universe of size n so that coalitions of k users not
in the privileged set cannot learn the secret. In the preferred embodiment of the present
invention, each user stores O(k log k log n) keys and the center broadcasts O(k2log2k log n)
messages regardless of the size of the privileged set. This embodiment is resilient to any
coalition of k users. Another embodiment described herein is resilient with probability p
against a random subset of k users. Each user stores O(log k log(1/p)) keys and the center
broadcasts O(k log2k log(1/p)) messages.The present invention also seeks to provide an improved
system for selective broadcasting of
</DESCRIPTION>
<CLAIMS>
A selective broadcasting method operative to
transmit a plurality of message data signals to a

corresponding plurality of subsets within a population U
of subscribers, the method comprising:


receiving an indication of a privileged set
comprising an individual subset;
providing each subscriber with confidential
information to be stored which requires a certain

memory size; and
transmitting a message data signal from which a key
can be extracted by members of the privileged set,
characterized in that
 the receiving step also
comprises predetermining a resiliency value and a

probability p 
<
 = 1, and 
in that
 the key cannot be
extracted, with probability p, by any set S c U of

members outside the privileged set whose number of
members is no more than the predetermined resiliency

value.
A method according to claim 1 wherein the total
length of the message data signal is less than the sum

of lengths of the message data signals required if an
individual message data signal is transmitted to each

subscriber in the privileged set.
A method according to claim 1, wherein said
providing step comprises:


providing confidential information comprising a
set of keys respectively corresponding to the set of

all possible subscriber subsets within the
subscriber population with less than a predetermined 

number k of members, wherein for each subset, the
key corresponding thereto is provided only to those

subscribers not belonging to the subset;

and wherein said receiving step comprises:

providing a message data signal and selecting from
among the subscriber population the privileged set

of subscribers which is to exclusively receive the
message data signal, and transmitting information

identifying the privileged set;

and wherein said transmitting step comprises:

encrypting the message data signal using a key
comprising the bitwise XOR of all keys corresponding

to subsets which are disjoint to the privileged
set;

and wherein the method also comprises:

broadcasting a data signal comprising the encrypted
message.
A method according to claim 3 wherein said key
providing process comprises:


computing an n-leaf balanced binary tree

characterized in that
 its root is labelled with a
common seed and, for each vertex of the tree, the

label of the root of its right subtree is the left
half of the result of applying a pseudo random

function to the vertex label and the label of the
root of its left subtree is the right half of the

result of applying a pseudo random function to the
vertex label; and
providing each subscriber with the label of the root
of each tree in a forest of trees resulting from

removal from the balanced binary tree of a path 
extending from a leaf associated with the subscriber

to the root.
A method according to claim 1, wherein said
providing step comprises:


providing each subscriber i with confidential
information comprising a key g to the power of pi

where g is a high index value unknown to the
subscribers and wherein the pi values are

selected such that, for any two subscribers i and
j, pi and pj are relatively prime;

and said receiving step comprises:

providing the message data signal and selecting
from among the subscriber population the privileged

set of subscribers which is to exclusively receive
the message data signal, and transmitting

information identifying the privileged set;

and said transmitting step comprises:

encrypting the message data signal using a key
which is the modulo N value of g to the power of the

product of the pi values of all subscribers i
belonging to the privileged set, where N is a random

hard to factor prime composite which is known to
the subscribers;

and wherein the method also comprises:

broadcasting a data signal comprising the encrypted
message.
A method according to claim 1, wherein said
providing step comprises:


defining a plurality of 1 partitions of the
population of subscribers, each partition

comprising m subscriber sets; and 
for each partition and for each subscriber set
within the partition, providing a unique scheme

which is one-resilient within said set and providing
confidential information comprising keys to the

subscribers in said subscriber set as indicated by
the unique scheme;

and said transmitting step comprises

providing a value Mi for each partition i (i=
1,..., l), at least some of which values are random;
for each partition i and for each set j (j =
1, ..., m) within partition i, transmitting Mi to

all privileged subscribers in set j using the
scheme of set j under partition i; and
transmitting a message data signal in encrypted
form using a key which is the bitwise XOR of the

Mi's.
A selective broadcasting method for broadcasting to
a privileged set of subscribers from among a population

U of n subscribers, the method comprising:

defining a plurality of 1 partitions of the
population of subscribers, each partition comprising

m subscriber sets; and
for each partition and for each subscriber set
within the partition, providing a unique scheme

based on the method of claim 3 which is one-resilient
within said set and providing confidential

information comprising keys to the subscribers in
said subscriber set as indicated by the unique

scheme; 
providing a value Mi for each partition i (i=
1,..., l), at least some of which values are

random;
for each partition i and for each set j (j =
1, ..., m) within partition i, transmitting Mi to

all privileged subscribers in set j using the
scheme of set j under partition i; and
transmitting a message data signal in encrypted
form using a key which is the bitwise XOR of the

Mi's.
A selective broadcasting method for broadcasting to
a privileged set of subscribers from among a population

U of n subscribers, the method comprising:

defining a plurality of 1 partitions of the
population of subscribers, each partition comprising

m subscriber sets; and
for each partition and for each subscriber set
within the partition, providing a unique scheme

based on the method of claim 4 which is one-resilient
within said set and providing confidential

information comprising keys to the subscribers in
said subscriber set as indicated by the unique

scheme;
providing a value Mi for each partition i (i= 1,...,
l), at least some of which values are random;
for each partition i and for each set j (j = 1,
..., m) within partition i, transmitting Mi to all

privileged subscribers in set j using the scheme of
set j under partition i; arid
transmitting a message data signal in encrypted form
using a key which is the bitwise XOR of the Mi's.
A selective broadcasting method for broadcasting to
a privileged set of subscribers from among a population

U of n subscribers, the method comprising:

defining a plurality of 1 partitions of the
population of subscribers, each partition

comprising m subscriber sets; and
for each partition and for each subscriber set
within the partition, providing a unique scheme

based on the method of claim 5 which is one-resilient
within said set and providing confidential

information comprising keys to the subscribers in
said subscriber set as indicated by the unique

scheme;
providing a value Mi for each partition i (i= 1,...,
l), at least some of which values are random;
for each partition i and for each set j (j = 1,
..., m) within partition i, transmitting Mi to all

privileged subscribers in set j using the scheme of
set j under partition i; and
transmitting a message data signal in encrypted form
using a key which is the bitwise XOR of the Mi's.
A method according to claim 6 wherein 1, the number
of partitions, and m, the number of sets per partition,

are selected as follows:

m is at least k2 where k is a predetermined
resiliency value with probability p for a random set

of k members;
1 is at least log (1/p).
A method according to claim 6 wherein 1, the number
of partitions, and m, the number of sets per partition,

are selected as follows: 

m is at least 2k2 where k is a predetermined
resiliency value.
l is at least k log n.
A method according to any of the preceding claims
and also comprising splitting the subscriber population

into a plurality of subscriber subpopulations and
performing the above methods separately for each

subpopulation.
A method according to claim 12 wherein each
subpopulation comprises approximately 1000 subscribers.
A method according to claim 12 wherein each
subpopulation comprises 63 subscribers.
A method according to claim 12 wherein there are
approximately 100,000 subpopulations.
A selective broadcasting system operative to
transmit a plurality of message data signals to a

corresponding plurality of subsets within a set of
subscribers, the system comprising:


a subscriber memory loaded with confidential
information occupying a certain memory size;
broadcasting equipment operative to receive an
indication of a privileged set comprising an

individual subset and to transmit a message data
signal from which a key can be extracted by

members of a privileged set,
characterized in that
 the receiving step also
comprises predetermining a resiliency value and a

probability p 
<
 = 1, and 
in that
 the key cannot be
extracted, with probability p, by any set S c U of

members outside the privileged set whose number of 
members is no more than the predetermined resiliency

value.
A system according to claim 16 wherein the length of
the message data signal is less than the sum of

lengths of the message data signals required if an
individual message data signal is transmitted to

each subscriber in the privileged set.
A selective broadcasting system according to claim
16, wherein the subscriber memory comprises:


n subscriber memories storing a set of keys
respectively corresponding to the set of all

possible subscriber subsets within the subscriber
population with less than a predetermined number k

of members, wherein for each subset, the key
corresponding thereto is stored only by those

subscribers not belonging to the subset;

and wherein the broadcasting equipment comprises:

an encryptor operative to encrypt a message data
signal intended for a privileged set using a key

comprising the bitwise XOR of all keys corresponding
to subsets which are disjoint to the privileged set;
the system also comprising broadcasting equipment
operative to broadcast information identifying the

privileged set and a data signal comprising the
encrypted message.
A selective broadcasting system according to claim
16, wherein the subscriber memory comprises:


a plurality of subscriber memories associated
respectively with the subscribers, wherein the ith

subscriber memory associated with subscriber i
stores a key g to the power of pi where g is a high 

index value unknown to the subscribers and wherein
the pi values are selected such that, for any two

subscribers i and j, pi and pj are relatively prime;

and wherein the broadcasting equipment comprises:

encrypting a message data signal intended for a
privileged set of subscribers using a key which is

the modulo N value of g to the power of the
product of the pi values of all subscribers i

belonging to the privileged set, where N is a random
hard to factor prime composite which is known to the

subscribers;

the system also comprising:

broadcasting equipment operative to broadcast
information identifying the privileged set and a

data signal comprising the encrypted message.
A selective broadcasting system according to claim
16, wherein said subscriber memory comprises:


n subscriber memories associated with the n
subscribers respectively, wherein for each of a

plurality of l partitions of the population of
subscribers, each partition comprising m subscriber

sets and for each subscriber set within the
partition, keys distributed according to a unique

scheme which is one-resilient within said set are
stored in the memories of all subscribers in said

subscriber set, '

and wherein the broadcasting equipment comprises:

broadcasting apparatus operative, for each
partition i and for each set j (j = 1, ..., m)

within partition i, to transmit an Mi signal to
all privileged subscribers in set j using the 

scheme of set j under partition i, wherein at
least some of the Mi signals are random, the

broadcasting apparatus also being operative to
transmit a message data signal in encrypted form

using a key which is the bitwise XOR of the Mi's.
A method according to claim 1 wherein at least one
of the total subscriber memory size, for a set of m

subscribers, and the sum of message data signal lengths,
are less than the total subscriber memory size and sum

of message data signal lengths, respectively, required
when 21 keys are provided to each subscriber, where l is

an integer, and m/l message data signals are used to
transmit a common key to the set having m members.
</CLAIMS>
</TEXT>
</DOC>
