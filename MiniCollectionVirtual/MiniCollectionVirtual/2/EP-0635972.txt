<DOC>
<DOCNO>EP-0635972</DOCNO> 
<TEXT>
<INVENTION-TITLE>
Automated detection and correction of eye color defects due to flash illumination
</INVENTION-TITLE>
<CLASSIFICATIONS>H04N146	H04N162	G03B728	G03B7091	G03B1505	H04N162	G03B728	G03B7091	H04N5262	H04N146	H04N5262	G03B1505	</CLASSIFICATIONS>
<CLASSIFICATIONS-THIRD>H04N	H04N	G03B	G03B	G03B	H04N	G03B	G03B	H04N	H04N	H04N	G03B	</CLASSIFICATIONS-THIRD>
<CLASSIFICATIONS-FOURTH>H04N1	H04N1	G03B7	G03B7	G03B15	H04N1	G03B7	G03B7	H04N5	H04N1	H04N5	G03B15	</CLASSIFICATIONS-FOURTH>
<ABSTRACT>
A method of determining and correcting for eye 
color defects in an image due to flash illumination includes 

determining whether an eye color defect group candidate 
corresponds to a defective eye base based on group shape, 

coloration and brightness. 
The method is implemented using a digitizing scanner (10), 
a control and 

logic device (24) (computer) and an optical disc writer (36). A strip of 
film (15), containing one or more frames (18) of developed film, is 

placed into a scan gate (12). As each frame (18) is scanned the 
resultant image is digitized and transmitted to a memory (28) for 

storage. 
The computer (24) processes the stored data to provide output image data 

(32) which may be written to an optical disc (34) by the optical disc 
writer (36) to provide a report as to the characteristics of the 

anomalies. 

</ABSTRACT>
<APPLICANTS>
<APPLICANT-NAME>
EASTMAN KODAK CO
</APPLICANT-NAME>
<APPLICANT-NAME>
EASTMAN KODAK COMPANY
</APPLICANT-NAME>
</APPLICANTS>
<INVENTORS>
<INVENTOR-NAME>
BENATI PAUL J
</INVENTOR-NAME>
<INVENTOR-NAME>
COSGROVE PATRICK A
</INVENTOR-NAME>
<INVENTOR-NAME>
GRAY ROBERT T
</INVENTOR-NAME>
<INVENTOR-NAME>
BENATI, PAUL J.
</INVENTOR-NAME>
<INVENTOR-NAME>
COSGROVE, PATRICK A.
</INVENTOR-NAME>
<INVENTOR-NAME>
GRAY, ROBERT T.
</INVENTOR-NAME>
</INVENTORS>
<DESCRIPTION>
The present invention relates to digital
detection for eye color defects of a subject in a
digital image.In color flash photography a phenomenon know
as red eye can occur. The term "red eye" refers to a
person's photographically reproduced pupil(s) when they
appear red instead of their normal black coloration.
[This effect also occurs in flash photography of
animals, although the characteristic color may not be
red.] The reddish colored light is the result of the
light produced by the flash reflecting off the eye's
layer immediately behind the retina. To prevent this
problem two procedures have been used during image
capture: (1) increase the ambient light levels or (2)
separate the flash from the camera by several inches.
The first solution reduces the size of the pupil thus
reducing the quantity of light reflected and also
lessens the amount of required flash illumination. The
second measure prevents the lens from detecting the
reflected light since it is confined to a narrow beam
directed back towards its source--the flash.
Unfortunately the amateur photographer is not always in
a position to execute either of the above solutions.
In general the amateur uses a flash to account for the
location's lack of ambient light. In addition, many
point-and-shoot cameras, as well as some SLR's, have
the flash located closely to the lens.After the image has been digitally captured
it is possible to correct the eye color defects.
US-A-5,130,789 
describes
a method by which a region's chroma and luma channels
are modified after an operator identifies a region
surrounding an eye, and was used as a basis for the preamble of claim 1.It is an object of this invention to
automatically determine a defective colored eye in an
image.It is another object of this invention to
improve the correction by providing separate
corrections for body, border, and glint pixels; and
also provide for performing correction at different
resolutions than that of detection.These and other objects of the present invention are achieved
by the characterizing features of claim 1. Preferred
embodiments may be gathered from the dependent claims.One of the preferred methods of the present
invention is an automated method of detecting for eye color
defects of a subject in an image due to flash
illumination as set forth in claim 1. The method used by the present invention
maintains the '789 patent criterion of recoloration
without destroying the region's luma fluctuation.
However, the present invention automatically supplies
two of the three inputs
</DESCRIPTION>
<CLAIMS>
An automated
method of detecting for eye color

defects of a subject in a digital image due to flash
illumination, including


defining (100) a spatial region within the
digital image in which one or more eye color defects

may exist, which region includes at least a portion of
the subject's head;
sampling pixels within such spatial
region for their color content and comparing each such

sampled pixel with a plurality of threshold values
which are representative of eye color defects to

identify possible eye color defect pixels (210); and 
segmenting (220) the identified possible eye
color defect pixels into one or more spatially

contiguous groups; characterized by:
a) calculating (230) a first score for each pixel
of each segmented group and for each group based upon a

plurality of features including group size, group
shape, coloration, and brightness to identify eye color

defect group candidates;
b) selecting a seed pixel based on its
score from each identified eye color defect group

candidate and determining all the neighboring pixels
which are within a predetermined score range of their

neighboring pixels and those pixels in a group which
represent a significant pixel score transition so that

the determined transitions identify the outer boundary
of an eye color defect group candidate (240);
c) calculating (250) a second score for each
pixel for each eye color defect group candidate based

on a plurality of features including group size, group
shape, coloration, and brightness

;
d) selecting the best group score of an eye
color defect group candidate and comparing it relative

to a predetermined threshold group score to determine
whether a first eye color defect group is present and identifying it as corresponding to the most likely

eye; and
e) determining whether a second actual eye color
defect group is present based on whether the area of one of the color

defect candidate's eye is within a predetermined threshold ratio of
the area of the first actual eye color defect group corresponding to the

most likely eye, and whether this group candidate is within
a predetermined threshold angular subtense of the most

likely eye along the predetermined horizontal axis of
the subject's head.
The method of claim 1 wherein the group
size feature is area, the group shape feature is

eccentricity, the coloration and brightness features
are hue, saturation, lightness, and red to maximum

(green, blue) ratio.
The method of claim 1 or 2 wherein the scores
per pixel in steps a) and c) are equal to the product

of the scores of individual features, and the scores of
individual features are weighted functions of the

feature values of the pixels.
An automated method of detecting and correcting for
eye color defects of a subject in a digital image due

to flash illumination, including the method of any of the preceding claims and further comprising the steps of:
 
   f) correcting (300) the defective color in each

eye color defect group by: 

(i) determining (370) the correct resolution
and whether each pixel at the corrected resolution

is an eye color defect pixel;
(ii) categorizing (380) the eye color defect
pixels at the corrected resolution into either

body, border, or glint categories; and
(iii) correcting (340,350,360) the eye color defect
pixels in the body, border, or glint categories.
The method of claim 4 wherein the
threshold value represents minimum and maximum allowed

values consistent with the expected color of a eye
color defect group.
The method of any of the preceding claims wherein the group
score is an average of all the pixels.
The method of claim 4 wherein step f)
(i) includes determining at a lower resolution a

correction factor for each low resolution pixel which
is a function of the number of eye color defect pixels

at the original resolution disposed at the same image
location. 
The method of claim 4 wherein step f)
(i) includes categorizing at a higher resolution each

original eye color defect pixel into eye color defect
pixels and non-eye color defect pixels.
The method of claim 4 including
desaturating and reducing the illuminance for each

body, border, and glint pixel.
</CLAIMS>
</TEXT>
</DOC>
