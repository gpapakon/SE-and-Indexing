<DOC>
<DOCNO>EP-0656592</DOCNO> 
<TEXT>
<INVENTION-TITLE>
Memory access control for implementing protected memory regions
</INVENTION-TITLE>
<CLASSIFICATIONS>G06F1202	G06F1202	G06F1214	G06F1214	</CLASSIFICATIONS>
<CLASSIFICATIONS-THIRD>G06F	G06F	G06F	G06F	</CLASSIFICATIONS-THIRD>
<CLASSIFICATIONS-FOURTH>G06F12	G06F12	G06F12	G06F12	</CLASSIFICATIONS-FOURTH>
<ABSTRACT>
A data processing system (10 or 28) and method uses a 
memory management unit (MMU 14). The processor has two 

privileged modes of operations, such as a user mode and a 
supervisor mode of operation. The MMU 14 has a first mode of 

operation wherein logical address translation is performed via 
cache accesses and tablewalks, and a second mode of operation. 

The second mode of operation involves providing translation 
attribute bits from one of either a first transparent translation 

register (TTR 16), a second transparent translation register (TTR 
18), or a default location (22). The TTRs (16 and 18) can each map 

different address spaces and different addressed memory sizes 
and the default location (22) covers all memory that is not 

mapped by one of the TTRs (16 or 18). The default location (22) is 
programmable, provides write protection, and provides attribute 

bits independent from the privilege mode. 

</ABSTRACT>
<APPLICANTS>
<APPLICANT-NAME>
MOTOROLA INC
</APPLICANT-NAME>
<APPLICANT-NAME>
MOTOROLA, INC.
</APPLICANT-NAME>
</APPLICANTS>
<INVENTORS>
<INVENTOR-NAME>
PARMET ART
</INVENTOR-NAME>
<INVENTOR-NAME>
REVILLA JUAN GUILLERMO
</INVENTOR-NAME>
<INVENTOR-NAME>
PARMET, ART
</INVENTOR-NAME>
<INVENTOR-NAME>
REVILLA, JUAN GUILLERMO
</INVENTOR-NAME>
</INVENTORS>
<DESCRIPTION>
The present invention relates generally to data processors
which access memory, and more particularly, memory management
units having transparent address translation registers.Transparent translation registers of a memory management
unit are used to translate logical addresses output by a central
processing unit to a corresponding physical address in memory.
(See, e.g., WO-A-88 02148 by Moyer). In such a memory
management unit, to satisfy systems requiring the transparent
mapping of several large areas of memory, it is sometimes
necessary to provide memory access control over the remaining
address space where the transparent translation registers do not
map. This was accomplished in the past by a set of hardwired
access control attribute bits stored within the memory
management unit. This hardwired storage method has the one
major disadvantage that it provides no flexibility, since the
attribute bits are stored in a storage location fixed in the
hardware and cannot be changed by a system user or programmer.Some systems incorporated a privilege-mode dependent
mode of operation for the MMU to provide access control over the
unmapped space. Specifically, in the Identity Translation Mode,
access control is regulated by a set of four area descriptors
wherein a first descriptor is used to control supervisor space
instruction accesses, a second descriptor is used to control
supervisor space operand accesses, a third descriptor is used to
control user space instruction accesses, and a fourth descriptor is
used to control user space operand accesses. This method has a
major disadvantage in that it requires the segmenting of the
logical address space into supervisor and user spaces since, the 
supervisor area descriptors cannot protect the supervisor space
from unauthorized accesses by user programs. Another major
disadvantage this method presents is that it requires a multiple
number of registers to be configured by the programmer.General key protection methods for protecting information in
a real storage unit are also known. (See, e.g., GB 2 248327 by
Takahashi).The previously mentioned disadvantages are overcome and
other advantages achieved with the present invention. In one
form, the present invention comprises a method for providing
memory access control in a data processing system wherein the
data processing system has at least two processor privilege
modes of operation. A logical address is provided to a memory
management unit within the data processor. A portion of the
logical address is selectively
</DESCRIPTION>
<CLAIMS>
A data processor (10) having a memory management unit
(14) with at least two modes of operation, one mode of

operation being a normal mode of operation wherein a logical
address is translated to a physical address, and a second

mode of operation being a default mode of operation wherein
the logical address is used as the physical address, the data

processor having two privilege modes wherein the two
privileged modes provide data protection, the data processor

comprising :

circuitry (12) within the data processor for providing,
to the memory management unit, a logical

address;

said data processor being characterized by :

a first transparent translation register (16), within
the memory management unit, which contains

write protection information to protect data in
memory;
a second transparent translation register (18), within
the memory management unit, which contains

write protection information to protect data in
memory;
compare circuitry (20) for receiving the logical
address, the compare circuitry being coupled to

both the first transparent translation register
and the second transparent translation register,

the compare circuitry comparing a first
predetermined number of bits in the logical

address to a second predetermined number of
bits in each of the first and second transparent

translation registers and asserting a control
signal if the first predetermined number of bits

in the logical address equals the second
predetermined number of bits in one of the first

and second transparent translation registers, the 
compare circuitry functioning in the default

mode of operation;
a default storage location (22), within the memory
management unit, for storing a plurality of

control attribute bits, the default storage
location having an output for providing the

plurality of control attribute bits regardless of
the privilege mode of the data processor, the

control attribute bits in the default storage
location including write protection information

used to protect data in memory when the first
and second transparent translation registers do

not provide write protection information; and
a selector circuit (24) having a first input for
receiving the write protection information from

the first transparent translation register, having
a second input for receiving the write protection

information from the second transparent
translation register, and having a third input

coupled for receiving the write protection
information from the default storage location,

the selector circuit being coupled to the control
signal wherein the control signal is used to

determine the output of the selector circuit
wherein the output of the selector circuit is the

bits of one of either the first input, the second
input, or the third input, to ensure write

protection when the selector circuit is
functioning in the default mode of operation.
A method for providing memory access control in a data
processing system having a memory management unit with at least two modes of operation, one mode

of operation being a normal mode of operation wherein a logical address is translated
to a physical address, and a second mode of operation being a default mode of operation wherein the logical address is used as the physical address,

the data processing system having at
least two processor privilege modes of operation, the

method comprising the step of:

providing a logical address to the memory management
unit within the data processor;
 
said method being characterized by the steps of:


selectively comparing a portion of the logical address
to a predetermined number of bits within a first

transparent translation register, and asserting a
first control signal if the portion of the logical

address is equal to the predetermined number of
bits within the first transparent translation

register;
selectively comparing a portion of the logical address
to a predetermined number of bits within a

second transparent translation register, and
asserting a second control signal if the portion

of the logical address is equal to the
predetermined number of bits within the second

transparent translation register; and
selecting, based on one of either the first control
signal or the second control signal, control

attribute bits from the first transparent
translation register, control attribute bits from

the second transparent translation register, or
control attribute bits from a default storage

location wherein the default storage location
provides control attribute bits regardless of

processor privilege mode, the control attribute
bits of each of the first transparent translation

register, the second transparent translation
register and the default storage location

containing write protection bits as part of the
control attribute bits to protect memory

accesses when operating in the default mode of
operation.
The method of claim 2 further comprising the step of:

disabling one of either the first or second transparent
translation registers before performing the

steps of selectively comparing.
The method of claim 2 further comprising the step of:

masking the predetermined number of bits within a
first transparent translation register via a

predetermined number of masking bits, the
masking bits allowing less than the

predetermined number of bits within a first
transparent translation register to be compared

in the first step of selectively comparing.
The method of claim 2 further comprising the step of:

writing a value to the default storage location before
the step of selecting.
The method of claim 2 further comprising the step of:

writing a bit value to the default storage location
before the step of selecting, the bit value

indicating a write protection status of at least
one memory access made by the data processor.
</CLAIMS>
</TEXT>
</DOC>
