<DOC>
<DOCNO>EP-0632383</DOCNO> 
<TEXT>
<INVENTION-TITLE>
Scannable interface to non-scannable microprocessor.
</INVENTION-TITLE>
<CLASSIFICATIONS>G06F1122	G06F1122	G06F11267	G06F11267	</CLASSIFICATIONS>
<CLASSIFICATIONS-THIRD>G06F	G06F	G06F	G06F	</CLASSIFICATIONS-THIRD>
<CLASSIFICATIONS-FOURTH>G06F11	G06F11	G06F11	G06F11	</CLASSIFICATIONS-FOURTH>
<ABSTRACT>
A diagnostic system for diagnosing states of circuit 
elements is described, wherein scannable circuits can be 

scanned without disturbing the state of unscannable circuits 
of violating protocols of busses on which unscannable devices 

are attached. One unscannable device is a standardized 
microprocessor. A processor interface circuit is coupled 

between the microprocessor and scannable processor circuits, 
via a processor bus, to insulate the scannable processor 

circuits from the unscannable microprocessor. The processor 
interface circuit is also scannable, including memory elements 

which affect the bus, by preventing a scan when the bus is in 
use. A scan is prevented through the use of a maintenance 

request signal from a scan controller to the processor 
interface circuit, and one or more maintenance approval 

signals from the processor interface circuit to the scan 
controller. 


</ABSTRACT>
<APPLICANTS>
<APPLICANT-NAME>
TANDEM COMPUTERS INC
</APPLICANT-NAME>
<APPLICANT-NAME>
TANDEM COMPUTERS INCORPORATED
</APPLICANT-NAME>
</APPLICANTS>
<INVENTORS>
<INVENTOR-NAME>
RAHMAN MIZANUR MOHAMMED
</INVENTOR-NAME>
<INVENTOR-NAME>
SABERNICK FRED C C O MRS N SAB
</INVENTOR-NAME>
<INVENTOR-NAME>
SPROUSE JEFF A
</INVENTOR-NAME>
<INVENTOR-NAME>
RAHMAN, MIZANUR MOHAMMED
</INVENTOR-NAME>
<INVENTOR-NAME>
SABERNICK,FRED C. C/O MRS.N.SABERNICK
</INVENTOR-NAME>
<INVENTOR-NAME>
SPROUSE, JEFF A.
</INVENTOR-NAME>
</INVENTORS>
<DESCRIPTION>
The present invention relates to the field of 
digital processing systems with diagnostic capabilities. More 
specifically, in one embodiment, the invention provides a 
means for scanning scannable processor circuitry without 
disturbing a non-scannable microprocessor which forms part of 
a digital system. To fully diagnose a logic-only circuit (i.e., no 
memory of past states), a diagnostic system need only control 
the overall inputs to the circuit, and record the outputs. 
The outputs for a known set of inputs, when compared to an 
expected set of outputs, will indicate if the circuit is 
working properly. Circuits with memory elements, such as 
flip-flops, latches, and memory storage cells, are more 
complicated to diagnose. To fully diagnose circuits with memory elements, not 
only must the inputs be controlled, but the internally 
remembered states must be known and controllable. Some 
internal states can be controlled by manipulation of the 
inputs to the circuit. For example, the internal state of a 
counter, i.e., its count, can be controlled by asserting a 
reset input of the counter to reach a known state, then 
clocking the clock input to reach the desired internal state. 
This, of course, is not practical with today's complex 
circuits. Furthermore, for certain tests, the internal state 
might need to be set to a state which is not reachable through 
mere manipulation of the circuit's inputs. What is needed is a means for reading the internal 
state of the circuit and for setting the internal state to a 
specific state. With discrete circuitry, reading an internal 
state can be done by probing each memory element and setting a 
known state can be done by gating off each memory element 
output and substituting a logic value consistent with the 
desired internal state. With integrated circuitry, however,  
 
the number of pins over which signals can be communicated 
between a test system and the integrated circuit severely 
limits the number of pins which can be allocated to internal 
state testing and control. One well known method of dealing with diagnostics in 
integrated circuits (IC's) is to include a scan path among the 
logic of the circuit. A scan path is a serial path linking 
all the memory elements of a circuit, or at least those which 
are to be scannable elements into a serial stream. Placing 
the elements in a serial scan path allows the internal state 
to be read serially from one pin, and allows the internal 
state to be set with one pin. The integrated circuit has a mechanism
</DESCRIPTION>
<CLAIMS>
A diagnostic system for diagnosing states of 
circuit elements within
 a digital computer where internal 
states of a microprocessor in the digital computer are not 

available for control by the diagnostic system, comprising: 
   a plurality of scannable processor circuits; 

   a processor interface circuit coupled between the 
microprocessor via a processor bus and coupled to said 

plurality of scannable processor circuits, wherein said 
processor interface circuit interfaces with the microprocessor 

using a predetermined bus protocol over said processor bus; 
   a scan controller coupled to said plurality of 

scannable processor circuits and said processor interface 
circuit, wherein said scan controller is capable of reading 

out and modifying internal states of said plurality of 
scannable processor circuits and said processor interface 

circuit; 
   a first signal means for providing a maintenance 

request signal from said scan controller to said processor 
interface circuit; 

   a second signal means for providing a maintenance 
approval signal from said processor interface circuit to said 

scan controller; and 
   means within said processor interface circuit and 

coupled to said processor bus, for ensuring that said 
maintenance approval signal is not asserted if said 

predetermined bus protocol would be violated by a change of an 
internal state of said processor interface circuit. 
The apparatus of claim 1, further comprising: 
   an internal bus between said processor interface 

circuit and said scannable processor circuits; 
   a first state machine within said processor 

interface circuit for tracking a diagnostic state; 
   a second state machine within said processor 

interface circuit for indicating that said processor bus is 
not to be accessed, said second state machine controlled by a 

 
first signal from said first state machine indicating that 

said diagnostic state is to become an idle state after said 
processor bus is idle; and 

   a third state machine within said processor 
interface circuit for indicating that said internal bus is not 

to be accessed, said third state machine controlled by a 
second signal from said first state machine indicating that 

said diagnostic state is to become an idle state after said 
internal bus is idle. 
The apparatus of claim 1, wherein said 
maintenance request signal comprises a request signal and a 

maintenance type signal, where said maintenance type signal 
requests either a scan or a bus step, and wherein said 

processor interface circuit comprises logic to perform a scan 
and logic to perform a bus step in response to said 

maintenance type signal. 
The apparatus of claim 1, wherein each of said 
plurality of scannable processor circuits, said processor 

interface circuit, and said scan controller are individual 
integrated circuit chips mounted on a processor board with the 

microprocessor. 
A method of diagnosing scannable circuit 
elements which are coupled in a circuit including unscannable 

circuit elements, comprising the steps of: 
   isolating the unscannable circuit elements from the 

scannable elements over a known interface, said known 
interface connecting the unscannable circuit elements to a 

scannable interface element; 
   asserting a first signal requesting a diagnostic, 

where said first signal is input to said scannable interface 
element; 

   waiting for any in-process bus cycles to complete 
over said known interface; 

   holding control signals output by said scannable 
interface element over said known interface in a fixed state, 

 
said fixed state selected such that a state of the unscannable 

circuit elements is not uncontrollably affected by any unfixed 
signals on said known interface while said scannable interface 

element is being scanned. 
A digital processor system with scannable 
processor circuits and a non-scannable microprocessor, 

comprising: 
   a first logical circuit, where a processor bus 

having a predefined bus protocol with predefined handshaking 
sequences comprising bus steps couples the microprocessor to 

the scannable processor circuits, said first logical circuit, 
coupled to a scannable processor interface circuit which is in 

turn coupled to said processor bus, for performing a bus step 
of the processor bus such that said scannable processor 

circuits can be scanned between bus steps without violating 
said bus protocol; 

   a second logical circuit, coupled to the scannable 
processor circuits for single-stepping at least one of the 

scannable circuits; and 
   a third logical circuit, coupled to the first and 

second logical circuits, which allows said first and second 
logical circuits to be included in a scan path through the 

scannable processor circuits. 
</CLAIMS>
</TEXT>
</DOC>
