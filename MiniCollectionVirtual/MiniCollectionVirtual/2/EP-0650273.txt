<DOC>
<DOCNO>EP-0650273</DOCNO> 
<TEXT>
<INVENTION-TITLE>
Circuit for inserting stuffbits in a digital data stream at regular distances
</INVENTION-TITLE>
<CLASSIFICATIONS>H04J307	H04J307	</CLASSIFICATIONS>
<CLASSIFICATIONS-THIRD>H04J	H04J	</CLASSIFICATIONS-THIRD>
<CLASSIFICATIONS-FOURTH>H04J3	H04J3	</CLASSIFICATIONS-FOURTH>
<ABSTRACT>
This device inserts stuffing bits at regular intervals into a digital train consisting of rows of bits originating from a first synchronous link (1) strobed by a first clock (HE), and which is to send on a second synchronous link (10) strobed by a second clock (HL). It includes:     - a buffer memory (5);   - a pointer (4) supplying a write address to the buffer memory;   - a pointer (6) supplying a read address to the buffer memory; - means (12, 13) for calculating the filling value ( DELTA P) of the buffer memory (5); - means (14, 15) for comparing this value ( DELTA P) with a first and with a second threshold value (NF, NE), and for producing a stuffing control signal (JP, JN); - means (11) for determining the first and the second threshold value (NF, NE) on the basis of the phase shift between the header of a row originating from the first link (1) and the header of a row sent at the same instant on the second link (10).   Application to gateways at the input, and to telecommunications networks using the synchronous digital hierarchy. 
<
IMAGE
>
</ABSTRACT>
<APPLICANTS>
<APPLICANT-NAME>
CIT ALCATEL
</APPLICANT-NAME>
<APPLICANT-NAME>
ALCATEL
</APPLICANT-NAME>
</APPLICANTS>
<INVENTORS>
<INVENTOR-NAME>
ETIENNE JEAN-PAUL
</INVENTOR-NAME>
<INVENTOR-NAME>
ETIENNE, JEAN-PAUL
</INVENTOR-NAME>
</INVENTORS>
<CLAIMS>
Device for justifying at regular intervals a digital bit stream received from a first
synchronous link (1) timed by a first clock (H
E
) and to be sent on a second
synchron
ous link (10) timed by a second clock (H
L
), said binary bit stream
comprising a continuous sequence of rows of bits, each row comprising a fixed

total number of bits but including a payload comprising a variable number of
bits and a header (SOH, PT) comprising a variable number of bits, the numbers

of bits varying according to whether said row has been subjected to positive
justification, negative justification or no justification, the device including:


a buffer memory (5) into which said payload is written under the control of said
first clock and from which said payload is read under the control of said second

clock;
means (12, 13) for calculating a value (ΔP) indicative of how full said buffer
memory (5) is;
means (14, 15) for comparing said filling value to first and second threshold
values (NF, NE) to produce a negative justification command signal (JN) when it

is greater than said first threshold value (NF) and to produce a positive
justification command signal (JP) when it is less than said second threshold value

(NE);
characterised in that the first and second threshold values are variable;
and in that the device includes means (11, 16, 17, 29) for determining first
and second variable threshold values (NF, NE) according to the phase difference

(ΔS) between the header (SOH
E
) of a row received from said first link (1) and the
header (SOH
L
) of a row sent on said second link (10).
Device according to claim 1 characterised in that said means (11, 16, 17, 29)
for determining said first and second threshold values (NF, NE) as a function of

the phase difference (Δs) include:

means (20) for supplying a value (ΔS) representing the phase difference
between the header of a row received (SOH
E
) and the header of a row sent
(SOH
L
); and
two first function generators (22, 23) operating under the control of said value
(ΔS) representing said phase difference and supplying two respective threshold

values (NE, NF).
Device according to claim 1 characterised in that each of said two function
generators (22, 23) generates a sawtooth function: 


a first slope of the sawtooth (GH; IJ) corresponding to a first time interval (T
r
;
t
5
t
6
; t
11
t
12
) in which said phase difference between the header of a row
received (SOH
E
) and the header of a row sent (SOH
L
) is such that the latter
header has a phase delay relative to the former header and the two headers

overlap in time;
a second slope of the sawtooth (OG; OI) corresponding to a second time
interval (T
P
-T
r
; t
1
t
5
, t
6
t
7
) in which the above two conditions are not satisfied
simultaneously.
Device according to claim 1 characterised in that said means (11, 16, 17, 29)
for determining said first and second variable threshold values (NF, NE) are also

responsive to a justification indicator signal (S) indicating whether a row has
been subjected to justification or not.
Device according to claim 4 characterised in that said means (11, 16, 17, 29)
for determining said first and second threshold values (NF, NE) include:


a counter (20) supplying a value (Δs) representing said phase difference
between the header of a row received (SOH
E
) and the header of a row sent
(SOH
L
);
two first function generators (22, 23) operating under the control of said value
(ΔS) representing said phase difference and supplying two respective values

(NE1, NF1);
a high-pass digital filter (31 through 37) for filtering said justification indicator
signal (S);
two second function generators (38, 39) operating under the control of the
filtered signal and supplying respective values (NE2, NF2); and
means (16, 17) for calculating said first and second threshold values (NE, NF)
by respectively adding a value (NE1; NF1) supplied by said first function

generators (22, 23) and a value (NE2; NF2) supplied by said second function
generators (38, 39).
Device according to claim 5 characterised in that said digital filter (31 through
37) is a variable bandwidth high-pass filter in which the bandwidth is

determined by the value of at least one parameter (m1, m2), and in that the
device includes means (30, 31) for determining the value of each filter

parameter according to how full (ΔP) said buffer memory (5) is, in order to
increase the bandwidth of said filter if a transient tends to saturate said memory.
Device according to claim 6 characterised in that said means (30, 31) for 
determining the value of at least one parameter modify the value of at least one

parameter in a direction to increase said bandwidth if said memory (12) is full
(ΔP) to above a predetermined threshold value and in synchronism with

justification, in order to modify the value of said parameter just before a
justification;

in that they modify the value of at least one parameter in a direction to reduce
said bandwidth:


if the buffer becomes full to less than a predetermined threshold value; and
if the above condition is satisfied for a predetermined time (T
0
); and
if these means detect a series of justifications with no interruption during said
predetermined time (T
0
).
Device according to claim 6 characterised in that the bandwidth of said filter (31
through 37) is determined by at least two parameters (m1, m2) and in that said

means (30, 31) for determining the value of each filter parameter compare said
filling value to a plurality of separate fixed threshold values and in that they

modify only one parameter (m1, m2) at a time when said filling value becomes
respectively greater than or less than one of the threshold values.
Device according to claim 6 in which said filter (31 through 37) includes at least
two stages and in which the final value supplied by the first stage (32 through

34) is respectively multiplied or divided by two when the value of a parameter is
increased or decreased by one unit,

characterised in that said first stage (31 through 34) further includes means (31,
33) for multiplying or dividing by 2
k
 the value supplied by said first stage and
means (31) for controlling the multiplying or dividing means when the means

(31) for determining the value of each parameter determine for said first stage a
parameter modification equal to +k or -k, respectively, where k is a non-null

integer.
Device according to claim 5 characterised in that said justification indicator
signal (S) temporarily assumes two values of opposite sign to indicate positive

justification and negative justification, respectively, and assumes a null value in
the absence of any justification;

and in that said second function generators (38, 39) respectively generate the
following functions:


a function (NE2) increasing linearly with the filtered justification signal (S8)
when the latter indicates positive justification and having a predetermined fixed 

value when it indicates negative justification or no justification; and
a function (NF2) increasing linearly with the filtered justification signal (SF)
when the latter indicates negative justificati
on and having a predetermined fixed
value when it indicates positive justification or no justification.
</CLAIMS>
</TEXT>
</DOC>
