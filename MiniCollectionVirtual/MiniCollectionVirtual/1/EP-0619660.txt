<DOC>
<DOCNO>EP-0619660</DOCNO> 
<TEXT>
<INVENTION-TITLE>
Method of file signature and device for performing the method
</INVENTION-TITLE>
<CLASSIFICATIONS>G07F712	G06F1200	G07F710	G06F1200	G07F712	G09C100	G09C100	G07F710	</CLASSIFICATIONS>
<CLASSIFICATIONS-THIRD>G07F	G06F	G07F	G06F	G07F	G09C	G09C	G07F	</CLASSIFICATIONS-THIRD>
<CLASSIFICATIONS-FOURTH>G07F7	G06F12	G07F7	G06F12	G07F7	G09C1	G09C1	G07F7	</CLASSIFICATIONS-FOURTH>
<ABSTRACT>
The invention relates to a method of signing a main computer file (FP), of the type consisting in making circuits of an information processing device (1,3,4) calculate at least one signature (SG) of the file, taking into account at least one secret data item (S; Sd) specific to the signatory, but unknown to the latter, memorised in a secret memory area of a portable electronic object (4), with a memory and processing circuits, available to the signatory, and in linking the calculated signature to the main file. It is characterised in that, upon the calculation of each signature, it further consists in taking account of at least a part of the main file, so that the signature is a function of the secret data item of the signatory and of each part of the file taken into account, and in creating a secondary file (FS) and in writing therein at least some information (IN) making it possible to identify each part of the main file having served for the calculation of this signature, and in linking the secondary file, on the one hand to the corresponding signature, and, on the other hand, to the signed file. 
<
IMAGE
>
</ABSTRACT>
<APPLICANTS>
<APPLICANT-NAME>
BULL CP8
</APPLICANT-NAME>
<APPLICANT-NAME>
BULL CP8
</APPLICANT-NAME>
</APPLICANTS>
<INVENTORS>
<INVENTOR-NAME>
UGON MICHEL
</INVENTOR-NAME>
<INVENTOR-NAME>
UGON, MICHEL
</INVENTOR-NAME>
</INVENTORS>
<CLAIMS>
Method for signature of a main computer file (FP) by a person, of
the type consisting in having at least one signature (SG) of the file

calculated by circuits of an information processing device (1, 3, 4), using a
signature algorithm (Aa, Ao) and taking account of at least one secret

data item (S; Sd) specific to the signatory, but unknown to him, stored in a
secret memory zone of a portable electronic object (4), with a memory and

processing circuits, available to that signatory, and in linking the
calculated signature to the main file, 
characterised in that
, when each
signature is calculated, it further consists in:


selecting at least one chosen portion (19) of the main file to which
the signatory wishes to attach his signature, so that the signature

is a function of the secret data item of the signatory and of each
chosen portion of the file;
creating a secondary file (FS) and recording therein at least some
information (IN) allowing the identification of each portion of the

main file that was used in calculating this signature; and
linking the secondary file on the one hand to the corresponding
signature and on the other hand to the signed file.
Method according to Claim 1, comprising the step consisting in
recording, in said secondary file (FS), a piece of algorithm information (IC)

defining a type of signature algorithm used for calculating said signature.
Method according to Claim 1 comprising the step consisting in
recording, in said secondary file (FS), a piece of portable object

information (10) defining a type of portable object used for calcullating said
signature. 
Method according to Claim 1, including the step consisting in
having the main file (FP) signed by a plurality of signatories having

different secret data items (S, Sd), located respectively in different
portable objects (4), by means of the following steps:


selecting from the main file as many chosen file portions (19) as

there are signatories, for which the respective signatories intend
to calculate their signature;
calculating each signature by using an information processing
device (1) incorporating a signature algorithm and executing a

calculation with this algorithm on the basis of said respective
secret data item of the signatories, taken from the corresponding

portable object and on the basis of the corresponding chosen file
portion, in order to obtain a result defining each signature;
using a secondary file (FS) to record a piece of file identification
information (IN) identifying, in the main file, all the chosen file

portions that have been used to calculate the signature; and
linking the main file, the signatures and the secondary file.
Method according to Claim 1, in which the calculation of signatures
comprises the steps consisting in:


providing a first signature algorithm (Aa) in the information
processing device;
providing a second key calculation algorithm (Ao) in the portable
object;
producing and transmitting a variable data item (E) from the
circuits of the processing device to the circuits of the object; 
calculating a key (K) in the circuits of the object by executing the
second key algorithm in the circuits of the object and by using the

variable data item and the secret data item;
transmitting the key from the circuits of the object to the circuits of
the processing device;
calculating the signature by executing the first signature algorithm
in the circuits of the processing device and using the key and said

chosen file portion (19); and
recording the variable data item in the secondary file (FS).
Method according to Claim 1, in which the calculation of signatures
comprises the steps consisting in:


executing the signature algorithm (Ao) in the portable object;
transmitting the chosen file portion (19) from the circuits of the
processing device to the circuits of the object; and
calculating the signature by using this chosen file portion and the
secret data item by executing the signature algorithm in the

circuits of the object.
Method according to Claim 1, further consisting in verifying the
signature linked with the main file, the signature verification step

comprising the steps consisting in:

identifying the chosen file portion (19) within the main file (FP) by
using said file identification information (IN) in the secondary file

(FS);
using an information processing device (1) incorporating said
signature algorithm and, in a secret memory zone, said secret

data item (S, Sd); 
recalculating the signature in the device by executing a
calculation with the signature algorithm, based on the secret data

item in the secret memory zone and on the identified chosen file
portion, and taking account of any other information previously

recorded in the secondary file in order to calculate the signature,
the result of the calculation constituting the recalculated

signature;
comparing the recalculated signature with the signature (SG)
linked to the main file; and
indicating a result of the comparison without revealing the
recalculated signature.
Apparatus for allowing a person to sign a main computer file (FP),
for the implementation of the method according to any one of Claims 1 to

11, including:

a portable object (4) having a memory and processing circuits,
said portable object being dedicated to one signatory and

available to him, and a secret zone of this memory storing a
secret data item (S, Sd) that is specific to an identify of at least

one signatory;
information processing means (1);
means for calculating a signature (SG) by using a signature
algorithm (Aa, Ao) and by executing a calculation with this

algorithm, based on the secret data item of the portable object
and on the file, a result of this calculation constituting said

signature;

   
characterised in that
 it further comprises:

means (6) for displaying the content of the main file; 
means for allowing the signatory to select from the main file a
chosen file portion (19) so that said signature (SG) is based on

that portion;
means for using a secondary file (FS) for recording a piece of file
identification information (IN) identifying within the main file said

chosen file portion used for calculating the signature; and
means for linking the main file, the signature and the secondary
file.
Apparatus according to Claim 8, further comprising:

means (13) for displaying a name or a rank of a signature already
linked to a file;
means for selecting at least one signature to be verified; and
means (14) for displaying the rank or the name of a signature for
which calculation or verification is in progress.
Apparatus according to Claim 8, comprising means for specifying to
the information processing means (1) the characteristics (IO) of the

portable object that is used for a signature for which calculation is in
progress, or that has been used for a signature for which verification is in

progress.
Apparatus according to Claim 8, comprising a verification device
associated with a verification module arranged so as to find and/or

recalculate the parameters used for calculating the signature, these
parameters being different from said portions (19) of the main file (FP)

used for calculating the signature, without revealing said parameters. 
Apparatus according to Claim 8, in which the module is a portable
electronic object (4) having a memory and processing circuits, said

portable object being capable of connecting to the verification device.
Apparatus according to Claim 12 in which the portable electronic
objects (4) available to the signatories are adapted so as to include said

verification module, the objects serving both for signing the files and for
verifying the calculated signatures, using a non-diversified or diversified

data item.
</CLAIMS>
</TEXT>
</DOC>
