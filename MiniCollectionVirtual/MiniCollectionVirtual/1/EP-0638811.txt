<DOC>
<DOCNO>EP-0638811</DOCNO> 
<TEXT>
<INVENTION-TITLE>
Estimator of amplitude and frequency of a noisy biased sinusoid from short bursts of samples
</INVENTION-TITLE>
<CLASSIFICATIONS>G01C1956	G01C1956	G01R1900	G01R1900	G01R1904	G01R1904	G01R1925	G01R1925	G01R2300	G01R2302	G06F1700	G06F1700	H04L120	H04L120	H04L2738	H04L2738	</CLASSIFICATIONS>
<CLASSIFICATIONS-THIRD>G01C	G01C	G01R	G01R	G01R	G01R	G01R	G01R	G01R	G01R	G06F	G06F	H04L	H04L	H04L	H04L	</CLASSIFICATIONS-THIRD>
<CLASSIFICATIONS-FOURTH>G01C19	G01C19	G01R19	G01R19	G01R19	G01R19	G01R19	G01R19	G01R23	G01R23	G06F17	G06F17	H04L1	H04L1	H04L27	H04L27	</CLASSIFICATIONS-FOURTH>
<ABSTRACT>
The amplitude or frequency of a sinusoidal signal 
represented as sample values S₁, S₂, S₃, S₄ is estimated by 

computing a triplet of differences x₁, x₂, x₃, where x₁ is a 
difference between S₂ and S₁, x₂ is a difference between S₃ and S₂, 

and x₃ is a difference between S₄ and S₃. An indication of the 
estimate of the amplitude or frequency is computed as a ratio of 

algebraic functions of the differences x₁, x₂, x₃. The amplitude 
is computed as the square root of a first ratio of algebraic 

functions, and the frequency is computed as an arc-cosine 
function of a second ratio of algebraic functions. Preferably 

the ratio is evaluated by a division operation computed as a 
polynomial approximation, and the square root function and the 

arc-cosine function are also computed as a polynomial 
approximation. Preferably ratios computed from a plurality of 

triplets are averaged together to give more accurate estimates. 
Preferably any ratio having a denominator value that has a 

magnitude less than a threshold value is excluded from the 
average of the ratios, so that the average will not be corrupted 

by any inaccurate result that could be obtained when dividing by 
a relatively small number. The method can be used for 

compensating a parasitic capacitance, or for monitoring the 
health of a plurality of signals in an electronic circuit. 


</ABSTRACT>
<APPLICANTS>
<APPLICANT-NAME>
ROCKWELL INTERNATIONAL CORP
</APPLICANT-NAME>
<APPLICANT-NAME>
ROCKWELL INTERNATIONAL CORPORATION
</APPLICANT-NAME>
</APPLICANTS>
<INVENTORS>
<INVENTOR-NAME>
WHITE STANLEY A
</INVENTOR-NAME>
<INVENTOR-NAME>
WHITE, STANLEY A.
</INVENTOR-NAME>
</INVENTORS>
<DESCRIPTION>
The present invention relates generally to digital signal
processing, and more particularly to signal processing for
detecting the amplitude and frequency of a noisy, biased and
sparsely-sampled sinusoidal signal.A known method of estimating the amplitude of a sampled
sinusoidal signal is to compute a "root-mean square" (RMS) value,
and then multiply the RMS value by the square root of two. This
method, however, is inaccurate when the sinusoid is sparsely
sampled and an estimate is obtained from a block of a small
number of samples.In accordance with a basic aspect of the invention, there is
provided a method of estimating the amplitude and frequency of a
sinusoidal signal represented as sample values S1, S2, S3, S4 at
respective spaced instants in time. The method includes the
steps of: computing a triplet of differences x1, x2, x3, where x1
is a difference between S2 and S1, x2 is a difference between S3
and S2, and x3 is a difference between S4 and S3; and computing an
estimate (B) of the amplitude, and an estimate (f) of the
frequency, of the sinusoidal signal from the triplet of
differences. Preferably an indication of the estimate of the 
amplitude or frequency is computed as a ratio of algebraic
functions of the differences x1, x2, x3. The amplitude, for
example, is computed as the square root of a first ratio of
algebraic functions, and the frequency is computed as an arc-cosine
function of a second ratio of algebraic functions.
Preferably the ratio is evaluated by a division operation
computed as a polynomial approximation, and the square root and
the arc-cosine functions are also computed as polynomial
approximations.In accordance with another aspect, the present invention
provides a method of obtaining an indication of a characteristic
of a signal represented as sample values (x1, x2, x3, ..., xn) at
respective spaced instants in time. The method includes the
steps computing a series of ratios of algebraic functions of
triplets (xi, xi-1, xi-2) of neighboring ones of the sample values,
and computing an average of the ratios to produce the indication
of the signal characteristic. Preferably any ratio having a
denominator value that has a magnitude less than a threshold
value is excluded from the average of the ratios, so that the
average will not be corrupted by any inaccurate result that could
be obtained when diving by a relatively small number.In accordance with a final aspect, the present invention
provides a system for monitoring the health of a plurality of
analog signals in an
</DESCRIPTION>
<CLAIMS>
A method of estimating amplitude of a sinusoidal signal 
represented as sample values S₁, S₂, S₃, S₄ at respective 

spaced instants in time, said method comprising the steps 
of: 


a) computing a triplet of differences x₁, x₂, x₃, where x₁ 
is a difference between S₂ and S₁, x₂ is a difference 

between S₃ and S₂, and x₃ is a difference between S₄ and 
S₃; and 
b) computing an estimate (B) of the amplitude of said 
sinusoidal signal from said triplet of differences. 
The method as claimed in claim 1, wherein said step of 
computing an estimate (B) of said amplitude is performed by 


i) computing a ratio of algebraic functions of said 
triplet of differences x₁, x₂, and x₃; and 
ii) computing said estimate (B) of said amplitude as a 

nonlinear function of said ratio of algebraic 
functions. 
The method as claimed in claim 2, wherein said ratio of 
algebraic functions includes terms equivalent to: 

 
, 

   wherein preferably said nonlinear 
function includes a polynomial approximation of a square 

root functions, 
   wherein preferably each of said steps 

(a) and (b) are performed by a data processor under program 
control, 

   and preferably further comprising the 
step of computing a correction value from said estimate (B) 

of the amplitude of said sinusoidal signal for compensating 
a parasitic capacitance in an electrical circuit. 
A method of estimating frequency of a sinusoidal signal 
represented as sample values S₁, S₂, S₃, S₄ at respective 

spaced instants in time, said method comprising the steps 
of: 
a) computing a triplet of differences x₁, x₂, x₃, where x₁ 
is a difference between S₂ and S₁, x₂ is a difference 

between S₃ and S₂, and x₃ is a difference between S₄ and 
S₃; and 
b) computing an estimate (F) of the frequency of said 
sinusoidal signal from said triplet of differences. 
The method as claimed in claim 4, wherein said step of 
computing an estimate (F) of said frequency is performed by 


i) computing a ratio of algebraic functions of said 
differences x₁, x₂, and x₃; and 
ii) computing said estimate (F) of said frequency as a 
nonlinear function of said ratio of algebraic 

functions. 
The method as claimed in claim 5, wherein said ratio of 
algebraic functions includes terms equivalent to: 

 
.

 
   wherein preferably said nonlinear 

function includes a polynomial approximation of an arc-cosine 
function , and 

   wherein preferably each of said steps 
(a) and (b) are performed by a data processor under program 

control. 
A method of obtaining an indication of a characteristic of a 
signal represented as sample values (x₁, x₂, x₃, ..., xn) at 

respective spaced instants in time, said method comprising 
the steps of: 


a) computing a series of ratios of algebraic functions of 
triplets (xi, xi-1, xi-2) of neighboring ones of said 

sample values; and 
b) computing an average of said ratios to produce said 
indication of said characteristic. 
The method as claimed in claim 7, wherein each of said 
ratios has a denominator determined by a first one of said 

algebraic functions, and a numerator determined by a second 
one of said algebraic functions, and wherein said method 

further includes computing a value for said first one of 
said algebraic functions for each of said triplets, and 

 
excluding from said average any of said ratios for each of 

said triplets having a value for said first one of said 
algebraic functions that has a magnitude less than a 

threshold value, 
   wherein preferably said threshold 

value is constant for each of said triplets, 
   wherein preferably said threshold 

value is an average value of previously-computed values for 
said first one of said algebraic functions, 

   wherein preferably said triplets are 
non-overlapping such at no two of said triplets both include 

any one of said sample values, 
   wherein preferably the three samples 

values (xi, xi-1, xi-2) in each of said triplets are computed 
from four sample values (Sj, Sj-1, Sj-2, Sj-3) representing 

another signal, such that xi is a difference between Sj and 
Sj-1, xi-1 is a difference between Sj-1 and Sj-2, and xi-2 is a 

difference between Sj-2 and Sj-3, 
   further preferably comprising the 

steps of comparing said average value to a predetermined 
 

limit value, and when said predetermined limit value is 
exceeded, reporting an error condition to an operator, 

   wherein said ratio 
includes terms equivalent to: 

 
so that said ratio is an indication of amplitude of said 

signal when said signal is sinusoidal, 
   , wherein said ratio 

includes terms equivalent to: 
 

so that said ratio is an indication of frequency of said 
signal when said signal is sinusoidal, 

   wherein the three samples 
values (xi, xi-1, xi-2) in each of said triplets are computed 

from four sample values (Sj, Sj-1, Sj-2, Sj-3) representing 
another signal, such that xi is a difference between Sj and 

Sj-1, xi-1, is a difference between Sj-1 and Sj-2, and xi-2 is a 
difference between Sj-2 and Sj-3; and wherein said ratio 

includes terms equivalent to:  
so that said ratio is an indication of amplitude of a 

sinusoidal signal, when said another signal represents said 
sinusoidal signal superimposed on a DC bias, 

   wherein preferably each of steps (a) 
and (b) are performed by a data processor under program 

control. 
A system for monitoring health of a plurality of analog 
signals in an electronic circuit, said system comprising, in 

combination; 

a) an analog multiplexer having a plurality of inputs 
connected to said electronic circuit for receiving said 

analog signals, an analog output, and a selection 
control input: 
b) an analog-to-digital converter having an analog input 
connected to said analog output of said analog 

multiplexer, and a digital output; 
c) a programmed data processor having an input port 
connected to said digital output of said analog-to-digital 

converter, and an output port connected to said 
selection control input of said analog multiplexer; and 
d) an output unit for indicating an error condition to an 
operator; 
 
   wherein said programmed data processor is programmed 

to output selection control signals to said analog 
multiplexer for conversion of each of said analog signals to 

a respective series of digital values by said analog-to-digital 
converter, and to input into said programmed data 

processor said respective series of digital values for each 
of said analog signals, and to determine an indication of 

amplitude and an indication of frequency of each of said 
analog signals by computing ratios of algebraic functions of 

at least four samples in the respective series of digital 
values for said each of said analog signals, and to compare 

said indication of amplitude and said indication of 
frequency to limit values to indicate said error condition 

when one of said indications of amplitude and frequency 
falls outside a boundary set by one of said limit values. 
The system as claimed in claim 9 , wherein said programmed 
data processor as programmed to compute said ratios of 

 
algebraic functions by computing a triplet of differences 

between successive values in each of said series of at least 
four samples, and by computing one of said ratios of 

algebraic functions indicative of amplitude from said 
triplet of differences, and computing one of said ratios of 

algebraic functions indicative of frequency from said 
triplet of differences, 

   wherein preferably said programmed 
data processor is programmed to average together a plurality 

of said ratios of algebraic functions to compute said 
indication of amplitude, and to average together a plurality 

of said ratios of algebraic functions to compute said 
indication of frequency , and 

   wherein preferably said ratios of 
algebraic functions include algebraic functions which 

determine values for a denominator of each of said ratios of 
algebraic functions, and wherein said programmed data 

processor is programmed to exclude from said averages any 
ratios having a value for the denominator having a mag
nitude 
that is less than a limit value. 
</CLAIMS>
</TEXT>
</DOC>
