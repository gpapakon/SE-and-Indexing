<DOC>
<DOCNO>EP-0614150</DOCNO> 
<TEXT>
<INVENTION-TITLE>
Database system backup apparatus and method
</INVENTION-TITLE>
<CLASSIFICATIONS>G06F1200	G06F1114	G06F1200	G06F1114	</CLASSIFICATIONS>
<CLASSIFICATIONS-THIRD>G06F	G06F	G06F	G06F	</CLASSIFICATIONS-THIRD>
<CLASSIFICATIONS-FOURTH>G06F12	G06F11	G06F12	G06F11	</CLASSIFICATIONS-FOURTH>
<ABSTRACT>
This invention provides an easy backup, restoration 
and migration method of a database system. The command 

interpreter receives a backup request and the controller 
identifies the backup object in the backup request by 

referring to the definition. The backup-migrate-restore-procedure 
generator generates a backup procedure 

of the backup object identified by the controller by 
referring to the definition. The controller converts the 

backup object to a command form of SQL in accordance with 
the procedure generated by the backup-migrate-restore-procedure 

generator and stores in the storage medium. 
The stored data are the replace information, definition, 

dependence information, data, journal and program. 
Restoration of the system and migration of the database 

to another system is enable by inputting such data. 
Backup, migration and restoration of a system is able to 

be made in an identical apparatus. Furthermore, since a 
command form of SQL is used, a special means is 

unnecessary for migration and restoration. 
</ABSTRACT>
<APPLICANTS>
<APPLICANT-NAME>
MITSUBISHI ELECTRIC CORP
</APPLICANT-NAME>
<APPLICANT-NAME>
MITSUBISHI DENKI KABUSHIKI KAISHA
</APPLICANT-NAME>
</APPLICANTS>
<INVENTORS>
<INVENTOR-NAME>
FUSHIMI SHINYA
</INVENTOR-NAME>
<INVENTOR-NAME>
FUSHIMI, SHINYA
</INVENTOR-NAME>
</INVENTORS>
<DESCRIPTION>
This invention relates to a database system backup
apparatus according to the pre-characterizing part of
claim 1 and to a method using this apparatus.A relational database is rapidly prevailing. In the
relational database, an international standard language
which is called SQL (JIS X3005 ISO/IEC 9075:Database
Language SQL) is commonly used as a database language.
Therefore, the relational database and the international
standard database language SQL are assumed to be used in
the following explanations.FIG. 15 shows a basic configuration of an
application program and a database.Generally, a database system is composed of a
database definition where contents of the data are
described and the application program which operates in
reference with the definition in addition to the
processing data. The definition is called a catalog,
repository, data directory/dictionary, etc.
Furthermore, the data are always updated and the update
history is stored in a special file. The special file
which stores the update history is called a journal,
log, etc. Meanwhile, the database language such as SQL is a
language to process the database (to retrieve required
data from the database, to update, delete and insert the
data in the database, to define the data to manipulate
the data in the database, etc.). The database language
is unable to program the process of communication,
display control, etc. which is necessary for operations.
Therefore, it is common in the application program that
the program related to the database process is written in
SQL and the rest is written in a conventional language
such as COBOL, etc.When a program which contains a SQL statement is
compiled, a part which is written in SQL is compiled to a
SQL procedure, while the rest is compiled as a normal
load module. The SQL statement is replaced by a
procedure call (sql_exec in FIG. 15) which is set to
retrieve the SQL procedure which is compiled via a
database system kernel. Furthermore, an ID of the SQL
procedure which is registered in the database system is
given as an argument of the procedure call.It differs according to the realization methods of
the system, but it is common that the load module and the
SQL procedure which are generated by using SQL are
registered as a part of the definition in the SQL system.FIG. 15 shows the basic configuration of the 
application program and the database. In FIG. 15, the
SQL program is inserted in a COBOL application program.The SQL program is compiled by a compiler. When the
compiler compiles the SQL program,
</DESCRIPTION>
<CLAIMS>
A database system backup apparatus for saving
backup objects to a storage medium (8) from a

database system (9) which has a definition and data
defined by the definition, comprising:


(a) database access means (6) for accessing the
database system;
(b) storage medium access means (5) for saving the
backup objects as backup data to the storage medium

(8);
(c) command interpreter means (1) for inputting and
interpreting a backup command of the database system

(9);
(d) backup procedure generator means (3) for
accessing the definition in the database system (9)

through the database access means (6) and generating
a backup procedure for saving the backup objects;


characterized
 by
(e) control means (2) for identifying the backup
objects by referring to the definition in the database system (9) based on the

backup command interpreted by the command interpreter 
means (1), giving the backup objects to the backup

procedure generator means (3) so as to get the backup
procedure, extracting the backup objects from the

database system (9) with the database access means
(6) according to the backup procedure, and storing

the backup objects as a series of commands in a database language to the storage medium (8) with the
storage medium access means (5).
A database system backup apparatus of claim 1,
wherein the command interpreter means (1) includes:


(1) means for receiving and interpreting a
backup command, and
(2) means for providing the backup command to a
control means.
The database system backup apparatus of claim 1
wherein the backup command includes:


(a) a list of objects, the list having at least
one of the objects being a name of a data category

description unit,
(b) an object type assignment, and
(c) an object range assignment.
The database system backup apparatus of claim 1
wherein the database access means (6) includes a

database language to access the database system (9). 
The database system backup apparatus of claim 1
wherein the control means (2) includes:


(a) means for converting the backup objects to
a form of a command description, the command

description written in a database language, and
(b) means for providing the command description
to the storage medium access means (5) for saving in

the storage medium (8).
The database system backup apparatus of claim 1
wherein the control means (2) includes:


(a) means for converting the definition to be
saved to a form of a definition command, the

definition command creates the definition to be
written in a database language, and
(b) means for providing the definition command
to the storage medium access means (5) for saving the

definition command in the storage medium (8), when
the definition is one of the backup objects.
The database system backup apparatus of claim 1
wherein the control means (2) includes:


(a) means for converting the data to be saved
to a form of a data insert command, the data insert

command for inserting the data to be written in a 

database language, and
(b) means for providing the data insert command
to the storage medium access means (5) for saving the

data insert command in the storage medium (8), when
the data is one of the backup objects.
The database system backup apparatus of claim 1
wherein the control means (2) includes:


(a) means for creating replace information, the
replace information to replace a value of a variable,

and
(b) means for providing the replace information
to the storage medium access means (5) for saving the

replace information in the storage medium (8), when
the variable is one of the backup objects.
The database system backup apparatus of claim 1
further comprising program access means (7) for

accessing a program, the program having a source code
of a procedure and processing data by executing an

executable procedure, the executable procedure being
cataloged by the definition in the database system

(9) based on a database language.
The database system backup apparatus of claim 9
wherein the control means (2) includes: 


(a) means for identifying the program which has
the source code of the executable procedure as the

backup object, instead of the executable procedure,
(b) means for extracting the program to be
saved with the program access means (7); and
(c) means for providing the program to the
storage medium access means (5) for saving the

program in the storage medium (8).
The database system backup apparatus of claim 1
wherein the control means (2) includes:


(a) means for creating an area reserve command
for reserving a data recording area, the data

recording to be written in a database language; and
(b) means for providing the area reserve
command to the storage medium access means (5) for

saving the area reserve command in the storage medium
(8).
The database system backup apparatus of claim 1
wherein the control means (2) includes:


(a) means for searching a data ID recorded in a
journal in the database system (9);
(b) means for extracting an access history
related to the backup objects based on the search of 

the data ID; and
(c) means for providing the extracted access
history to the storage medium access means (5) for

saving the extracted access history as a backup
journal in the storage medium (8).
The database system backup apparatus of claim 1
wherein the backup procedure generator means (3)

includes:

(a) means for identifying a dependence relation
between the data to be saved, the dependence relation

being defined by the definition; and
(b) means for providing the dependence relation
to the storage medium access means (5) for saving the

dependence relation in the storage medium (8).
A database system backup method using the
apparatus of one of claims 1 to 13

for saving backup objects to a storage medium (8) from a database system (9) which
has a definition and data defined by the definition, wherein database access means (6)

accesses the database system, storage madium access means (5) saves the backup
objects as backup data to the storage medium (8), command interpreter means (1)

inputs and interprets a backup command of the database system (9), backup
procedure generator means (3) accesses the definition in the database system (9)

through the database access- means (6) and generates a backup procedure for saving
the backup objects, and control means (2) identifies the backup objects by referring to

the definition in the database system (9) based on the backup command interpreted by
the command interpreter means (1), giving the backup objects to the backup procedure

generator means (3) so as to-get the backup procedure, extracting the backup objects
from the database system (9) with the database access means (6) according to the

backup procedure, and storing the backup objects as a series of commands in a
database language to the storage medium (8) with the storage medium access means

(5), and wherein the
command interpreter means (1) inputs the backup

command with a list of objects having at least one of
a name of data category description unit such as user

names, schema, a data name such as SQL table and
file, a logical data name such as view, a program

name, and privilege name, and with an object type
assignment and an object range assignment of the  

objects, and the control means (2) identifies the
backup objects which are included in the object type

assignment and the object range assignment referring
to the definition based on the list of the objects

and the object type assignment and the object range
assignment inputted.
The database system backup method of claim 14,
wherein the database system (9) is accessed with a

database language, and the database access means (6)
accesses the database system with the database

language.
The database system backup method of claim 14,
wherein the control means (2) converts backup objects

to a form of a command description written in a
database language and storing the command description

in the storage medium (8).
The database system backup method of claim 14,
wherein the control means (2) converts the definition

to be saved to a form of a definition command for
creating the definition written in a database

language and storing the definition command in the
storage medium (8), in case that the definition is

one of the backup objects. 
The database system backup method of claim 14,
wherein the control means (2) converts the data to be

saved to a form of a data insert command for
inserting data written in a database language, and

storing the insert command in the storage medium (8),
in case that the data are one of the backup objects.
The database system backup method of claim 14,
wherein the control means (2) creates replace

information for being possible to replace a value of
a variable and storing the replace information in the

storage medium (8), in case that the variable being
possible to replace the value thereof is one of the

backup objects.
The database system backup method of claim 14,
wherein the definition in the database system (9)

catalogs an executable procedure based on a database
language, the database system includes a program

having a source code of the procedure and processing
data by executing the executable procedure cataloged

in the definition, and the database system backup
apparatus further comprising program access means (7)

for accessing the program, wherein, in case that the
executable procedure is one of the backup objects, 

the control means (2) identifies the program which
has the source code of the executable procedure, as

the backup object instead of the executable
procedure, and extracts the program to be saved with

the program access means (7) and stores the program
to the storage medium (8).
The database system backup method of claim 14,
wherein the control means (2) creates an area reserve

command for reserving a data recording area written
in a database language and storing the area reserve

command to the storage medium (8).
The database system backup method of claim 14,

wherein the database system (9) has a journal for
recording access history with a data ID, the control

means (2) searches the data ID recorded in the
journal and extracts the access history related to

the backup objects based on the search of the data
ID, and stores the extracted access history as a

backup journal in the storage medium (8).
The database system backup method of claim 14,
wherein the definition defines a dependence relation

of data, and the backup procedure generator means (3)
identifies the dependence relation between the data 

to be saved, and the control means (2) stores the
dependence relation identified by the backup

procedure generator means (3) to the storage medium
(8).
</CLAIMS>
</TEXT>
</DOC>
