<DOC>
<DOCNO>EP-0616281</DOCNO> 
<TEXT>
<INVENTION-TITLE>
Battery pack including static memory and a timer for charge management.
</INVENTION-TITLE>
<CLASSIFICATIONS>G01R3136	G01R3136	G06F126	G06F126	H02J700	H02J700	</CLASSIFICATIONS>
<CLASSIFICATIONS-THIRD>G01R	G01R	G06F	G06F	H02J	H02J	</CLASSIFICATIONS-THIRD>
<CLASSIFICATIONS-FOURTH>G01R31	G01R31	G06F1	G06F1	H02J7	H02J7	</CLASSIFICATIONS-FOURTH>
<ABSTRACT>
A battery pack for a computer system including 
static memory to maintain battery operating parameters 

and charge information, a real time clock (RTC) for 
measuring periods of non-use of the battery and a 

communication means to exchange the battery information 
with a microcontroller located in the computer system. 

The static memory, RTC and communication means is 
preferably in the form of a single RAM/RTC chip. The 

battery pack also includes circuitry to maintain power 
to the RAM/RTC from the battery if AC power is not 

available. The microcontroller detects the presence of 

the battery and retrieves the present time from the 
RTC, a timestamp indicating time or removal of the 

battery and other operating parameters and charge 
information from the battery pack, and controls the 

charging functions of the battery accordingly. The 
microcontroller also updates the charge information of 

the battery pack while performing other housekeeping 
functions of a DC-DC converter. The microcontroller 

further controls a switch located in the charge path of 
the battery to control fast charging. Trickle charge 

is simulated by pulsing the switch at a predetermined 
duty cycle and period. The microcontroller may be 

placed in standby to conserve energy, while also 
monitoring the standby switch to pull the computer 

system out of standby mode if the standby switch is 
pressed. This allows the keyboard controller 21 to be 

shut off during standby mode to conserve energy. 

</ABSTRACT>
<APPLICANTS>
<APPLICANT-NAME>
COMPAQ COMPUTER CORP
</APPLICANT-NAME>
<APPLICANT-NAME>
COMPAQ COMPUTER CORPORATION
</APPLICANT-NAME>
</APPLICANTS>
<INVENTORS>
<INVENTOR-NAME>
LIN DAVID S
</INVENTOR-NAME>
<INVENTOR-NAME>
SCHNEIDER MICHAEL E
</INVENTOR-NAME>
<INVENTOR-NAME>
LIN, DAVID S
</INVENTOR-NAME>
<INVENTOR-NAME>
SCHNEIDER, MICHAEL E.
</INVENTOR-NAME>
</INVENTORS>
<DESCRIPTION>
The present invention relates to a battery pack 
for a computer system including static memory to retain 
battery operating parameters and charge information and 
a real time clock for measuring periods of non-use. Computers are often needed in locations where AC 
power is not available. Rechargeable batteries are 
typically used as an alternative source of power, such 
as nickel-based batteries including nickel cadmium 
(NiCad) and nickel metal hydride (NiMH) batteries, 
which are capable of providing power to a portable or 
pen-based computer for several hours. Since 
rechargeable batteries have a limited cycle life, it is 
desirable to maximize the life of and to obtain the 
maximum power from each battery during every discharge 
cycle. To achieve these goals, it is necessary to 
fully and efficiently charge the battery without 
causing temperature abuse as a result of overcharging. Many battery chargers presently in use do not 
efficiently charge a rechargeable battery, thereby 
limiting the useful life of the battery. The total 
charge capacity of a battery, typically referred to as 
the amp-hour (Ah) rating or otherwise called the milli-amp-hour 
rating (mAh), tends to change over time and 
usage. For example, the charge of a battery typically 
increases and then decreases over time and usage until 
the battery eventually will not hold a charge and must  
 
be replaced. In particular, NiCad batteries exhibit a 
memory effect causing lower capacity after multiple 
partial charge and discharge cycles have occurred. 
Some battery chargers monitor the temperature and 
voltage to avoid fast charging when the battery voltage 
is too low or when the battery temperature is not 
within an acceptable fast charging temperature range. 
Examples are disclosed in U.S. patent applications 
Serial No. 596,223 filed October 12, 1990, and Serial 
No. 701,657, filed May 16, 1991. These and most other 
known battery chargers do not have the capability to 
accurately determine the charge level and the total 
charge capacity and thus may still overcharge the 
battery, thereby further reducing its useful life. The primary reason for temperature abuse and 
overcharging of nickel-based batteries was the 
difficulty of determining the charge level since the 
voltage is substantially the same regardless of the 
charge level. Furthermore, if the battery was removed 
and then later re-installed, the system had no way of 
determining the charge history and the remaining charge 
level of the battery. Some methods estimated the

</DESCRIPTION>
<CLAIMS>
A removable battery pack for providing power 
to a computer system, the computer system including a 

microcontroller for detecting when said battery pack is 
connected to the computer system, means coupled to the 

microcontroller for determining the amount of charge 
provided to and provided by said battery pack while 

said battery pack is connected and communication means 
coupled to the microcontroller for communicating with 

said battery pack, said battery pack comprising: 
   a rechargeable battery; 

   a real time clock coupled to said battery for 
continually providing an indication of the present 

time; and 
   memory coupled to said battery for storing a 

timestamp value of said present time indication and a 
numerator value representing the remaining charge of 

said battery at approximately the time indicated by 
said timestamp value, 

   wherein the microcontroller detects said 
battery pack when it is initially connected to the 

computer system, retrieves said present time indication 
and said timestamp and numerator values, and thereafter 

periodically updates said numerator based on the amount 
of charge provided to and provided by said battery and 

also updates said timestamp value with said present 
time indication while said battery pack is connected to 

said computer system. 
A battery pack according to claim 1, further 
comprising: 

   communication means coupled to said battery, 
said real time clock and said memory, for coupling to 

the computer system communication means and for 
transmitting said present time indication, said stored 

 
timestamp and said stored numerator values to the 

microcontroller and receiving said timestamp and 
numerator values from the microcontroller. 
A battery pack according to claim 2, wherein 
said battery pack communication means comprises a one 

bit wide serial communication port. 
A battery pack according to claim 2, wherein 
said real time clock, said battery pack communication 

means and said memory are incorporated into a single 
semiconductor chip. 
A battery pack according to claim 1, wherein 
said real time clock is a binary counter for counting 

elapsed time in seconds. 
A battery pack according to claim 1, wherein 
said memory comprises random access memory for storing 

said numerator and said timestamp values. 
A battery pack according to claim 3, wherein 
said memory further comprises read only memory for 

storing battery charging parameters. 
A battery pack according to claim 7, wherein 
said battery charging parameters include a value 

indicative of the initial full charge capacity of said 
battery, a value indicative of the maximum charge 

temperature and a value indicative of the self 
discharge rate of said battery. 
A battery pack according to claim 7, wherein 
said battery charging parameters include a plurality of 

 
self discharge rates corresponding to a plurality of 

consecutive time periods. 
A battery pack according to claim 1, further 
comprising a temperature sensor coupled in good thermal 

contact with said battery. 
A battery pack according to claim 1, further 
comprising: 

   a positive terminal coupled to the positive 
terminal of said battery; 

   a negative terminal coupled to the negative 
terminal of said battery; 

   a system ground terminal for coupling to the 
ground of the computer system; 

   an intermediate ground; 
   a voltage regulator coupled between said 

positive terminal and said intermediate ground, for 
providing a regulated voltage output, wherein said 

memory and said real time clock are coupled between 
said regulated voltage output and said intermediate 

ground; and 
   switching means coupled between said negative 

terminal, said system ground terminal and said 
intermediate ground, wherein said switching means 

electrically connects said negative terminal to said 
intermediate ground unless a voltage greater than the 

voltage of said battery is applied between said 
positive terminal and said system ground terminal, 

wherein said switching means electrically disconnects 
said negative terminal from said intermediate ground 

and electrically connects said system ground terminal 
to said intermediate ground. 
A battery pack according to claim 11, further 
comprising: 

   communication means, coupled between said 
regulated voltage output and said intermediate ground 

and for coupling to the computer system communication 
means, for transmitting said present time indication, 

said timestamp and said numerator values to the 
microcontroller and receiving said timestamp and 

numerator values from the microcontroller. 
A battery pack according to claim 11, wherein 
said voltage regulator comprises an emitter follower 

transistor circuit. 
A battery pack according to claim 11, wherein 
said switching means comprises Schottky diodes. 
A battery pack according to claim 11, wherein 
said switching means comprises: 

   a first diode having its anode coupled to 
said intermediate ground and its cathode coupled to 

said system ground terminal; and 
   a second diode having its anode coupled to 

said intermediate ground and its cathode coupled to 
said negative terminal. 
A computer system, comprising: 
   a removable battery pack, comprising 

      a rechargeable battery, 
      a real time clock coupled to said 

battery for continually providing an indication of the 
present time, 

      memory coupled to said battery for 
storing a timestamp of said present time indication and 

a numerator representing the remaining charge of said 
 

battery at approximately the time indicated by said 
timestamp, and 

      communication means coupled to said 
battery, said real time clock and said memory for 

receiving, storing and transmitting said present time 
indication, said timestamp and said numerator; and 

   a host computer for coupling to and receiving 
power from said battery pack, said host computer 

comprising: 
      means for coupling to said battery pack 

for measuring the amount of charge provided to and 

provided by said battery, 
      communication means for coupling to said 

battery pack communication means for interfacing said 
host computer with said real time clock and said memory 

of said battery pack, 
      means for detecting installation of said 

battery pack to said host computer, and 
      processing means coupled to said host 

computer communication means, said detecting means and 
said measuring means, wherein said processing means 

retrieves said timestamp, said numerator and said 
present time indication after said detecting means 

detects installation of said battery pack, and 
thereafter, while said battery pack is connected to 

said host computer, said processing means periodically 
updates said numerator based on the amount of charge 

provided to and provided by said battery, and also 
periodically updates said timestamp with the current 

value of said present time indication. 
A computer system according to claim 16, 
wherein said host computer processing means subtracts 

said timestamp from said present time indication upon 
power up and when said battery pack is initially 

 
installed during operation of the computer system and 

determines the self discharge of said battery pack 
based on the time difference. 
A computer system according to claim 16, 
wherein said host computer processing means updates 

said numerator and said timestamp approximately twice 
every minute. 
A computer system according to claim 16, 
wherein said battery pack memory comprises random 

access memory for storing said numerator and said 
timestamp and further comprises read only memory. 
A computer system according to claim 19, 
wherein said read only memory stores a value indicative 

of the initial charge capacity of said battery and a 
value indicative of the maximum charge temperature. 
A computer system according to claim 19, 
wherein said read only memory stores a value indicative 

of the voltage of said battery when said battery is 
fully discharged. 
A computer system according to claim 19, 
wherein said read only memory stores a value 

representative of the self-discharge rate of said 
battery. 
A computer system according to claim 19, 
wherein said read only memory stores a plurality of 

self discharge rates corresponding to a plurality of 
consecutive time periods. 
A computer system according to claim 23, 
wherein said plurality of self discharge rates and 

corresponding time periods include: 
   a first self-discharge rate for a first time 

period; 
   a second self-discharge rate for a second 

time period, wherein said second time period starts 
when said first time period ends; 

   a third self discharge rate for a third time 
period, wherein said third time period begins when said 

second time period ends; and 
   a fourth self-discharge rate for a fourth 

time period, wherein said fourth time period begins 
when said third time period ends. 
A computer system according to claim 16, 
wherein said battery pack further comprises: 

   a temperature sensor in good thermal contact 
with said battery; and 

   said host computer further includes means 
coupled to said processing means and for coupling to 

said temperature sensor for providing a temperature 
signal indicative of the temperature of said battery. 
A computer system according to claim 25, 
wherein said battery pack communication means includes 

means for responding to an external request within a 
predetermined time period, said host computer further 

comprising: 
   means, coupled to said means for providing a 

temperature signal indicative of the temperature of 
said battery, for asserting a level of said temperature 

signal indicative of said temperature sensor not being 
connected, wherein said processing means provides said 

external request, detects said response and determines 
 

whether said temperature signal indicates said 
temperature sensor is not connected. 
A computer system according to claim 25, 
wherein said measuring means provides a signal to said 

processing means indicative of the current through said 
battery. 
A computer system according to claim 27, 
further comprising: 

   a removably connected AC adapter for coupling 
to said host computer and said battery pack, said AC 

adapter providing an output to power the computer 
system and to fast charge said battery; and 

   said host computer further comprising: 
      means coupled to said processing means 

and for coupling to said battery for providing a signal 
indicative of the voltage of said battery, and 

      switching means coupled to said 
processing means and for coupling in the charge path of 

the battery, wherein said AC adapter fast charges said 
battery when said switching means is on and said 

battery is connected, and 
      wherein said processing means monitors 

the voltage, temperature and current of said battery 
for determining when said battery is in a condition for 

fast charging and for detecting said AC adapter being 
connected, wherein said processing means turns on said 

switching means when said battery pack is installed and 
said AC adapter is not connected and when said AC 

adapter is connected and said battery is in a condition 
for fast charging. 
A computer system according to claim 27, 
wherein said processing means updates said numerator 

based on the current through said battery. 
A computer system according to claim 29, 
wherein: 

   said battery pack memory further stores a 
denominator representing the charge capacity of said 

battery; and 
   said host computer processing means 

calibrates said denominator after said battery has been 
fully charged, wherein said denominator is decreased by 

half the remaining value of said numerator after said 
battery is fully discharged if said numerator is not 

zero when said battery has been fully discharged, and 
wherein said denominator is increased by half the 

discharge current rate while said battery is 
discharging if said numerator reaches zero before said 

battery is fully discharged. 
A method for determining the elapsed time 
during which a battery in a removable battery pack is 

self-discharging, wherein the battery pack includes 
memory, comprising the steps of: 

   the battery pack continually providing a 
present time value; 

   detecting whether the battery pack is 
installed on the computer system while the computer 

system is powered on; 
   when the battery pack is first detected 

installed on the computer system, retrieving the 
present time value and a timestamp of the present time 

value previously stored in the memory of the battery 
pack;

 
   subtracting the retrieved stored timestamp 

from the present time value to calculate the elapsed 
time; and 

   periodically reading a new timestamp of the 
present time value and storing the new timestamp in the 

battery pack memory while the battery pack is connected 
to the computer system and while the computer system is 

powered on. 
A method for determining the amount of self-discharge 
of a battery in a removable battery pack, 

wherein the battery pack includes memory, comprising 
the steps of: 

   the battery pack continually providing a 
present time value; 

   detecting whether the battery pack is 

installed on the computer system while the computer 
system is powered on; 

   monitoring the amount of charge added to the 
battery during charging and the amount of charge 

removed during discharging of the battery while the 
battery pack is detected installed on the computer 

system; 
   retrieving the present time value and a 

previously stored timestamp of the present time value 
from the battery pack memory when the battery pack is 

first detected installed on the computer system; 
   subtracting the retrieved stored timestamp 

from the present time value to calculate an elapsed 
time of self-discharge; 

   calculating the amount of self-discharge by 
multiplying the elapsed time by a predetermined self-discharge 

rate; and 
   periodically reading a new timestamp of the 

present time value and storing the new timestamp into 
 

the battery pack memory while the battery pack is 
detected installed. 
A method according to claim 32, further 
comprising the steps of: 

   during said retrieving step, further 
retrieving a previously stored numerator from the 

battery pack memory representing the charge of the 
battery at the time represented by the stored 

timestamp; 
   subtracting the amount of self-discharge from 

the retrieved stored numerator to calculate a numerator 
representing the remaining charge on the battery; 

   while the battery pack is detected installed 
on the computer system, periodically updating the 

numerator based on the added and removed charge; and 
   during said periodically reading and storing 

step, further storing a copy of the numerator into the 
battery pack memory. 
A method according to claim 33, further 
comprising the steps of: 

   during said retrieving step, further 
retrieving a previously stored denominator from the 

battery pack memory representing the full charge 
capacity of the battery; 

   monitoring the voltage of the battery; 
   charging the battery until it is fully 

charged; 
   copying the denominator into the numerator; 

   discharging the battery; 
   increasing the denominator by an amount based 

on the amount of charge removed from the battery during 
discharging if the numerator reaches zero before the 

 
voltage of the battery reaches a predetermined minimum 

value; 
   decreasing the denominator by the remaining 

numerator if the voltage of the battery reaches the 
predetermined minimum value before the numerator 

reaches zero; and 
   storing a copy of the denominator into the 

battery pack memory when the voltage of the battery 
reaches the predetermined minimum value. 
</CLAIMS>
</TEXT>
</DOC>
