<DOC>
<DOCNO>EP-0613271</DOCNO> 
<TEXT>
<INVENTION-TITLE>
Method and apparatus for time synchronization of bus type local area networks including hierarchical networks
</INVENTION-TITLE>
<CLASSIFICATIONS>H04L1240	G06F114	H04J306	G06F1300	H04L1240	G06F114	G06F1300	H04L1246	H04J306	H04L1246	</CLASSIFICATIONS>
<CLASSIFICATIONS-THIRD>H04L	G06F	H04J	G06F	H04L	G06F	G06F	H04L	H04J	H04L	</CLASSIFICATIONS-THIRD>
<CLASSIFICATIONS-FOURTH>H04L12	G06F1	H04J3	G06F13	H04L12	G06F1	G06F13	H04L12	H04J3	H04L12	</CLASSIFICATIONS-FOURTH>
<ABSTRACT>
A first network sends a first message, uniquely 
identified as a sync message to a second network. The first 

network produces a first relative time of when the first 
message is transmitted. When the first network recognizes 

that the first message was sent, a second relative time is 
obtained to send a second message to the second network 

containing a real time of the first network of when the 
first message was sent. The second network produces a third 

relative time within the second network of when the first 
message is received. The real time of the first network 

contained in the second message is associated to the third 
relative time of the second network, thereby synchronizing 

the time of the second network to the time of the first 
network. Any skew of time associated with transmission 

protocols of the first and second network is thereby 
eliminated. 


</ABSTRACT>
<APPLICANTS>
<APPLICANT-NAME>
HONEYWELL INC
</APPLICANT-NAME>
<APPLICANT-NAME>
HONEYWELL INC.
</APPLICANT-NAME>
</APPLICANTS>
<INVENTORS>
<INVENTOR-NAME>
MASSEY W RUSSELL
</INVENTOR-NAME>
<INVENTOR-NAME>
MASSEY, W. RUSSELL
</INVENTOR-NAME>
</INVENTORS>
<DESCRIPTION>
The invention relates to communications systems, and
more particularly, to a method and apparatus for providing
time synchronization of data transmitted between devices of
a bus type local area network, including hierarchical networks.On a bus type local area network messages ideally
appear at receiving nodes as soon as transmitted, without
variable delays caused by intermediary devices (propagation
delays are not generally significant). Bus type networks
include networks having bounded propagation delays such as
induced by repeaters, and further including hierarchical
network structures. Typically, however, such networks are
software-driven and have variable/unpredictable delays in
the network hardware and software between the time messages
are queued for transmission and actually transmitted, and
between the
time messages are received and actually processed. This
lack of determinism prevents synchronization or time broadcast 
via messages containing high-precision clock times.
Such networks do not provide for high-resolution clock
synchronization in their standard definitions. Additionally,
the available network interface products do not provide
this feature, nor the ability to recognize a predefined,
unique, synchronization message, to enable external synchronization
processing.Thus there is a need to provide, in bus type networks,
a technique for determining the difference between the time
messages are queued and actually transmitted, and the difference
between the time messages are received and actually
processed. Therefore, there is provided by the present invention,
a method and apparatus for determining the difference between
the time messages are queued for transmission and
actually transmitted, and between the time messages are
received and actually processed, thereby achieving time
synchronization of the data transmitted between devices of a
bus type local area network, including hierarchical networks.
The present invention provides a method for synchronizing
the time of a second network to a first network, each
network having an independent timing subsystem for maintaining
its own real time, comprises the following steps. The
first network sends a first message to the second network,
the first message being uniquely identified as a sync message.
A first relative time is obtained within the first
network of when the first message is transmitted. When the
first network recognizes that the first message was sent, a
second relative time is obtained to send a second message to
the second network
</DESCRIPTION>
<CLAIMS>
A method for synchronizing the time of a second
network to a first network, each network having an

independent timing subsystem for maintaining its own real
time, the method characterised by the steps of:-

for the first network -

a) sending a first message to the second network, the
first message being uniquely identified as a sync message;
b) obtaining a first relative time within the first
network of when the first message is transmitted;
c) when the first network recognizes that the first
message was sent, obtaining a second relative time to send a

second message to the second network containing a real time
of the first network that the first message was sent;

for the second network -
d) obtaining a third relative time within the second
network of when the first message is received; and
e) associating the real time of the first network
contained in the second message to the third relative time,

thereby synchronizing the time of the second network to the
time of the first network and eliminating any skew of time

associated with transmission protocols of the first and
second network.
A method according to Claim 1, characterised by:

for the first network -

a) including a message ID number in the first and
second message; and 

for the second network -
b) checking the message ID number of the first and
second message to insure a valid association of the real

time of the second message to the third relative time.
A method for synchronizing the time of a second
network to a first network, each network having an

independent timing subsystem for maintaining its own real
time, the method comprising the steps of:

for the first network -

a) sending a first message to the second network, the
first message being uniquely identified as a sync message;
b) obtaining a first relative time within the first
network of when the first message is transmitted;

for the second network -
c) setting a second relative time within the second
network to zero of when the first message is received; and
d) when data is transmitted to the first network,
transmitting data to the first network via a second message

along with the second relative time associated with the data
such that the first network can correlate the real time of

the first network to the second relative time associated
with the data.
Apparatus for synchronizing the time of a second
network to a first network, each network having an

independent timing subsystem for generating its own real
time, respectively, the apparatus characterised by: 


a) a first free running counter for generating
relative time within the first network;
b) a second free running counter for generating
relative time within the second network;
c) a first and second latch associated with the first
network for recording a first and second relative time

value, respectively, from the first free running counter in
response to a first and second control signal, respectively;
d) a third latch associated with the second network
for recording a third relative time value from the second

free running counter in response to a third control signal;
e) first means, associated with the first network,
for detecting when a first message is transmitted to the

second network, the first message containing a message ID
number, to generate the first control signal;
f) third means, associated with the second network,
for detecting when the first message is received from the

first network, to generate the third control signal; and
g) second means, associated with the first network,
for recognising that the first message was transmitted to

generate the second control signal to record the second
relative time value, and to transmit a second message to the

second network, the second message including the message ID
number, and the real time of the first network when the

first message was transmitted, such that the second network
associates the real time of the first network received in

the second message to the third relative time, thereby
synchronizing the time of the second network to the time of

the first network.
Apparatus for synchronizing the time of a second
and third network to a first network, each network having an

independent timing subsystem for generating its own real
time, respectively, the apparatus characterised by:


a) a first free running counter for generating
relative time within the second network;
b) a second free running counter for generating
relative time within the second network;
c) a first and second latch associated with the first
network for recording a first and second relative time

value, respectively, from the first free running counter in
response to a first and second control signal, respectively;
d) a third and fourth latch associated with the
second network for recording a third relative time value

from the second free running counter in response to a third
and fourth control signal;
e) first means, associated with the first network,
for detecting when a first message is transmitted to the

second network, the first message containing a message ID
number, to generate the first control signal;
f) third means, associated with the second network,
for detecting when the first message is received from the

first network, to generate the third control signal; and
g) second means, associated with the first network,
for recognizing that the first message was transmitted to

generate the second control signal to record the second
relative time value, and to transmit a second message to the

second network, the second message including the message ID 
number, and the real time of the first network when the

first message was transmitted, such that the second network
associates the real time of the first network received in

the second message to the third relative time, thereby
synchronizing the time of the second network to the time of

the first network; and
h) fourth means, associated with the second network,
for outputting a third message to generate the fourth

control signal and to indicate a time synchronization
message, the fourth control signal being generated when said

fourth message is outputted, thereby permitting the third
network to initialize a fifth relative time within the third

network to zero, and data transmitted from the third network
to the second network including a value of the fifth

relative time associated with the data, thereby permitting
the second network to correlate the time of the data of the

third network to the time of the second and first networks.
</CLAIMS>
</TEXT>
</DOC>
