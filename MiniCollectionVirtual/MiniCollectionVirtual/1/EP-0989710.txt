<DOC>
<DOCNO>EP-0989710</DOCNO> 
<TEXT>
<INVENTION-TITLE>
Secure distribution system for digital contents
</INVENTION-TITLE>
<CLASSIFICATIONS>H04L2906	H04L2906	</CLASSIFICATIONS>
<CLASSIFICATIONS-THIRD>H04L	H04L	</CLASSIFICATIONS-THIRD>
<CLASSIFICATIONS-FOURTH>H04L29	H04L29	</CLASSIFICATIONS-FOURTH>
<ABSTRACT>
A digital cryptograph and encryption process encrypts
and transmits in a digital format specific items of

information requested by a user of a digital content
transmission system by using key information, a user's key

and a content encryption key, to decrypt and replay the
encrypted digital information at the user's terminal by

using the key information and the user's authorization
information. Each registered subscribing user is provided

with unique key information. The user key is generated by
applying the key information to a key generation

algorithm. The content encryption key that is created when
the registered user accesses the server, is encrypted with

the user key. The digital information is encrypted by
using the content encryption key in an encryption

algorithm. The decryption algorithm allows the user to
decrypt and replay the encrypted digital information upon

receipt of the key information that has a one-to-one
correspondence to the identity characters of the

registered subscribing user.

</ABSTRACT>
<APPLICANTS>
<APPLICANT-NAME>
SAMSUNG ELECTRONICS CO LTD
</APPLICANT-NAME>
<APPLICANT-NAME>
SAMSUNG ELECTRONICS CO., LTD.
</APPLICANT-NAME>
</APPLICANTS>
<INVENTORS>
<INVENTOR-NAME>
BYUN JIN YOUNG
</INVENTOR-NAME>
<INVENTOR-NAME>
KANG EUN-SEONG
</INVENTOR-NAME>
<INVENTOR-NAME>
BYUN, JIN YOUNG
</INVENTOR-NAME>
<INVENTOR-NAME>
KANG, EUN-SEONG
</INVENTOR-NAME>
</INVENTORS>
<DESCRIPTION>
The present invention is generally related to
encryption processes and apparatus, and, more
particularly, to processes and apparatus for the
generation and use of keys in the transmission and replay
of digital information.Recently, with the flood of information provided by
various media such as broadcasting and press, an
atmosphere has been created by the information providers
who are interested in providing integrated information
that covers all of the media. Other users want to
selectively receive a specific item of digital
infornnation from the entire spectrum of information
available from a particular information provider (IP).
Accordingly, a digital content transmission system has
been formed by the information providers who convert
various types of information into digital form and store
this digital information and store information about the
users who subscribe to this digital information system
from an information provider via the network. Digital
information transmission systems endow an application
program with easy download ability of the digital content.
The user can get all the information desired by using this
application program to access the digital information
system through the network.The digital information may be provided to the user
either by payment or for free. In case of paid digital
information, the server that provides the digital
information via the transmission system sets the service
fee. The service server charges the user according to the 
quantity of information requested when the digital
information is downloaded to the user. The MPEG software
protocol, for example, compresses audio files to a
fraction of their original size, but it has little
perceptible affect upon the quality of the audio sound.
The MPEG software protocol is now used widely by Internet
sites to offer digitalized music, and is reported to be
used commonly to transmit digitalized versions of recorded
music without the consent of the musicians. When a user is
connected to a server that provides digital information
commercially via a network, a few of the users may be able
inadvertently or illegally to copy the digital
information, a practice that is economically damaging to
both the musicians who performed the music and to the
providers of the server that runs the digital information
transmission system, as was recently noted by Interdeposit
and the French Agency for the Protection of Programs, a
member of the European Association of Authors and
Information Technology Professional, in the Patent,
Tradem
</DESCRIPTION>
<CLAIMS>
An apparatus for encrypting and decrypting a digital
content, comprising:


a terminal unit having a decryption algorithm, for
tansmitting identity characters of a user, for receiving

and storing a key information, for receiving a protocol
including a encrypted digital content, and decrypting said

protocol by using said decryption algorithm and said key
information; and
a service server having an encryption algorithm, for
generating said key information corresponding to said

identity characters transmitted from said terminal unit,
for transmitting said key information to said terminal

unit, for encrypting said digital content by using said
key information and said encryption algorithm, and

transmitting said protocol including said encrypted
digital content and a header to said terminal unit.
An apparatus for encrypting and decrypting a digital
content, comprising:


a terminal unit having a decryption algorithm, for
transmitting identity characters of a user, for receiving

and storing key information, for receiving a protocol
including a encrypted digital content, and decrypting said

protocol by using said decryption algorithm and said key
information;
a service server having an encryption algorithm, said
service server transmitting said key information to said

terminal unit, for encrypting said digital content by
using said key information and said encryption algorithm,

and for transmitting said protocol to said terminal unit;
and
a host server corresponding to said identity
characters transmitted from said service server for

generating said key information, for transmitting said key
information to said service server, and for storing said

key information with said identity characters.
The apparatus of claim 1 or 2, wherein said terminal
unit further comprises:


a user key generated by said key information and a
key generation algorithm; and
a content encryption key decrypted by said user key,
for decrypting said encrypted digital content.
The apparatus of claim 1, 2 or 3, wherein said
terminal unit further comprises:


a first interface for receiving said key information;
a user authority identifier for identifying whether
said user is authorized, a first hash value of said user

key with a second hash value of user authorization
information header of said protocol, for generating said

user key using said key information;
means for decrypting content encryption key by using
said user key; and
means for decrypting said encrypted digital content
by using said content encryption key.
The apparatus of claim 1, 2, 3 or 4, wherein said
service server further comprises:


a user key generated by said key information and a
key generation algorithm; and
a content encryption key generated in response to
user's request and encrypted by said user key, for

encrypting said digital content.
The apparatus of any preceding claim, wherein said
service server further comprises:


a second interface for receiving said identity
characters input from said terminal unit;
key information generator responding to said identity
characters for generating said key information;
a user key generator responding to said key
information for generating said user key;
a content encryption key generator responding to
user's access to said service server for generating said

content encryption key;
a user authorization information generator responding
to said user key for encrypting said content encryption

key to generate a user authorization information;
a header generator responding to said user key for
generating a header, wherein said header includes said

user authorization information; and
a protocol format generator for adding said encrypted
digital content to said header to generate said protocol.
The apparatus of any preceding claim further
comprised of a service sanction agent server connected to

said service server for receiving from the service server
a signal concerning digital content fee responding to the

transmission of said digital content requested by said
user, and accumulating said digital content fees

responding to said signal into a registered user's ID.
The apparatus of any preceding claim, wherein the
terminal unit having a network access program is connected

to a network, public switched telephone network, or a
wireless network.
The apparatus of any preceding claim, wherein said
protocol includes a header and said encrypted digital

content.
The apparatus of any preceding claim, wherein said
protocol is copyright protection protocol.
The apparatus of claim 2 or any of claims 3 to 7, 9
or 10, as appendant thereto, wherein said host server

further comprises:
key information generator corresponding to the
identity characters input from said second interface for

generating said key information.
The apparatus of claim 2, wherein said terminal unit
is connected to a network, public switched telephone

network, or wireless network, said terminal unit having a
network access program to access said service server.
A protocol format apparatus, comprising:

a protocol format encoder for encoding a header and a
digital content to a copyright protection protocol,

wherein said header includes information relating to
decrypting and explaining said digital content; and
a protocol format decoder for decoding said protocol
and for decrypting said digital content according to said

information of said header received from said protocol
format encoder.
The apparatus of claim 13, wherein said protocol
format encoder generates a user key by using a key

information and a key generation algorithm, calculates a
hash value by applying said user key to a hash algorithm,

and encrypts a content encryption key by using said user
key, said header including a user authorization

information with said hash value and said encrypted
content encryption key.
The apparatus of claim 13 or 14, wherein said
protocol format decoder generates a user key by applying a

key information to a key generation algorithm, decrypts a
content encryption key by using the user key, and

decrypts said encrypted digital content by using said
content encryption key.
A protocol format decoder for copyright protection
having a decryption algorithm, comprising:


means for receiving a copyright protection protocol
including an encrypted digital content; and
means for decrypting said copyright protection
protocol by using said decryption algorithm and a key

information to replay said encrypted digital content.
The apparatus of claim 16, wherein said protocol
format decoder generates a user key by applying key

information to key generation algorithm and decrypts a
content encryption key from user authorization information

included in said copyright protection protocol by using
said user key and said encrypted digital content by using

said temporary validation key.
A protocol for protecting copyright, comprising:

an encrypted digital content; and
a header having information for decrypting said
encrypted digital content.
The protocol of claim 18, wherein said header
includes a field for indicating a size of said encrypted

digital content, and an additional information field.
The protocol of claim 18 or 19, wherein said header
includes a copyright support field for indicating whether

said digital content are under copyright protection, a
non-encrypted header field and an encrypted header field.
The protocol of claim 18, 19 or 20, wherein said
header includes a field for indicating a size of the non-encrypted

header field, and a field for indicating said
size of said encrypted header field.
The protocol of claim 18, 19, 20 or 21, wherein said
header includes a copyright library version field, a

digital content conversion format field, a key generation
algorithm field, a digital content encryption algorithm

field, a field for indicating a user authorization
information, and a field for indicating said user

authorization information for a replaying device.
The protocol of claim 22, wherein said field includes
a field for indicating a hash value of said user key, and

a field for indicating said size of said hash value
generated by hash algorithm, a field for indicating a

resultant value of an encrypted content encryption key,
and a field for indicating said size of said resultant

value of said encrypted content encryption key.
The protocol of any of claims 19 to 23, wherein said
non-encrypted header field further comprises a copyright

library version field, a digital content conversion format
field, a field for indicating the code of a digital

content provider, a key generation algorithm field, a
digital content encryption algorithm field, a field for

indicating the number of users sharing a PC, a field for
indicating the number of users sharing a replaying device,

a field for indicating user authorization information for
said PC, and a field for indicating user authorization

information for said replaying device.
The protocol format of claim 20 or 21, wherein said
encrypted header field includes a field for encryption

algorithmof said digital content, a field for indicating a
basic process unit of said digital content, a field for

indicating the number of encrypted bytes, and a hash value
field for a hash value for determining state of entire

header.
A method for encrypting digital content, comprising
steps of:


inputting identity characters of a user for
registration;
determining whether said user is registered;
storing information of said identity characters of
said user on membership registration when said user is

determined to be unregistered;
transmitting key information to said user;
encrypting said digital content by using a content
encryption key in response to a request signal from said

user; and
transmitting said encrypted digital content.
The method of claim 26 further comprising the step of
transmitting information relating to service fee to a

service sanction agent server, said information being
generated when said encrypted digital content is

transmitted to said user.
A method for generating user authorization
information of digital content, comprising steps of:


receiving identity characters;
comparing said received identity characters with
stored identity characters to determine whether identical

identity characters with said received identity characters
exist among stored identity characters;
generating key information when said received
identity characters are determined not to exist;
transmitting said key information to said service
server; and
storing said identity characters and said key
information.
A method for encrypting digital content, comprising
steps of:


receiving a request signal for digital content from a
user;
generating a user authorization information when said
request signal is received;
generating a header having information relating to
said digital content and said user authorization

information;
encrypting said digital content; and
transmitting a copyright protection protocol
including said encrypted digital content and said header.
The method of claim 29 wherein said authorization
information is generated by using a key information

relating to said user's identity characters.
The method of claim 29, wherein said step of
generating said user authorization information further

comprises steps of:

generating a content encryption key in response to
said received request signal;
generating a user key by using a key information; and
generating said user authorization information by
using said content encryption key and said user key.
The method of claim 31, wherein said user
authorization information includes a hash value of said

user indicating user's authorization.
A method for generating a protocol format comprising
steps of:
receiving a user's request for digital content;
generating, in response to said users request, first
header by applying first digital content encryption

algorithm, or second header by applying second digital
content encryption algorithm when said first digital

content encryption algorithm does not exist;
encrypting said digital content; and
adding said header to said digital content.
The method of claim 33, further comprising the steps
of:


determining whether additional information exists;
generating an additional information field when the
additional information is determined to exist; and
adding said additional information field to said
protocol format.
The method of claim 33 or 34, wherein said step of
generating said header further comprises steps of:


generating a field for copyright support information
and a field for indicating size of non-encrypted header

information and then adding said fields to said header;
and
adding said non-encrypted header information field to
said header.
The method of claim 33, wherein said step for
generating said header further comprises steps of:


generating a user authorization information by using
a key information and adding said user authorization

information to said header;
generating a header information relating to said
encrypted digital content and encrypting said header

information; and
adding a field for said user authorization
information and a field said encrypted header information;

and a field for indicating a size of said encrypted header
information to the header.
A method for decrypting an encrypted digital content
comprising steps of:


receiving copyright protection protocol having a
header and digital content;
comparing internally stored data with user
authorization information included in said copyright

protection protocol; and
decrypting said encrypted digital content included in
said copyright protection protocol when said internally

stored data coincides with said user authorization
information.
The method of claim 37, further comprising the step
of replaying said decrypted digital content.
The method of claim 37 or 38, wherein said internally
stored data is a key information relating to a user's

identity characters.
The method of claim 37, 38 or 39, wherein said user
authorization information includes a hash value of a user

key generated by using a key information and an encrypted
content encryption key including said protocol, and said

hash value indicates user's authorization to enable said
user to decrypt said encrypted digital content.
The method of claim 37, wherein a first hash value
included in internally stored data generated by applying

key information to key generation algorithm is compared to
a second hash value generated from said user authorization

information of said protocol.
The method of claim 41, further comprising the steps
of:


decrypting a content encryption key included in said
user authorization information; and
decrypting an encrypted header included in said
copyright protection protocol by using said decrypted

content encryption key.
The method of claim 41, wherein said hash value is
served as a reference value for determination change of

said header and is calculated by applying said head to
hash algorithm.
A method for receiving authorization to receive
digital content from a service server, comprising steps

of:

requesting said service server for membership
registration;
receiving, from said service server, key information
for authorization, corresponding to said membership

registration; and
storing said received key information.
A method for receiving authorization to receive
digital content from a service server, comprising steps

of:

inputting and transmitting user's identity characters
to said service server;
receiving a key information for authorization,
corresponding to said transmitted user's identity

characters; and
storing said received key information.
The method further comprising the steps of:

receiving encrypted digital content; and
decrypting said encrypted digital content by using
said key information.
The method of claim 44 or 45, wherein said key
information is transmitted to and stored in an external

slave device.
A replaying device, comprising:

a memory for storing an algorithm for decrypting a
protocol including encrypted digital content, and for

storing key information and said protocol received from
outside of said replaying device;
a microcomputer for decrypting said protocol
including said digital content by using said key

information and said algorithm.
The replaying device of claim 48, further comprising
a decoder for decoding said encrypted digital content to

analog signal.
The replaying device of claim 48, wherein said
encrypted digital content is an MPEG bit stream
The replaying device of claim 48, 49 or 50, wherein
said microcomputer generates a user key by using said key

information, decrypts content encryption key included in
user authorization information of a header of said

protocol by using said user key, and decrypts said
encrypted digital content by using said content encryption

key.
The replaying device of claim 48, 49 or 50, wherein
said microcomputer outputs said digital content without

decrypting said digital content when said received digital
content is non-encrypted.
A method for decrypting digital content in a
replaying device, comprising steps of:


receiving protocol comprising a header including user
authorization information, and an encrypted digital

content; and
storing said protocol on a record medium.
The method of claim 53, further comprising a step of
decrypting and replaying said encrypted digital content

stored in said record media.
The method of claim 53, wherein said user
authorization information comprises a hash value of a user

key generated by key information, and an encrypted content
encryption key.
The method of claim 53, 54 or 55, wherein said record
medium is a flash memory.
A method for decrypting digital content in a
replaying device, comprising steps of:


receiving encrypted digital content and a header
having user author ization information;
generating calculated data using internally stored
data;
comparing said calculated data with said user
authorization information;
decrypting said encrypted digital content when said
calculated data and said user authorization information

are determined to be identical; and
replaying said decrypted digital content.
The method of claim 57, further comprising the steps
of:


applying key information to key generation algorithm
to calculate said calculated data;
calculating first hash value by applying said
calculated data to hash algorithm;
determining whether said first hash value is
identical to second hash value set in said user

authorization information;
decrypting a content encryption key included in said
user authorization information; and
decrypting an encrypted header included in copyright
protection protocol by using said decrypted content

encryption key.
The method of claim 57 or 58, wherein said internally
stored data is key information relating to user's identity

characters.
A method for decrypting digital content in a
replaying device, comprising steps of:


receiving key information and storing said key
information on a record medium;
receiving encrypted digital content and a header
having user authorization information;
generating a user key using said key information;
comparing first hash value of first user key set in
said received user authorization information and second

hash value of said generated user key; and
decrypting said encrypted digital content when said
hash values are identical to each other.
A player, comprising:

means for receiving authorization information;
means for receiving and decoding a protocol format
from outside of said player by using said authorization

information;
means for transmitting said decoded protocol format.
The player of claim 61, wherein said player is a
portable player.
The player of claim 61 or 62, wherein said player is
a portable audio player.
The player of claim 61, 62 or 63, further comprising
of means for storing an algorithm to decode said protocol

format.
The player of claim 61, 62, 63 or 64, further
comprising of second decoder means for decoding said

transmitted signal to an analog signal.
The player of claim 61, 62 63, 64 or 65 further
comprising a second decoder means for decoding said

transmitted signal to an audio signal.
The player of any of claims 61 to 66, wherein said
decoded signal is an MPEG signal.
The player of any of claims 61 to 67, wherein said
protocol format includes an encrypted digital content.
The player of any of claims 61 to 68, wherein said
protocol format includes a header having information for

encrypted digital content.
The player of any of claims 61 to 68, wherein said
protocol format includes a non-encrypted digital content.
The player of any of claims 61 to 70, further
comprising:


means for determinining whether first data in
protocol format is identical to second data in

authorization information; and
means for allowing decoding means to applying
algorithm to encrypted signal of said protocol format.
</CLAIMS>
</TEXT>
</DOC>
