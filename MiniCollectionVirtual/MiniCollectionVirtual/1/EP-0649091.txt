<DOC>
<DOCNO>EP-0649091</DOCNO> 
<TEXT>
<INVENTION-TITLE>
Correction and modification of microprocessor chip operations.
</INVENTION-TITLE>
<CLASSIFICATIONS>G06F930	G06F930	G06F9318	G06F9318	G06F932	G06F932	G06F938	G06F938	G06F9445	G06F9445	G06F11267	G06F11267	</CLASSIFICATIONS>
<CLASSIFICATIONS-THIRD>G06F	G06F	G06F	G06F	G06F	G06F	G06F	G06F	G06F	G06F	G06F	G06F	</CLASSIFICATIONS-THIRD>
<CLASSIFICATIONS-FOURTH>G06F9	G06F9	G06F9	G06F9	G06F9	G06F9	G06F9	G06F9	G06F9	G06F9	G06F11	G06F11	</CLASSIFICATIONS-FOURTH>
<ABSTRACT>
A correction of microprocessor chip design errors is achieved by 
identifying selected sets of instructions an/or selected sets of 

instruction sequences in an erroneous control flow of the 
microprocessor and/or by identifying selected sets of interface 

control and status signals. A match selectively initiates a 
corrective action by interfering with the instruction flow in 

the microprocessor chip or by requesting external control from 
an associated processor unit. Alternatively, a match is used for 

a programmable modification of interface control and status 
signals to adapt the chip to changes of its environment without 

redesign. 
A programmable on-chip detector logic (52, 54, 56, 60) is set by 
select and mask registers (64 to 69) to identify in an erroneous 

control flow a selected instruction and mode of operation, a 
selected sequence of instructions and a selected set of 

interface control and status signals. Programmable logic means 
(80) assign match condition signals to escape control lines (111 

to 120) to initiate a corrective interference with the control 
flow of the microprocessor chip or an interrupt request to an 

associated processing unit performing a sequence of corrective 
operations by or instead of the microprocessor chip, or to 

perform a correction of certain interface signals. The detector 
logic and the related registers are multiplied to simultaneously 

handle classes of different errors. A signal modification 
facility (130, 138, 139, 170) allows to select chip interface 

control and status lines to modify, insert or suppress input and 
output interface control and status signals. 


</ABSTRACT>
<APPLICANTS>
<APPLICANT-NAME>
IBM
</APPLICANT-NAME>
<APPLICANT-NAME>
INTERNATIONAL BUSINESS MACHINES CORPORATION
</APPLICANT-NAME>
</APPLICANTS>
<INVENTORS>
<INVENTOR-NAME>
DAO-TRONG SON
</INVENTOR-NAME>
<INVENTOR-NAME>
GERWIG GUENTER
</INVENTOR-NAME>
<INVENTOR-NAME>
HAAS JUERGEN
</INVENTOR-NAME>
<INVENTOR-NAME>
MUELLER ROLF
</INVENTOR-NAME>
<INVENTOR-NAME>
DAO-TRONG, SON
</INVENTOR-NAME>
<INVENTOR-NAME>
GERWIG, GUENTER
</INVENTOR-NAME>
<INVENTOR-NAME>
HAAS, JUERGEN
</INVENTOR-NAME>
<INVENTOR-NAME>
MUELLER, ROLF
</INVENTOR-NAME>
</INVENTORS>
<DESCRIPTION>
The invention relates to a method and a device for the 
correction and modification of the operation of processors chips 
in a multiprocessor computer system consisting of a number of 
single chip processors and a number of storage chips. Although the logical design of microprocessor chips are usually 
verified by simulation, it is often unavoidable that the first 
delivery of a VLSI chip embodying the microprocessor contains 
design errors. Such errors may exist in false results obtained 
during the execution of certain instructions, in incorrect 
control of the instruction sequencing which in particular may 
arise in a pipelined microprocessor design, or in the occurrence 
of invalid parity checks. There may also arise synchronization 
problems between tightly coupled functional units such as the 
instruction execution unit, the mathematical coprocessor or the 
cache storages. The probability of defective design increases 
with the growing complexity and the increase of the number of 
circuits implemented on one chip. A redesign of the chip to 
correct the errors requires a modification of the design, a new 
test time consuming run by simulation, and a new production 
cycle. Until the redesigned chip version is available it may 
take months during that the computer system of which the 
microprocessor is a part of can not be continued to be tested or 
is prevented from productive utilization. Microprocessor systems of the prior art try to avoid these 
difficulties by mounting on the chip card carrying the 
microprocessor chip an additional chip which takes over the 
function of a correction or replacement logic (IBM Technical 
Disclosure Bulletin, Vol. 19, No. 10, pages 3719-3722 and 3723-3725). 
The additional chip may for example be a programmable 
array logic (PAL). It receives input signals from the output of 
the microprocessor processor chip or may replace the latter with 
regard to certain input signals, and it will deliver  
 
corrected or otherwise modified output signals back to the 
microprocessor chip or instead of the latter to other functional 
units of the computer system. Such "off-chip" logic necessitates a considerable rework and 
test expenditure. Control lines must be disconnected, diverted 
and reconnected to other positions. The additional chip requires 
additional space on the chip card which is mostly rare. If a PAL 
is used, adaptation of power and voltage levels may be required. 
In addition, the design of the correction or replacement logic 
is usually irreversible which
</DESCRIPTION>
<CLAIMS>
Method for the correction and modification of the operation 
of a microprocessor chip in a computer system having of a 

number of processors and storage chips connected among each 
other via interfaces, comprising the steps of: 


a) comparing on processor chip level an erroneous 
instruction flow with a number of predetermined 

instructions or predetermined sequences of 
instructions and simultaneously comparing a set of 

interface control and status signals with a number of 
predetermined sets of interface status signals, 
b) assigning comparison match results obtained by step a) 
to selected escape conditions initiating 


(i) an interference with the internal control flow of 
the microprocessor to take a corrective action, 
(ii) an interrupt request to an associated processing 
unit performing a sequence of corrective 

operations, where said sequence may control the 
microprocessor chip or take over certain of its 

functions, or 
(iii) a modification of preselected interface signals, 
c) reprogramming the microprocessor chip to select a set 
of instructions and/or interface control and status 

signals for the comparisons according step a) and to 
adjust the assignment of said match signals from step 

a) to certain escape conditions of step b) according 
to the correction or modification required and to 

determine type and manner of said interface signal 
modification, and 
d) repeat steps a) to c) until the appropriate correction 
and/or modification has been achieved. 
Method according to claim 1 further comprising the step of 
selectively masking out certain portions of the preselected 

instructions and of interface status signals for taking 
part in the comparisons according to step a). 
Method according to claim 1 and 2, where said interference 
with the internal control flow of the microprocessor 

comprises the insertion or the suppression of instructions 
or sequences of instructions. 
Method according to claim 1 to 3, where said interface 
signal modification comprises the extension, shortening, 

insertion or suppression of input and output interface 
status signals. 
Method according to claim 1 and 4, further comprising the 
step of selectively masking out certain interface signals 

for being modified by one of the escape conditions. 
Device for the correction and modification of the operation 
of a single chip microprocessor having interface lines for 

the exchange of data, control and status signals with other 
components of a computer system such as associated 

processor and storage chips, comprising: 

a) detector means (52, 54, 56, 60) identifying 
predetermined instructions or sequences of 

instructions and operation mode information in an 
erroneous control flow of the microprocessor chip and 

for identifying predetermined sets of interface 
control and status signals of the microprocessor chip, 

where said detector means generate a match signal for 
each successful identification operation, 
b) programmable register means (64 to 69) connected to 
said detector means (52, 54, 56, 60) containing a 

first select register (64) each settable according to 
a selected combination of interface control and status 

 
signals, and containing a second and a third select 

register (66 and 68) each programmable according to 
selected instructions of the microprocessor 

instruction set, and further containing mask registers 
(65, 67, 69) each associated with one of said select 

registers settable to selectively mask out certain 
portions of said instructions and of said combinations 

of interface signals from participating in said 
identification operation, 
c) logic means (80) for selectively assigning said match 
signals to escape control lines (111 to 120) to 

initiate an interference with the control flow of the 
microprocessor chip, or an interrupt request to an 

associated processing unit performing a sequence of 
corrective operations, or a modification of 

preselected interface signals, 
d) programmable register means (91) connected to said 
logic means and settable to contain control 

information to establish and maintain a selective 
assignment between the match signal inputs (100) of 

said logic means (80) and the output lines of said 
logic means to generate the appropriate escape control 

signal for initiating a corrective action. 
Device according to claim 6, comprising a plurality of 
detector means (52, 54, 56, 60) for identifying 

predetermined combinations of sets of selected instructions 
and operation mode information in the data flow of the 

microprocessor chip and for simultaneously identifying 
predetermined combinations o
f sets of selected interface 
control and status signals of the microprocessor chip, 

where said plurality of detector means (52, 54, 56, 60) 
generate simultaneously a set of match signals to indicate 

in combination success in a complex identification 
operation, and comprising sets of programmable select 

registers (64, 66, 68) and sets of programmable mask 
 

registers (65, 67, 69) each connected to a set of detector 
means (52, 54, 56, 60) to program said plurality of 

detector means to perform a complex identification 
operation. 
Device according to claims 6 and 7, comprising a plurality 
programmable register means (91) connected to said logic 

means (80) and settable to contain control information to 
establish and maintain a selective assignment between the 

said set of match signals and each of the output lines of 
said logic means to generate the appropriate escape control 

signals for initiating corrective actions. 
Device according to one of the claims 6 to 8, further 
comprising: 


a) a plurality of programmable interface modification 
means (130, 170) assigned to the interface control and 

status lines of the microprocessor chip, containing 
logic means (148, 151, 152, 154, 160; 180, 182, 186, 

192, 194) which receive as input signals the regular 
interface control and status signal and a modification 

control signal to produce a regular or modified 
interface status or control signal, 
b) programmable register means (138, 139) connected to 
said interface modification means (130, 170) 

containing a function select register (138) settable 
according to a selected combination of interface 

control and status signals to be modified and 
providing control signals to said logic means, and 

further containing mask registers (MR0, MR1, MR2) each 
associated with one of said escape control signals to 

allow or suppress the generation of a corresponding 
modification control signal. 
Device according to one of the claims 6 to 9, where said 
modification control signals urge said logic means to 

 
extent, shorten or suppress said interface control and 

status signals or to insert new interface control and 
status signals. 
Device according to one of the claims 6 to 10, where a 
subset of said escape control lines (111 to 120) are 

connected to engineering change pins (124, 126, 128) for 
off-chip processing. 
Device according to one of the claims 6 to 11, where said 
register means (64 to 69, 91, 138, 139) are part of a level 

sensitive scan design (LSSD) and are loaded by shift 
register operations initiated by an associated processing 

unit (12). 
</CLAIMS>
</TEXT>
</DOC>
