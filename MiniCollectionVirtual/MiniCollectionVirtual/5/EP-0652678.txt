<DOC>
<DOCNO>EP-0652678</DOCNO> 
<TEXT>
<INVENTION-TITLE>
Method, apparatus and circuit for improving motion compensation in digital video coding
</INVENTION-TITLE>
<CLASSIFICATIONS>H04N732	G06T900	H04N726	G06T900	H03M736	H04N726	H04N732	H03M736	</CLASSIFICATIONS>
<CLASSIFICATIONS-THIRD>H04N	G06T	H04N	G06T	H03M	H04N	H04N	H03M	</CLASSIFICATIONS-THIRD>
<CLASSIFICATIONS-FOURTH>H04N7	G06T9	H04N7	G06T9	H03M7	H04N7	H04N7	H03M7	</CLASSIFICATIONS-FOURTH>
<ABSTRACT>
A novel method and apparatus for use in digital video 
compression provides improved block-based motion 

compensation using the global motion of a video frame. A 
video frame comprising a plurality of blocks may be 

compressed for transmission using block motion vectors. 
Motion vectors are generated by block matching a block to 

be coded with a block within a reference frame and 
determining the displacement therebetween. To effect 

block matching, motion compensation techniques define a 
search window within one or more reference frames within 

which a displaced block will be found. According to the 
present invention, the location of the search window 

within a reference frame is defined using the global 
motion of the frame. 


</ABSTRACT>
<APPLICANTS>
<APPLICANT-NAME>
AT 
&
 T CORP
</APPLICANT-NAME>
<APPLICANT-NAME>
AT
&
T CORP.
</APPLICANT-NAME>
</APPLICANTS>
<INVENTORS>
<INVENTOR-NAME>
HORNE CASPAR
</INVENTOR-NAME>
<INVENTOR-NAME>
HORNE, CASPAR
</INVENTOR-NAME>
</INVENTORS>
<DESCRIPTION>
This invention relates to methods of converting a
block of video data into a compressed encoded digital bit
stream, to apparatus for determining the location of a
displaced block of video data within a reference frame, and
to video coder circuits for converting a plurality of
frames of video data into a compressed encoded digital
bit stream.Block-based motion compensation techniques including
either motion interpolation or motion prediction are used
in digital image sequence coding to reduce the amount of
data that must be transmitted in digital video systems.
Video sequences typically exhibit a substantial amount of
repetitive image information between consecutive frames.
By compensating for the motion of objects within an image
frame, a high compression of the video data can be
achieved.Block-based motion compensation techniques initially
divide a video frame into several blocks of picture
elements (pels). These techniques employ motion vectors
to indicate the movement of these blocks between
successive frames. It is assumed that each pel within a
block has the same translational motion. These motion
vectors, along with error signals, may be transmitted to a
receiver. The receiver may then regenerate the video
blocks using the motion vectors to locate the
corresponding blocks from a previously transmitted frame.
The error signals are used to account for pel differences
within each block between successive frames.Consider, for example, the image of a football in a
football game video sequence. The football image remains
substantially identical from frame to frame, but its
location within the video frame changes. If the motion
vector of the football is known, then the image of the
football can be reconstructed in a new video frame using 
the football image data from the previous frame. As a
consequence, instead of transmitting repetitive image data
for each new frame, motion vectors may be transmitted. An
error signal is also transmitted to account for other
differences, for example, a change in orientation of the
football.Motion compensation methods employ a process known as
motion estimation to generate the motion vectors. In
motion estimation, a motion vector for a particular block
within a current frame is determined by matching the image
data within the block to the image data in a displaced
block within a reference frame. The motion vector
represents the difference in position between the block
from the current frame and the displaced block from the
reference frame. The reference frame may be a
</DESCRIPTION>
<CLAIMS>
A method (300) of converting a block of video data (354) which is
one of a plurality of blocks defining a frame of video data, into a compressed encoded

digital bit stream for transmission over a transmission medium, said method being
characterized by


a) generating a global motion vector (355);
b) generating both video data and position data corresponding to the
block of video data to be coded (354); and
c) effecting block matching (312) by using predetermined criteria to
identify a displaced block (351) corresponding to the block of video data to be coded

(354), the displaced block (351) having a location within a reference frame (352), said
block matching step comprising defining a search window within the reference frame

using the global motion vector (310).
A method as claimed in claim 1 comprising the steps:

d) generating a motion vector defined by the block position data and the
location of the displaced block within the reference frame (318);
e) storing said motion vector;
f) encoding said motion vector into a bit stream for transmission; and
g) repeating steps b) to f) for a plurality of blocks to be encoded, said
plurality of blocks constituting at least a portion of one frame of video data.
A method as claimed in claim 2 wherein the step of generating the
global motion vector comprises the step of utilizing a plurality of the previously stored

motion vectors from said step (e) to generate the global motion vector, and comprising
the step of:


h) repeating steps a) to g) for a plurality of frames of video data.
A method as claimed in claim 3 wherein the plurality of previously
stored motion vectors comprise motion vectors stored during the encoding of a frame of

video data. 
A method as claimed in claim 3 wherein the step of generating the
global motion vector utilizing a plurality of the previously stored motion vectors

comprises utilizing the mean of the plurality of the previously stored motion vectors to
generate the global motion vector.
A method as claimed in claim 3 wherein the step of generating the
global motion vector utilizing a plurality of the previously stored motion vectors

comprises utilizing the median of the plurality of the previously stored motion vectors
to generate the global motion vector.
A method as claimed in claim 3 wherein the step of generating the
global motion vector utilizing a plurality of the previously stored motion vectors

comprises utilizing the motion vector occurring with the most repetition within the
plurality of the previously stored motion vectors to generate the global motion vector.
A method as claimed in claim I wherein said step of defining a search
window within the reference frame using the global motion vector comprises:


a) generating a motion vector for each new data block from a frame of
video data comprising a plurality of data blocks (401);
b) storing said motion vector in a memory;
c) repeating steps a) and b) until a plurality of motion vectors for a
plurality of said data blocks within said frame of video data have been generated and

stored (402);
d) generating the global motion vector from the plurality of the stored
motion vectors (407);
e) identifying a video data block having a location within a frame of
video data to be coded; and
f) defining a search window having a location within a stored reference
video frame wherein the location of the search window is at least partially dependent

upon the global motion vector.
A method as claimed in claim 8 wherein the location of the search
window to be defined in step f) is at least partially dependent on the location of the

video data block within the frame of video data to be coded. 
A method as claimed in claim 8 wherein the step of generating the
glob
al motion vector using a predetermined method comprises the step of calculating
the mean of the plurality of stored motion vectors.
A method as claimed in claim 8 wherein the step of generating the
global motion vector using a predetermined method comprises the step of determining

the median of the plurality of stored motion vectors.
A method as claimed in claim 8 wherein the step of generating the
global motion vector using a predetermined method comprises the step of determining

the motion vector occurring with the most repetition within the plurality of stored
motion vectors.
The method of claim 8 wherein the step of generating the global
motion vector comprises the step of creating a table of occurrence indices for a plurality

of possible motion vectors, and the step of storing the motion vector comprises
incrementing an occurrence index corresponding to the motion vector in the table.
Apparatus (100) for determining the location of a displaced block of
video data within a reference frame corresponding to a block of video data where the

displaced block is identified from a plurality of candidate displaced blocks using
predetermined criteria, the apparatus being characterized by:


a) a motion estimator (104) comprising a processing means and memory
means, the processing means being operable to determine the location of a displaced

block by defining a search window within the reference frame using a global motion
vector, identifying a plurality of candidate displaced blocks having a location within the

search window, and comparing each candidate displaced blocks with the block of video
data; and
b) a global motion estimator (106) coupled to the motion estimator,
comprising processing means and storage means, said processing means being operable

to generate global motion vectors.
Apparatus as claimed in claim 14 wherein the motion estimator
comprises means for effecting motion compensation prediction. 
Apparatus as claimed in claim 14 wherein the motion estimator
comprises means for effecting motion compensation interpolation.
A video coder circuit (100) for converting a plurality of frames (201)
of video data comprising a plurality of pels (204), each pel having pel video data, a

plurality of pels further defining a block (202), into a compressed encoded digital bit
stream for transmission over a transmission medium, said video coder circuit being

characterized by:

a) a video frame storage unit (103) operable to generate a block of video
to be coded from a frame of video data, said block having a position within the frame of

video data;
b) a motion estimation means (104) connected to the video frame
storage unit (103) for receiving the video data corresponding to a block of video to be

coded. said motion estimation means being operable to effect block matching between a
block of video to be coded and a block within a reference frame to identify a displaced

block having a location within the reference frame, and to generate a motion vector
defined by the position of the block to be coded and the location of the displaced block

within the reference frame, said motion estimation means being operable to effect block
matching using a global motion vector, whereby the global motion vector is used to define a search window within the reference frame;
c) a first buffer (108) for storing video data corresponding to one or
more reference frames connected to the motion estimation means for providing

reference frame video data thereto:
d) a second buffer (109) for storing video data corresponding to a
current frame connected to the first buffer for providing current frame video data thereto

and connected to the motion estimation means;
e) a subtraction node (105) connected to the video frame storage unit for
receiving block video data and connected to the motion estimation means for receiving

displaced block video data, said subtraction node being operable to generate an error
signal representative of the difference in pel video data between two blocks of video

data: and
f) a coding device (107) connected to the subtraction node (105) for
receiving an error signal and connected to the motion estimation means (104) for 

receiving a motion vector, said coding device (107) being operable to encode video data
from a block error signal and motion vector data into a bit stream.
A circuit as claimed in claim 17 comprising a global motion
estimation means (106) connected to the motion estimation means for providing the

global motion vector thereto, said global motion estimation means being operable to
generate global motion vector data representative of the global motion between video

frames.
A circuit as claimed in claim 17 wherein the global motion
estimation means is operably connected to receive motion vectors from the motion

estimation means and is operable to generate a global motion vector from a plurality of
received motion vectors.
A circuit as claimed in claim 17 wherein the motion estimation
means comprises means for effecting motion compensation prediction.
A circuit as claimed in claim 17 wherein the motion estimation
means comprises means for effecting motion compensation interpolation.
</CLAIMS>
</TEXT>
</DOC>
