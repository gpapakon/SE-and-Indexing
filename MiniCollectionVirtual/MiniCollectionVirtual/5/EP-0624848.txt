<DOC>
<DOCNO>EP-0624848</DOCNO> 
<TEXT>
<INVENTION-TITLE>
A technique for the detection and removal of local defects in digital continuous-tone images
</INVENTION-TITLE>
<CLASSIFICATIONS>G06T500	G06T500	G06T520	G06T520	G06T700	G06T700	</CLASSIFICATIONS>
<CLASSIFICATIONS-THIRD>G06T	G06T	G06T	G06T	G06T	G06T	</CLASSIFICATIONS-THIRD>
<CLASSIFICATIONS-FOURTH>G06T5	G06T5	G06T5	G06T5	G06T7	G06T7	</CLASSIFICATIONS-FOURTH>
<ABSTRACT>
The present invention is a method for 
automatically detecting and correcting a wide range of local 

digital image defects with minimal user intervention. The 
detection process employs brightness and color thresholds in 

conjunction with magnitude thresholds on residuals of 
nonlinear spatial filters to separate defects from scene 

content with minimal confusion. The detected defects are 
then cosmetically corrected by combinations of nonlinear 

smoothing and grey-scale erosion. Several options are 
outlined for the feature selection, detection, and cleaning 

operations depending on source type and computational 
constraints. 


</ABSTRACT>
<APPLICANTS>
<APPLICANT-NAME>
EASTMAN KODAK CO
</APPLICANT-NAME>
<APPLICANT-NAME>
EASTMAN KODAK COMPANY
</APPLICANT-NAME>
</APPLICANTS>
<INVENTORS>
<INVENTOR-NAME>
GRAY, ROBERT T., C/O EASTMAN KODAK COMPANY
</INVENTOR-NAME>
</INVENTORS>
<DESCRIPTION>
The present application is related to U. S. 
Patent Application Serial No. 07/934,089 entitled 
"Process for Detecting and Mapping Dirt on The Surface of 
a Photographic Element" filed 08/21/92 by Robert Gray et 
al., corres. to EP 0 585 759 A1. The present invention is related to the field 
of scanning images, primarily from photographic film, to 
form electrical equivalents of the scanned images and 
more particularly to the detection and the removal of 
defects due, for example, to dirt contamination or 
physical damage of the film. A portion of the disclosure of this patent 
document contains material which is subject to 
copyright protection. The copyright owner has no 
objection to the facsimile reproduction by any one of 
the patent disclosure, as it appears in the Patent and 
Trademark Office patent files or records, but otherwise 
reserves all copyright rights whatsoever. Digital images created from electronic scanning 
of continuous-tone photographic film often reveal 
visually objectionable defects due to dirt contamination 
or surface damage of the film. These defects usually must 
be digitally corrected by manual digital retouching (e.g.  
 
via "dustbusting" and other cloning techniques), which 
require that the operator visually identify each local 
defect in the image. A patent of interest for its teaching in this 
art is U.S. Patent No. 4,189,235. entitled "Test Device 
For Dynamically Measuring The Degree of Dirt Accumulation 
On Bank-Notes" by Guter et al. That patent describes a 
method for inspecting opaque web materials for dirt 
accumulation. A reflected signal from the web material 
is sensed by three adjacent photosensors as the material 
moves past the sensors. When the signal sensed by the 
center sensor is significantly different than from that 
sensed by the side sensors the sensed area is classified 
as containing dirt. In conventional optical printing systems, if 
dirt or a scratch appears on the photographic image, the 
photographic negative or slide may be cleaned and the 
print remade or the print itself may be retouched. In 
the case where the images are written to an optical disc, 
it is not convenient nor desirable to rewrite the image, 
because many images are written onto a disc before the 
images are viewed, and once an image is written it cannot 
be removed. Therefore, it is desirable to monitor the 
dirt present in photofinishing environments and to assess 
the effectiveness of any selected film cleaning methods. In U.S. Patent No. 4,907,156, entitled "Method 
an
</DESCRIPTION>
<CLAIMS>
A method for the detection and removal of 
defects in digital images comprising the steps of: 


a) preprocessing a digital image represented by 
pixel values to form a feature image in which defect pixels 

have large local contrast from their neighboring non-defect 

pixels; 
b) testing the value of each feature image pixel 
value to determine if the value is within a range of pixel 

values expected of defects; 
c) edge-preserving spatial filtering of each of 
the feature image pixel values that are within the range of 

expected defects; 
d) forming a residual value for each pixel as a 
function of the difference between the corresponding feature 

image pixel value and the filtered value of step c); 
e) testing each residual value of step d) to 
determine if the residual value is within a range of 

residuals values expected of defects; 
f) forming a map in which each pixel that is 
within the range of expected defects according to steps b) 

and e) is marked as a defect; and 
g) correcting the digital image using the map 
created in step f). 
A method for the detection and removal of 
defects in digital images comprising the steps of: 


a) preprocessing a digital image represented by 
pixel values to form a feature image in which defect pixels 

have large local contrast from their neighboring non-defect 
pixels; 
b) testing the value of each feature image pixel 
value to determine if the value is within a range of pixel 

values expected of defects; 
c) edge-preserving spatial filtering of each of 
the feature image pixel values that are within the range of 

expected defects; 
d) forming a residuals image which consists of the 
difference between the feature image pixel values and the 

filtered values of step c); 
e) testing each pixel value of the residuals image 
of step d) to determine if the residual value is within a 

range of residuals values expected of defects; 
f) forming a map in which each pixel that is 
within the range of expected defects according to steps b) 

and e) is marked as a defect; and 
g) correcting the digital image using the map 
created in step f). 
A method for the detection and removal of 
defects in digital images comprising the steps of: 


a) preprocessing a digital image represented by 
pixel values to form a feature image in which defect pixels 

have large local contrast from their neighboring non-defect 
pixels; 
b) testing the value of each feature image pixel 
value to determine if the value is within a range of pixel 

values expected of defects; 
c) edge-preserving spatial filtering of each of 
the feature image pixel values; 
d) forming a residual value for each pixel as a 
function of the difference between the corresponding feature 

image pixel value and the filtered value of step c); 
e) testing each residual value of step d) to 
determine if the residual value is within a range of 

residuals values expected of defects; 
f) forming a map in which each pixel that is 
within the range of expected defects according to steps b) 

and e) is marked as a defect; and 
g) correcting the digital image using the map 
created in step f). 
The method according to Claim 1, 2, or 3, 
wherein the map formed in step f) is conditioned by 

morphological dilation of the pixels marked as defect. 
The method according to Claim 1, 2, or 3, 
wherein the map formed in step f) is conditioned by 

morphological erosion of the pixels not marked as defect. 
The method according to Claim 1, 2, or 3, 
wherein the map of step f) is formed with each pixel marked 

according to the magnitude of its values according to steps 
b) and e). 
A method for the detection and removal of 
defects in digital images represented by multiple spatial 

resolutions ordered from lower to higher, comprising the 
steps of: 


a) preprocessing a lower spatial resolution 
representation of the digital image by forming a feature 

image in which defect pixels have large local contrast from 
their neighboring non-defect pixels; 
b) testing the value of each feature image pixel 
value to determine if the value is within a range of pixel 

values expected of defects; 
c) edge-preserving spatial filtering of each of 
the feature image pixel values that are within the range of 

expected defects; 
d) forming a residual value for each pixel as a 
function of the difference between the corresponding feature 

image pixel value and the filtered value of step c); 
e) testing each residual value of step d) to 
determine if the residual value is within a range of 

residuals values expected of defects; 
f) forming a map in which each pixel that is 
within the range of expected defects according to steps b) 

and e) is marked as a defect; 
g) correcting the lower resolution representation 
of the digital image using the map created in step f); and 
h) correcting the higher resolution 
representations of the digital image using the map created 

in step f). 
An apparatus for the detection and removal of 
defects in digital images comprising: 

   means for preprocessing a digital image 
represented by pixel values to form a feature image in which 

defect pixels have large local contrast from their 
neighboring non-defect pixels; 

   first means for testing the value of each feature 
image pixel value to determine if the value is within a 

range of pixel values expected of defects; 
   filter means for edge-preserving spatial filtering 

of each of the feature image pixel values; 
   means for forming a residual value for each pixel 

as a function of the difference between the corresponding 
feature image pixel value and the filtered value from said 

filter means; 
   second means for testing each residual value from 

said forming means to determine if the residual value is 
within a range of residuals values expected of defects; 

   means for forming a map in which each pixel that 
is within the range of expected defects according to said 

first and said second testing means is marked as a defect; 
and

 
   means for correcting the digital image as a 

function of the formed map. 
An apparatus for the detection and removal of 
defects in digital images represented by multiple spatial 

resolutions ordered from lower to higher, comprising: 
   means for preprocessing a lower spatial resolution 

representation of the digital image by forming a feature 
image in which defect pixels have large local contrast from 

their neighboring non-defect pixels; 
   first testing means for testing the value of each 

feature image pixel value to determine if the value is 
within a range of pixel values expected of defects; 

   filter means for edge-preserving spatial filtering 
of each of the feature image pixel values that are within 

the range of expected defects; 
   residual means for forming a residual value for 

each pixel as a function of the difference between the 
corresponding feature image pixel value and the filtered 

value of said filter means; 
   second testing means for testing each residual 

value from said residual means to determine if the residual 
value is within a range of residuals values expected of 

defects; 
   mapping means for forming a map in which each 

pixel that is within the range of expected defects from said 

first and said second testing means is marked as a defect; 
   means for correcting the lower resolution 

representation of the digital image using the map created by 
said mapping means; and 

   means for correcting the higher resolution 
representations of the digital image using the map created 

by said mapping means. 
A method for the detection and removal of 
local defects in digital images comprising the steps of: 


a) generating a feature image from an original 
digital image; 
b) creating an EPS-residuals image using the 
feature image; 
c) testing and mapping image pixels based upon the 
values of the EPS residuals image and the pixel values of 

the feature image; 
d) modifying the mapped image as a function of 
mapped values of neighboring pixels; 
e) cleaning of defect pixels by an EPS-substitution 
process or by a greyscale erosion process; and 
f) cleaning of defect pixels in different spatial 
resolution representations of the original image if 

different spatial resolution representations are present. 
A method for the detection and removal of 
defects in digital images comprising the steps of: 


a) preprocessing a digital image to form a feature 
image; and 
b) testing each feature image to determine if a 
value is within a range of pixel values expected of defects; 
c) edge-preserving spatial filtering of each of 
the feature image pixel values that are within the range of 

expected defects. 
</CLAIMS>
</TEXT>
</DOC>
