<DOC>
<DOCNO>EP-0610208</DOCNO> 
<TEXT>
<INVENTION-TITLE>
METHOD AND APPARATUS FOR ADAPTIVELY THRESHOLDING GRAYSCALE IMAGE DATA
</INVENTION-TITLE>
<CLASSIFICATIONS>G09G542	G06T500	H04N1403	G09G510	H04N141	H04N1407	H04N141	G09G542	H04N1407	G06T500	G09G510	H04N1403	G06K938	G06K938	</CLASSIFICATIONS>
<CLASSIFICATIONS-THIRD>G09G	G06T	H04N	G09G	H04N	H04N	H04N	G09G	H04N	G06T	G09G	H04N	G06K	G06K	</CLASSIFICATIONS-THIRD>
<CLASSIFICATIONS-FOURTH>G09G5	G06T5	H04N1	G09G5	H04N1	H04N1	H04N1	G09G5	H04N1	G06T5	G09G5	H04N1	G06K9	G06K9	</CLASSIFICATIONS-FOURTH>
<ABSTRACT>
A method and apparatus for adaptively adjusting (e.g. thresholding) grayscale image data associates with each document image file (210, 212) a predetermined grayscale adjusting function (216) which can be used to threshold, contrast stretch and gray level reduce the original gray level image of the document into a picture representation for display at workstations, the picture representation yielding increased contrast of written and printed text viewed. The invention includes a method of generating a remapping function for use in converting near-photographic document image pixel gray level data lying in a first range of gray level values to higher contrast, background-suppressed pixel gray level data lying in a second more limited gray level range. Global document information, such as a histogram of all the document's original pixels, is used to generate at least one threshold gray level value and to determine the shape of the remapping function on either side of the threshold. Preferably, the remapping function is implemented by a look-up table (216) addressed in accordance with the original pixel data.
</ABSTRACT>
<APPLICANTS>
<APPLICANT-NAME>
UNISYS CORP
</APPLICANT-NAME>
<APPLICANT-NAME>
UNISYS CORPORATION
</APPLICANT-NAME>
</APPLICANTS>
<INVENTORS>
<INVENTOR-NAME>
KIDD ROBERT CHARLES
</INVENTOR-NAME>
<INVENTOR-NAME>
KLEIN ROBERT DENNIS
</INVENTOR-NAME>
<INVENTOR-NAME>
KIDD, ROBERT, CHARLES
</INVENTOR-NAME>
<INVENTOR-NAME>
KLEIN, ROBERT, DENNIS
</INVENTOR-NAME>
</INVENTORS>
<DESCRIPTION>
The present invention concerns image data processing.
More particularly, the invention pertains to high speed,
post-processing of image data to adaptively effect gray
level tone scale adjustment of document imagery at an
image-based data entry workstation. Still more
specifically, the invention is directed to a method of
generating a pixel remapping formation to effect an
enhanced gray level adjustment.Heretofore financial documents, such as checks or
drafts, usually contain a magnetic ink character
recognition (MICR) code line which is typically read by a
sorter and which automatically sorts these documents into
a plurality of bins. Prior to sorting, in current
practice, these documents are presented to banking
personnel who physically handle the documents and
mechanically enter, in MICR form, the dollar amount
associated therewith upon each document by the use of
specialized amount entry equipment. Additionally, these
individuals physically correct incorrectly read MICR data
associated with each of the sorted documents.These prior techniques of utilizing banking personnel
to process financial documents have proven relatively
costly and inefficient, in that many of these documents
have been lost or destroyed during their physical
handling, and the speed associated with the processing of
the documents is limited to that associated with the
processing capabilities of the banking personnel and the
mechanical amount entry equipment they use. To address these problems, document imaging systems
have been introduced to eliminate much of the previously
required physical handling of the documents themselves.
In such known systems, functions such as image data
element normalization, background suppression, scaling and
document height detection are performed as preprocessing
functions prior to compression of the document image data
for storage or transmission to a data decompressor.Previous approaches for effecting background
suppression in document image processing systems to yield
higher contrast images for data entry operators are
complex. Additionally, for imaging systems to be
associated with archival storage systems, the original
image data cannot be discarded in a suppression technique,
but must be maintained for archival integrity. Therefore,
there is a need for an efficient, relatively non-complex
approach to gray level tone scale adjustment, such as
thresholding image pixel data, in order to yield picture-like
representations of the image at the workstation which
feature increased contrast of written
</DESCRIPTION>
<CLAIMS>
A method of adjusting gray level tone scale of document
image data generated by an image processing system for

subsequent display, the method comprising:

reading the image data and generating a tone scale adjusting
function based on the image data;
constructing and storing a document image data file
comprising the document image data and the tone scale adjusting

function;
subsequently accessing the document image data file to
retrieve the document image data and the tone scale adjusting

function;
subsequently utilizing the retrieved tone scale adjusting
function to alter the retrieved image data to generate tone

scale-adjusted image data prior to display thereof;

   the tone scale adjusting function for retrieved image data
comprising:


generating a gray level histogram of the retrieved image data;
identifying a preselected gray level range in said histogram in which at least
one histogram peak is identified, the peak comprising a range of

levels between about one-third of a whitest level and the
whitest level of the original document gray level range; and
identifying first and second histogram peaks, the first peak
being closest to the whitest level and the second peak being

closest to one-third of the whitest level, wherein all original

gray level data points whiter than a first threshold level
determined by the first histogram peak are adjusted to a whitest

gray level, wherein all original gray level data points lying
between the first threshold and a second threshold determined by

the second histogram peak are de-emphasized, and wherein all
original gray level data points darker than the second threshold

are emphasized.
The method of claim 1 further comprising:

downloading the document image data file and its associated
tone scale adjusting function to at least one workstation

associated with the image processing system; and
performing the altering of the grayscale of the document
image data at the workstation by means of the tone scale 

adjusting function prior to display of the document image.
The method of claims 1 or 2, wherein the adjusting
function is implemented by means of a look-up table which is

addressed using the grayscale value of pixels of the document
image having contents at each pixel address corresponding to a

thresholded value of the pixel.
The method of claim 3, wherein the tone scale adjusting
function stored in the look-up table is determined by the image

processing system as a function of preselected characteristics
of grayscale image data of a corresponding document.
The method of claims 3 or 4, wherein the step of
downloading document image data at the workstation comprises:


receiving compressed image data from an image processing and
storage system,
capturing an image of a document and digitizing the image as
a plurality of pixels, each having one of a plurality of

grayscale levels in a preselected range;
selecting a grayscale remapping curve as a function of
predetermined characteristics of the digitized grayscale image

data; and
generating the look-up table for producing thresholded output
pixels related to address inputs in accordance with the selected

remapping curve.
The method of one or more of claims 1-5, wherein the
adjusting function is effected by generating a gray level

remapping function by the steps of:

generating a gray level histogram of the original gray level
image data;
identifying at least one peak in a preselected gray level
range in the gray level histogram;
defining the adjusting function as

(a) adjusting all original gray level data
points to a whitest gray level whenever a

corresponding original gray level datum point
is whiter than a threshold level determined by

the at least one histogram peak, and 
(b) adjusting all other original gray level
data points having gray levels less than the

threshold level to preselected levels darker
than the whitest level.
The method of claim 6 which further includes the step of
filtering the histogram by using a low-pass, finite impulse

response filter; and wherein first and second histogram peaks
are identified, the first peak being closest to the whitest

level and the second peak being closest to one-third of the
whitest level, wherein all original gray level data points

whiter than a first threshold level determined by the first
histogram peak are adjusted to a whitest gray level, and wherein

all original gray level data points lying between the first
threshold and a second threshold determined by the second

histogram peak are de-emphasized, and wherein all original gray
level data points darker than the second threshold are enhanced.
The method of claim 2, wherein the preselected adjusting
function is effected by generating contents of a remapping look-up

table for use in converting original near-photographic
document image pixel gray levels lying in a first range of gray

level values to higher contrast and background-suppressed
limited pixel gray level data lying in a second range of gray

level values smaller than the first range, the conversion
performed by reading the look-up table at an address determined

by a gray level value of an original pixel of interest and
reading out a converted value, the method comprising:


(a) generating a gray level histogram of all
pixels of a document;
(b) suppressing small peaks and noise in the
histogram by use of a smoothing filter;
(c) generating a first-order difference
function of the histogram and identifying two

histogram peaks, if any, by estimating
locations of zero-crossings of the first-order

difference function and saving two peaks, a
first peak closest to the whitest gray level of

the first range and a second peak closest to
one-third of the whitest gray level of the first 

range;
(d) whenever no peaks are identified, setting
a high threshold and a low threshold both equal

to about two-thirds of a whitest gray level
value in the first range and proceeding to

step (g);
(e) whenever a single peak is identified,
setting a high threshold and a low threshold

both equal to a gray level value in the first
range which corresponds to a gray level value

at which the first-order difference function
falls to half of its maximum value on a darker

side of the single peak and proceeding to
step (g);
(f) setting a high threshold to a gray level
value in the first range which corresponds to

a gray level at which the first-order difference
function falls to half of its maximum value on a

darker side of the first saved peak, and
setting a low threshold to a gray level value

in the first range which corresponds to a gray
level at which the first-order difference

function falls to half of its maximum value on a
darker side of the second saved peak; and
(g) defining the contents of the remapping
table by


(i) placing a whitest gray level value of
the second range at all table addresses

specified by original pixel values above
the high threshold,
(ii) placing de-emphasized gray level
values in the second range at all table

addresses specified by original pixel
values between the high and low

thresholds, and
(iii) placing emphasized gray level
values in the second range at all table

addresses specified by original pixel
values below the low threshold.
The method of one or more of claims 1-8, further including
the step of storing the gray level values as pixel image data

for subsequent retrieval.
An apparatus for adaptively thresholding grayscale
document image data in an image processing system (202, 204)

associated with at least one workstation (38), the apparatus
comprising:


generator means (206) for examining grayscale image data
produced by the image processing system (202, 204) corresponding

to a document of interest, the generator means (206) generating
as a function of the image data a grayscale remapping curve

(216) for thresholding the image data, and the generator means
(206) placing the grayscale remapping curve (216) in an image

file header block (210, 212) for storage with image data (214)
which is associated with the document of interest in a storage

module (34) of the image processing system (202, 204); and
post-processing means (222) at each workstation (38) coupled
for receipt of the grayscale remapping curve (216) and operative

to adaptively threshold each grayscale pixel of the document

image data in accordance with the grayscale remapping curve
(216) and to present a thresholded image of the document of

interest for display at the workstation (38),
the grayscale remapping curve (216) to adaptively threshold
each grayscale pixel of the document image data being generated

by:

generating a gray level histogram of the retrieved image data;
identifying a preselected gray level range in said histogram in which at least
one histogram peak is identified, the peak comprising a range of

levels between about one-third of a whitest level and the
whitest level of the original document gray level range; and
identifying first and second histogram peaks, the first peak
being closest to the whitest level and the second peak being

closest to one-third of the whitest level, wherein all original
gray level data points whiter than a first threshold level

determined by the first histogram peak are adjusted to a whitest
gray level and wherein all original gray level data points lying

between the first threshold and a second threshold determined by
the second histogram peak are de-emphasized, and wherein all

original gray level data points darker than the second threshold 
are emphasized.
The apparatus of claim 10, wherein the generator means
(206) is further adapted for generating a gray level tone scale

adjusting function and wherein the grayscale remapping curve or
the adjusting function is represented by entries in a look-up

table (216) which is stored by the generator means (206) in the
image file header block (210, 212).
The apparatus of claims 10 or 11, wherein the generator
means (206) examines the grayscale image data for generating the

remapping curve prior to compression of the grayscale image data
by a compressor (208) of the image processing system (202, 204),

and wherein the generator means (206) places the remapping curve
in the image file header block (210, 212) for storage in the

storage module (34) with compressed image data (218) associated
with the document of interest.
The apparatus of claim 10, wherein the grayscale
remapping curve is represented by entries in a look-up table

(216) which is stored in the storage module (34) by the
generator means (206) in the image file header block (210, 212)

with a compressed image data (218) associated with the document
of interest.
The apparatus of one or more of claims 10-13, further
comprising a decompressor (220) at each workstation (38) for

decompressing compressed image data (218) received from the
storage module (34) and wherein the post-processing means (222),

preferably upon receipt of the look-up table (216) in the image
header block (210, 212), is operative to adaptively threshold

each decompressed grayscale pixel.
The apparatus of claim 14, further comprising selection
means (224) having a first input (256a) coupled for receipt of

unthresholded decompressed image data from the decompressor
(220), a second input (258) coupled for receipt of thresholded

image data preferably from the look-up table (216) in the post-processing
means (222), and a control input (260) coupled for

receipt of selection signals generated by a workstation 
operator, the selection means (224) being operative to present

either unthresholded or thresholded image data for display at
the workstation (38) in accordance with a signal present on the

control input (260).
The apparatus of claim 15, further comprising a display
buffer (264) connected to the selection means (224) for storing

the thresholded image therein prior to display by the
workstation (38).
</CLAIMS>
</TEXT>
</DOC>
