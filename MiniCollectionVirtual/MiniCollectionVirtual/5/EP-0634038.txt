<DOC>
<DOCNO>EP-0634038</DOCNO> 
<TEXT>
<INVENTION-TITLE>
A CRYPTOGRAPHIC COMMUNICATIONS METHOD AND SYSTEM
</INVENTION-TITLE>
<CLASSIFICATIONS>G06F2120	G09C100	G06F2120	G09C100	H04L932	G07F710	H04L932	H04L928	G07F710	H04L930	</CLASSIFICATIONS>
<CLASSIFICATIONS-THIRD>G06F	G09C	G06F	G09C	H04L	G07F	H04L	H04L	G07F	H04L	</CLASSIFICATIONS-THIRD>
<CLASSIFICATIONS-FOURTH>G06F21	G09C1	G06F21	G09C1	H04L9	G07F7	H04L9	H04L9	G07F7	H04L9	</CLASSIFICATIONS-FOURTH>
<ABSTRACT>
A method for loading secret data, such as an application key, on a smart card (6), which involves storing a random key on the card (6), encrypting the random key on the basis of a public key, and providing the encrypted random key to a central processing station (4). The encrypted random key is decrypted at the central station on the basis of a secret key, and the station (4) encrypts data on the basis of the random key and transmits it to the smart card (6). The smart card decrypts the encrypted data on the basis of the random key. The random key can be generated internally and stored on read protected memory (23) of the card (6). The public key encrypting and secret key decrypting steps may be based on the RSA algorithm, using a small encryption exponent.
 
</ABSTRACT>
<APPLICANTS>
<APPLICANT-NAME>
TELSTRA CORP LTD
</APPLICANT-NAME>
<APPLICANT-NAME>
TELSTRA CORPORATION LIMITED
</APPLICANT-NAME>
</APPLICANTS>
<INVENTORS>
<INVENTOR-NAME>
ZUK EDWARD ANDREW
</INVENTOR-NAME>
<INVENTOR-NAME>
ZUK, EDWARD, ANDREW
</INVENTOR-NAME>
</INVENTORS>
<DESCRIPTION>
The present invention relates to a cryptographic method and system and, in
particular to a smart card and method of initialising a smart card.Cryptographic techniques are used to encrypt and decrypt sensitive
communications between two terminals. A particular problem exists in ensuring secure
communications between credit cards and a central processing station, or host, and the
problem becomes more acute with respect to smart cards which are intended to transmit
and receive sensitive data. Conventional encryption techniques require that the smart card
have a secret key before any sensitive data can be loaded onto the card. Present solutions
for smart cards are usually based around one of two techniques. The first involves
loading the card with secret information through a physically secure communications
channel, which unfortunately is not always practical. The second technique involves
relying on the card manufacturer to place an initial secret key on the card, and the card
owner then uses the secret key to load the sensitive data required for card applications.
Unfortunately, the card manufacturer then has at its disposal all of the information
necessary to decipher communications with the card and to recover any secret information
loaded on the card.European patent publication 138,386 describes a system for smart card
communication with a host where the encryption and decryption keys are generated
internally by the card and the host on the basis of a random number generated by the host
and a pre-assigned code number PN allocated to the card. The system, however, again
suffers from the disadvantage that the pre-assigned code number needs to be stored in
the card on manufacture or else it must be placed on the card in a physically secure
environment. If the pre-assigned code number PN cannot be transferred in a physically 
secure environment, then there is a risk it may become known to someone other than an
authorised user. The card could then be used in an unauthorised manner by simply
providing an appropriate random number to the card, once the PN and logic used to
generated the encryption key are known. It is therefore advantageous to provide a system
which could be used for smart cards, and which does not require any third party to be
provided with information from which an encryption key can be simply derived or a
secure environment within which a pre-assigned code number must be transferred.Most encryption techniques use a key which is generally a large number on which
the encryption and
</DESCRIPTION>
<CLAIMS>
A cryptographic communications method comprising:

storing a random key (r) on a smart card (6);
encrypting said random key on the basis of a public key (e, m) and providing the

encrypted random key to a central processing station (4);
decrypting said encrypted random key at said central station on the basis of a
secret key (d),
encrypting data (Ki) on the basis of said random key (r) and transmitting the encrypted
data from said central station (4) to said smart card (6); and
decrypting the encrypted data at said smart card (6) on the basis of said random key (r).
A communications method as claimed in claim 1, wherein said random key (r) is
stored in a memory area (18, 23) of said smart card which is not externally addressable.
A communications method as claimed in claim 2, wherein said data includes an
application key (Ki) for said card.
A communications method as claimed in claim 3, including generating said
random key (r) on said smart card.
A communications method as claimed in claim 4, including deleting at least one
said random key (r), said public key (e, m) and program code (C
2
) for encrypting on the basis of said
public key, after receiving said data.
A communications method as claimed in claim 5, including storing an
identification number (card serial number) on said smart card, transmitting said identification number to said

central station (4), and accessing said secret key (d) at said central station on the basis of said
identification number.
A communications method as claimed in claim 6, including generating said public (e, m)
and secret keys (d) at said station (4) and storing said secret key on the basis of said 

identification number (card serial number).
A communications method as claimed in claim 7, wherein said public (e, m) and secret (d)
keys are unique for said smart card (6).
A communications method as claimed in claim 7, wherein said public (e, m) and secret (d)
keys are unique for a batch of smart cards.
A communications method as claimed in claim 7, wherein the pubilc key
encrypting and secret key decrypting steps comprise an RSA based algorithm, using a

modulus (m) and a small encryption exponent (e).
A communications method as claimed in claim 10, wherein said exponent (e) is three.
A communications method as claimed in claim 10, including keeping said
modulus secret (m) and using said modulus as a basis for authenticating said smart card (6).
A communications method as claimed in claim 10, including using said encrypted
random key (r) as a basis for authenticating said smart card (6).
A communications method as claimed in claim 10, wherein said algorithm
comprises encrypting and decrypting a value Z using:


Z
b
 * (2
-R
)
(b-1)
 (mod m)

where b is the exponent and R is a constant.
A communications system comprising smart card means (6) and a central processing
station (4), said smart card (6) means including:


means (18, 23) for storing a random key (r) on a smart card,
means for encrypting (C
2
) said random key (r) on the basis of a public key (e, m), and
means (C
3
) for decrypting data encrypted on the basis of said random key (r), and
said central station (4) including: 
means (mont_power) for deerypting the encrypted random key on the basis of a secret
key (d), and
means for encrypting data on the basis of said random key (r) and
transmitting the encrypted data to said smart card (6).
A communications system as claimed in claim 15, wherein said storing means (18, 23) is
not externally addressable.
A communications system as claimed in claim 16, wherein said data includes an
application key (ki) for said card (6).
A communications system as claimed in claim 17, wherein said smart card means (6)
includes means (C
1
) for generating said random key (r) on said smart card (6).
A communications system as claimed in claim 18, wherein said smart card
includes program code (C
2
) for encrypting on the basis of said public key (e, m), and at least one of
said program code (C
2
), said public key (e, m) and said random key (r) are deleted after said smart card (6)
receives said data.
A communications system as claimed in claim 19, wherein said smart card (6)
includes a identification number (card serial number), and means for transmitting said identification number

to said central station (4), said central station including means for accessing said secret key (d)
on the basis of said identification number card serial number.
A communications system as claimed in claim 20, wherein said central stab n
includes means for generating said public (e, m) and secret keys (d) and storing said secret key (d) on

the basis of said identification number (card serial number).
A communications system as claimed in claim 21, wherein said public (e, m) and secret (d)
keys are unique for said smart card (6).
A communications system as claimed in claim 21, wherein said public (e, m) and secret (d) 
keys are unique for a batch of smart cards.
A communications system as claimed in claim 21, wherein said public key
encrypting means and said secret key decrypting means execute an RSA based algorithm,

using a modulus (m) and a small encryption exponent (e).
A communications system as claimed in claim 24, wherein said exponent (e) is three.
A communications system as claimed in claim 24, wherein said modulus (m) is kept
secret and used as a basis for authenticating said smart card (6).
A communications system as claimed in claim 24, wherein said encrypted random
key (r) is used as a basis for authenticating said smart card (6).
A communications system as claimed in claim 24, wherein said algorithm
comprises encrypting and decrypting a value Z using:


Z
b
 * (2
-R
)
(b-1)
 (mod m)

where b is the exponent and R is a constant.
A method of initialising a smart card (6) comprising:

generating a random key (r);
storing said random key in a memory area (18, 23) of said smart card which is not
externally addressable;
encrypting said random key (r) on the basis of a public key (e, m);
providing a central processing station (4) with the encrypted random key;
decrypting said encrypted random key at said central station on the basis of a
secret key (d),
encrypting secret data at said central station on the basis of said random key (r),
transmitting the encrypted secret data to said smart card (6); and
decrypting said encrypted secret data at said smart card on the basis of said
random key (r).
A method as claimed in claim 29, wherein said secret data includes an application
key (Ki) for said smart card.
A method as claimed in claim 30, wherein said random key (r) is generated on said
card (6).
A method as claimed in claim 30, including deleting (C
3
) at least one of said random
key (r), said public key (e, m) and program code (C
2
) for encrypting on the basis of said public key
from said smart card after receiving said secret data.
A method as claimed in claim 30, including generating said public (e, m) and secret keys (d)
for said smart card at said central station (4).
A method as claimed in claim 30, wherein said public key encrypting and secret
key decrypting steps comprise a Montgomery modulo reduced RSA based algorithm,

using a modulus (m) and a small encryption exponent (e).
A smart card (6) comprising:

read protected memory (18, 23) for storing a random key (r) and a public key (e, m),
means for encrypting said random key on the basis of said public key (e, m); and
means for decrypting encrypted data on the basis of said random key (r).
A smart card as claimed in claim 35, wherein said data includes an application
key (Ki).
A smart card as claimed in claim 35, including means (C
1
) for generating said random
key (r).
A smart card as claimed in claim 35, including means (C
3
) for deleting at least one of
said keys and program code (C
2
) for encrypting on the basis of said public key after receiving
said data. 
A smart card as claimed in claim 35, wherein said means for encrypting executes
a public key component of a Montgomery modulo reduced RSA based algorithm, using

a modulus (m) and a small encryption exponent (e).
</CLAIMS>
</TEXT>
</DOC>
