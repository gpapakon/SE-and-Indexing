<DOC>
<DOCNO>EP-0621569</DOCNO> 
<TEXT>
<INVENTION-TITLE>
Device for and method of protecting the keys of a chip card
</INVENTION-TITLE>
<CLASSIFICATIONS>G06F1214	G06F2100	G06K1700	G07F710	G06K1700	G06K19073	G07F710	G06F2124	G06K19073	G06F1214	</CLASSIFICATIONS>
<CLASSIFICATIONS-THIRD>G06F	G06F	G06K	G07F	G06K	G06K	G07F	G06F	G06K	G06F	</CLASSIFICATIONS-THIRD>
<CLASSIFICATIONS-FOURTH>G06F12	G06F21	G06K17	G07F7	G06K17	G06K19	G07F7	G06F21	G06K19	G06F12	</CLASSIFICATIONS-FOURTH>
<ABSTRACT>
The present invention relates to a device for protecting keys of a chip card, characterized in that:     - each key is enciphered with the aid of a diversified key; - a protection entity, corresponding to an entity dependent on each enciphered key, is generated and associated with each enciphered key;   - a means of detection installed in the card allows the integrity of the key to be verified, by comparing the protection entity with a verification entity generated from the key of the card, by the means of detection of the card; - a means of blocking allows the blocking of any subsequent calculation on the key in the case where the verification entity is not identical to the protection entity.   
<
IMAGE
>
</ABSTRACT>
<APPLICANTS>
<APPLICANT-NAME>
BULL CP8
</APPLICANT-NAME>
<APPLICANT-NAME>
BULL CP8
</APPLICANT-NAME>
</APPLICANTS>
<INVENTORS>
<INVENTOR-NAME>
HAZARD MICHEL
</INVENTOR-NAME>
<INVENTOR-NAME>
HAZARD, MICHEL
</INVENTOR-NAME>
</INVENTORS>
<CLAIMS>
Device for protecting a user key (CU) of a smart card,
installed in the smart card and characterised in that it

comprises:

information processing means (1) arranged so as to
calculate an encrypted form (CCCi) of the user key (CU) from

a diversified key (CSPDi) and an algorithm (ASCC) for
encrypting/decrypting a user key;
storage means (3) for storing the encrypted user
key (CCCi) and, in association therewith, a piece of

protection information (SCip; CCRip; Sip; CBVip) comprising
information dependent on that key;
detection means (OS) allowing the card to verify
the integrity of the encrypted key (CCCi) by causing the

information processing means (1) to calculate a piece of
verification information (SCiv; CCRiv; Siv; CBViv) on the

basis of the encrypted user key (CCCi) and a verification
algorithm (ACASC), then by comparing this verification

information with said protection information; and
blocking means (1, OS) allowing the card to block any
further calculation using the encrypted user key (CCCi), in

the event that the verification information is not identical
to the protection information.
Device according to Claim 1, in which the protection
information is located in a secret memory zone (ZS) of the

storage means (3) of the card.
Device according to Claim 1, in which the detection
means comprise means for correcting the user key.
Device according to Claim 1, in which the protection
information comprises a check total or checksum (SCip).
Device according to Claim 1, in which the protection
information comprises a cyclic redundancy check (CRC). 
Device according to Claim 1, in which the protection
information comprises a number of bits (CBVip) of the

encrypted user key.
Device according to Claim 1, in which the protection
information comprises a signature (Sip) calculated by using

a secret key (CS).
Device according to Claim 1, in which the detection
means comprise an algorithm (ACASC) executed by the

microprocessor (1) of the card.
Device according to Claim 1, in which:

decryption means are arranged so as to decrypt the
encrypted user key (CCCi) into a decrypted user key by using

said algorithm (ASCC) for encrypting/decrypting the user
key, if the verification information is identical to the

protection information, said algorithm using said
diversified key (CSPDi);
the information processing means (1) are arranged
so as to store the decrypted user key in the storage means

(3) so that it is available for calculation.
Device according to Claim 1, for protecting a user key
(CU) during its loading on the card, characterised in that:


it comprises an algorithm (ACU) for
encrypting/decrypting the loading of a user key;
it is arranged so as to encrypt the key with a
view to loading it, and to decrypt it after loading on a

card with a view to encrypting it by means of the algorithm
(ASCC) for encrypting/decrypting the user key.
Device according to Claim 10, in which the algorithm
(ASCC) for encrypting/decrypting the user key is different

from the algorithm (ACU) for encrypting/decrypting the
loading of a user key and is stored in a secret memory zone 

of the card.
Method for storing an encrypted user key in a smart
card, characterised in that it comprises the steps

consisting in:

receiving a user key (CU);
through information processing means (1) of the
card, encrypting this user key into an encrypted user key

(CCCi) by using a diversified key (CSPDi) and an algorithm
(ASCC) for encrypting/decrypting a user key;
through the information processing means (1),
calculating a piece of protection information (SCip; CCRip;

Sip;, CBVip) by using the encrypted user key (CCCi) and a
verification algorithm (ACASC);
storing the encrypted user key (CCCi) in
association with the protection in a memory zo
ne of the
card.
Method according to Claim 12 in which the user key (CU)
is sent to the card in an encrypted form (CCU) by an

algorithm (ACU) for encrypting/decrypting the loading of a
user key, this method comprising the steps consisting in:


through the information processing means (1) of
the card, decrypting the encrypted user key (CCU) into a

decrypted user key (CU) by using the algorithm (ACU) for
encrypting/decrypting the loading of a user key; and
encrypting the decrypted user key (CU) into said
encrypted user key (CCCi) by means of the algorithm (ASCC)

for encrypting/decrypting a user key.
Method for using a user key stored on a smart card in
encrypted form (CCCi) by means of a diversified key (CSPDi)

and an algorithm (ASCC) for encrypting/decrypting a user
key, in association with a piece of protection information

(SCip; CCRip; Sip;, CBVip) calculated by means of the
encrypted user key (CCCi) and a verification algorithm

(ACASC), characterised in that it comprises the steps 
consisting in:


through the information processing means (1) of
the card, and before making a calculation using the user

key, calculating a piece of verification information (SCiv;
CCRiv; Siv; CBViv) by using the verification algorithm

(ACASC) and the encrypted user key (CCCi);
comparing the verification information with the
protection information, in order to verify the integrity of

the encrypted user key (CCCi);
blocking the use of the encrypted user key (CCCi)
if the verification information is not identical to the

protection information;
if the verification information is identical to
the protection information, decrypting the encrypted user

key (CCCi), by means of the algorithm (ASCC) for
encrypting/decrypting a user key; and
storing the decrypted user key (CU) either in a
protected zone of a random access memory (4) of the card or,

for the duration of a session, in a protected zone of a nonvolatile
memory (3) of the card.
</CLAIMS>
</TEXT>
</DOC>
