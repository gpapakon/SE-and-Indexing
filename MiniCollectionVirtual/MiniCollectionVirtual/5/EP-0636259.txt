<DOC>
<DOCNO>EP-0636259</DOCNO> 
<TEXT>
<INVENTION-TITLE>
CRYPTOGRAPHIC DATA SECURITY IN A SECURED COMPUTER SYSTEM
</INVENTION-TITLE>
<CLASSIFICATIONS>H04K100	G06F2100	G06F1300	G06F1214	G06F100	G06F2120	G06F1300	G06F100	G09C100	H04K100	G09C100	H04L932	G06F1214	H04L932	G06F2120	G06F2100	</CLASSIFICATIONS>
<CLASSIFICATIONS-THIRD>H04K	G06F	G06F	G06F	G06F	G06F	G06F	G06F	G09C	H04K	G09C	H04L	G06F	H04L	G06F	G06F	</CLASSIFICATIONS-THIRD>
<CLASSIFICATIONS-FOURTH>H04K1	G06F21	G06F13	G06F12	G06F1	G06F21	G06F13	G06F1	G09C1	H04K1	G09C1	H04L9	G06F12	H04L9	G06F21	G06F21	</CLASSIFICATIONS-FOURTH>
<APPLICANTS>
<APPLICANT-NAME>
SECURE COMPUTING CORP
</APPLICANT-NAME>
<APPLICANT-NAME>
SECURE COMPUTING CORPORATION
</APPLICANT-NAME>
</APPLICANTS>
<INVENTORS>
<INVENTOR-NAME>
BOEBERT WILLIAM E
</INVENTOR-NAME>
<INVENTOR-NAME>
MARKHAM THOMAS R
</INVENTOR-NAME>
<INVENTOR-NAME>
OLMSTED ROBERT A
</INVENTOR-NAME>
<INVENTOR-NAME>
BOEBERT, WILLIAM, E.
</INVENTOR-NAME>
<INVENTOR-NAME>
MARKHAM, THOMAS, R.
</INVENTOR-NAME>
<INVENTOR-NAME>
OLMSTED, ROBERT, A.
</INVENTOR-NAME>
</INVENTORS>
<DESCRIPTION>
This invention relates generally to data 
communication systems, and more specifically to secure 
data processing on a data communication system. Individuals working in a departmental computing 
environment typically have a substantial amount of 
computing power on their desks in the form of personal 
computers and workstations. A workstation has a 
computational subsystem, keyboard, and display for user 
interaction, and typically substantial amounts of local 
data storage in the form of fixed and removable media. In order for the individual in the departmental 
computing environment to interact and share data, their 
workstations are typically attached to a local area 
network (LAN) which permits the transfer of data files 
and electronic mail between the workstations. In 
addition, "servers" may be attached to the LAN to 
provide specialized services, such as the management of 
centralized databases, which are not practical for 
individual workstations. Departmental computing environments are 
typically members of a larger organization or have other 
reasons to communicate with computing facilities outside 
themselves. They therefore make use of a special kind 
of server, called a "gateway", to gain access to a wide 
area network (WAN). WANs are often interconnected 
(called "internetting") to provide world-wide data 
transmission paths. A typical overall departmental computing 
environment is shown in Figure 1. In the departmental 
computer environment 1, large amounts of valuable data 
is stored on magnetic or other electronic Media 2, 4 for 
processing in the Workstations 10 and file servers (not 
shown). This media offers the benefits of compact  
 
storage, easy retrieval, and in the case of removable 
Media 4 (e.g., "diskettes"), convenient sharing and 
distribution. In addition, data is transmitted freely around 
the Local Area Network 12 and occasionally through a 
Gateway 14 to the Wide Area Network 16 and Remote Sites 
18. This transmission is necessary in order for the 
organization performing departmental computing to 
perform its internal work and interact with the outside 
world. There is also a requirement that certain 
operations, including but not limited to the 
transmission of data to the outside world, be restricted 
to individuals who possess special privileges. Examples 
of such operations are messages (electronic mail) which 
are directive in nature, such as users to transfer 
funds, and operations such as the adding of new orders 
or the granting of limited access to
</DESCRIPTION>
<CLAIMS>
A data enclave (20) for securing data carried on physical units of fixed (2) 
and removable (4) media, the data enclave (20) including a security server (24) 

connected over a network (42) to one or more workstations (10), wherein each 
workstation (10) includes a crypto media controller (26) used to read one of said 

physical units of media (2,4), the data enclave further comprising: 

an enclave key (40) used to encrypt data transmitted within the data 
enclave (20), wherein a copy of the enclave key (40) is stored in the security 

server (24) and the workstations (10); 
a personal keying device (30) for each user in the data enclave (20); 
a personal identification number (PIN) (50) and a user unique identifier 
(user UID) (48) assigned to each user in the enclave (20), wherein each user UID 

(48) is encrypted with the enclave key and stored in the personal keying device 
(30) of the user associated with the user UID; 
a set of user attributes (56) provided for each user, wherein each set of 
user attributes (56) represents user privileges and other security related 

information pertaining to a particular user and wherein each set of user attributes 
(56) is associated with the user UID (48) of its respective user; 
a media key (42) for each physical unit of media (2,4), wherein the media 
key (42) is used to encrypt and protect data carried on the media; 
a media unique identifier (media UID) (46) for each physical unit of 
media (2,4); and 
a set of media attributes (54) provided for each physical unit of media 
(2,4), wherein each set of media attributes (54) represents sensitivity or other 

security related information pertaining to data carried on a particular unit of 
media and wherein each set of media attributes (54) is associated with the media 

UID (46) of its respective physical unit of media (2,4); characterised in that
 
   the security server (24) comprises:  

 

security policy logic (86) for computing, from the set of user attributes 
assigned to a particular user (5) and the set of media attributes assigned to a 

particular unit of media (2,4), an access vector (52) which defines limits on 
access by the particular user (5) to the particular unit of media (2,4); and 
a key management crypto (70) for combining the access vector (52) and 
the media key (42) assigned to the particular unit of media (2,4) to form a media 

key/access vector pair (91) and for enciphering the media key/access vector pair 
(91) with a combined key formed from the enclave key (40) and the user UID 

(48) and PIN (50) of the particular user (5); 
wherein the personal keying device (30) comprises means (78) for storing 
the enciphered media key/access vector pair (91); and 
wherein the crypto media controller (26) comprises means (70, 72, 76) for 
controlling access to data on the particular unit of media (2,4) as a function of 

the PIN (50) of the particular user (5), the media UID (46) of the particular 
physical unit of media (2,4) and the media key/access vector pair (91) retrieved 

from the personal keying device (30) of the particular user (5). 
A data enclave method for securing data carried on physical units of fixed 
(2) and removable (4) media in a data enclave (20) including a security server 

(24) connected over a network (12) to one or more workstations (10), wherein 
each workstation (10) includes a crypto media controller (26) used to read one of 

said physical units of media (2,4), the method comprising the steps of: 

providing an enclave key (40) used to encrypt data transmitted within the 
data enclave (20); 
storing a copy of the enclave key (40) in the security server (24) and the 
workstations (10); 
providing a personal keying device (30) for each user in the data enclave 
(20); 
assigning a personal identification number (PIN) (50) and a user unique 
identifier (user UID) (48) to each user in the enclave (20);  

 
assigning a set of user attributes (56) for each user, wherein each set of 
user attributes (56) represents user privileges and other security related 

information pertaining to a particular user; 
associating each set of user attributes (56) with the user UID (48) of its 
respective user; 
encrypting each user UID (48) with the enclave key and storing each 

encrypted user UID (48') in the personal keying device (30) of the user associated 
with the user UID (48); 
assigning a media key (42) and a media unique identifier (media UID) 
(46) for each physical unit of media (2,4), wherein the media key (42) is used to 

encrypt and protect data carried on the media; 
assigning a set of media attributes (54) for each physical unit of media 
(2,4), wherein each set of media attributes (54) represents sensitivity or other 

security related information pertaining to data carried on a particular unit of 
media; and 
associating each set of media attributes (54) with the media UID (46) of 
its respective physical unit of media (2,4); and characterised by 
computing, from the set of user attributes assigned to a particular user (5) 
and the set of media attributes assigned to a particular unit of media (2,4), an 

access vector (52) which defines limits on access by the particular user (5) to the 
particular unit of media (2,4); 
combining the access vector (52) and the media key (42) assigned to the 
particular unit of media (2,4) to form a media key/access vector pair (91); 
enciphering the media key/access vector pair (91) with a combined key 
formed from the enclave key (40) and the user UID (48) and PIN (50) of the 

particular user (5); and 
storing the enciphered media key/access vector pair (91) in the personal 
keying device (30) of the particular user (5); and 
controlling access to data on the particular unit of media (2,4) as a 
function of the PIN (50) of the particular user (5), the media UID (46) of the  

 
particular physical unit of media (2,4) and the media key/access vector pair (91) 

retrieved from the personal keying device (30) of the particular user (5). 
A method according to claim 2 wherein the method further comprises the 
step of providing device attributes for each workstation (10), the device attributes 

representing security attributes of the workstations (10), and wherein the step of 
controlling access comprises the steps of: 


determining the workstation (10) being used by the particular user (5); 
retrieving the device attributes (58) associated with the workstation (10) 
being used by the particular user (5); 
extracting the access vector (52) from the encrypted media key/access 
vector pair (91) retrieved from the personal keying device (30) of the particular 

user (5); and 
combining the retrieved device attributes (58) with the extracted access 
vector (52) to determine access rights by the particular user (5) on the particular 

workstation (10). 
A method according to claim 2 wherein the method further comprises the 
steps of: 


(a) providing key management crypto logic in each crypto media 
controller for (i) receiving a requesting user's PIN from a personal keying device 

(ii) receiving an encrypted user UID from the personal keying device and 
decrypting the user UID using the enclave key, and (iii) forming a first packet 

including the requesting user's PIN, the user UID and a request for initialization 
of a new unit of media, the request including the media attributes for the new 

unit of media; 
(b) providing key management crypto logic in the server for 
decrypting the first packet using the enclave key stored in the server, 
(c) providing storage search logic in the server for (i) reading a user 
attribute data base stored in the server using the user UID as an index, (ii)  

 
returning a pass value if the requesting user's PIN received in the first packet 

matches a valid PIN stored in the user attribute data base, (iii) aborting the 
request for initialization if the requesting user's PIN is not valid, (iv) extracting 

the media attributes from the request and commanding a media attribute data base 
stored in the server to make an entry for the new unit of media, and to create a 

new media UID for the new unit of media, and (v) indexing the user attribute 
data base with the user UID to extract the set of security attributes pertaining to 

the requesting user and passing the security attributes to security policy logic in 
the server; 
(d) the security policy logic accepting the media attributes and the 
requesting user's security attributes and, using a set of rules and/or under the 

direction of a system administrator, computing a new access vector which defines 
limits on the access the requesting user will have to the new unit of media; 
(e) the key management crypto in the server also (i) generating, with 
the optional aid of a system administrator, a new media key for the new unit of 

media, and (ii) enciphering the new media key/access vector pair formed with the 
new media key and the new access vector with a combined key including the 

user UID, the user PIN and the enclave key, to form a second packet; 
(f) the storage search logic also storing the enciphered second packet 
in a crypto key data base stored in the server, the second packet indexed 

according to the requesting user's user UID and the new media UID; 
(g) providing further logic for sending the new media UID and the 
second packet to the Workstation from which the first packet was received; and 
(h) providing storage search logic in the crypto media controller for (i) 
receiving the new media UID and writing it to an appropriate location on the new 

unit of media and (ii) storing the second packet containing the new media key/ 
access vector pair in the personal keying device attached to the Workstation using 

the new media UID as an index 
A method according to claim 2 further comprising the steps of:  
 


(a) providing key management crypto logic in each crypto media 
controller for (i) receiving a requesting user's PIN from a personal keying device, 

(ii) receiving an encrypted user UID from the personal keying device and 
decrypting the user UID using the enclave key, and (iii) reading the media UID 

off an initialized unit of media and searching the personal keying device for a 
media key/access vector pair for the initialized unit of media for the requesting 

user using the user's PIN as an index, and (iv) if no pair is found generating a 
request for a key assignment; 
(b) the key management crypto logic in the workstations further (i) 
forming the first packet including the requesting user's PIN and user UID, the 

media UID for the initialized unit of media, and the request for key assignment, 
(ii) encrypting the first packet with the enclave key, and (iii) sending the packet 

to the security server over the network; 
(c) providing key management crypto logic in the server for 
decrypting the first packet using the enclave key stored in the server to obtain the 

requesting user's PIN and user UID, and the media UID and the request; 
(d) providing storage search logic in the security server for (i) reading 
a user attribute data base stored in the server using the user UID as an index, (ii) 

returning a pass value if the requesting user's PIN received in the first packet 
matches a valid PIN stored in the user attribute data base, (iii) aborting the 

request for initialization set forth in the first packet if the requesting user's PIN is 
not valid, (iv) reading the user attribute data base using the user's PIN as an 

index and extracting the security attributes of the requesting user, and (v) passing 
the security attributes to security policy logic in the server; 
(e) the security policy logic receiving the security attributes and 
computing a new access vector which defines limits on the access the user may 

have to the initialized unit of media, the new access vector computed using a set 
of rules and/or with the intervention of a system administrator; 
(f) the storage search logic also (i) finding an enciphered key packet 
in a crypto key data base held in the security server which has been previously  

 
stored and which contains the media key for the initialized unit of media, (ii) 

when a packet is found extracting the media key from it, and (iii) forming a new 
media key/access vector pair with the extracted media key and the new access 

vector, and a new key packet including the new media key/access vector pair, the 
user UID, and the media UID, and placing the new key packet in the crypto key 

data base for archival purposes; 
(g) the crypto key logic also enciphering the new media key/access 
vector pair with a combined key including the user UID, the user's PIN, and the 

enclave key, and transmitting the enciphered packet along the network to the 
crypto media controller; and 
(h) the crypto media controller using the media UID as an index to 
store the new media key/access vector pair in the personal keying device from 

which the user's PIN was entered whereby the personal keying device contains a 
media key which can only be used by someone who has physical possession of 

that personal keying device, knows the user PIN associated with the media key, 
and has physical possession of the unit of media controlled by a crypto media 

controller containing the enclave key, the access of the user further being 
restricted by the access vector paired with the media key. 
A method according to claim 2, further comprising the steps of: 

(a) the crypto media controller also (i) receiving a user PIN from a 
personal keying device from a user seeking access to an initialized unit of media 

under control of the crypto media controller; 
(b) providing storage search logic in the crypto media controller for (i) 
reading the initialized unit of media and extracting the media UID, (ii) searching 

the storage in the personal keying device and extracting the enciphered media 
key/access vector pair for the media UID and passing it to a key management 

crypto in the crypto media controller; 
(c) the key management crypto (i) fetching the user UID from the 
personal keying device and deciphering it using the enclave key, (ii) combining  

 
the user UID, the user PIN, and the enclave key to form a combined key to 

decrypt the media key/access vector pair, and passing the extracted media key to 
a data crypto and the access vector to the access control logic; 
(d) the data crypto deciphering data on a unit of media using the 
media key and passing it to the access control logic, the data deciphered in 

response to a read or write request for the data by the Workstation; 
(e) the access control logic controlling whether the desired mode of 
access is permitted based on the access vector and the device attributes contained 

within the crypto media controller, and aborting the attempted access to the data 
if the access is not permitted and otherwise permitting the access whereby data is 

transferred to a Workstation for procession; and 
(f) providing logic in the crypto media controller for causing a 
complete reset of the crypto media controller and requiring the keying process to 

be started from the beginning in the event that the personal keying device is 
uncoupled or the unit of media is removed from the Workstation. 
</CLAIMS>
</TEXT>
</DOC>
