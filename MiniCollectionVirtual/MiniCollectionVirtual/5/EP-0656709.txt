<DOC>
<DOCNO>EP-0656709</DOCNO> 
<TEXT>
<INVENTION-TITLE>
Encryption device and apparatus for encryption/decryption based on the Montgomery method using efficient modular multiplication
</INVENTION-TITLE>
<CLASSIFICATIONS>G06F772	H04L928	H04L930	G06F760	</CLASSIFICATIONS>
<CLASSIFICATIONS-THIRD>G06F	H04L	H04L	G06F	</CLASSIFICATIONS-THIRD>
<CLASSIFICATIONS-FOURTH>G06F7	H04L9	H04L9	G06F7	</CLASSIFICATIONS-FOURTH>
<APPLICANTS>
<APPLICANT-NAME>
CANON KK
</APPLICANT-NAME>
<APPLICANT-NAME>
CANON KABUSHIKI KAISHA
</APPLICANT-NAME>
</APPLICANTS>
<INVENTORS>
<INVENTOR-NAME>
IWAMURA KEIICHI
</INVENTOR-NAME>
<INVENTOR-NAME>
YAMAMOTO TAKAHISA
</INVENTOR-NAME>
<INVENTOR-NAME>
IWAMURA, KEIICHI
</INVENTOR-NAME>
<INVENTOR-NAME>
YAMAMOTO, TAKAHISA
</INVENTOR-NAME>
</INVENTORS>
<DESCRIPTION>
This invention relates to an encryption device for
performing encoded communication in home banking, farm
banking and electronic mail in a computer network and in
various communication services such as electronic
conferencing. Furthermore, the invention relates to an
encryption device for performing encrypted communication
using an encryption method that employs modular
multiplication (quadratic residual ciphers, RSA ciphers,
ElGamal ciphers, etc.), a key distribution method (DH-type
key distribution method, ID-based key distribution
method, etc.), a zero-knowledge authentication system,
etc.Further, the invention relates to a communication
method and apparatus which employ random-number
generation necessary in encrypted communication,
particularly data concealment, originator/terminator
authentication, distribution of encryption key and a
zero-knowledge authentication protocol, etc. The
invention relates also to a method and apparatus for
random-number generation as necessary in a Monte Carlo
simulation, by way of example.The importance of cryptographic techniques to 
protect the content of data has grown with the rapid
advances that have recently been made in information
communication systems using computer networks. In
particular, high-speed encryption is becoming essential
as computer networks are being developed for higher
speed and larger volume.Among the foregoing, modular multiplication is a
particularly important operation used in various
cryptographic techniques. Various methods of encryption
using modular multiplication will now be described.Two methods of encryption which are well known are
secret-key cryptosystem and public-key cryptosystem.In public-key cryptosystem, the encryption and
decryption keys differ. The encryption key is known
publicly but the decryption key is held in secrecy by
the receiving party and it is difficult to infer the
decryption key from the publicly disclosed encryption
key. Ciphers based upon modular multiplication, such as
RSA ciphers and ElGamal ciphers, are used widely in
public-key cryptosystem. Attention is being given to
the fact that these ciphers have an application called
authentication in addition to a secret communication
function. Authentication, which is a function for
investigating whether a party transmitting communication
text is correct or not, is also referred to as digital
signature. In digital signature which uses these 
ciphers, secret signatures known only to the
transmitting party are possible and cannot be forged.
Accordingly, digital
</DESCRIPTION>
<CLAIMS>
A communication apparatus for performing at least
one of the functions of encrypting or decrypting

communication data by processing the communication data
on the basis of a pseudorandom-number sequence,

comprising:

generating means (190) for generating a sequence of
numbers y
i
, i = 1,2,..., from a prescribed initial value
y
0
; and
extracting means (191) for extracting a prescribed
portion from each number of the sequence of numbers to

serve as the pseudorandom-number sequence, 
characterised
in that
:

said generating means is arranged to generate the
sequence of numbers by the recurrence formula:


y
i+1
 = R
-(e-1)
·y
i
e
 mod N

the recurrence formula being obtained by the following
recursive operation:


y
i+1
 = {y
i+1
2
 + (y
i+1
2
·(-N
-1
 mod R)mod R)·N}/R

on the basis of the initial value y
0
, a prescribed odd
number N, an arbitrary integer e which is larger than or

equal to 2, and a prescribed number R which is a power
of 2.
The apparatus according to claim 1, arranged to
select 2
t
 for an integer t as the integer R and to
perform a division by R in said recursive operation by

a t-bit shift.
The apparatus according to claim 1, wherein e=2 and
y
i+1
 is obtained as follows:

y
i+1
 = {y
i
2
 + (y
i
2
·(-N
-1
 mod R)mod R)·N}/R.
A communication method for performing at least one
of the functions of encrypting or decrypting

communication data by processing the communication data
on the basis of a pseudorandom-number sequence,

comprising the steps of:

generating a sequence of numbers y
i
, i = 1,2,...,
from a prescribed initial value y
0
; and
extracting a prescribed portion from each number of
the sequence of numbers to serve as the pseudorandom-number

sequence,

   
characterised in that
:

said generating step is arranged to generate the
sequence of numbers by the recurrence formula:


y
i+1
 = R
-(e-1)
·y
i
e
 mod N

the recurrence formula being obtained by the following
recursive operation: 


y
i+1
 = {y
i+1
2
 + (y
i+1
2
·(-N
-1
 mod R)mod R)·N}/R

on the basis of the initial value y
0
, a prescribed odd
number N, an arbitrary integer e which is larger than or

equal to 2, and a prescribed number R which is a power
of 2.
The method according to claim 4, wherein 2
t
 for an
integer t is selected as the integer R and a division by

R in said recursive operation is performed by a t-bit
shift.
The method according to claim 4, wherein e=2 and y
i+1

is obtained as follows:

y
i+1
 = {y
i
2
 + (y
i
2
·(-N
-1
 mod R)mod R)·N}/R.
A computer program product comprising machine readable
instructions for performing all the steps of a method according to any one

of claims 4 to 6, when executed on a computer.
</CLAIMS>
</TEXT>
</DOC>
