<DOC>
<DOCNO>EP-0650289</DOCNO> 
<TEXT>
<INVENTION-TITLE>
Method and apparatus for generating a halftone pattern for a multi-level output device.
</INVENTION-TITLE>
<CLASSIFICATIONS>G06T500	G06T500	G09G502	G09G502	H04N140	H04N140	H04N1405	H04N1405	</CLASSIFICATIONS>
<CLASSIFICATIONS-THIRD>G06T	G06T	G09G	G09G	H04N	H04N	H04N	H04N	</CLASSIFICATIONS-THIRD>
<CLASSIFICATIONS-FOURTH>G06T5	G06T5	G09G5	G09G5	H04N1	H04N1	H04N1	H04N1	</CLASSIFICATIONS-FOURTH>
<ABSTRACT>
Method and apparatus for generating a halftone 
image for a multi-level output device employing a dither 

matrix (18) generated by minimizing a visual cost function. The 
dither matrix is addressed by the least significant bits of 

a pixel address and the value supplied by the dither matrix 
is added (12) to the pixel value. The resulting sum is quantized 

in a quantizer (20) to produce the multi-level halftone value. 
 
The added dither may also be multiplied (24,26) dependent on the 
input pixel value. The cost function is minimized by stochastic 

annealing or by a genetic algorithm. 

</ABSTRACT>
<APPLICANTS>
<APPLICANT-NAME>
EASTMAN KODAK CO
</APPLICANT-NAME>
<APPLICANT-NAME>
EASTMAN KODAK COMPANY
</APPLICANT-NAME>
</APPLICANTS>
<INVENTORS>
<INVENTOR-NAME>
RAY LAWRENCE A C O EASTMAN KOD
</INVENTOR-NAME>
<INVENTOR-NAME>
SPAULDING KEVIN EDWARD C O EAS
</INVENTOR-NAME>
<INVENTOR-NAME>
RAY, LAWRENCE A., C/O EASTMAN KODAK CO.
</INVENTOR-NAME>
<INVENTOR-NAME>
SPAULDING, KEVIN EDWARD, C/O EASTMAN KODAK CO.
</INVENTOR-NAME>
</INVENTORS>
<DESCRIPTION>
The present invention relates to the field of 
digital image processing and more particularly to a method 
for halftoning digital images for a multi-level output 
device. Halftoning is a technique which is commonly used 
in digital imaging to create the appearance of intermediate 
tones or color values when only a limited number of specific 
tones or color values are available (e.g. two tones for a 
binary black and white output device or several tones in 
each of several colors for a multi-level color output device 
such as a color thermal printer or color CRT). Halftoning 
methods rely on the fact that an observer's eye will 
spatially average over some local area of the image so that 
intermediate tone levels and/or color values can be created 
by turning some of the pixels "on" and some of the pixels 
"off" in some small region. The fraction of the pixels 
which are turned on (and the level that they are turned on 
in a multi-level output device) will determine the apparent 
gray level in the small region. Examples of common 
halftoning techniques include dithering and error-diffusion. As noted by Gentile et al in the article entitled 
"Quantization and multilevel halftoning of color images for 
near-original image quality"; Vol. 7, No. 6/June 1990/J. 
Opt. Soc. Am. A page 1021, the process of dithering may be 
implemented by adding a dither signal to each color 
component of a digital image signal before quantization. 
The dither signal is spatially periodic and uniformly 
distributed over the range +Δ/2 to -Δ/2, where Δ is the 
spacing between output levels in the quantizer. Gentile et.  
 
al. employed a 4x4 pattern which was shown by Bayer to be 
optimal for a specified criteria. Experience has shown that 
the Bayer pattern produces noticeable artifacts in halftoned 
images. In U.S. patent 5,111,310 issued May 5, 1992 to 
Parker et al. multilevel halftoning is expressed 
mathematically as follows: 
where:
 
   f(i,j) is the continuous tone input image;
 
   m(i,j) is the matrix of threshold values;
 
   hk(i,j) is the kth level of the output image;
 
   "int" denotes integer truncation; and
 
   the gray levels of m(i,j) and f(i,j) vary between 
0 and 1 (here the range of the continuous tone image has 
been normalized to one). Parker et al obtain a matrix of threshold values 
by using an iterative Fourier Transform Technique where a 
blue noise mask is applied to the Fourier Transform of the 
halftone dot profile upon each iteration. The dither matrix 
generated by Parker et al. contains 128x128
</DESCRIPTION>
<CLAIMS>
A method of halftoning a digital image having 
an x,y array of No level pixel values for an Nq output 

device, where No
>
Nq
>
1, comprising the steps of: 

a. providing a matrix of dither values generated 
by minimizing a visual cost function; 
b. modularly addressing said dither matrix with 
the location of a pixel in said digital image to obtain an 

addressed dither value; 
c. adding the addressed dither value to the value 
of said pixel to obtain a sum; and 
d. quantizing said sum to Nq levels to produce a 
multi-level halftone image. 
The method claimed in claim 1, wherein said 
visual cost function is a combination of costs for a 

plurality of threshold values and wherein the cost for a 
single threshold value is defined as: 

 
where, 

   Ct is the cost for a single threshold value; 
   Mx and My are the dimensions of the dither matrix; 

   Rt,ij is the (i,j)th element of the discrete 
Fourier transform of the halftone pattern formed by 

thresholding the dither matrix at t; and 
is the square of the of the value of the visual 

modulation transfer function for the frequency corresponding 
to element (ij). 

   t is an individual threshold value; and 
   P is a constant. 
The method claimed in claim 1, wherein said 
visual cost function is minimized by stochastic annealing. 
The method claimed in claim 1, wherein said 
visual cost function is minimized by a genetic algorithm. 
The method claimed in claim 1, wherein said 
digital image is a color digital image having a plurality of 

color channels, and wherein a separate dither matrix is 
applied to each color channel. 
The method claimed in claim 1, further 
comprising the step of multiplying the addressed dither 

value by a scale factor that is a function of the input 
pixel value before adding the addressed dither value to the 

input pixel value, to thereby provide a non-linear mapping 
between input n-bit pixel values and output halftone values. 
Apparatus for halftoning a digital image 
having an x,y array of No level pixels for a Nq level output 

device, where No
>
Nq
>
1, comprising: 

a. a memory containing a matrix of dither values 
generated by minimizing a visual cost function; 
b. means for modularly addressing said memory to 
produce a dither value; 
c. an adder for receiving an input pixel value and 
said dither value and producing a sum of said input pixel 

value and said dither value; and 
d. a quantizer having Nq levels for receiving said 
sum and producing an Nq level halftoned digital image. 
The apparatus claimed in claim 7, wherein 
said visual cost function is a combination of costs for a 

plurality of threshold values and wherein the cost for a 
single threshold value is defined as follows: 

 
where,

 
   Ct is the cost for a single threshold value; 

   Mx and My are the dimensions of the dither matrix; 
   Rt,ij is the (i,j)th element of the discrete 

Fourier transform of the halftone pattern formed by 
thresholding the dither matrix at t; and 

is the square of the of the value of the visual 
modulation transfer function for the frequency corresponding 

to element (ij). 
   t is an individual threshold value; and 

   P is a constant. 
The apparatus claimed in claim 7, wherein 
said visual cost function is minimized by stochastic 

annealing. 
The apparatus claimed in claim 7, wherein said 
visual cost function is minimized by a genetic algorithm. 
The apparatus claimed in claim 7, wherein 
said digital image is a color digital image having a 

plurality of color channels, and wherein said apparatus 
comprises a separate memory, addressing means, adder and 

quantizer for each channel. 
The apparatus claimed in claim 7, further 
comprising means for multiplying the dither value by a 

function of the input pixel value prior to the adder, 
whereby a non-linear mapping is provided between the input 

pixel values and the output halftone values. 
</CLAIMS>
</TEXT>
</DOC>
