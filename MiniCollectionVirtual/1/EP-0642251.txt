<DOC>
<DOCNO>EP-0642251</DOCNO> 
<TEXT>
<INVENTION-TITLE>
Method for the automatic switching of the speech direction and circuit arrangement for implementing the method
</INVENTION-TITLE>
<CLASSIFICATIONS>H04M160	G10L1102	G10L1100	H04M908	H04B146	H04M908	H04M160	H04M910	H04B144	</CLASSIFICATIONS>
<CLASSIFICATIONS-THIRD>H04M	G10L	G10L	H04M	H04B	H04M	H04M	H04M	H04B	</CLASSIFICATIONS-THIRD>
<CLASSIFICATIONS-FOURTH>H04M1	G10L11	G10L11	H04M9	H04B1	H04M9	H04M1	H04M9	H04B1	</CLASSIFICATIONS-FOURTH>
<ABSTRACT>
Method and circuit arrangement in which a received signal is fed with adjustable attenuation to a loudspeaker, in which an adjustable-attenuation signal emitted by a microphone is provided as a transmit signal, in which the received signal and microphone signal are in each case continuously classified as speech signals or noise, in which the attenuation of in each case one signal, which has been classified as a speech signal, is set to a first attenuation value and the respective other signal is set to a second attenuation value which is greater than the first value and is maintained until one signal is classified as noise, in which, if both signals are classified as speech signals, the previous attenuation values are maintained, in which, if both signals are classified as noise, both attenuations are set to a third attenuation value situated between the first and second attenuation values, and in which a transition from the first or second attenuation value to the third attenuation value takes place more slowly than a transition from the third attenuation value to the first or second attenuation value or a transition from the first to the second attenuation value and vice versa. 
<
IMAGE
>
</ABSTRACT>
<APPLICANTS>
<APPLICANT-NAME>
INFINEON TECHNOLOGIES AG
</APPLICANT-NAME>
<APPLICANT-NAME>
INFINEON TECHNOLOGIES AG
</APPLICANT-NAME>
</APPLICANTS>
<INVENTORS>
<INVENTOR-NAME>
DEGENHARDT ACHIM DIPL-ING
</INVENTOR-NAME>
<INVENTOR-NAME>
HENKEL THOMAS DIPL-ING
</INVENTOR-NAME>
<INVENTOR-NAME>
DEGENHARDT, ACHIM, DIPL.-ING.
</INVENTOR-NAME>
<INVENTOR-NAME>
HENKEL, THOMAS, DIPL.-ING.
</INVENTOR-NAME>
</INVENTORS>
<CLAIMS>
Method for the automatic switching of the speech direction, in which a received signal (Rx) with variable attenuation is supplied to a loudspeaker (LS), in which a signal (Mx) with variable attenuation, which is delivered by a microphone (MIC), is provided as transmit signal (Tx), in which the received signal (Rx) and microphone signal (Mx) are in each case continuously classified as a speech signal or as noise, in which the attenuation of the one signal (Rx, Tx) which has been classified as speech signal is in each case set to a first attenuation value (D1) and the other signal (Tx, Rx) is in each case set to a second attenuation value (D2) which is greater than the first one, in which, if both signals have been classified as speech signals, the preceding attenuation values are retained, in which, if both signals (Rx, Tx) have been classified as noise, both attenuations are set to a third attenuation value (D3) lying between the first and the second attenuation value (D1, D2),
characterized in that
 the signal (Lx) supplied to the loudspeaker (LS) and the microphone signal (Mx) are compared with one another with regard to a quantity which can be assigned to the respective signal volume,
in that
 with an attenuation of the microphone signal (Mx) set to the second attenuation value (D2), if a microphone signal (Mx) recognized as speech signal is louder than the loudspeaker signal (Lx) by a certain first difference amount, the attenuation of the microphone signal is set to the first attenuation value (D1) and the attenuation of the received signal (Rx) is set to the second attenuation value (D2) and otherwise the previous attenuations are retained and 
in that
, with an attenuation of the received signal (Rx) set to the second attenuation value (D2), if a received signal (Rx) recognized as speech signal is louder than the transmit signal (Tx) by a certain second difference amount, the attenuation of the received signal (Rx) is set to the first attenuation value (D1) and the attenuation of the microphone
 signal (Mx) is set to the second attenuation value (D2) and otherwise the previous attenuations are retained.
Method according to Claim 1, 
characterized in that
 the quantity which can be assigned to the respective signal volume is the respective signal amplitude multiplied by a weighting factor.
Method according to Claim 1, 
characterized in that
 a transition from the first or the second attenuation value (D1, D2) to the third attenuation value (D3) is slower than a transition from the third attenuation value (D3) to the first or second attenuation value (D1, D2) or a transition from the first to the second attenuation value (D1, D2) or conversely.
Method according to one of Claims 1 to 3, 
characterized in that
, after a change from a speech signal to a noise in the received signal (Rx) and/or microphone signal (Mx), a transition from a first and/or second attenuation value ((D1, D2) to the third attenuation value (D3) is effected after a given delay time has elapsed.
Method according to one of Claims 1 to 4, 
characterized in that
, for classifying the received signal (Rx) and microphone signal (Mx) as speech signal or noise, the following method steps are provided:

• forming the amount of the respective signal (Rx, Mx)
• amplitude companding
• first low-pass filtering with a given time constant
• second low-pass filtering with a given time constant
• comparing the signal before the second low-pass filtering minus an adjustable offset signal with the signal after the second low-pass filtering
• classifying the signal as speech signal when the signal before the second low-pass filtering minus the offset signal predominates or classifying the signal as noise
 when the signal after the second low-pass filtering predominates.
Method according to Claim 5, 
characterized in that
, after the first low-pass filtering, a peak-value detection with two alternative decay time constants is performed, 
in that
 two alternative time constants are provided in the second low-pass filtering, and 
in that
, with the peak value detector PD1 and second low-pass filtering, the greater time constant in each case is set when the signal is classified as speech signal and the smaller time constant in each case is set when the signal is classified as noise.
Method according to Claim 5 or 6, 
characterized in that
 the given time constant of the first low-pass filtering is greater for the microphone signal (Mx) than that for the received signal (Rx).
Method according to Claim 5, 6 or 7, 
characterized in that
 in the microphone signal (Mx) or in the received signal (Rx), respectively, an internal state in the second low-pass filtering is set to an amplitude value which is greater than the instantaneous amplitude value of the respective signal (Rx, Mx) when the classification of the received signal (Rx) or of the microphone signal (Mx), respectively, changes from speech signal to noise and the respective signal (Rx, Mx) is classified as noise.
Method according to Claim 8, 
characterized in that
 the internal state in the second low-pass filtering is set to the maximum amplitude value (MA).
Method according to one of Claims 5 to 9, 
characterized in that
 the offset signal (O) of a signal-noise detector (NMT, NMR) is raised when the other signal-noise detector (NMR, NMT) classifies its input signal as a speech signal.
Method according to one of Claims 8 to 10, 
characterized in that
 after the transition from speech to noise in a signal-noise detector (NMT, NMR), the offset signal (O) and/or the instantaneous amplitude value of the other signal-noise detector in each case (NMR, NMT) is held for a given time.
Method according to one of Claims 1 to 11, 
characterized by
 time- and amplitude-discrete signal processing.
Method according to Claims 5 and 12, 
characterized in that
 in at least one low-pass filtering, the time- and amplitude-discrete signal to be filtered is multiplied by a give factor and added to the delayed filtered time- and amplitude-discrete signal and 
in that
 from this the filtered signal multiplied by the given factor and delayed is subtracted.
Method according to Claim 13, 
characterized in that
 the given factor is equal to an n
th
 power of 2 and 
in that
, instead of the multiplication, shift operations and n positions are provided.
Method according to Claims 2 and 13, 
characterized in that
 a transition from the second attenuation value (D2) to the third one (D3) is effected by a continuous subtraction of the instantaneous value, shifted to the right arithmetically by k positions, of the attenuation from the instantaneous value up until the third attenuation value (D3) is reached and 
in that
 a transition from the first attenuation value (D1) to the third one (D3) is effected by continuous addition of the instantaneous value, shifted to the right arithmetically by k positions, until the third attenuation value (D3) is reached.
Circuit arrangement for automatic switching of the speech direction comprising a controllable receive attenuator
 (AR), at the input of which the received signal (Rx) is applied and at the output of which a signal (Lx) provided for driving the loudspeaker (LS) is present, a controllable transmit attenuator (AT), at the input of which the microphone signal (Mx) is applied and at the output of which the transmit signal (Tx) is present, two signal-noise detectors (NMR, NMT), one of which (NMR) is supplied with the received signal (Rx) or the loudspeaker signal (Lx) and the other one of which (NMT) is supplied with the microphone signal (Mx) or the transmit signal (Tx) and which continuously classifies the received signal (Rx) and the transmit signal (Tx) as speech signal or noise, and with a control logic (ACL), following the signal-noise detectors (NMR, NMT), for controlling the received and transmit attenuator (AR, AT), which, in each case, sets the attenuation of the signal branch, the signal (Tx, Rx) of which has been classified as speech signal, to a first attenuation value and the other signal in each case (Rx, Tx) to a second attenuation value which is greater than the first one and sets a third attenuation value lying between the first and second attenuation value if both signals (Tx, Rx) have been classified as noise,
characterized in that
 a comparison device (CC), which compares the signal (Lx) supplied to the loudspeaker and the microphone signal (Mx) with one another and the transmit signal (Tx) and the received signal (Rx) with one another with regard to a quantity which can be allocated to the respective signal volume, is coupled to the control logic (ACL), and 
in that
 the control logic (ACL), with a transmit attenuator (AT) set to the second attenuation value, if a microphone signal (Mx) recognized as the speech signal is louder than the loudspeaker signal (Lx) by a certain amount, sets the attenuation of the transmit attenuator (AT) equal to the first attenuation value and the attenuation of the received attenuator (AR) equal to the second attenuation value, with a receive attenuator (AR) set to the second attenuation value, if a received signal (Rx) recognized as
 speech signal is louder than the transmit signal (Tx) by a certain amount sets the receive attenuator (AR) to the first attenuation value and the attenuation of the transmit attenuator (AT) to the second attenuation value and otherwise retains the previous attenuations.
Circuit arrangement according to Claim 16, 
characterized in that
 the signal-noise detectors (NMR, NMT) in each case consist of a rectifier (AV) at the input (E), a compander (CP) following the rectifier (AV), a first low-pass filter (LP1) following the compander (CP), a second low-pass filter (LP2) following the first low-pass filter (LP1), and an evaluating circuit (CU) at the output (A) which is supplied with the input signal of the second low-pass filter (LP2) minus the controllable offset signal (02) and minus the output signal of the second low-pass filter (LP2).
The circuit arrangement according to Claim 17, 
characterized in that
 the first low-pass filter (LP1) is followed by a peak value detector with an adjustable decay time constant (PD), 
in that
 the time constant of the second low-pass filter (LP2) is adjustable and 
in that
 the control inputs of peak value detector (PD) and second low-pass filter (LP2) are connected to the evaluating circuit (CU) for adjusting the time constant.
Circuit arrangement according to one of Claims 16 to 18, 
characterized in that
 the comparison device (CC) has a comparator (KP), the output signal of which is supplied to the control logic (ACL) and the inputs of which are in each case preceded by a further peak value detector (PD1, PD2) with a given time constant, 
in that
 the further peak value detectors (PD1, PD2) are in each case preceded by a logarithmic amplifier (LA1, LA2) and these are in turn preceded in each case by a level matching unit (GS1, GS2), 
in that
 the control logic (ACL), if the attenuation of the receive attenuator (AR) is set to the second attenuation
 value, connects the received signal (Rx) and transmit signal (Tx) to in each case one of the level matching units (GS1, GS2) by means of a switching device (SU), and superimposes an offset signal (O1) corresponding to the second difference amount on the signals at the input of the comparator (KP), and, if the attenuation of the transmit attenuator (AT) is set to the second attenuation value, connects the loudspeaker signal (Lx) and microphone signal (Mx) to in each case one of the level matching units (GS1, GS2) by means of the switching device (SU), and superimposes an offset signal (O1) corresponding to the first difference amount on the signals at the input of the comparator (KP).
Circuit arrangement according to Claim 19, 
characterized in that
 the attenuations or amplifications of the level matching units (GS1, GS2) are set in dependence on a corresponding control signal of the control logic (ACL).
Circuit arrangement according to one of Claims 17 to 20, 
characterized in that
 peak value detectors (PD1, PD2) are set in dependence on a corresponding control signal of the control logic (ACL).
</CLAIMS>
</TEXT>
</DOC>
